var Vo=Object.defineProperty;var eo=e=>{throw TypeError(e)};var zo=(e,i,s)=>i in e?Vo(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s;var an=(e,i,s)=>zo(e,typeof i!="symbol"?i+"":i,s),Ts=(e,i,s)=>i.has(e)||eo("Cannot "+s);var ft=(e,i,s)=>(Ts(e,i,"read from private field"),s?s.call(e):i.get(e)),cr=(e,i,s)=>i.has(e)?eo("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,s),lr=(e,i,s,a)=>(Ts(e,i,"write to private field"),a?a.call(e,s):i.set(e,s),s),or=(e,i,s)=>(Ts(e,i,"access private method"),s);var Tn=(e,i,s,a)=>({set _(c){lr(e,i,c,s)},get _(){return ft(e,i,a)}});function _mergeNamespaces(e,i){for(var s=0;s<i.length;s++){const a=i[s];if(typeof a!="string"&&!Array.isArray(a)){for(const c in a)if(c!=="default"&&!(c in e)){const d=Object.getOwnPropertyDescriptor(a,c);d&&Object.defineProperty(e,c,d.get?d:{enumerable:!0,get:()=>a[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function s(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(c){if(c.ep)return;c.ep=!0;const d=s(c);fetch(c.href,d)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var s=function a(){return this instanceof a?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};s.prototype=i.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var c=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(s,a,c.get?c:{enumerable:!0,get:function(){return e[a]}})}),s}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$2={};function E$2(e,i,s){this.props=e,this.context=i,this.refs=D$2,this.updater=s||B$1}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$2.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$2.prototype;function G$1(e,i,s){this.props=e,this.context=i,this.refs=D$2,this.updater=s||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$2.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(e,i,s){var a,c={},d=null,h=null;if(i!=null)for(a in i.ref!==void 0&&(h=i.ref),i.key!==void 0&&(d=""+i.key),i)J.call(i,a)&&!L$2.hasOwnProperty(a)&&(c[a]=i[a]);var g=arguments.length-2;if(g===1)c.children=s;else if(1<g){for(var _=Array(g),b=0;b<g;b++)_[b]=arguments[b+2];c.children=_}if(e&&e.defaultProps)for(a in g=e.defaultProps,g)c[a]===void 0&&(c[a]=g[a]);return{$$typeof:l$1,type:e,key:d,ref:h,props:c,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape$1(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return i[s]})}var P$2=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape$1(""+e.key):i.toString(36)}function R$1(e,i,s,a,c){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(d){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:h=!0}}if(h)return h=e,c=c(h),e=a===""?"."+Q$1(h,0):a,I$1(c)?(s="",e!=null&&(s=e.replace(P$2,"$&/")+"/"),R$1(c,i,s,"",function(b){return b})):c!=null&&(O$1(c)&&(c=N$1(c,s+(!c.key||h&&h.key===c.key?"":(""+c.key).replace(P$2,"$&/")+"/")+e)),i.push(c)),1;if(h=0,a=a===""?".":a+":",I$1(e))for(var g=0;g<e.length;g++){d=e[g];var _=a+Q$1(d,g);h+=R$1(d,i,s,_,c)}else if(_=A$1(e),typeof _=="function")for(e=_.call(e),g=0;!(d=e.next()).done;)d=d.value,_=a+Q$1(d,g++),h+=R$1(d,i,s,_,c);else if(d==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return h}function S$1(e,i,s){if(e==null)return e;var a=[],c=0;return R$1(e,a,"","",function(d){return i.call(s,d,c++)}),a}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,i,s){S$1(e,function(){i.apply(this,arguments)},s)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$2;react_production_min.Fragment=p$2;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$2;react_production_min.cloneElement=function(e,i,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=C$1({},e.props),c=e.key,d=e.ref,h=e._owner;if(i!=null){if(i.ref!==void 0&&(d=i.ref,h=K$1.current),i.key!==void 0&&(c=""+i.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(_ in i)J.call(i,_)&&!L$2.hasOwnProperty(_)&&(a[_]=i[_]===void 0&&g!==void 0?g[_]:i[_])}var _=arguments.length-2;if(_===1)a.children=s;else if(1<_){g=Array(_);for(var b=0;b<_;b++)g[b]=arguments[b+2];a.children=g}return{$$typeof:l$1,type:e.type,key:c,ref:d,props:a,_owner:h}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$2;react_production_min.createFactory=function(e){var i=M$2.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$2,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(e,i){return U$1.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$1.current.useEffect(e,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,i,s){return U$1.current.useImperativeHandle(e,i,s)};react_production_min.useInsertionEffect=function(e,i){return U$1.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$1.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$1.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,s){return U$1.current.useReducer(e,i,s)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,s){return U$1.current.useSyncExternalStore(e,i,s)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const o=getDefaultExportFromCjs(reactExports),React=_mergeNamespaces({__proto__:null,default:o},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,s){var a,c={},d=null,h=null;s!==void 0&&(d=""+s),i.key!==void 0&&(d=""+i.key),i.ref!==void 0&&(h=i.ref);for(a in i)m$1.call(i,a)&&!p$1.hasOwnProperty(a)&&(c[a]=i[a]);if(e&&e.defaultProps)for(a in i=e.defaultProps,i)c[a]===void 0&&(c[a]=i[a]);return{$$typeof:k,type:e,key:d,ref:h,props:c,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(qt,kt){var Xt=qt.length;qt.push(kt);e:for(;0<Xt;){var sr=Xt-1>>>1,At=qt[sr];if(0<c(At,kt))qt[sr]=kt,qt[Xt]=At,Xt=sr;else break e}}function s(qt){return qt.length===0?null:qt[0]}function a(qt){if(qt.length===0)return null;var kt=qt[0],Xt=qt.pop();if(Xt!==kt){qt[0]=Xt;e:for(var sr=0,At=qt.length,ht=At>>>1;sr<ht;){var dt=2*(sr+1)-1,Tt=qt[dt],Mt=dt+1,It=qt[Mt];if(0>c(Tt,Xt))Mt<At&&0>c(It,Tt)?(qt[sr]=It,qt[Mt]=Xt,sr=Mt):(qt[sr]=Tt,qt[dt]=Xt,sr=dt);else if(Mt<At&&0>c(It,Xt))qt[sr]=It,qt[Mt]=Xt,sr=Mt;else break e}}return kt}function c(qt,kt){var Xt=qt.sortIndex-kt.sortIndex;return Xt!==0?Xt:qt.id-kt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();e.unstable_now=function(){return h.now()-g}}var _=[],b=[],_e=1,nt=null,it=3,et=!1,lt=!1,rt=!1,at=typeof setTimeout=="function"?setTimeout:null,ot=typeof clearTimeout=="function"?clearTimeout:null,st=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ct(qt){for(var kt=s(b);kt!==null;){if(kt.callback===null)a(b);else if(kt.startTime<=qt)a(b),kt.sortIndex=kt.expirationTime,i(_,kt);else break;kt=s(b)}}function mt(qt){if(rt=!1,ct(qt),!lt)if(s(_)!==null)lt=!0,nr(pt);else{var kt=s(b);kt!==null&&Jt(mt,kt.startTime-qt)}}function pt(qt,kt){lt=!1,rt&&(rt=!1,ot(gt),gt=-1),et=!0;var Xt=it;try{for(ct(kt),nt=s(_);nt!==null&&(!(nt.expirationTime>kt)||qt&&!St());){var sr=nt.callback;if(typeof sr=="function"){nt.callback=null,it=nt.priorityLevel;var At=sr(nt.expirationTime<=kt);kt=e.unstable_now(),typeof At=="function"?nt.callback=At:nt===s(_)&&a(_),ct(kt)}else a(_);nt=s(_)}if(nt!==null)var ht=!0;else{var dt=s(b);dt!==null&&Jt(mt,dt.startTime-kt),ht=!1}return ht}finally{nt=null,it=Xt,et=!1}}var Et=!1,ut=null,gt=-1,xt=5,Pt=-1;function St(){return!(e.unstable_now()-Pt<xt)}function Ct(){if(ut!==null){var qt=e.unstable_now();Pt=qt;var kt=!0;try{kt=ut(!0,qt)}finally{kt?Lt():(Et=!1,ut=null)}}else Et=!1}var Lt;if(typeof st=="function")Lt=function(){st(Ct)};else if(typeof MessageChannel<"u"){var er=new MessageChannel,Kt=er.port2;er.port1.onmessage=Ct,Lt=function(){Kt.postMessage(null)}}else Lt=function(){at(Ct,0)};function nr(qt){ut=qt,Et||(Et=!0,Lt())}function Jt(qt,kt){gt=at(function(){qt(e.unstable_now())},kt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(qt){qt.callback=null},e.unstable_continueExecution=function(){lt||et||(lt=!0,nr(pt))},e.unstable_forceFrameRate=function(qt){0>qt||125<qt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xt=0<qt?Math.floor(1e3/qt):5},e.unstable_getCurrentPriorityLevel=function(){return it},e.unstable_getFirstCallbackNode=function(){return s(_)},e.unstable_next=function(qt){switch(it){case 1:case 2:case 3:var kt=3;break;default:kt=it}var Xt=it;it=kt;try{return qt()}finally{it=Xt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(qt,kt){switch(qt){case 1:case 2:case 3:case 4:case 5:break;default:qt=3}var Xt=it;it=qt;try{return kt()}finally{it=Xt}},e.unstable_scheduleCallback=function(qt,kt,Xt){var sr=e.unstable_now();switch(typeof Xt=="object"&&Xt!==null?(Xt=Xt.delay,Xt=typeof Xt=="number"&&0<Xt?sr+Xt:sr):Xt=sr,qt){case 1:var At=-1;break;case 2:At=250;break;case 5:At=1073741823;break;case 4:At=1e4;break;default:At=5e3}return At=Xt+At,qt={id:_e++,callback:kt,priorityLevel:qt,startTime:Xt,expirationTime:At,sortIndex:-1},Xt>sr?(qt.sortIndex=Xt,i(b,qt),s(_)===null&&qt===s(b)&&(rt?(ot(gt),gt=-1):rt=!0,Jt(mt,Xt-sr))):(qt.sortIndex=At,i(_,qt),lt||et||(lt=!0,nr(pt))),qt},e.unstable_shouldYield=St,e.unstable_wrapCallback=function(qt){var kt=it;return function(){var Xt=it;it=kt;try{return qt.apply(this,arguments)}finally{it=Xt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,s,a){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,s,a){if(i===null||typeof i>"u"||pa(e,i,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v$1(e,i,s,a,c,d,h){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=a,this.attributeNamespace=c,this.mustUseProperty=s,this.propertyName=e,this.type=i,this.sanitizeURL=d,this.removeEmptyString=h}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v$1(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v$1(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v$1(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v$1(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v$1(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v$1(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v$1(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v$1(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v$1(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v$1(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v$1(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v$1(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v$1(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v$1(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,s,a){var c=z.hasOwnProperty(i)?z[i]:null;(c!==null?c.type!==0:a||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,s,c,a)&&(s=null),a||c===null?oa(i)&&(s===null?e.removeAttribute(i):e.setAttribute(i,""+s)):c.mustUseProperty?e[c.propertyName]=s===null?c.type===3?!1:"":s:(i=c.attributeName,a=c.attributeNamespace,s===null?e.removeAttribute(i):(c=c.type,s=c===3||c===4&&s===!0?"":""+s,a?e.setAttributeNS(a,i,s):e.setAttribute(i,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(b){var a=b}Reflect.construct(e,[],i)}else{try{i.call()}catch(b){a=b}e.call(i.prototype)}else{try{throw Error()}catch(b){a=b}e()}}catch(b){if(b&&a&&typeof b.stack=="string"){for(var c=b.stack.split(`
`),d=a.stack.split(`
`),h=c.length-1,g=d.length-1;1<=h&&0<=g&&c[h]!==d[g];)g--;for(;1<=h&&0<=g;h--,g--)if(c[h]!==d[g]){if(h!==1||g!==1)do if(h--,g--,0>g||c[h]!==d[g]){var _=`
`+c[h].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=h&&0<=g);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),a=""+e[i];if(!e.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var c=s.get,d=s.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return c.call(this)},set:function(h){a=""+h,d.call(this,h)}}),Object.defineProperty(e,i,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(h){a=""+h},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var s=i.getValue(),a="";return e&&(a=Ta(e)?e.checked?"true":"false":e.value),e=a,e!==s?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var s=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Za(e,i){var s=i.defaultValue==null?"":i.defaultValue,a=i.checked!=null?i.checked:i.defaultChecked;s=Sa(i.value!=null?i.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var s=Sa(i.value),a=i.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,s):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var a=i.type;if(!(a!=="submit"&&a!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,s||i===e.value||(e.value=i),e.defaultValue=i}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function cb(e,i,s){(i!=="number"||Xa(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var eb=Array.isArray;function fb(e,i,s,a){if(e=e.options,i){i={};for(var c=0;c<s.length;c++)i["$"+s[c]]=!0;for(s=0;s<e.length;s++)c=i.hasOwnProperty("$"+e[s].value),e[s].selected!==c&&(e[s].selected=c),c&&a&&(e[s].defaultSelected=!0)}else{for(s=""+Sa(s),i=null,c=0;c<e.length;c++){if(e[c].value===s){e[c].selected=!0,a&&(e[c].defaultSelected=!0);return}i!==null||e[c].disabled||(i=e[c])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}i=s}i==null&&(i=""),s=i}e._wrapperState={initialValue:Sa(s)}}function ib(e,i){var s=Sa(i.value),a=Sa(i.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),i.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,a,c){MSApp.execUnsafeLocalFunction(function(){return e(i,s,a,c)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var s in i)if(i.hasOwnProperty(s)){var a=s.indexOf("--")===0,c=rb(s,i[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,c):e[s]=c}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,s){if(Ib)return e(i,s);Ib=!0;try{return Gb(e,i,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var s=e.stateNode;if(s===null)return null;var a=Db(s);if(a===null)return null;s=a[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(p(231,i,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,s,a,c,d,h,g,_){var b=Array.prototype.slice.call(arguments,3);try{i.apply(s,b)}catch(_e){this.onError(_e)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,s,a,c,d,h,g,_){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,s,a,c,d,h,g,_){if(Tb.apply(this,arguments),Ob){if(Ob){var b=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=b)}}function Vb(e){var i=e,s=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(s=i.return),e=i.return;while(e)}return i.tag===3?s:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p(188));return i!==e?null:e}for(var s=e,a=i;;){var c=s.return;if(c===null)break;var d=c.alternate;if(d===null){if(a=c.return,a!==null){s=a;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===s)return Xb(c),e;if(d===a)return Xb(c),i;d=d.sibling}throw Error(p(188))}if(s.return!==a.return)s=c,a=d;else{for(var h=!1,g=c.child;g;){if(g===s){h=!0,s=c,a=d;break}if(g===a){h=!0,a=c,s=d;break}g=g.sibling}if(!h){for(g=d.child;g;){if(g===s){h=!0,s=d,a=c;break}if(g===a){h=!0,a=d,s=c;break}g=g.sibling}if(!h)throw Error(p(189))}}if(s.alternate!==a)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var s=e.pendingLanes;if(s===0)return 0;var a=0,c=e.suspendedLanes,d=e.pingedLanes,h=s&268435455;if(h!==0){var g=h&~c;g!==0?a=tc(g):(d&=h,d!==0&&(a=tc(d)))}else h=s&~c,h!==0?a=tc(h):d!==0&&(a=tc(d));if(a===0)return 0;if(i!==0&&i!==a&&!(i&c)&&(c=a&-a,d=i&-i,c>=d||c===16&&(d&4194240)!==0))return i;if(a&4&&(a|=s&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=a;0<i;)s=31-oc(i),c=1<<s,a|=e[s],i&=~c;return a}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var s=e.suspendedLanes,a=e.pingedLanes,c=e.expirationTimes,d=e.pendingLanes;0<d;){var h=31-oc(d),g=1<<h,_=c[h];_===-1?(!(g&s)||g&a)&&(c[h]=vc(g,i)):_<=i&&(e.expiredLanes|=g),d&=~g}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],s=0;31>s;s++)i.push(e);return i}function Ac(e,i,s){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=s}function Bc(e,i){var s=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var c=31-oc(s),d=1<<c;i[c]=0,a[c]=-1,e[c]=-1,s&=~d}}function Cc(e,i){var s=e.entangledLanes|=i;for(e=e.entanglements;s;){var a=31-oc(s),c=1<<a;c&i|e[a]&i&&(e[a]|=i),s&=~c}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,s,a,c,d){return e===null||e.nativeEvent!==d?(e={blockedOn:i,domEventName:s,eventSystemFlags:a,nativeEvent:d,targetContainers:[c]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=a,i=e.targetContainers,c!==null&&i.indexOf(c)===-1&&i.push(c),e)}function Uc(e,i,s,a,c){switch(i){case"focusin":return Lc=Tc(Lc,e,i,s,a,c),!0;case"dragenter":return Mc=Tc(Mc,e,i,s,a,c),!0;case"mouseover":return Nc=Tc(Nc,e,i,s,a,c),!0;case"pointerover":var d=c.pointerId;return Oc.set(d,Tc(Oc.get(d)||null,e,i,s,a,c)),!0;case"gotpointercapture":return d=c.pointerId,Pc.set(d,Tc(Pc.get(d)||null,e,i,s,a,c)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var s=Vb(i);if(s!==null){if(i=s.tag,i===13){if(i=Wb(s),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var s=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);wb=a,s.target.dispatchEvent(a),wb=null}else return i=Cb(s),i!==null&&Fc(i),e.blockedOn=s,!1;i.shift()}return!0}function Zc(e,i,s){Xc(e)&&s.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(c){return ad(c,e)}if(0<Kc.length){ad(Kc[0],e);for(var s=1;s<Kc.length;s++){var a=Kc[s];a.blockedOn===e&&(a.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),s=0;s<Qc.length;s++)a=Qc[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,s,a){var c=C,d=cd.transition;cd.transition=null;try{C=1,fd(e,i,s,a)}finally{C=c,cd.transition=d}}function gd(e,i,s,a){var c=C,d=cd.transition;cd.transition=null;try{C=4,fd(e,i,s,a)}finally{C=c,cd.transition=d}}function fd(e,i,s,a){if(dd){var c=Yc(e,i,s,a);if(c===null)hd(e,i,a,id,s),Sc(e,a);else if(Uc(c,e,i,s,a))a.stopPropagation();else if(Sc(e,a),i&4&&-1<Rc.indexOf(e)){for(;c!==null;){var d=Cb(c);if(d!==null&&Ec(d),d=Yc(e,i,s,a),d===null&&hd(e,i,a,id,s),d===c)break;c=d}c!==null&&a.stopPropagation()}else hd(e,i,a,null,s)}}var id=null;function Yc(e,i,s,a){if(id=null,e=xb(a),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(s=i.tag,s===13){if(e=Wb(i),e!==null)return e;e=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,s=i.length,a,c="value"in kd?kd.value:kd.textContent,d=c.length;for(e=0;e<s&&i[e]===c[e];e++);var h=s-e;for(a=1;a<=h&&i[s-a]===c[d-a];a++);return md=c.slice(e,1<a?1-a:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(s,a,c,d,h){this._reactName=s,this._targetInst=c,this.type=a,this.nativeEvent=d,this.target=h,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(s=e[g],this[g]=s?s(d):d[g]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe=!1;function ge$1(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie$1=!1;function je(e,i){switch(e){case"compositionend":return he$1(i);case"keypress":return i.which!==32?null:(fe=!0,ee$1);case"textInput":return e=i.data,e===ee$1&&fe?null:e;default:return null}}function ke(e,i){if(ie$1)return e==="compositionend"||!ae$1&&ge$1(e,i)?(e=nd(),md=ld=kd=null,ie$1=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de$1&&i.locale!=="ko"?null:i.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le$1[e.type]:i==="textarea"}function ne$1(e,i,s,a){Eb(a),i=oe$1(i,"onChange"),0<i.length&&(s=new td("onChange","change",null,s,a),e.push({event:s,listeners:i}))}var pe$1=null,qe=null;function re(e){se$1(e,0)}function te$1(e){var i=ue(e);if(Wa(i))return e}function ve$1(e,i){if(e==="change")return i}var we$1=!1;if(ia){var xe$1;if(ia){var ye$1="oninput"in document;if(!ye$1){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$1=typeof ze.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae(){pe$1&&(pe$1.detachEvent("onpropertychange",Be),qe=pe$1=null)}function Be(e){if(e.propertyName==="value"&&te$1(qe)){var i=[];ne$1(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,s){e==="focusin"?(Ae(),pe$1=i,qe=s,pe$1.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te$1(qe)}function Ee(e,i){if(e==="click")return te$1(i)}function Fe(e,i){if(e==="input"||e==="change")return te$1(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var s=Object.keys(e),a=Object.keys(i);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var c=s[a];if(!ja.call(i,c)||!He(e[c],i[c]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var s=Je(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=i&&a>=i)return{node:s,offset:i-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Je(s)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),s=e.focusedElem,a=e.selectionRange;if(i!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(a!==null&&Ne(s)){if(i=a.start,e=a.end,e===void 0&&(e=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(e,s.value.length);else if(e=(i=s.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var c=s.textContent.length,d=Math.min(a.start,c);a=a.end===void 0?d:Math.min(a.end,c),!e.extend&&d>a&&(c=a,a=d,d=c),c=Ke(s,d);var h=Ke(s,a);c&&h&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(i=i.createRange(),i.setStart(c.node,c.offset),e.removeAllRanges(),d>a?(e.addRange(i),e.extend(h.node,h.offset)):(i.setEnd(h.node,h.offset),e.addRange(i)))}}for(i=[],e=s;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)e=i[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te$1=!1;function Ue(e,i,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te$1||Qe==null||Qe!==Xa(a)||(a=Qe,"selectionStart"in a&&Ne(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Se&&Ie(Se,a)||(Se=a,a=oe$1(Re,"onSelect"),0<a.length&&(i=new td("onSelect","select",null,i,s),e.push({event:i,listeners:a}),i.target=Qe)))}function Ve(e,i){var s={};return s[e.toLowerCase()]=i.toLowerCase(),s["Webkit"+e]="webkit"+i,s["Moz"+e]="moz"+i,s}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],s;for(s in i)if(i.hasOwnProperty(s)&&s in Ye)return Xe[e]=i[s];return e}var $e$1=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e$1,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,s){var a=e.type||"unknown-event";e.currentTarget=s,Ub(a,i,void 0,e),e.currentTarget=null}function se$1(e,i){i=(i&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],c=a.event;a=a.listeners;e:{var d=void 0;if(i)for(var h=a.length-1;0<=h;h--){var g=a[h],_=g.instance,b=g.currentTarget;if(g=g.listener,_!==d&&c.isPropagationStopped())break e;nf(c,g,b),d=_}else for(h=0;h<a.length;h++){if(g=a[h],_=g.instance,b=g.currentTarget,g=g.listener,_!==d&&c.isPropagationStopped())break e;nf(c,g,b),d=_}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D$1(e,i){var s=i[of];s===void 0&&(s=i[of]=new Set);var a=e+"__bubble";s.has(a)||(pf(i,e,2,!1),s.add(a))}function qf(e,i,s){var a=0;i&&(a|=4),pf(s,e,a,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,e),qf(s,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,s,a){switch(jd(i)){case 1:var c=ed;break;case 4:c=gd;break;default:c=fd}s=c.bind(null,i,s,e),c=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(c=!0),a?c!==void 0?e.addEventListener(i,s,{capture:!0,passive:c}):e.addEventListener(i,s,!0):c!==void 0?e.addEventListener(i,s,{passive:c}):e.addEventListener(i,s,!1)}function hd(e,i,s,a,c){var d=a;if(!(i&1)&&!(i&2)&&a!==null)e:for(;;){if(a===null)return;var h=a.tag;if(h===3||h===4){var g=a.stateNode.containerInfo;if(g===c||g.nodeType===8&&g.parentNode===c)break;if(h===4)for(h=a.return;h!==null;){var _=h.tag;if((_===3||_===4)&&(_=h.stateNode.containerInfo,_===c||_.nodeType===8&&_.parentNode===c))return;h=h.return}for(;g!==null;){if(h=Wc(g),h===null)return;if(_=h.tag,_===5||_===6){a=d=h;continue e}g=g.parentNode}}a=a.return}Jb(function(){var b=d,_e=xb(s),nt=[];e:{var it=df.get(e);if(it!==void 0){var et=td,lt=e;switch(e){case"keypress":if(od(s)===0)break e;case"keydown":case"keyup":et=Rd;break;case"focusin":lt="focus",et=Fd;break;case"focusout":lt="blur",et=Fd;break;case"beforeblur":case"afterblur":et=Fd;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Vd;break;case $e$1:case af:case bf:et=Hd;break;case cf:et=Xd;break;case"scroll":et=vd;break;case"wheel":et=Zd;break;case"copy":case"cut":case"paste":et=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=Td}var rt=(i&4)!==0,at=!rt&&e==="scroll",ot=rt?it!==null?it+"Capture":null:it;rt=[];for(var st=b,ct;st!==null;){ct=st;var mt=ct.stateNode;if(ct.tag===5&&mt!==null&&(ct=mt,ot!==null&&(mt=Kb(st,ot),mt!=null&&rt.push(tf(st,mt,ct)))),at)break;st=st.return}0<rt.length&&(it=new et(it,lt,null,s,_e),nt.push({event:it,listeners:rt}))}}if(!(i&7)){e:{if(it=e==="mouseover"||e==="pointerover",et=e==="mouseout"||e==="pointerout",it&&s!==wb&&(lt=s.relatedTarget||s.fromElement)&&(Wc(lt)||lt[uf]))break e;if((et||it)&&(it=_e.window===_e?_e:(it=_e.ownerDocument)?it.defaultView||it.parentWindow:window,et?(lt=s.relatedTarget||s.toElement,et=b,lt=lt?Wc(lt):null,lt!==null&&(at=Vb(lt),lt!==at||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(et=null,lt=b),et!==lt)){if(rt=Bd,mt="onMouseLeave",ot="onMouseEnter",st="mouse",(e==="pointerout"||e==="pointerover")&&(rt=Td,mt="onPointerLeave",ot="onPointerEnter",st="pointer"),at=et==null?it:ue(et),ct=lt==null?it:ue(lt),it=new rt(mt,st+"leave",et,s,_e),it.target=at,it.relatedTarget=ct,mt=null,Wc(_e)===b&&(rt=new rt(ot,st+"enter",lt,s,_e),rt.target=ct,rt.relatedTarget=at,mt=rt),at=mt,et&&lt)t:{for(rt=et,ot=lt,st=0,ct=rt;ct;ct=vf(ct))st++;for(ct=0,mt=ot;mt;mt=vf(mt))ct++;for(;0<st-ct;)rt=vf(rt),st--;for(;0<ct-st;)ot=vf(ot),ct--;for(;st--;){if(rt===ot||ot!==null&&rt===ot.alternate)break t;rt=vf(rt),ot=vf(ot)}rt=null}else rt=null;et!==null&&wf(nt,it,et,rt,!1),lt!==null&&at!==null&&wf(nt,at,lt,rt,!0)}}e:{if(it=b?ue(b):window,et=it.nodeName&&it.nodeName.toLowerCase(),et==="select"||et==="input"&&it.type==="file")var pt=ve$1;else if(me$1(it))if(we$1)pt=Fe;else{pt=De;var Et=Ce}else(et=it.nodeName)&&et.toLowerCase()==="input"&&(it.type==="checkbox"||it.type==="radio")&&(pt=Ee);if(pt&&(pt=pt(e,b))){ne$1(nt,pt,s,_e);break e}Et&&Et(e,it,b),e==="focusout"&&(Et=it._wrapperState)&&Et.controlled&&it.type==="number"&&cb(it,"number",it.value)}switch(Et=b?ue(b):window,e){case"focusin":(me$1(Et)||Et.contentEditable==="true")&&(Qe=Et,Re=b,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue(nt,s,_e);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(nt,s,_e)}var ut;if(ae$1)e:{switch(e){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else ie$1?ge$1(e,s)&&(gt="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(gt="onCompositionStart");gt&&(de$1&&s.locale!=="ko"&&(ie$1||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&ie$1&&(ut=nd()):(kd=_e,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),Et=oe$1(b,gt),0<Et.length&&(gt=new Ld(gt,e,null,s,_e),nt.push({event:gt,listeners:Et}),ut?gt.data=ut:(ut=he$1(s),ut!==null&&(gt.data=ut)))),(ut=ce$1?je(e,s):ke(e,s))&&(b=oe$1(b,"onBeforeInput"),0<b.length&&(_e=new Ld("onBeforeInput","beforeinput",null,s,_e),nt.push({event:_e,listeners:b}),_e.data=ut))}se$1(nt,i)})}function tf(e,i,s){return{instance:e,listener:i,currentTarget:s}}function oe$1(e,i){for(var s=i+"Capture",a=[];e!==null;){var c=e,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=Kb(e,s),d!=null&&a.unshift(tf(e,d,c)),d=Kb(e,i),d!=null&&a.push(tf(e,d,c))),e=e.return}return a}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,s,a,c){for(var d=i._reactName,h=[];s!==null&&s!==a;){var g=s,_=g.alternate,b=g.stateNode;if(_!==null&&_===a)break;g.tag===5&&b!==null&&(g=b,c?(_=Kb(s,d),_!=null&&h.unshift(tf(s,_,g))):c||(_=Kb(s,d),_!=null&&h.push(tf(s,_,g)))),s=s.return}h.length!==0&&e.push({event:i,listeners:h})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,s){if(i=zf(i),zf(e)!==i&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var s=i,a=0;do{var c=s.nextSibling;if(e.removeChild(s),c&&c.nodeType===8)if(s=c.data,s==="/$"){if(a===0){e.removeChild(c),bd(i);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=c}while(s);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return e;i--}else s==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var s=e.parentNode;s;){if(i=s[uf]||s[Of]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(e=Mf(e);e!==null;){if(s=e[Of])return s;e=Mf(e)}return i}e=s,s=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E$1(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var s=e.type.contextTypes;if(!s)return Vf;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===i)return a.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in s)c[d]=i[d];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=c),c}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E$1(Wf),E$1(H)}function ag(e,i,s){if(H.current!==Vf)throw Error(p(168));G(H,i),G(Wf,s)}function bg(e,i,s){var a=e.stateNode;if(i=i.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var c in a)if(!(c in i))throw Error(p(108,Ra(e)||"Unknown",c));return A({},s,a)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,s){var a=e.stateNode;if(!a)throw Error(p(169));s?(e=bg(e,i,Xf),a.__reactInternalMemoizedMergedChildContext=e,E$1(Wf),E$1(H),G(H,e)):E$1(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var s=eg;for(C=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}eg=null,fg=!1}catch(c){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),c}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var a=rg;e=sg;var c=32-oc(a)-1;a&=~(1<<c),s+=1;var d=32-oc(i)+c;if(30<d){var h=c-c%5;d=(a&(1<<h)-1).toString(32),a>>=h,c-=h,rg=1<<32-oc(i)+c|s<<c|a,sg=d+e}else rg=1<<d|s<<c|a,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=e,i=e.deletions,i===null?(e.deletions=[s],e.flags|=16):i.push(s)}function Cg(e,i){switch(e.tag){case 5:var s=e.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=i,s.return=e,e.child=s,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var s=i;if(!Cg(e,i)){if(Dg(e))throw Error(p(418));i=Lf(s.nextSibling);var a=xg;i&&Cg(e,i)?Ag(a,s):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(i===0){yg=Lf(e.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var a=s.stateNode}if(!a)throw Error(p(147,e));var c=a,d=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===d?i.ref:(i=function(h){var g=c.refs;h===null?delete g[d]:g[d]=h},i._stringRef=d,i)}if(typeof e!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,e))}return e}function Mg(e,i){throw e=Object.prototype.toString.call(i),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function Ng(e){var i=e._init;return i(e._payload)}function Og(e){function i(ot,st){if(e){var ct=ot.deletions;ct===null?(ot.deletions=[st],ot.flags|=16):ct.push(st)}}function s(ot,st){if(!e)return null;for(;st!==null;)i(ot,st),st=st.sibling;return null}function a(ot,st){for(ot=new Map;st!==null;)st.key!==null?ot.set(st.key,st):ot.set(st.index,st),st=st.sibling;return ot}function c(ot,st){return ot=Pg(ot,st),ot.index=0,ot.sibling=null,ot}function d(ot,st,ct){return ot.index=ct,e?(ct=ot.alternate,ct!==null?(ct=ct.index,ct<st?(ot.flags|=2,st):ct):(ot.flags|=2,st)):(ot.flags|=1048576,st)}function h(ot){return e&&ot.alternate===null&&(ot.flags|=2),ot}function g(ot,st,ct,mt){return st===null||st.tag!==6?(st=Qg(ct,ot.mode,mt),st.return=ot,st):(st=c(st,ct),st.return=ot,st)}function _(ot,st,ct,mt){var pt=ct.type;return pt===ya?_e(ot,st,ct.props.children,mt,ct.key):st!==null&&(st.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===Ha&&Ng(pt)===st.type)?(mt=c(st,ct.props),mt.ref=Lg(ot,st,ct),mt.return=ot,mt):(mt=Rg(ct.type,ct.key,ct.props,null,ot.mode,mt),mt.ref=Lg(ot,st,ct),mt.return=ot,mt)}function b(ot,st,ct,mt){return st===null||st.tag!==4||st.stateNode.containerInfo!==ct.containerInfo||st.stateNode.implementation!==ct.implementation?(st=Sg(ct,ot.mode,mt),st.return=ot,st):(st=c(st,ct.children||[]),st.return=ot,st)}function _e(ot,st,ct,mt,pt){return st===null||st.tag!==7?(st=Tg(ct,ot.mode,mt,pt),st.return=ot,st):(st=c(st,ct),st.return=ot,st)}function nt(ot,st,ct){if(typeof st=="string"&&st!==""||typeof st=="number")return st=Qg(""+st,ot.mode,ct),st.return=ot,st;if(typeof st=="object"&&st!==null){switch(st.$$typeof){case va:return ct=Rg(st.type,st.key,st.props,null,ot.mode,ct),ct.ref=Lg(ot,null,st),ct.return=ot,ct;case wa:return st=Sg(st,ot.mode,ct),st.return=ot,st;case Ha:var mt=st._init;return nt(ot,mt(st._payload),ct)}if(eb(st)||Ka(st))return st=Tg(st,ot.mode,ct,null),st.return=ot,st;Mg(ot,st)}return null}function it(ot,st,ct,mt){var pt=st!==null?st.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number")return pt!==null?null:g(ot,st,""+ct,mt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case va:return ct.key===pt?_(ot,st,ct,mt):null;case wa:return ct.key===pt?b(ot,st,ct,mt):null;case Ha:return pt=ct._init,it(ot,st,pt(ct._payload),mt)}if(eb(ct)||Ka(ct))return pt!==null?null:_e(ot,st,ct,mt,null);Mg(ot,ct)}return null}function et(ot,st,ct,mt,pt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return ot=ot.get(ct)||null,g(st,ot,""+mt,pt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return ot=ot.get(mt.key===null?ct:mt.key)||null,_(st,ot,mt,pt);case wa:return ot=ot.get(mt.key===null?ct:mt.key)||null,b(st,ot,mt,pt);case Ha:var Et=mt._init;return et(ot,st,ct,Et(mt._payload),pt)}if(eb(mt)||Ka(mt))return ot=ot.get(ct)||null,_e(st,ot,mt,pt,null);Mg(st,mt)}return null}function lt(ot,st,ct,mt){for(var pt=null,Et=null,ut=st,gt=st=0,xt=null;ut!==null&&gt<ct.length;gt++){ut.index>gt?(xt=ut,ut=null):xt=ut.sibling;var Pt=it(ot,ut,ct[gt],mt);if(Pt===null){ut===null&&(ut=xt);break}e&&ut&&Pt.alternate===null&&i(ot,ut),st=d(Pt,st,gt),Et===null?pt=Pt:Et.sibling=Pt,Et=Pt,ut=xt}if(gt===ct.length)return s(ot,ut),I&&tg(ot,gt),pt;if(ut===null){for(;gt<ct.length;gt++)ut=nt(ot,ct[gt],mt),ut!==null&&(st=d(ut,st,gt),Et===null?pt=ut:Et.sibling=ut,Et=ut);return I&&tg(ot,gt),pt}for(ut=a(ot,ut);gt<ct.length;gt++)xt=et(ut,ot,gt,ct[gt],mt),xt!==null&&(e&&xt.alternate!==null&&ut.delete(xt.key===null?gt:xt.key),st=d(xt,st,gt),Et===null?pt=xt:Et.sibling=xt,Et=xt);return e&&ut.forEach(function(St){return i(ot,St)}),I&&tg(ot,gt),pt}function rt(ot,st,ct,mt){var pt=Ka(ct);if(typeof pt!="function")throw Error(p(150));if(ct=pt.call(ct),ct==null)throw Error(p(151));for(var Et=pt=null,ut=st,gt=st=0,xt=null,Pt=ct.next();ut!==null&&!Pt.done;gt++,Pt=ct.next()){ut.index>gt?(xt=ut,ut=null):xt=ut.sibling;var St=it(ot,ut,Pt.value,mt);if(St===null){ut===null&&(ut=xt);break}e&&ut&&St.alternate===null&&i(ot,ut),st=d(St,st,gt),Et===null?pt=St:Et.sibling=St,Et=St,ut=xt}if(Pt.done)return s(ot,ut),I&&tg(ot,gt),pt;if(ut===null){for(;!Pt.done;gt++,Pt=ct.next())Pt=nt(ot,Pt.value,mt),Pt!==null&&(st=d(Pt,st,gt),Et===null?pt=Pt:Et.sibling=Pt,Et=Pt);return I&&tg(ot,gt),pt}for(ut=a(ot,ut);!Pt.done;gt++,Pt=ct.next())Pt=et(ut,ot,gt,Pt.value,mt),Pt!==null&&(e&&Pt.alternate!==null&&ut.delete(Pt.key===null?gt:Pt.key),st=d(Pt,st,gt),Et===null?pt=Pt:Et.sibling=Pt,Et=Pt);return e&&ut.forEach(function(Ct){return i(ot,Ct)}),I&&tg(ot,gt),pt}function at(ot,st,ct,mt){if(typeof ct=="object"&&ct!==null&&ct.type===ya&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case va:e:{for(var pt=ct.key,Et=st;Et!==null;){if(Et.key===pt){if(pt=ct.type,pt===ya){if(Et.tag===7){s(ot,Et.sibling),st=c(Et,ct.props.children),st.return=ot,ot=st;break e}}else if(Et.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===Ha&&Ng(pt)===Et.type){s(ot,Et.sibling),st=c(Et,ct.props),st.ref=Lg(ot,Et,ct),st.return=ot,ot=st;break e}s(ot,Et);break}else i(ot,Et);Et=Et.sibling}ct.type===ya?(st=Tg(ct.props.children,ot.mode,mt,ct.key),st.return=ot,ot=st):(mt=Rg(ct.type,ct.key,ct.props,null,ot.mode,mt),mt.ref=Lg(ot,st,ct),mt.return=ot,ot=mt)}return h(ot);case wa:e:{for(Et=ct.key;st!==null;){if(st.key===Et)if(st.tag===4&&st.stateNode.containerInfo===ct.containerInfo&&st.stateNode.implementation===ct.implementation){s(ot,st.sibling),st=c(st,ct.children||[]),st.return=ot,ot=st;break e}else{s(ot,st);break}else i(ot,st);st=st.sibling}st=Sg(ct,ot.mode,mt),st.return=ot,ot=st}return h(ot);case Ha:return Et=ct._init,at(ot,st,Et(ct._payload),mt)}if(eb(ct))return lt(ot,st,ct,mt);if(Ka(ct))return rt(ot,st,ct,mt);Mg(ot,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"?(ct=""+ct,st!==null&&st.tag===6?(s(ot,st.sibling),st=c(st,ct),st.return=ot,ot=st):(s(ot,st),st=Qg(ct,ot.mode,mt),st.return=ot,ot=st),h(ot)):s(ot,st)}return at}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var i=Wg.current;E$1(Wg),e._currentValue=i}function bh(e,i,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,a!==null&&(a.childLanes|=i)):a!==null&&(a.childLanes&i)!==i&&(a.childLanes|=i),e===s)break;e=e.return}}function ch(e,i){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(dh=!0),e.firstContext=null)}function eh(e){var i=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return i}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,i,s,a){var c=i.interleaved;return c===null?(s.next=s,gh(i)):(s.next=c.next,c.next=s),i.interleaved=s,ih(e,a)}function ih(e,i){e.lanes|=i;var s=e.alternate;for(s!==null&&(s.lanes|=i),s=e,e=e.return;e!==null;)e.childLanes|=i,s=e.alternate,s!==null&&(s.childLanes|=i),s=e,e=e.return;return s.tag===3?s.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(e,i,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,K&2){var c=a.pending;return c===null?i.next=i:(i.next=c.next,c.next=i),a.pending=i,ih(e,s)}return c=a.interleaved,c===null?(i.next=i,gh(a)):(i.next=c.next,c.next=i),a.interleaved=i,ih(e,s)}function oh(e,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var a=i.lanes;a&=e.pendingLanes,s|=a,i.lanes=s,Cc(e,s)}}function ph(e,i){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var c=null,d=null;if(s=s.firstBaseUpdate,s!==null){do{var h={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};d===null?c=d=h:d=d.next=h,s=s.next}while(s!==null);d===null?c=d=i:d=d.next=i}else c=d=i;s={baseState:a.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=i:e.next=i,s.lastBaseUpdate=i}function qh(e,i,s,a){var c=e.updateQueue;jh=!1;var d=c.firstBaseUpdate,h=c.lastBaseUpdate,g=c.shared.pending;if(g!==null){c.shared.pending=null;var _=g,b=_.next;_.next=null,h===null?d=b:h.next=b,h=_;var _e=e.alternate;_e!==null&&(_e=_e.updateQueue,g=_e.lastBaseUpdate,g!==h&&(g===null?_e.firstBaseUpdate=b:g.next=b,_e.lastBaseUpdate=_))}if(d!==null){var nt=c.baseState;h=0,_e=b=_=null,g=d;do{var it=g.lane,et=g.eventTime;if((a&it)===it){_e!==null&&(_e=_e.next={eventTime:et,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var lt=e,rt=g;switch(it=i,et=s,rt.tag){case 1:if(lt=rt.payload,typeof lt=="function"){nt=lt.call(et,nt,it);break e}nt=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=rt.payload,it=typeof lt=="function"?lt.call(et,nt,it):lt,it==null)break e;nt=A({},nt,it);break e;case 2:jh=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,it=c.effects,it===null?c.effects=[g]:it.push(g))}else et={eventTime:et,lane:it,tag:g.tag,payload:g.payload,callback:g.callback,next:null},_e===null?(b=_e=et,_=nt):_e=_e.next=et,h|=it;if(g=g.next,g===null){if(g=c.shared.pending,g===null)break;it=g,g=it.next,it.next=null,c.lastBaseUpdate=it,c.shared.pending=null}}while(!0);if(_e===null&&(_=nt),c.baseState=_,c.firstBaseUpdate=b,c.lastBaseUpdate=_e,i=c.shared.interleaved,i!==null){c=i;do h|=c.lane,c=c.next;while(c!==i)}else d===null&&(c.shared.lanes=0);rh|=h,e.lanes=h,e.memoizedState=nt}}function sh(e,i,s){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var a=e[i],c=a.callback;if(c!==null){if(a.callback=null,a=s,typeof c!="function")throw Error(p(191,c));c.call(a)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,i){switch(G(wh,i),G(vh,e),G(uh,th),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E$1(uh),G(uh,i)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(e){xh(wh.current);var i=xh(uh.current),s=lb(i,e.type);i!==s&&(G(vh,e),G(uh,s))}function Bh(e){vh.current===e&&(E$1(uh),E$1(vh))}var L$1=Uf(0);function Ch(e){for(var i=e;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$1=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p(321))}function Mh(e,i){if(i===null)return!1;for(var s=0;s<i.length&&s<e.length;s++)if(!He(e[s],i[s]))return!1;return!0}function Nh(e,i,s,a,c,d){if(Hh=d,M$1=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=s(a,c),Jh){d=0;do{if(Jh=!1,Kh=0,25<=d)throw Error(p(301));d+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,e=s(a,c)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M$1=null,Ih=!1,i)throw Error(p(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M$1.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M$1.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var i=O===null?M$1.memoizedState:O.next;if(i!==null)O=i,N=e;else{if(e===null)throw Error(p(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M$1.memoizedState=O=e:O=O.next=e}return O}function Vh(e,i){return typeof i=="function"?i(e):i}function Wh(e){var i=Uh(),s=i.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var a=N,c=a.baseQueue,d=s.pending;if(d!==null){if(c!==null){var h=c.next;c.next=d.next,d.next=h}a.baseQueue=c=d,s.pending=null}if(c!==null){d=c.next,a=a.baseState;var g=h=null,_=null,b=d;do{var _e=b.lane;if((Hh&_e)===_e)_!==null&&(_=_.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),a=b.hasEagerState?b.eagerState:e(a,b.action);else{var nt={lane:_e,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};_===null?(g=_=nt,h=a):_=_.next=nt,M$1.lanes|=_e,rh|=_e}b=b.next}while(b!==null&&b!==d);_===null?h=a:_.next=g,He(a,i.memoizedState)||(dh=!0),i.memoizedState=a,i.baseState=h,i.baseQueue=_,s.lastRenderedState=a}if(e=s.interleaved,e!==null){c=e;do d=c.lane,M$1.lanes|=d,rh|=d,c=c.next;while(c!==e)}else c===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function Xh(e){var i=Uh(),s=i.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var a=s.dispatch,c=s.pending,d=i.memoizedState;if(c!==null){s.pending=null;var h=c=c.next;do d=e(d,h.action),h=h.next;while(h!==c);He(d,i.memoizedState)||(dh=!0),i.memoizedState=d,i.baseQueue===null&&(i.baseState=d),s.lastRenderedState=d}return[d,a]}function Yh(){}function Zh(e,i){var s=M$1,a=Uh(),c=i(),d=!He(a.memoizedState,c);if(d&&(a.memoizedState=c,dh=!0),a=a.queue,$h(ai.bind(null,s,a,e),[e]),a.getSnapshot!==i||d||O!==null&&O.memoizedState.tag&1){if(s.flags|=2048,bi(9,ci.bind(null,s,a,c,i),void 0,null),Q===null)throw Error(p(349));Hh&30||di(s,i,c)}return c}function di(e,i,s){e.flags|=16384,e={getSnapshot:i,value:s},i=M$1.updateQueue,i===null?(i={lastEffect:null,stores:null},M$1.updateQueue=i,i.stores=[e]):(s=i.stores,s===null?i.stores=[e]:s.push(e))}function ci(e,i,s,a){i.value=s,i.getSnapshot=a,ei(i)&&fi(e)}function ai(e,i,s){return s(function(){ei(i)&&fi(e)})}function ei(e){var i=e.getSnapshot;e=e.value;try{var s=i();return!He(e,s)}catch{return!0}}function fi(e){var i=ih(e,1);i!==null&&gi(i,e,1,-1)}function hi(e){var i=Th();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},i.queue=e,e=e.dispatch=ii.bind(null,M$1,e),[i.memoizedState,e]}function bi(e,i,s,a){return e={tag:e,create:i,destroy:s,deps:a,next:null},i=M$1.updateQueue,i===null?(i={lastEffect:null,stores:null},M$1.updateQueue=i,i.lastEffect=e.next=e):(s=i.lastEffect,s===null?i.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,i.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,i,s,a){var c=Th();M$1.flags|=e,c.memoizedState=bi(1|i,s,void 0,a===void 0?null:a)}function li(e,i,s,a){var c=Uh();a=a===void 0?null:a;var d=void 0;if(N!==null){var h=N.memoizedState;if(d=h.destroy,a!==null&&Mh(a,h.deps)){c.memoizedState=bi(i,s,d,a);return}}M$1.flags|=e,c.memoizedState=bi(1|i,s,d,a)}function mi(e,i){return ki(8390656,8,e,i)}function $h(e,i){return li(2048,8,e,i)}function ni(e,i){return li(4,2,e,i)}function oi(e,i){return li(4,4,e,i)}function pi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function qi(e,i,s){return s=s!=null?s.concat([e]):null,li(4,4,pi.bind(null,i,e),s)}function ri(){}function si(e,i){var s=Uh();i=i===void 0?null:i;var a=s.memoizedState;return a!==null&&i!==null&&Mh(i,a[1])?a[0]:(s.memoizedState=[e,i],e)}function ti(e,i){var s=Uh();i=i===void 0?null:i;var a=s.memoizedState;return a!==null&&i!==null&&Mh(i,a[1])?a[0]:(e=e(),s.memoizedState=[e,i],e)}function ui(e,i,s){return Hh&21?(He(s,i)||(s=yc(),M$1.lanes|=s,rh|=s,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=s)}function vi(e,i){var s=C;C=s!==0&&4>s?s:4,e(!0);var a=Gh.transition;Gh.transition={};try{e(!1),i()}finally{C=s,Gh.transition=a}}function wi(){return Uh().memoizedState}function xi(e,i,s){var a=yi(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(i,s);else if(s=hh(e,i,s,a),s!==null){var c=R();gi(s,e,a,c),Bi(s,i,a)}}function ii(e,i,s){var a=yi(e),c={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(i,c);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=i.lastRenderedReducer,d!==null))try{var h=i.lastRenderedState,g=d(h,s);if(c.hasEagerState=!0,c.eagerState=g,He(g,h)){var _=i.interleaved;_===null?(c.next=c,gh(i)):(c.next=_.next,_.next=c),i.interleaved=c;return}}catch{}finally{}s=hh(e,i,c,a),s!==null&&(c=R(),gi(s,e,a,c),Bi(s,i,a))}}function zi(e){var i=e.alternate;return e===M$1||i!==null&&i===M$1}function Ai(e,i){Jh=Ih=!0;var s=e.pending;s===null?i.next=i:(i.next=s.next,s.next=i),e.pending=i}function Bi(e,i,s){if(s&4194240){var a=i.lanes;a&=e.pendingLanes,s|=a,i.lanes=s,Cc(e,s)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,i){return Th().memoizedState=[e,i===void 0?null:i],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,i,s){return s=s!=null?s.concat([e]):null,ki(4194308,4,pi.bind(null,i,e),s)},useLayoutEffect:function(e,i){return ki(4194308,4,e,i)},useInsertionEffect:function(e,i){return ki(4,2,e,i)},useMemo:function(e,i){var s=Th();return i=i===void 0?null:i,e=e(),s.memoizedState=[e,i],e},useReducer:function(e,i,s){var a=Th();return i=s!==void 0?s(i):i,a.memoizedState=a.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},a.queue=e,e=e.dispatch=xi.bind(null,M$1,e),[a.memoizedState,e]},useRef:function(e){var i=Th();return e={current:e},i.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),i=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,s){var a=M$1,c=Th();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=i(),Q===null)throw Error(p(349));Hh&30||di(a,i,s)}c.memoizedState=s;var d={value:s,getSnapshot:i};return c.queue=d,mi(ai.bind(null,a,d,e),[e]),a.flags|=2048,bi(9,ci.bind(null,a,d,s,i),void 0,null),s},useId:function(){var e=Th(),i=Q.identifierPrefix;if(I){var s=sg,a=rg;s=(a&~(1<<32-oc(a)-1)).toString(32)+s,i=":"+i+"R"+s,s=Kh++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=Lh++,i=":"+i+"r"+s.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return ui(i,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return N===null?i.memoizedState=e:ui(i,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var s in e)i[s]===void 0&&(i[s]=e[s]);return i}return i}function Di(e,i,s,a){i=e.memoizedState,s=s(a,i),s=s==null?i:A({},i,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,s){e=e._reactInternals;var a=R(),c=yi(e),d=mh(a,c);d.payload=i,s!=null&&(d.callback=s),i=nh(e,d,c),i!==null&&(gi(i,e,c,a),oh(i,e,c))},enqueueReplaceState:function(e,i,s){e=e._reactInternals;var a=R(),c=yi(e),d=mh(a,c);d.tag=1,d.payload=i,s!=null&&(d.callback=s),i=nh(e,d,c),i!==null&&(gi(i,e,c,a),oh(i,e,c))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var s=R(),a=yi(e),c=mh(s,a);c.tag=2,i!=null&&(c.callback=i),i=nh(e,c,a),i!==null&&(gi(i,e,a,s),oh(i,e,a))}};function Fi(e,i,s,a,c,d,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,d,h):i.prototype&&i.prototype.isPureReactComponent?!Ie(s,a)||!Ie(c,d):!0}function Gi(e,i,s){var a=!1,c=Vf,d=i.contextType;return typeof d=="object"&&d!==null?d=eh(d):(c=Zf(i)?Xf:H.current,a=i.contextTypes,d=(a=a!=null)?Yf(e,c):Vf),i=new i(s,d),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,e.stateNode=i,i._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=d),i}function Hi(e,i,s,a){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,a),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,a),i.state!==e&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(e,i,s,a){var c=e.stateNode;c.props=s,c.state=e.memoizedState,c.refs={},kh(e);var d=i.contextType;typeof d=="object"&&d!==null?c.context=eh(d):(d=Zf(i)?Xf:H.current,c.context=Yf(e,d)),c.state=e.memoizedState,d=i.getDerivedStateFromProps,typeof d=="function"&&(Di(e,i,d,s),c.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(i=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),i!==c.state&&Ei.enqueueReplaceState(c,c.state,null),qh(e,s,c,a),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,i){try{var s="",a=i;do s+=Pa(a),a=a.return;while(a);var c=s}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:i,stack:c,digest:null}}function Ki(e,i,s){return{value:e,source:null,stack:s??null,digest:i??null}}function Li(e,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,i,s){s=mh(-1,s),s.tag=3,s.payload={element:null};var a=i.value;return s.callback=function(){Oi||(Oi=!0,Pi=a),Li(e,i)},s}function Qi(e,i,s){s=mh(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var c=i.value;s.payload=function(){return a(c)},s.callback=function(){Li(e,i)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(s.callback=function(){Li(e,i),typeof a!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var h=i.stack;this.componentDidCatch(i.value,{componentStack:h!==null?h:""})}),s}function Si(e,i,s){var a=e.pingCache;if(a===null){a=e.pingCache=new Mi;var c=new Set;a.set(i,c)}else c=a.get(i),c===void 0&&(c=new Set,a.set(i,c));c.has(s)||(c.add(s),e=Ti.bind(null,e,i,s),i.then(e,e))}function Ui(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Vi(e,i,s,a,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===i?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=mh(-1,1),i.tag=2,nh(s,i,1))),s.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,i,s,a){i.child=e===null?Vg(i,null,s,a):Ug(i,e.child,s,a)}function Yi(e,i,s,a,c){s=s.render;var d=i.ref;return ch(i,c),a=Nh(e,i,s,a,d,c),s=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c,Zi(e,i,c)):(I&&s&&vg(i),i.flags|=1,Xi(e,i,a,c),i.child)}function $i(e,i,s,a,c){if(e===null){var d=s.type;return typeof d=="function"&&!aj(d)&&d.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=d,bj(e,i,d,a,c)):(e=Rg(s.type,null,a,i,i.mode,c),e.ref=i.ref,e.return=i,i.child=e)}if(d=e.child,!(e.lanes&c)){var h=d.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(h,a)&&e.ref===i.ref)return Zi(e,i,c)}return i.flags|=1,e=Pg(d,a),e.ref=i.ref,e.return=i,i.child=e}function bj(e,i,s,a,c){if(e!==null){var d=e.memoizedProps;if(Ie(d,a)&&e.ref===i.ref)if(dh=!1,i.pendingProps=a=d,(e.lanes&c)!==0)e.flags&131072&&(dh=!0);else return i.lanes=e.lanes,Zi(e,i,c)}return cj(e,i,s,a,c)}function dj(e,i,s){var a=i.pendingProps,c=a.children,d=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=s;else{if(!(s&1073741824))return e=d!==null?d.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=d!==null?d.baseLanes:s,G(ej,fj),fj|=a}else d!==null?(a=d.baseLanes|s,i.memoizedState=null):a=s,G(ej,fj),fj|=a;return Xi(e,i,c,s),i.child}function gj(e,i){var s=i.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function cj(e,i,s,a,c){var d=Zf(s)?Xf:H.current;return d=Yf(i,d),ch(i,c),s=Nh(e,i,s,a,d,c),a=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c,Zi(e,i,c)):(I&&a&&vg(i),i.flags|=1,Xi(e,i,s,c),i.child)}function hj(e,i,s,a,c){if(Zf(s)){var d=!0;cg(i)}else d=!1;if(ch(i,c),i.stateNode===null)ij(e,i),Gi(i,s,a),Ii(i,s,a,c),a=!0;else if(e===null){var h=i.stateNode,g=i.memoizedProps;h.props=g;var _=h.context,b=s.contextType;typeof b=="object"&&b!==null?b=eh(b):(b=Zf(s)?Xf:H.current,b=Yf(i,b));var _e=s.getDerivedStateFromProps,nt=typeof _e=="function"||typeof h.getSnapshotBeforeUpdate=="function";nt||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(g!==a||_!==b)&&Hi(i,h,a,b),jh=!1;var it=i.memoizedState;h.state=it,qh(i,a,h,c),_=i.memoizedState,g!==a||it!==_||Wf.current||jh?(typeof _e=="function"&&(Di(i,s,_e,a),_=i.memoizedState),(g=jh||Fi(i,s,g,a,it,_,b))?(nt||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(i.flags|=4194308)):(typeof h.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=a,i.memoizedState=_),h.props=a,h.state=_,h.context=b,a=g):(typeof h.componentDidMount=="function"&&(i.flags|=4194308),a=!1)}else{h=i.stateNode,lh(e,i),g=i.memoizedProps,b=i.type===i.elementType?g:Ci(i.type,g),h.props=b,nt=i.pendingProps,it=h.context,_=s.contextType,typeof _=="object"&&_!==null?_=eh(_):(_=Zf(s)?Xf:H.current,_=Yf(i,_));var et=s.getDerivedStateFromProps;(_e=typeof et=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(g!==nt||it!==_)&&Hi(i,h,a,_),jh=!1,it=i.memoizedState,h.state=it,qh(i,a,h,c);var lt=i.memoizedState;g!==nt||it!==lt||Wf.current||jh?(typeof et=="function"&&(Di(i,s,et,a),lt=i.memoizedState),(b=jh||Fi(i,s,b,a,it,lt,_)||!1)?(_e||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(a,lt,_),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(a,lt,_)),typeof h.componentDidUpdate=="function"&&(i.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof h.componentDidUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(i.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(i.flags|=1024),i.memoizedProps=a,i.memoizedState=lt),h.props=a,h.state=lt,h.context=_,a=b):(typeof h.componentDidUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(i.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(i.flags|=1024),a=!1)}return jj(e,i,s,a,d,c)}function jj(e,i,s,a,c,d){gj(e,i);var h=(i.flags&128)!==0;if(!a&&!h)return c&&dg(i,s,!1),Zi(e,i,d);a=i.stateNode,Wi.current=i;var g=h&&typeof s.getDerivedStateFromError!="function"?null:a.render();return i.flags|=1,e!==null&&h?(i.child=Ug(i,e.child,null,d),i.child=Ug(i,null,g,d)):Xi(e,i,g,d),i.memoizedState=a.state,c&&dg(i,s,!0),i.child}function kj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),yh(e,i.containerInfo)}function lj(e,i,s,a,c){return Ig(),Jg(c),i.flags|=256,Xi(e,i,s,a),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,i,s){var a=i.pendingProps,c=L$1.current,d=!1,h=(i.flags&128)!==0,g;if((g=h)||(g=e!==null&&e.memoizedState===null?!1:(c&2)!==0),g?(d=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),G(L$1,c&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(h=a.children,e=a.fallback,d?(a=i.mode,d=i.child,h={mode:"hidden",children:h},!(a&1)&&d!==null?(d.childLanes=0,d.pendingProps=h):d=pj(h,a,0,null),e=Tg(e,a,s,null),d.return=i,e.return=i,d.sibling=e,i.child=d,i.child.memoizedState=nj(s),i.memoizedState=mj,e):qj(i,h));if(c=e.memoizedState,c!==null&&(g=c.dehydrated,g!==null))return rj(e,i,h,a,g,c,s);if(d){d=a.fallback,h=i.mode,c=e.child,g=c.sibling;var _={mode:"hidden",children:a.children};return!(h&1)&&i.child!==c?(a=i.child,a.childLanes=0,a.pendingProps=_,i.deletions=null):(a=Pg(c,_),a.subtreeFlags=c.subtreeFlags&14680064),g!==null?d=Pg(g,d):(d=Tg(d,h,s,null),d.flags|=2),d.return=i,a.return=i,a.sibling=d,i.child=a,a=d,d=i.child,h=e.child.memoizedState,h=h===null?nj(s):{baseLanes:h.baseLanes|s,cachePool:null,transitions:h.transitions},d.memoizedState=h,d.childLanes=e.childLanes&~s,i.memoizedState=mj,a}return d=e.child,e=d.sibling,a=Pg(d,{mode:"visible",children:a.children}),!(i.mode&1)&&(a.lanes=s),a.return=i,a.sibling=null,e!==null&&(s=i.deletions,s===null?(i.deletions=[e],i.flags|=16):s.push(e)),i.child=a,i.memoizedState=null,a}function qj(e,i){return i=pj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function sj(e,i,s,a){return a!==null&&Jg(a),Ug(i,e.child,null,s),e=qj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function rj(e,i,s,a,c,d,h){if(s)return i.flags&256?(i.flags&=-257,a=Ki(Error(p(422))),sj(e,i,h,a)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(d=a.fallback,c=i.mode,a=pj({mode:"visible",children:a.children},c,0,null),d=Tg(d,c,h,null),d.flags|=2,a.return=i,d.return=i,a.sibling=d,i.child=a,i.mode&1&&Ug(i,e.child,null,h),i.child.memoizedState=nj(h),i.memoizedState=mj,d);if(!(i.mode&1))return sj(e,i,h,null);if(c.data==="$!"){if(a=c.nextSibling&&c.nextSibling.dataset,a)var g=a.dgst;return a=g,d=Error(p(419)),a=Ki(d,a,void 0),sj(e,i,h,a)}if(g=(h&e.childLanes)!==0,dh||g){if(a=Q,a!==null){switch(h&-h){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(a.suspendedLanes|h)?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,ih(e,c),gi(a,e,c,-1))}return tj(),a=Ki(Error(p(421))),sj(e,i,h,a)}return c.data==="$?"?(i.flags|=128,i.child=e.child,i=uj.bind(null,e),c._reactRetry=i,null):(e=d.treeContext,yg=Lf(c.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=qj(i,a.children),i.flags|=4096,i)}function vj(e,i,s){e.lanes|=i;var a=e.alternate;a!==null&&(a.lanes|=i),bh(e.return,i,s)}function wj(e,i,s,a,c){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:c}:(d.isBackwards=i,d.rendering=null,d.renderingStartTime=0,d.last=a,d.tail=s,d.tailMode=c)}function xj(e,i,s){var a=i.pendingProps,c=a.revealOrder,d=a.tail;if(Xi(e,i,a.children,s),a=L$1.current,a&2)a=a&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,s,i);else if(e.tag===19)vj(e,s,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(G(L$1,a),!(i.mode&1))i.memoizedState=null;else switch(c){case"forwards":for(s=i.child,c=null;s!==null;)e=s.alternate,e!==null&&Ch(e)===null&&(c=s),s=s.sibling;s=c,s===null?(c=i.child,i.child=null):(c=s.sibling,s.sibling=null),wj(i,!1,c,s,d);break;case"backwards":for(s=null,c=i.child,i.child=null;c!==null;){if(e=c.alternate,e!==null&&Ch(e)===null){i.child=c;break}e=c.sibling,c.sibling=s,s=c,c=e}wj(i,!0,s,null,d);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function Zi(e,i,s){if(e!==null&&(i.dependencies=e.dependencies),rh|=i.lanes,!(s&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p(153));if(i.child!==null){for(e=i.child,s=Pg(e,e.pendingProps),i.child=s,s.return=i;e.sibling!==null;)e=e.sibling,s=s.sibling=Pg(e,e.pendingProps),s.return=i;s.sibling=null}return i.child}function yj(e,i,s){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var a=i.type._context,c=i.memoizedProps.value;G(Wg,a._currentValue),a._currentValue=c;break;case 13:if(a=i.memoizedState,a!==null)return a.dehydrated!==null?(G(L$1,L$1.current&1),i.flags|=128,null):s&i.child.childLanes?oj(e,i,s):(G(L$1,L$1.current&1),e=Zi(e,i,s),e!==null?e.sibling:null);G(L$1,L$1.current&1);break;case 19:if(a=(s&i.childLanes)!==0,e.flags&128){if(a)return xj(e,i,s);i.flags|=128}if(c=i.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),G(L$1,L$1.current),a)break;return null;case 22:case 23:return i.lanes=0,dj(e,i,s)}return Zi(e,i,s)}var zj,Aj,Bj,Cj;zj=function(e,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Aj=function(){};Bj=function(e,i,s,a){var c=e.memoizedProps;if(c!==a){e=i.stateNode,xh(uh.current);var d=null;switch(s){case"input":c=Ya(e,c),a=Ya(e,a),d=[];break;case"select":c=A({},c,{value:void 0}),a=A({},a,{value:void 0}),d=[];break;case"textarea":c=gb(e,c),a=gb(e,a),d=[];break;default:typeof c.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Bf)}ub(s,a);var h;s=null;for(b in c)if(!a.hasOwnProperty(b)&&c.hasOwnProperty(b)&&c[b]!=null)if(b==="style"){var g=c[b];for(h in g)g.hasOwnProperty(h)&&(s||(s={}),s[h]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(ea.hasOwnProperty(b)?d||(d=[]):(d=d||[]).push(b,null));for(b in a){var _=a[b];if(g=c!=null?c[b]:void 0,a.hasOwnProperty(b)&&_!==g&&(_!=null||g!=null))if(b==="style")if(g){for(h in g)!g.hasOwnProperty(h)||_&&_.hasOwnProperty(h)||(s||(s={}),s[h]="");for(h in _)_.hasOwnProperty(h)&&g[h]!==_[h]&&(s||(s={}),s[h]=_[h])}else s||(d||(d=[]),d.push(b,s)),s=_;else b==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,g=g?g.__html:void 0,_!=null&&g!==_&&(d=d||[]).push(b,_)):b==="children"?typeof _!="string"&&typeof _!="number"||(d=d||[]).push(b,""+_):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(ea.hasOwnProperty(b)?(_!=null&&b==="onScroll"&&D$1("scroll",e),d||g===_||(d=[])):(d=d||[]).push(b,_))}s&&(d=d||[]).push("style",s);var b=d;(i.updateQueue=b)&&(i.flags|=4)}};Cj=function(e,i,s,a){s!==a&&(i.flags|=4)};function Dj(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(i)for(var c=e.child;c!==null;)s|=c.lanes|c.childLanes,a|=c.subtreeFlags&14680064,a|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)s|=c.lanes|c.childLanes,a|=c.subtreeFlags,a|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=a,e.childLanes=s,i}function Ej(e,i,s){var a=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return a=i.stateNode,zh(),E$1(Wf),E$1(H),Eh(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,i),S(i),null;case 5:Bh(i);var c=xh(wh.current);if(s=i.type,e!==null&&i.stateNode!=null)Bj(e,i,s,a,c),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!a){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(e=xh(uh.current),Gg(i)){a=i.stateNode,s=i.type;var d=i.memoizedProps;switch(a[Of]=i,a[Pf]=d,e=(i.mode&1)!==0,s){case"dialog":D$1("cancel",a),D$1("close",a);break;case"iframe":case"object":case"embed":D$1("load",a);break;case"video":case"audio":for(c=0;c<lf.length;c++)D$1(lf[c],a);break;case"source":D$1("error",a);break;case"img":case"image":case"link":D$1("error",a),D$1("load",a);break;case"details":D$1("toggle",a);break;case"input":Za(a,d),D$1("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!d.multiple},D$1("invalid",a);break;case"textarea":hb(a,d),D$1("invalid",a)}ub(s,d),c=null;for(var h in d)if(d.hasOwnProperty(h)){var g=d[h];h==="children"?typeof g=="string"?a.textContent!==g&&(d.suppressHydrationWarning!==!0&&Af(a.textContent,g,e),c=["children",g]):typeof g=="number"&&a.textContent!==""+g&&(d.suppressHydrationWarning!==!0&&Af(a.textContent,g,e),c=["children",""+g]):ea.hasOwnProperty(h)&&g!=null&&h==="onScroll"&&D$1("scroll",a)}switch(s){case"input":Va(a),db(a,d,!0);break;case"textarea":Va(a),jb(a);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(a.onclick=Bf)}a=c,i.updateQueue=a,a!==null&&(i.flags|=4)}else{h=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=h.createElement(s,{is:a.is}):(e=h.createElement(s),s==="select"&&(h=e,a.multiple?h.multiple=!0:a.size&&(h.size=a.size))):e=h.createElementNS(e,s),e[Of]=i,e[Pf]=a,zj(e,i,!1,!1),i.stateNode=e;e:{switch(h=vb(s,a),s){case"dialog":D$1("cancel",e),D$1("close",e),c=a;break;case"iframe":case"object":case"embed":D$1("load",e),c=a;break;case"video":case"audio":for(c=0;c<lf.length;c++)D$1(lf[c],e);c=a;break;case"source":D$1("error",e),c=a;break;case"img":case"image":case"link":D$1("error",e),D$1("load",e),c=a;break;case"details":D$1("toggle",e),c=a;break;case"input":Za(e,a),c=Ya(e,a),D$1("invalid",e);break;case"option":c=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},c=A({},a,{value:void 0}),D$1("invalid",e);break;case"textarea":hb(e,a),c=gb(e,a),D$1("invalid",e);break;default:c=a}ub(s,c),g=c;for(d in g)if(g.hasOwnProperty(d)){var _=g[d];d==="style"?sb(e,_):d==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&nb(e,_)):d==="children"?typeof _=="string"?(s!=="textarea"||_!=="")&&ob(e,_):typeof _=="number"&&ob(e,""+_):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ea.hasOwnProperty(d)?_!=null&&d==="onScroll"&&D$1("scroll",e):_!=null&&ta(e,d,_,h))}switch(s){case"input":Va(e),db(e,a,!1);break;case"textarea":Va(e),jb(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Sa(a.value));break;case"select":e.multiple=!!a.multiple,d=a.value,d!=null?fb(e,!!a.multiple,d,!1):a.defaultValue!=null&&fb(e,!!a.multiple,a.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Cj(e,i,e.memoizedProps,a);else{if(typeof a!="string"&&i.stateNode===null)throw Error(p(166));if(s=xh(wh.current),xh(uh.current),Gg(i)){if(a=i.stateNode,s=i.memoizedProps,a[Of]=i,(d=a.nodeValue!==s)&&(e=xg,e!==null))switch(e.tag){case 3:Af(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(a.nodeValue,s,(e.mode&1)!==0)}d&&(i.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[Of]=i,i.stateNode=a}return S(i),null;case 13:if(E$1(L$1),a=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,d=!1;else if(d=Gg(i),a!==null&&a.dehydrated!==null){if(e===null){if(!d)throw Error(p(318));if(d=i.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(p(317));d[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),d=!1}else zg!==null&&(Fj(zg),zg=null),d=!0;if(!d)return i.flags&65536?i:null}return i.flags&128?(i.lanes=s,i):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(i.child.flags|=8192,i.mode&1&&(e===null||L$1.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E$1(L$1),d=i.memoizedState,d===null)return S(i),null;if(a=(i.flags&128)!==0,h=d.rendering,h===null)if(a)Dj(d,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(h=Ch(e),h!==null){for(i.flags|=128,Dj(d,!1),a=h.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),i.subtreeFlags=0,a=s,s=i.child;s!==null;)d=s,e=a,d.flags&=14680066,h=d.alternate,h===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=h.childLanes,d.lanes=h.lanes,d.child=h.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=h.memoizedProps,d.memoizedState=h.memoizedState,d.updateQueue=h.updateQueue,d.type=h.type,e=h.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return G(L$1,L$1.current&1|2),i.child}e=e.sibling}d.tail!==null&&B()>Gj&&(i.flags|=128,a=!0,Dj(d,!1),i.lanes=4194304)}else{if(!a)if(e=Ch(h),e!==null){if(i.flags|=128,a=!0,s=e.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),Dj(d,!0),d.tail===null&&d.tailMode==="hidden"&&!h.alternate&&!I)return S(i),null}else 2*B()-d.renderingStartTime>Gj&&s!==1073741824&&(i.flags|=128,a=!0,Dj(d,!1),i.lanes=4194304);d.isBackwards?(h.sibling=i.child,i.child=h):(s=d.last,s!==null?s.sibling=h:i.child=h,d.last=h)}return d.tail!==null?(i=d.tail,d.rendering=i,d.tail=i.sibling,d.renderingStartTime=B(),i.sibling=null,s=L$1.current,G(L$1,a?s&1|2:s&1),i):(S(i),null);case 22:case 23:return Hj(),a=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(i.flags|=8192),a&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Ij(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return zh(),E$1(Wf),E$1(H),Eh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E$1(L$1),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,i){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){W(e,i,a)}else s.current=null}function Mj(e,i,s){try{s()}catch(a){W(e,i,a)}}var Nj=!1;function Oj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var c=a.anchorOffset,d=a.focusNode;a=a.focusOffset;try{s.nodeType,d.nodeType}catch{s=null;break e}var h=0,g=-1,_=-1,b=0,_e=0,nt=e,it=null;t:for(;;){for(var et;nt!==s||c!==0&&nt.nodeType!==3||(g=h+c),nt!==d||a!==0&&nt.nodeType!==3||(_=h+a),nt.nodeType===3&&(h+=nt.nodeValue.length),(et=nt.firstChild)!==null;)it=nt,nt=et;for(;;){if(nt===e)break t;if(it===s&&++b===c&&(g=h),it===d&&++_e===a&&(_=h),(et=nt.nextSibling)!==null)break;nt=it,it=nt.parentNode}nt=et}s=g===-1||_===-1?null:{start:g,end:_}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:e,selectionRange:s},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var lt=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var rt=lt.memoizedProps,at=lt.memoizedState,ot=i.stateNode,st=ot.getSnapshotBeforeUpdate(i.elementType===i.type?rt:Ci(i.type,rt),at);ot.__reactInternalSnapshotBeforeUpdate=st}break;case 3:var ct=i.stateNode.containerInfo;ct.nodeType===1?ct.textContent="":ct.nodeType===9&&ct.documentElement&&ct.removeChild(ct.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(mt){W(i,i.return,mt)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return lt=Nj,Nj=!1,lt}function Pj(e,i,s){var a=i.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&e)===e){var d=c.destroy;c.destroy=void 0,d!==void 0&&Mj(i,s,d)}c=c.next}while(c!==a)}}function Qj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==i)}}function Rj(e){var i=e.ref;if(i!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof i=="function"?i(e):i.current=e}}function Sj(e){var i=e.alternate;i!==null&&(e.alternate=null,Sj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,i,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(e,i):s.insertBefore(e,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(e,s)):(i=s,i.appendChild(e)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=Bf));else if(a!==4&&(e=e.child,e!==null))for(Vj(e,i,s),e=e.sibling;e!==null;)Vj(e,i,s),e=e.sibling}function Wj(e,i,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,i?s.insertBefore(e,i):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Wj(e,i,s),e=e.sibling;e!==null;)Wj(e,i,s),e=e.sibling}var X$1=null,Xj=!1;function Yj(e,i,s){for(s=s.child;s!==null;)Zj(e,i,s),s=s.sibling}function Zj(e,i,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U||Lj(s,i);case 6:var a=X$1,c=Xj;X$1=null,Yj(e,i,s),X$1=a,Xj=c,X$1!==null&&(Xj?(e=X$1,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):X$1.removeChild(s.stateNode));break;case 18:X$1!==null&&(Xj?(e=X$1,s=s.stateNode,e.nodeType===8?Kf(e.parentNode,s):e.nodeType===1&&Kf(e,s),bd(e)):Kf(X$1,s.stateNode));break;case 4:a=X$1,c=Xj,X$1=s.stateNode.containerInfo,Xj=!0,Yj(e,i,s),X$1=a,Xj=c;break;case 0:case 11:case 14:case 15:if(!U&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){c=a=a.next;do{var d=c,h=d.destroy;d=d.tag,h!==void 0&&(d&2||d&4)&&Mj(s,i,h),c=c.next}while(c!==a)}Yj(e,i,s);break;case 1:if(!U&&(Lj(s,i),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(g){W(s,i,g)}Yj(e,i,s);break;case 21:Yj(e,i,s);break;case 22:s.mode&1?(U=(a=U)||s.memoizedState!==null,Yj(e,i,s),U=a):Yj(e,i,s);break;default:Yj(e,i,s)}}function ak(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Kj),i.forEach(function(a){var c=bk.bind(null,e,a);s.has(a)||(s.add(a),a.then(c,c))})}}function ck(e,i){var s=i.deletions;if(s!==null)for(var a=0;a<s.length;a++){var c=s[a];try{var d=e,h=i,g=h;e:for(;g!==null;){switch(g.tag){case 5:X$1=g.stateNode,Xj=!1;break e;case 3:X$1=g.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=g.stateNode.containerInfo,Xj=!0;break e}g=g.return}if(X$1===null)throw Error(p(160));Zj(d,h,c),X$1=null,Xj=!1;var _=c.alternate;_!==null&&(_.return=null),c.return=null}catch(b){W(c,i,b)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,e),i=i.sibling}function dk(e,i){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(i,e),ek(e),a&4){try{Pj(3,e,e.return),Qj(3,e)}catch(rt){W(e,e.return,rt)}try{Pj(5,e,e.return)}catch(rt){W(e,e.return,rt)}}break;case 1:ck(i,e),ek(e),a&512&&s!==null&&Lj(s,s.return);break;case 5:if(ck(i,e),ek(e),a&512&&s!==null&&Lj(s,s.return),e.flags&32){var c=e.stateNode;try{ob(c,"")}catch(rt){W(e,e.return,rt)}}if(a&4&&(c=e.stateNode,c!=null)){var d=e.memoizedProps,h=s!==null?s.memoizedProps:d,g=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{g==="input"&&d.type==="radio"&&d.name!=null&&ab(c,d),vb(g,h);var b=vb(g,d);for(h=0;h<_.length;h+=2){var _e=_[h],nt=_[h+1];_e==="style"?sb(c,nt):_e==="dangerouslySetInnerHTML"?nb(c,nt):_e==="children"?ob(c,nt):ta(c,_e,nt,b)}switch(g){case"input":bb(c,d);break;case"textarea":ib(c,d);break;case"select":var it=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var et=d.value;et!=null?fb(c,!!d.multiple,et,!1):it!==!!d.multiple&&(d.defaultValue!=null?fb(c,!!d.multiple,d.defaultValue,!0):fb(c,!!d.multiple,d.multiple?[]:"",!1))}c[Pf]=d}catch(rt){W(e,e.return,rt)}}break;case 6:if(ck(i,e),ek(e),a&4){if(e.stateNode===null)throw Error(p(162));c=e.stateNode,d=e.memoizedProps;try{c.nodeValue=d}catch(rt){W(e,e.return,rt)}}break;case 3:if(ck(i,e),ek(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(rt){W(e,e.return,rt)}break;case 4:ck(i,e),ek(e);break;case 13:ck(i,e),ek(e),c=e.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(fk=B())),a&4&&ak(e);break;case 22:if(_e=s!==null&&s.memoizedState!==null,e.mode&1?(U=(b=U)||_e,ck(i,e),U=b):ck(i,e),ek(e),a&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!_e&&e.mode&1)for(V=e,_e=e.child;_e!==null;){for(nt=V=_e;V!==null;){switch(it=V,et=it.child,it.tag){case 0:case 11:case 14:case 15:Pj(4,it,it.return);break;case 1:Lj(it,it.return);var lt=it.stateNode;if(typeof lt.componentWillUnmount=="function"){a=it,s=it.return;try{i=a,lt.props=i.memoizedProps,lt.state=i.memoizedState,lt.componentWillUnmount()}catch(rt){W(a,s,rt)}}break;case 5:Lj(it,it.return);break;case 22:if(it.memoizedState!==null){gk(nt);continue}}et!==null?(et.return=it,V=et):gk(nt)}_e=_e.sibling}e:for(_e=null,nt=e;;){if(nt.tag===5){if(_e===null){_e=nt;try{c=nt.stateNode,b?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(g=nt.stateNode,_=nt.memoizedProps.style,h=_!=null&&_.hasOwnProperty("display")?_.display:null,g.style.display=rb("display",h))}catch(rt){W(e,e.return,rt)}}}else if(nt.tag===6){if(_e===null)try{nt.stateNode.nodeValue=b?"":nt.memoizedProps}catch(rt){W(e,e.return,rt)}}else if((nt.tag!==22&&nt.tag!==23||nt.memoizedState===null||nt===e)&&nt.child!==null){nt.child.return=nt,nt=nt.child;continue}if(nt===e)break e;for(;nt.sibling===null;){if(nt.return===null||nt.return===e)break e;_e===nt&&(_e=null),nt=nt.return}_e===nt&&(_e=null),nt.sibling.return=nt.return,nt=nt.sibling}}break;case 19:ck(i,e),ek(e),a&4&&ak(e);break;case 21:break;default:ck(i,e),ek(e)}}function ek(e){var i=e.flags;if(i&2){try{e:{for(var s=e.return;s!==null;){if(Tj(s)){var a=s;break e}s=s.return}throw Error(p(160))}switch(a.tag){case 5:var c=a.stateNode;a.flags&32&&(ob(c,""),a.flags&=-33);var d=Uj(e);Wj(e,d,c);break;case 3:case 4:var h=a.stateNode.containerInfo,g=Uj(e);Vj(e,g,h);break;default:throw Error(p(161))}}catch(_){W(e,e.return,_)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function hk(e,i,s){V=e,ik(e)}function ik(e,i,s){for(var a=(e.mode&1)!==0;V!==null;){var c=V,d=c.child;if(c.tag===22&&a){var h=c.memoizedState!==null||Jj;if(!h){var g=c.alternate,_=g!==null&&g.memoizedState!==null||U;g=Jj;var b=U;if(Jj=h,(U=_)&&!b)for(V=c;V!==null;)h=V,_=h.child,h.tag===22&&h.memoizedState!==null?jk(c):_!==null?(_.return=h,V=_):jk(c);for(;d!==null;)V=d,ik(d),d=d.sibling;V=c,Jj=g,U=b}kk(e)}else c.subtreeFlags&8772&&d!==null?(d.return=c,V=d):kk(e)}}function kk(e){for(;V!==null;){var i=V;if(i.flags&8772){var s=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var a=i.stateNode;if(i.flags&4&&!U)if(s===null)a.componentDidMount();else{var c=i.elementType===i.type?s.memoizedProps:Ci(i.type,s.memoizedProps);a.componentDidUpdate(c,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var d=i.updateQueue;d!==null&&sh(i,d,a);break;case 3:var h=i.updateQueue;if(h!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}sh(i,h,s)}break;case 5:var g=i.stateNode;if(s===null&&i.flags&4){s=g;var _=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&s.focus();break;case"img":_.src&&(s.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var b=i.alternate;if(b!==null){var _e=b.memoizedState;if(_e!==null){var nt=_e.dehydrated;nt!==null&&bd(nt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||i.flags&512&&Rj(i)}catch(it){W(i,i.return,it)}}if(i===e){V=null;break}if(s=i.sibling,s!==null){s.return=i.return,V=s;break}V=i.return}}function gk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var s=i.sibling;if(s!==null){s.return=i.return,V=s;break}V=i.return}}function jk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{Qj(4,i)}catch(_){W(i,s,_)}break;case 1:var a=i.stateNode;if(typeof a.componentDidMount=="function"){var c=i.return;try{a.componentDidMount()}catch(_){W(i,c,_)}}var d=i.return;try{Rj(i)}catch(_){W(i,d,_)}break;case 5:var h=i.return;try{Rj(i)}catch(_){W(i,h,_)}}}catch(_){W(i,i.return,_)}if(i===e){V=null;break}var g=i.sibling;if(g!==null){g.return=i.return,V=g;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,i,s,a){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,s,a),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=s),T===4&&Ck(e,Z)),Dk(e,a),s===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,i){var s=e.callbackNode;wc(e,i);var a=uc(e,e===Q?Z:0);if(a===0)s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;else if(i=a&-a,e.callbackPriority!==i){if(s!=null&&bc(s),i===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(a)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Fk(s,Gk.bind(null,e))}e.callbackPriority=i,e.callbackNode=s}}function Gk(e,i){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var s=e.callbackNode;if(Hk()&&e.callbackNode!==s)return null;var a=uc(e,e===Q?Z:0);if(a===0)return null;if(a&30||a&e.expiredLanes||i)i=Ik(e,a);else{i=a;var c=K;K|=2;var d=Jk();(Q!==e||Z!==i)&&(uk=null,Gj=B()+500,Kk(e,i));do try{Lk();break}catch(g){Mk(e,g)}while(!0);$g(),mk.current=d,K=c,Y!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(c=xc(e),c!==0&&(a=c,i=Nk(e,c))),i===1)throw s=pk,Kk(e,0),Ck(e,a),Dk(e,B()),s;if(i===6)Ck(e,a);else{if(c=e.current.alternate,!(a&30)&&!Ok(c)&&(i=Ik(e,a),i===2&&(d=xc(e),d!==0&&(a=d,i=Nk(e,d))),i===1))throw s=pk,Kk(e,0),Ck(e,a),Dk(e,B()),s;switch(e.finishedWork=c,e.finishedLanes=a,i){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,a),(a&130023424)===a&&(i=fk+500-B(),10<i)){if(uc(e,0)!==0)break;if(c=e.suspendedLanes,(c&a)!==a){R(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 4:if(Ck(e,a),(a&4194240)===a)break;for(i=e.eventTimes,c=-1;0<a;){var h=31-oc(a);d=1<<h,h=i[h],h>c&&(c=h),a&=~d}if(a=c,a=B()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*lk(a/1960))-a,10<a){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),a);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===s?Gk.bind(null,e):null}function Nk(e,i){var s=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,i).flags|=256),e=Ik(e,i),e!==2&&(i=tk,tk=s,i!==null&&Fj(i)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var i=e;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var c=s[a],d=c.getSnapshot;c=c.value;try{if(!He(d(),c))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(e,i){for(i&=~rk,i&=~qk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var s=31-oc(i),a=1<<s;e[s]=-1,i&=~a}}function Ek(e){if(K&6)throw Error(p(327));Hk();var i=uc(e,0);if(!(i&1))return Dk(e,B()),null;var s=Ik(e,i);if(e.tag!==0&&s===2){var a=xc(e);a!==0&&(i=a,s=Nk(e,a))}if(s===1)throw s=pk,Kk(e,0),Ck(e,i),Dk(e,B()),s;if(s===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,i){var s=K;K|=1;try{return e(i)}finally{K=s,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var s=ok.transition,a=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=a,ok.transition=s,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(e,i){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Gf(s)),Y!==null)for(s=Y.return;s!==null;){var a=s;switch(wg(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H),Eh();break;case 5:Bh(a);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(a.type._context);break;case 22:case 23:Hj()}s=s.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(s=fh[i],a=s.interleaved,a!==null){s.interleaved=null;var c=a.next,d=s.pending;if(d!==null){var h=d.next;d.next=c,a.next=h}s.pending=a}fh=null}return e}function Mk(e,i){do{var s=Y;try{if($g(),Fh.current=Rh,Ih){for(var a=M$1.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Ih=!1}if(Hh=0,O=N=M$1=null,Jh=!1,Kh=0,nk.current=null,s===null||s.return===null){T=1,pk=i,Y=null;break}e:{var d=e,h=s.return,g=s,_=i;if(i=Z,g.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var b=_,_e=g,nt=_e.tag;if(!(_e.mode&1)&&(nt===0||nt===11||nt===15)){var it=_e.alternate;it?(_e.updateQueue=it.updateQueue,_e.memoizedState=it.memoizedState,_e.lanes=it.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var et=Ui(h);if(et!==null){et.flags&=-257,Vi(et,h,g,d,i),et.mode&1&&Si(d,b,i),i=et,_=b;var lt=i.updateQueue;if(lt===null){var rt=new Set;rt.add(_),i.updateQueue=rt}else lt.add(_);break e}else{if(!(i&1)){Si(d,b,i),tj();break e}_=Error(p(426))}}else if(I&&g.mode&1){var at=Ui(h);if(at!==null){!(at.flags&65536)&&(at.flags|=256),Vi(at,h,g,d,i),Jg(Ji(_,g));break e}}d=_=Ji(_,g),T!==4&&(T=2),sk===null?sk=[d]:sk.push(d),d=h;do{switch(d.tag){case 3:d.flags|=65536,i&=-i,d.lanes|=i;var ot=Ni(d,_,i);ph(d,ot);break e;case 1:g=_;var st=d.type,ct=d.stateNode;if(!(d.flags&128)&&(typeof st.getDerivedStateFromError=="function"||ct!==null&&typeof ct.componentDidCatch=="function"&&(Ri===null||!Ri.has(ct)))){d.flags|=65536,i&=-i,d.lanes|=i;var mt=Qi(d,g,i);ph(d,mt);break e}}d=d.return}while(d!==null)}Sk(s)}catch(pt){i=pt,Y===s&&s!==null&&(Y=s=s.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,i){var s=K;K|=2;var a=Jk();(Q!==e||Z!==i)&&(uk=null,Kk(e,i));do try{Tk();break}catch(c){Mk(e,c)}while(!0);if($g(),K=s,mk.current=a,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(e){var i=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,i===null?Sk(e):Y=i,nk.current=null}function Sk(e){var i=e;do{var s=i.alternate;if(e=i.return,i.flags&32768){if(s=Ij(s,i),s!==null){s.flags&=32767,Y=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(s=Ej(s,i,fj),s!==null){Y=s;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=e}while(i!==null);T===0&&(T=5)}function Pk(e,i,s){var a=C,c=ok.transition;try{ok.transition=null,C=1,Wk(e,i,s,a)}finally{ok.transition=c,C=a}return null}function Wk(e,i,s,a){do Hk();while(wk!==null);if(K&6)throw Error(p(327));s=e.finishedWork;var c=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var d=s.lanes|s.childLanes;if(Bc(e,d),e===Q&&(Y=Q=null,Z=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),d=(s.flags&15990)!==0,s.subtreeFlags&15990||d){d=ok.transition,ok.transition=null;var h=C;C=1;var g=K;K|=4,nk.current=null,Oj(e,s),dk(s,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=s,hk(s),dc(),K=g,C=h,ok.transition=d}else e.current=s;if(vk&&(vk=!1,wk=e,xk=c),d=e.pendingLanes,d===0&&(Ri=null),mc(s.stateNode),Dk(e,B()),i!==null)for(a=e.onRecoverableError,s=0;s<i.length;s++)c=i[s],a(c.value,{componentStack:c.stack,digest:c.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),d=e.pendingLanes,d&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),i=ok.transition,s=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var a=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var c=K;for(K|=4,V=e.current;V!==null;){var d=V,h=d.child;if(V.flags&16){var g=d.deletions;if(g!==null){for(var _=0;_<g.length;_++){var b=g[_];for(V=b;V!==null;){var _e=V;switch(_e.tag){case 0:case 11:case 15:Pj(8,_e,d)}var nt=_e.child;if(nt!==null)nt.return=_e,V=nt;else for(;V!==null;){_e=V;var it=_e.sibling,et=_e.return;if(Sj(_e),_e===b){V=null;break}if(it!==null){it.return=et,V=it;break}V=et}}}var lt=d.alternate;if(lt!==null){var rt=lt.child;if(rt!==null){lt.child=null;do{var at=rt.sibling;rt.sibling=null,rt=at}while(rt!==null)}}V=d}}if(d.subtreeFlags&2064&&h!==null)h.return=d,V=h;else e:for(;V!==null;){if(d=V,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Pj(9,d,d.return)}var ot=d.sibling;if(ot!==null){ot.return=d.return,V=ot;break e}V=d.return}}var st=e.current;for(V=st;V!==null;){h=V;var ct=h.child;if(h.subtreeFlags&2064&&ct!==null)ct.return=h,V=ct;else e:for(h=st;V!==null;){if(g=V,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Qj(9,g)}}catch(pt){W(g,g.return,pt)}if(g===h){V=null;break e}var mt=g.sibling;if(mt!==null){mt.return=g.return,V=mt;break e}V=g.return}}if(K=c,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}a=!0}return a}finally{C=s,ok.transition=i}}return!1}function Xk(e,i,s){i=Ji(s,i),i=Ni(e,i,1),e=nh(e,i,1),i=R(),e!==null&&(Ac(e,1,i),Dk(e,i))}function W(e,i,s){if(e.tag===3)Xk(e,e,s);else for(;i!==null;){if(i.tag===3){Xk(i,e,s);break}else if(i.tag===1){var a=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Ri===null||!Ri.has(a))){e=Ji(s,e),e=Qi(i,e,1),i=nh(i,e,1),e=R(),i!==null&&(Ac(i,1,e),Dk(i,e));break}}i=i.return}}function Ti(e,i,s){var a=e.pingCache;a!==null&&a.delete(i),i=R(),e.pingedLanes|=e.suspendedLanes&s,Q===e&&(Z&s)===s&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=s),Dk(e,i)}function Yk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var s=R();e=ih(e,i),e!==null&&(Ac(e,i,s),Dk(e,s))}function uj(e){var i=e.memoizedState,s=0;i!==null&&(s=i.retryLane),Yk(e,s)}function bk(e,i){var s=0;switch(e.tag){case 13:var a=e.stateNode,c=e.memoizedState;c!==null&&(s=c.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(p(314))}a!==null&&a.delete(i),Yk(e,s)}var Vk;Vk=function(e,i,s){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&s)&&!(i.flags&128))return dh=!1,yj(e,i,s);dh=!!(e.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var a=i.type;ij(e,i),e=i.pendingProps;var c=Yf(i,H.current);ch(i,s),c=Nh(null,i,a,e,c,s);var d=Sh();return i.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(a)?(d=!0,cg(i)):d=!1,i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,kh(i),c.updater=Ei,i.stateNode=c,c._reactInternals=i,Ii(i,a,e,s),i=jj(null,i,a,!0,d,s)):(i.tag=0,I&&d&&vg(i),Xi(null,i,c,s),i=i.child),i;case 16:a=i.elementType;e:{switch(ij(e,i),e=i.pendingProps,c=a._init,a=c(a._payload),i.type=a,c=i.tag=Zk(a),e=Ci(a,e),c){case 0:i=cj(null,i,a,e,s);break e;case 1:i=hj(null,i,a,e,s);break e;case 11:i=Yi(null,i,a,e,s);break e;case 14:i=$i(null,i,a,Ci(a.type,e),s);break e}throw Error(p(306,a,""))}return i;case 0:return a=i.type,c=i.pendingProps,c=i.elementType===a?c:Ci(a,c),cj(e,i,a,c,s);case 1:return a=i.type,c=i.pendingProps,c=i.elementType===a?c:Ci(a,c),hj(e,i,a,c,s);case 3:e:{if(kj(i),e===null)throw Error(p(387));a=i.pendingProps,d=i.memoizedState,c=d.element,lh(e,i),qh(i,a,null,s);var h=i.memoizedState;if(a=h.element,d.isDehydrated)if(d={element:a,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},i.updateQueue.baseState=d,i.memoizedState=d,i.flags&256){c=Ji(Error(p(423)),i),i=lj(e,i,a,s,c);break e}else if(a!==c){c=Ji(Error(p(424)),i),i=lj(e,i,a,s,c);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,s=Vg(i,null,a,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),a===c){i=Zi(e,i,s);break e}Xi(e,i,a,s)}i=i.child}return i;case 5:return Ah(i),e===null&&Eg(i),a=i.type,c=i.pendingProps,d=e!==null?e.memoizedProps:null,h=c.children,Ef(a,c)?h=null:d!==null&&Ef(a,d)&&(i.flags|=32),gj(e,i),Xi(e,i,h,s),i.child;case 6:return e===null&&Eg(i),null;case 13:return oj(e,i,s);case 4:return yh(i,i.stateNode.containerInfo),a=i.pendingProps,e===null?i.child=Ug(i,null,a,s):Xi(e,i,a,s),i.child;case 11:return a=i.type,c=i.pendingProps,c=i.elementType===a?c:Ci(a,c),Yi(e,i,a,c,s);case 7:return Xi(e,i,i.pendingProps,s),i.child;case 8:return Xi(e,i,i.pendingProps.children,s),i.child;case 12:return Xi(e,i,i.pendingProps.children,s),i.child;case 10:e:{if(a=i.type._context,c=i.pendingProps,d=i.memoizedProps,h=c.value,G(Wg,a._currentValue),a._currentValue=h,d!==null)if(He(d.value,h)){if(d.children===c.children&&!Wf.current){i=Zi(e,i,s);break e}}else for(d=i.child,d!==null&&(d.return=i);d!==null;){var g=d.dependencies;if(g!==null){h=d.child;for(var _=g.firstContext;_!==null;){if(_.context===a){if(d.tag===1){_=mh(-1,s&-s),_.tag=2;var b=d.updateQueue;if(b!==null){b=b.shared;var _e=b.pending;_e===null?_.next=_:(_.next=_e.next,_e.next=_),b.pending=_}}d.lanes|=s,_=d.alternate,_!==null&&(_.lanes|=s),bh(d.return,s,i),g.lanes|=s;break}_=_.next}}else if(d.tag===10)h=d.type===i.type?null:d.child;else if(d.tag===18){if(h=d.return,h===null)throw Error(p(341));h.lanes|=s,g=h.alternate,g!==null&&(g.lanes|=s),bh(h,s,i),h=d.sibling}else h=d.child;if(h!==null)h.return=d;else for(h=d;h!==null;){if(h===i){h=null;break}if(d=h.sibling,d!==null){d.return=h.return,h=d;break}h=h.return}d=h}Xi(e,i,c.children,s),i=i.child}return i;case 9:return c=i.type,a=i.pendingProps.children,ch(i,s),c=eh(c),a=a(c),i.flags|=1,Xi(e,i,a,s),i.child;case 14:return a=i.type,c=Ci(a,i.pendingProps),c=Ci(a.type,c),$i(e,i,a,c,s);case 15:return bj(e,i,i.type,i.pendingProps,s);case 17:return a=i.type,c=i.pendingProps,c=i.elementType===a?c:Ci(a,c),ij(e,i),i.tag=1,Zf(a)?(e=!0,cg(i)):e=!1,ch(i,s),Gi(i,a,c),Ii(i,a,c,s),jj(null,i,a,!0,e,s);case 19:return xj(e,i,s);case 22:return dj(e,i,s)}throw Error(p(156,i.tag))};function Fk(e,i){return ac(e,i)}function $k(e,i,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,s,a){return new $k(e,i,s,a)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,i){var s=e.alternate;return s===null?(s=Bg(e.tag,i,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=i,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,i=e.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Rg(e,i,s,a,c,d){var h=2;if(a=e,typeof e=="function")aj(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case ya:return Tg(s.children,c,d,i);case za:h=8,c|=8;break;case Aa:return e=Bg(12,s,i,c|2),e.elementType=Aa,e.lanes=d,e;case Ea:return e=Bg(13,s,i,c),e.elementType=Ea,e.lanes=d,e;case Fa:return e=Bg(19,s,i,c),e.elementType=Fa,e.lanes=d,e;case Ia:return pj(s,c,d,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:h=10;break e;case Ca:h=9;break e;case Da:h=11;break e;case Ga:h=14;break e;case Ha:h=16,a=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return i=Bg(h,s,i,c),i.elementType=e,i.type=a,i.lanes=d,i}function Tg(e,i,s,a){return e=Bg(7,e,a,i),e.lanes=s,e}function pj(e,i,s,a){return e=Bg(22,e,a,i),e.elementType=Ia,e.lanes=s,e.stateNode={isHidden:!1},e}function Qg(e,i,s){return e=Bg(6,e,null,i),e.lanes=s,e}function Sg(e,i,s){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=s,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function al(e,i,s,a,c){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=a,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function bl(e,i,s,a,c,d,h,g,_){return e=new al(e,i,s,g,_),i===1?(i=1,d===!0&&(i|=8)):i=0,d=Bg(3,null,null,i),e.current=d,d.stateNode=e,d.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(d),e}function cl(e,i,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:a==null?null:""+a,children:e,containerInfo:i,implementation:s}}function dl(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(e.tag===1){var s=e.type;if(Zf(s))return bg(e,s,i)}return i}function el(e,i,s,a,c,d,h,g,_){return e=bl(s,a,!0,e,c,d,h,g,_),e.context=dl(null),s=e.current,a=R(),c=yi(s),d=mh(a,c),d.callback=i??null,nh(s,d,c),e.current.lanes=c,Ac(e,c,a),Dk(e,a),e}function fl(e,i,s,a){var c=i.current,d=R(),h=yi(c);return s=dl(s),i.context===null?i.context=s:i.pendingContext=s,i=mh(d,h),i.payload={element:e},a=a===void 0?null:a,a!==null&&(i.callback=a),e=nh(c,i,h),e!==null&&(gi(e,c,h,d),oh(e,c,h)),h}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<i?s:i}}function il(e,i){hl(e,i),(e=e.alternate)&&hl(e,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p(409));fl(e,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Rk(function(){fl(null,e,null,null)}),i[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var s=0;s<Qc.length&&i!==0&&i<Qc[s].priority;s++);Qc.splice(s,0,e),s===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,i,s,a,c){if(c){if(typeof a=="function"){var d=a;a=function(){var b=gl(h);d.call(b)}}var h=el(i,a,e,0,null,!1,!1,"",pl);return e._reactRootContainer=h,e[uf]=h.current,sf(e.nodeType===8?e.parentNode:e),Rk(),h}for(;c=e.lastChild;)e.removeChild(c);if(typeof a=="function"){var g=a;a=function(){var b=gl(_);g.call(b)}}var _=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=_,e[uf]=_.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(i,_,s,a)}),_}function rl(e,i,s,a,c){var d=s._reactRootContainer;if(d){var h=d;if(typeof c=="function"){var g=c;c=function(){var _=gl(h);g.call(_)}}fl(i,h,e,c)}else h=ql(s,i,e,c,a);return gl(h)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var s=tc(i.pendingLanes);s!==0&&(Cc(i,s|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var a=ih(e,1);if(a!==null){var c=R();gi(a,e,1,c)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var i=ih(e,134217728);if(i!==null){var s=R();gi(i,e,134217728,s)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var i=yi(e),s=ih(e,i);if(s!==null){var a=R();gi(s,e,i,a)}il(e,i)}};Hc=function(){return C};Ic=function(e,i){var s=C;try{return C=e,i()}finally{C=s}};yb=function(e,i,s){switch(i){case"input":if(bb(e,s),i=s.name,s.type==="radio"&&i!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var a=s[i];if(a!==e&&a.form===e.form){var c=Db(a);if(!c)throw Error(p(90));Wa(a),bb(a,c)}}}break;case"textarea":ib(e,s);break;case"select":i=s.value,i!=null&&fb(e,!!s.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p(200));return cl(e,i,null,s)};reactDom_production_min.createRoot=function(e,i){if(!nl(e))throw Error(p(299));var s=!1,a="",c=kl;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(a=i.identifierPrefix),i.onRecoverableError!==void 0&&(c=i.onRecoverableError)),i=bl(e,1,!1,null,null,s,!1,a,c),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ll(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,i,s){if(!ol(i))throw Error(p(200));return rl(null,e,i,!0,s)};reactDom_production_min.hydrateRoot=function(e,i,s){if(!nl(e))throw Error(p(405));var a=s!=null&&s.hydratedSources||null,c=!1,d="",h=kl;if(s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onRecoverableError!==void 0&&(h=s.onRecoverableError)),i=el(i,null,e,1,s??null,c,!1,d,h),e[uf]=i.current,sf(e),a)for(e=0;e<a.length;e++)s=a[e],c=s._getVersion,c=c(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,c]:i.mutableSourceEagerHydrationData.push(s,c);return new ml(i)};reactDom_production_min.render=function(e,i,s){if(!ol(i))throw Error(p(200));return rl(null,e,i,!1,s)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,s,a){if(!ol(s))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl(e,i,s,!1,a)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const vt=getDefaultExportFromCjs(reactDomExports);var createRoot,m=reactDomExports;createRoot=m.createRoot,m.hydrateRoot;const TOAST_LIMIT=1,TOAST_REMOVE_DELAY=1e6;let count=0;function genId(){return count=(count+1)%Number.MAX_SAFE_INTEGER,count.toString()}const toastTimeouts=new Map,addToRemoveQueue=e=>{if(toastTimeouts.has(e))return;const i=setTimeout(()=>{toastTimeouts.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},TOAST_REMOVE_DELAY);toastTimeouts.set(e,i)},reducer=(e,i)=>{switch(i.type){case"ADD_TOAST":return{...e,toasts:[i.toast,...e.toasts].slice(0,TOAST_LIMIT)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(s=>s.id===i.toast.id?{...s,...i.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=i;return s?addToRemoveQueue(s):e.toasts.forEach(a=>{addToRemoveQueue(a.id)}),{...e,toasts:e.toasts.map(a=>a.id===s||s===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return i.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==i.toastId)}}},listeners=[];let memoryState={toasts:[]};function dispatch(e){memoryState=reducer(memoryState,e),listeners.forEach(i=>{i(memoryState)})}function toast({...e}){const i=genId(),s=c=>dispatch({type:"UPDATE_TOAST",toast:{...c,id:i}}),a=()=>dispatch({type:"DISMISS_TOAST",toastId:i});return dispatch({type:"ADD_TOAST",toast:{...e,id:i,open:!0,onOpenChange:c=>{c||a()}}}),{id:i,dismiss:a,update:s}}function useToast(){const[e,i]=reactExports.useState(memoryState);return reactExports.useEffect(()=>(listeners.push(i),()=>{const s=listeners.indexOf(i);s>-1&&listeners.splice(s,1)}),[e]),{...e,toast,dismiss:s=>dispatch({type:"DISMISS_TOAST",toastId:s})}}function composeEventHandlers(e,i,{checkForDefaultPrevented:s=!0}={}){return function(c){if(e==null||e(c),s===!1||!c.defaultPrevented)return i==null?void 0:i(c)}}function setRef(e,i){if(typeof e=="function")return e(i);e!=null&&(e.current=i)}function composeRefs(...e){return i=>{let s=!1;const a=e.map(c=>{const d=setRef(c,i);return!s&&typeof d=="function"&&(s=!0),d});if(s)return()=>{for(let c=0;c<a.length;c++){const d=a[c];typeof d=="function"?d():setRef(e[c],null)}}}}function useComposedRefs(...e){return reactExports.useCallback(composeRefs(...e),e)}function createContextScope(e,i=[]){let s=[];function a(d,h){const g=reactExports.createContext(h),_=s.length;s=[...s,h];const b=nt=>{var ot;const{scope:it,children:et,...lt}=nt,rt=((ot=it==null?void 0:it[e])==null?void 0:ot[_])||g,at=reactExports.useMemo(()=>lt,Object.values(lt));return jsxRuntimeExports.jsx(rt.Provider,{value:at,children:et})};b.displayName=d+"Provider";function _e(nt,it){var rt;const et=((rt=it==null?void 0:it[e])==null?void 0:rt[_])||g,lt=reactExports.useContext(et);if(lt)return lt;if(h!==void 0)return h;throw new Error(`\`${nt}\` must be used within \`${d}\``)}return[b,_e]}const c=()=>{const d=s.map(h=>reactExports.createContext(h));return function(g){const _=(g==null?void 0:g[e])||d;return reactExports.useMemo(()=>({[`__scope${e}`]:{...g,[e]:_}}),[g,_])}};return c.scopeName=e,[a,composeContextScopes(c,...i)]}function composeContextScopes(...e){const i=e[0];if(e.length===1)return i;const s=()=>{const a=e.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(d){const h=a.reduce((g,{useScope:_,scopeName:b})=>{const nt=_(d)[`__scope${b}`];return{...g,...nt}},{});return reactExports.useMemo(()=>({[`__scope${i.scopeName}`]:h}),[h])}};return s.scopeName=i.scopeName,s}function createSlot(e){const i=createSlotClone(e),s=reactExports.forwardRef((a,c)=>{const{children:d,...h}=a,g=reactExports.Children.toArray(d),_=g.find(isSlottable);if(_){const b=_.props.children,_e=g.map(nt=>nt===_?reactExports.Children.count(b)>1?reactExports.Children.only(null):reactExports.isValidElement(b)?b.props.children:null:nt);return jsxRuntimeExports.jsx(i,{...h,ref:c,children:reactExports.isValidElement(b)?reactExports.cloneElement(b,void 0,_e):null})}return jsxRuntimeExports.jsx(i,{...h,ref:c,children:d})});return s.displayName=`${e}.Slot`,s}var Slot=createSlot("Slot");function createSlotClone(e){const i=reactExports.forwardRef((s,a)=>{const{children:c,...d}=s;if(reactExports.isValidElement(c)){const h=getElementRef$1(c),g=mergeProps(d,c.props);return c.type!==reactExports.Fragment&&(g.ref=a?composeRefs(a,h):h),reactExports.cloneElement(c,g)}return reactExports.Children.count(c)>1?reactExports.Children.only(null):null});return i.displayName=`${e}.SlotClone`,i}var SLOTTABLE_IDENTIFIER=Symbol("radix.slottable");function createSlottable(e){const i=({children:s})=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s});return i.displayName=`${e}.Slottable`,i.__radixId=SLOTTABLE_IDENTIFIER,i}function isSlottable(e){return reactExports.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===SLOTTABLE_IDENTIFIER}function mergeProps(e,i){const s={...i};for(const a in i){const c=e[a],d=i[a];/^on[A-Z]/.test(a)?c&&d?s[a]=(...g)=>{const _=d(...g);return c(...g),_}:c&&(s[a]=c):a==="style"?s[a]={...c,...d}:a==="className"&&(s[a]=[c,d].filter(Boolean).join(" "))}return{...e,...s}}function getElementRef$1(e){var a,c;let i=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,s=i&&"isReactWarning"in i&&i.isReactWarning;return s?e.ref:(i=(c=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:c.get,s=i&&"isReactWarning"in i&&i.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}function createCollection(e){const i=e+"CollectionProvider",[s,a]=createContextScope(i),[c,d]=s(i,{collectionRef:{current:null},itemMap:new Map}),h=rt=>{const{scope:at,children:ot}=rt,st=o.useRef(null),ct=o.useRef(new Map).current;return jsxRuntimeExports.jsx(c,{scope:at,itemMap:ct,collectionRef:st,children:ot})};h.displayName=i;const g=e+"CollectionSlot",_=createSlot(g),b=o.forwardRef((rt,at)=>{const{scope:ot,children:st}=rt,ct=d(g,ot),mt=useComposedRefs(at,ct.collectionRef);return jsxRuntimeExports.jsx(_,{ref:mt,children:st})});b.displayName=g;const _e=e+"CollectionItemSlot",nt="data-radix-collection-item",it=createSlot(_e),et=o.forwardRef((rt,at)=>{const{scope:ot,children:st,...ct}=rt,mt=o.useRef(null),pt=useComposedRefs(at,mt),Et=d(_e,ot);return o.useEffect(()=>(Et.itemMap.set(mt,{ref:mt,...ct}),()=>void Et.itemMap.delete(mt))),jsxRuntimeExports.jsx(it,{[nt]:"",ref:pt,children:st})});et.displayName=_e;function lt(rt){const at=d(e+"CollectionConsumer",rt);return o.useCallback(()=>{const st=at.collectionRef.current;if(!st)return[];const ct=Array.from(st.querySelectorAll(`[${nt}]`));return Array.from(at.itemMap.values()).sort((Et,ut)=>ct.indexOf(Et.ref.current)-ct.indexOf(ut.ref.current))},[at.collectionRef,at.itemMap])}return[{Provider:h,Slot:b,ItemSlot:et},lt,a]}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive=NODES.reduce((e,i)=>{const s=createSlot(`Primitive.${i}`),a=reactExports.forwardRef((c,d)=>{const{asChild:h,...g}=c,_=h?s:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(_,{...g,ref:d})});return a.displayName=`Primitive.${i}`,{...e,[i]:a}},{});function dispatchDiscreteCustomEvent(e,i){e&&reactDomExports.flushSync(()=>e.dispatchEvent(i))}function useCallbackRef(e){const i=reactExports.useRef(e);return reactExports.useEffect(()=>{i.current=e}),reactExports.useMemo(()=>(...s)=>{var a;return(a=i.current)==null?void 0:a.call(i,...s)},[])}function useEscapeKeydown(e,i=globalThis==null?void 0:globalThis.document){const s=useCallbackRef(e);reactExports.useEffect(()=>{const a=c=>{c.key==="Escape"&&s(c)};return i.addEventListener("keydown",a,{capture:!0}),()=>i.removeEventListener("keydown",a,{capture:!0})},[s,i])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((e,i)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:a,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:g,..._}=e,b=reactExports.useContext(DismissableLayerContext),[_e,nt]=reactExports.useState(null),it=(_e==null?void 0:_e.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,et]=reactExports.useState({}),lt=useComposedRefs(i,ut=>nt(ut)),rt=Array.from(b.layers),[at]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),ot=rt.indexOf(at),st=_e?rt.indexOf(_e):-1,ct=b.layersWithOutsidePointerEventsDisabled.size>0,mt=st>=ot,pt=usePointerDownOutside(ut=>{const gt=ut.target,xt=[...b.branches].some(Pt=>Pt.contains(gt));!mt||xt||(c==null||c(ut),h==null||h(ut),ut.defaultPrevented||g==null||g())},it),Et=useFocusOutside(ut=>{const gt=ut.target;[...b.branches].some(Pt=>Pt.contains(gt))||(d==null||d(ut),h==null||h(ut),ut.defaultPrevented||g==null||g())},it);return useEscapeKeydown(ut=>{st===b.layers.size-1&&(a==null||a(ut),!ut.defaultPrevented&&g&&(ut.preventDefault(),g()))},it),reactExports.useEffect(()=>{if(_e)return s&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=it.body.style.pointerEvents,it.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(_e)),b.layers.add(_e),dispatchUpdate(),()=>{s&&b.layersWithOutsidePointerEventsDisabled.size===1&&(it.body.style.pointerEvents=originalBodyPointerEvents)}},[_e,it,s,b]),reactExports.useEffect(()=>()=>{_e&&(b.layers.delete(_e),b.layersWithOutsidePointerEventsDisabled.delete(_e),dispatchUpdate())},[_e,b]),reactExports.useEffect(()=>{const ut=()=>et({});return document.addEventListener(CONTEXT_UPDATE,ut),()=>document.removeEventListener(CONTEXT_UPDATE,ut)},[]),jsxRuntimeExports.jsx(Primitive.div,{..._,ref:lt,style:{pointerEvents:ct?mt?"auto":"none":void 0,...e.style},onFocusCapture:composeEventHandlers(e.onFocusCapture,Et.onFocusCapture),onBlurCapture:composeEventHandlers(e.onBlurCapture,Et.onBlurCapture),onPointerDownCapture:composeEventHandlers(e.onPointerDownCapture,pt.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((e,i)=>{const s=reactExports.useContext(DismissableLayerContext),a=reactExports.useRef(null),c=useComposedRefs(i,a);return reactExports.useEffect(()=>{const d=a.current;if(d)return s.branches.add(d),()=>{s.branches.delete(d)}},[s.branches]),jsxRuntimeExports.jsx(Primitive.div,{...e,ref:c})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(e,i=globalThis==null?void 0:globalThis.document){const s=useCallbackRef(e),a=reactExports.useRef(!1),c=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const d=g=>{if(g.target&&!a.current){let _=function(){handleAndDispatchCustomEvent$1(POINTER_DOWN_OUTSIDE,s,b,{discrete:!0})};const b={originalEvent:g};g.pointerType==="touch"?(i.removeEventListener("click",c.current),c.current=_,i.addEventListener("click",c.current,{once:!0})):_()}else i.removeEventListener("click",c.current);a.current=!1},h=window.setTimeout(()=>{i.addEventListener("pointerdown",d)},0);return()=>{window.clearTimeout(h),i.removeEventListener("pointerdown",d),i.removeEventListener("click",c.current)}},[i,s]),{onPointerDownCapture:()=>a.current=!0}}function useFocusOutside(e,i=globalThis==null?void 0:globalThis.document){const s=useCallbackRef(e),a=reactExports.useRef(!1);return reactExports.useEffect(()=>{const c=d=>{d.target&&!a.current&&handleAndDispatchCustomEvent$1(FOCUS_OUTSIDE,s,{originalEvent:d},{discrete:!1})};return i.addEventListener("focusin",c),()=>i.removeEventListener("focusin",c)},[i,s]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function dispatchUpdate(){const e=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(e)}function handleAndDispatchCustomEvent$1(e,i,s,{discrete:a}){const c=s.originalEvent.target,d=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});i&&c.addEventListener(e,i,{once:!0}),a?dispatchDiscreteCustomEvent(c,d):c.dispatchEvent(d)}var Root$2=DismissableLayer,Branch=DismissableLayerBranch,useLayoutEffect2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},PORTAL_NAME$1="Portal",Portal=reactExports.forwardRef((e,i)=>{var g;const{container:s,...a}=e,[c,d]=reactExports.useState(!1);useLayoutEffect2(()=>d(!0),[]);const h=s||c&&((g=globalThis==null?void 0:globalThis.document)==null?void 0:g.body);return h?vt.createPortal(jsxRuntimeExports.jsx(Primitive.div,{...a,ref:i}),h):null});Portal.displayName=PORTAL_NAME$1;function useStateMachine(e,i){return reactExports.useReducer((s,a)=>i[s][a]??s,e)}var Presence=e=>{const{present:i,children:s}=e,a=usePresence(i),c=typeof s=="function"?s({present:a.isPresent}):reactExports.Children.only(s),d=useComposedRefs(a.ref,getElementRef(c));return typeof s=="function"||a.isPresent?reactExports.cloneElement(c,{ref:d}):null};Presence.displayName="Presence";function usePresence(e){const[i,s]=reactExports.useState(),a=reactExports.useRef(null),c=reactExports.useRef(e),d=reactExports.useRef("none"),h=e?"mounted":"unmounted",[g,_]=useStateMachine(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const b=getAnimationName(a.current);d.current=g==="mounted"?b:"none"},[g]),useLayoutEffect2(()=>{const b=a.current,_e=c.current;if(_e!==e){const it=d.current,et=getAnimationName(b);e?_("MOUNT"):et==="none"||(b==null?void 0:b.display)==="none"?_("UNMOUNT"):_(_e&&it!==et?"ANIMATION_OUT":"UNMOUNT"),c.current=e}},[e,_]),useLayoutEffect2(()=>{if(i){let b;const _e=i.ownerDocument.defaultView??window,nt=et=>{const rt=getAnimationName(a.current).includes(et.animationName);if(et.target===i&&rt&&(_("ANIMATION_END"),!c.current)){const at=i.style.animationFillMode;i.style.animationFillMode="forwards",b=_e.setTimeout(()=>{i.style.animationFillMode==="forwards"&&(i.style.animationFillMode=at)})}},it=et=>{et.target===i&&(d.current=getAnimationName(a.current))};return i.addEventListener("animationstart",it),i.addEventListener("animationcancel",nt),i.addEventListener("animationend",nt),()=>{_e.clearTimeout(b),i.removeEventListener("animationstart",it),i.removeEventListener("animationcancel",nt),i.removeEventListener("animationend",nt)}}else _("ANIMATION_END")},[i,_]),{isPresent:["mounted","unmountSuspended"].includes(g),ref:reactExports.useCallback(b=>{a.current=b?getComputedStyle(b):null,s(b)},[])}}function getAnimationName(e){return(e==null?void 0:e.animationName)||"none"}function getElementRef(e){var a,c;let i=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,s=i&&"isReactWarning"in i&&i.isReactWarning;return s?e.ref:(i=(c=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:c.get,s=i&&"isReactWarning"in i&&i.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}var useInsertionEffect=React[" useInsertionEffect ".trim().toString()]||useLayoutEffect2;function useControllableState({prop:e,defaultProp:i,onChange:s=()=>{},caller:a}){const[c,d,h]=useUncontrolledState({defaultProp:i,onChange:s}),g=e!==void 0,_=g?e:c;{const _e=reactExports.useRef(e!==void 0);reactExports.useEffect(()=>{const nt=_e.current;nt!==g&&console.warn(`${a} is changing from ${nt?"controlled":"uncontrolled"} to ${g?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),_e.current=g},[g,a])}const b=reactExports.useCallback(_e=>{var nt;if(g){const it=isFunction(_e)?_e(e):_e;it!==e&&((nt=h.current)==null||nt.call(h,it))}else d(_e)},[g,e,d,h]);return[_,b]}function useUncontrolledState({defaultProp:e,onChange:i}){const[s,a]=reactExports.useState(e),c=reactExports.useRef(s),d=reactExports.useRef(i);return useInsertionEffect(()=>{d.current=i},[i]),reactExports.useEffect(()=>{var h;c.current!==s&&((h=d.current)==null||h.call(d,s),c.current=s)},[s,c]),[s,a,d]}function isFunction(e){return typeof e=="function"}var VISUALLY_HIDDEN_STYLES=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),NAME$1="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((e,i)=>jsxRuntimeExports.jsx(Primitive.span,{...e,ref:i,style:{...VISUALLY_HIDDEN_STYLES,...e.style}}));VisuallyHidden.displayName=NAME$1;var Root$1=VisuallyHidden,PROVIDER_NAME$1="ToastProvider",[Collection,useCollection,createCollectionScope]=createCollection("Toast"),[createToastContext,createToastScope]=createContextScope("Toast",[createCollectionScope]),[ToastProviderProvider,useToastProviderContext]=createToastContext(PROVIDER_NAME$1),ToastProvider$1=e=>{const{__scopeToast:i,label:s="Notification",duration:a=5e3,swipeDirection:c="right",swipeThreshold:d=50,children:h}=e,[g,_]=reactExports.useState(null),[b,_e]=reactExports.useState(0),nt=reactExports.useRef(!1),it=reactExports.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${PROVIDER_NAME$1}\`. Expected non-empty \`string\`.`),jsxRuntimeExports.jsx(Collection.Provider,{scope:i,children:jsxRuntimeExports.jsx(ToastProviderProvider,{scope:i,label:s,duration:a,swipeDirection:c,swipeThreshold:d,toastCount:b,viewport:g,onViewportChange:_,onToastAdd:reactExports.useCallback(()=>_e(et=>et+1),[]),onToastRemove:reactExports.useCallback(()=>_e(et=>et-1),[]),isFocusedToastEscapeKeyDownRef:nt,isClosePausedRef:it,children:h})})};ToastProvider$1.displayName=PROVIDER_NAME$1;var VIEWPORT_NAME="ToastViewport",VIEWPORT_DEFAULT_HOTKEY=["F8"],VIEWPORT_PAUSE="toast.viewportPause",VIEWPORT_RESUME="toast.viewportResume",ToastViewport$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,hotkey:a=VIEWPORT_DEFAULT_HOTKEY,label:c="Notifications ({hotkey})",...d}=e,h=useToastProviderContext(VIEWPORT_NAME,s),g=useCollection(s),_=reactExports.useRef(null),b=reactExports.useRef(null),_e=reactExports.useRef(null),nt=reactExports.useRef(null),it=useComposedRefs(i,nt,h.onViewportChange),et=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),lt=h.toastCount>0;reactExports.useEffect(()=>{const at=ot=>{var ct;a.length!==0&&a.every(mt=>ot[mt]||ot.code===mt)&&((ct=nt.current)==null||ct.focus())};return document.addEventListener("keydown",at),()=>document.removeEventListener("keydown",at)},[a]),reactExports.useEffect(()=>{const at=_.current,ot=nt.current;if(lt&&at&&ot){const st=()=>{if(!h.isClosePausedRef.current){const Et=new CustomEvent(VIEWPORT_PAUSE);ot.dispatchEvent(Et),h.isClosePausedRef.current=!0}},ct=()=>{if(h.isClosePausedRef.current){const Et=new CustomEvent(VIEWPORT_RESUME);ot.dispatchEvent(Et),h.isClosePausedRef.current=!1}},mt=Et=>{!at.contains(Et.relatedTarget)&&ct()},pt=()=>{at.contains(document.activeElement)||ct()};return at.addEventListener("focusin",st),at.addEventListener("focusout",mt),at.addEventListener("pointermove",st),at.addEventListener("pointerleave",pt),window.addEventListener("blur",st),window.addEventListener("focus",ct),()=>{at.removeEventListener("focusin",st),at.removeEventListener("focusout",mt),at.removeEventListener("pointermove",st),at.removeEventListener("pointerleave",pt),window.removeEventListener("blur",st),window.removeEventListener("focus",ct)}}},[lt,h.isClosePausedRef]);const rt=reactExports.useCallback(({tabbingDirection:at})=>{const st=g().map(ct=>{const mt=ct.ref.current,pt=[mt,...getTabbableCandidates(mt)];return at==="forwards"?pt:pt.reverse()});return(at==="forwards"?st.reverse():st).flat()},[g]);return reactExports.useEffect(()=>{const at=nt.current;if(at){const ot=st=>{var pt,Et,ut;const ct=st.altKey||st.ctrlKey||st.metaKey;if(st.key==="Tab"&&!ct){const gt=document.activeElement,xt=st.shiftKey;if(st.target===at&&xt){(pt=b.current)==null||pt.focus();return}const Ct=rt({tabbingDirection:xt?"backwards":"forwards"}),Lt=Ct.findIndex(er=>er===gt);focusFirst(Ct.slice(Lt+1))?st.preventDefault():xt?(Et=b.current)==null||Et.focus():(ut=_e.current)==null||ut.focus()}};return at.addEventListener("keydown",ot),()=>at.removeEventListener("keydown",ot)}},[g,rt]),jsxRuntimeExports.jsxs(Branch,{ref:_,role:"region","aria-label":c.replace("{hotkey}",et),tabIndex:-1,style:{pointerEvents:lt?void 0:"none"},children:[lt&&jsxRuntimeExports.jsx(FocusProxy,{ref:b,onFocusFromOutsideViewport:()=>{const at=rt({tabbingDirection:"forwards"});focusFirst(at)}}),jsxRuntimeExports.jsx(Collection.Slot,{scope:s,children:jsxRuntimeExports.jsx(Primitive.ol,{tabIndex:-1,...d,ref:it})}),lt&&jsxRuntimeExports.jsx(FocusProxy,{ref:_e,onFocusFromOutsideViewport:()=>{const at=rt({tabbingDirection:"backwards"});focusFirst(at)}})]})});ToastViewport$1.displayName=VIEWPORT_NAME;var FOCUS_PROXY_NAME="ToastFocusProxy",FocusProxy=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,onFocusFromOutsideViewport:a,...c}=e,d=useToastProviderContext(FOCUS_PROXY_NAME,s);return jsxRuntimeExports.jsx(VisuallyHidden,{"aria-hidden":!0,tabIndex:0,...c,ref:i,style:{position:"fixed"},onFocus:h=>{var b;const g=h.relatedTarget;!((b=d.viewport)!=null&&b.contains(g))&&a()}})});FocusProxy.displayName=FOCUS_PROXY_NAME;var TOAST_NAME="Toast",TOAST_SWIPE_START="toast.swipeStart",TOAST_SWIPE_MOVE="toast.swipeMove",TOAST_SWIPE_CANCEL="toast.swipeCancel",TOAST_SWIPE_END="toast.swipeEnd",Toast$1=reactExports.forwardRef((e,i)=>{const{forceMount:s,open:a,defaultOpen:c,onOpenChange:d,...h}=e,[g,_]=useControllableState({prop:a,defaultProp:c??!0,onChange:d,caller:TOAST_NAME});return jsxRuntimeExports.jsx(Presence,{present:s||g,children:jsxRuntimeExports.jsx(ToastImpl,{open:g,...h,ref:i,onClose:()=>_(!1),onPause:useCallbackRef(e.onPause),onResume:useCallbackRef(e.onResume),onSwipeStart:composeEventHandlers(e.onSwipeStart,b=>{b.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:composeEventHandlers(e.onSwipeMove,b=>{const{x:_e,y:nt}=b.detail.delta;b.currentTarget.setAttribute("data-swipe","move"),b.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${_e}px`),b.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${nt}px`)}),onSwipeCancel:composeEventHandlers(e.onSwipeCancel,b=>{b.currentTarget.setAttribute("data-swipe","cancel"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),b.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:composeEventHandlers(e.onSwipeEnd,b=>{const{x:_e,y:nt}=b.detail.delta;b.currentTarget.setAttribute("data-swipe","end"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),b.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${_e}px`),b.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${nt}px`),_(!1)})})})});Toast$1.displayName=TOAST_NAME;var[ToastInteractiveProvider,useToastInteractiveContext]=createToastContext(TOAST_NAME,{onClose(){}}),ToastImpl=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,type:a="foreground",duration:c,open:d,onClose:h,onEscapeKeyDown:g,onPause:_,onResume:b,onSwipeStart:_e,onSwipeMove:nt,onSwipeCancel:it,onSwipeEnd:et,...lt}=e,rt=useToastProviderContext(TOAST_NAME,s),[at,ot]=reactExports.useState(null),st=useComposedRefs(i,er=>ot(er)),ct=reactExports.useRef(null),mt=reactExports.useRef(null),pt=c||rt.duration,Et=reactExports.useRef(0),ut=reactExports.useRef(pt),gt=reactExports.useRef(0),{onToastAdd:xt,onToastRemove:Pt}=rt,St=useCallbackRef(()=>{var Kt;(at==null?void 0:at.contains(document.activeElement))&&((Kt=rt.viewport)==null||Kt.focus()),h()}),Ct=reactExports.useCallback(er=>{!er||er===1/0||(window.clearTimeout(gt.current),Et.current=new Date().getTime(),gt.current=window.setTimeout(St,er))},[St]);reactExports.useEffect(()=>{const er=rt.viewport;if(er){const Kt=()=>{Ct(ut.current),b==null||b()},nr=()=>{const Jt=new Date().getTime()-Et.current;ut.current=ut.current-Jt,window.clearTimeout(gt.current),_==null||_()};return er.addEventListener(VIEWPORT_PAUSE,nr),er.addEventListener(VIEWPORT_RESUME,Kt),()=>{er.removeEventListener(VIEWPORT_PAUSE,nr),er.removeEventListener(VIEWPORT_RESUME,Kt)}}},[rt.viewport,pt,_,b,Ct]),reactExports.useEffect(()=>{d&&!rt.isClosePausedRef.current&&Ct(pt)},[d,pt,rt.isClosePausedRef,Ct]),reactExports.useEffect(()=>(xt(),()=>Pt()),[xt,Pt]);const Lt=reactExports.useMemo(()=>at?getAnnounceTextContent(at):null,[at]);return rt.viewport?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Lt&&jsxRuntimeExports.jsx(ToastAnnounce,{__scopeToast:s,role:"status","aria-live":a==="foreground"?"assertive":"polite","aria-atomic":!0,children:Lt}),jsxRuntimeExports.jsx(ToastInteractiveProvider,{scope:s,onClose:St,children:reactDomExports.createPortal(jsxRuntimeExports.jsx(Collection.ItemSlot,{scope:s,children:jsxRuntimeExports.jsx(Root$2,{asChild:!0,onEscapeKeyDown:composeEventHandlers(g,()=>{rt.isFocusedToastEscapeKeyDownRef.current||St(),rt.isFocusedToastEscapeKeyDownRef.current=!1}),children:jsxRuntimeExports.jsx(Primitive.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":d?"open":"closed","data-swipe-direction":rt.swipeDirection,...lt,ref:st,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:composeEventHandlers(e.onKeyDown,er=>{er.key==="Escape"&&(g==null||g(er.nativeEvent),er.nativeEvent.defaultPrevented||(rt.isFocusedToastEscapeKeyDownRef.current=!0,St()))}),onPointerDown:composeEventHandlers(e.onPointerDown,er=>{er.button===0&&(ct.current={x:er.clientX,y:er.clientY})}),onPointerMove:composeEventHandlers(e.onPointerMove,er=>{if(!ct.current)return;const Kt=er.clientX-ct.current.x,nr=er.clientY-ct.current.y,Jt=!!mt.current,qt=["left","right"].includes(rt.swipeDirection),kt=["left","up"].includes(rt.swipeDirection)?Math.min:Math.max,Xt=qt?kt(0,Kt):0,sr=qt?0:kt(0,nr),At=er.pointerType==="touch"?10:2,ht={x:Xt,y:sr},dt={originalEvent:er,delta:ht};Jt?(mt.current=ht,handleAndDispatchCustomEvent(TOAST_SWIPE_MOVE,nt,dt,{discrete:!1})):isDeltaInDirection(ht,rt.swipeDirection,At)?(mt.current=ht,handleAndDispatchCustomEvent(TOAST_SWIPE_START,_e,dt,{discrete:!1}),er.target.setPointerCapture(er.pointerId)):(Math.abs(Kt)>At||Math.abs(nr)>At)&&(ct.current=null)}),onPointerUp:composeEventHandlers(e.onPointerUp,er=>{const Kt=mt.current,nr=er.target;if(nr.hasPointerCapture(er.pointerId)&&nr.releasePointerCapture(er.pointerId),mt.current=null,ct.current=null,Kt){const Jt=er.currentTarget,qt={originalEvent:er,delta:Kt};isDeltaInDirection(Kt,rt.swipeDirection,rt.swipeThreshold)?handleAndDispatchCustomEvent(TOAST_SWIPE_END,et,qt,{discrete:!0}):handleAndDispatchCustomEvent(TOAST_SWIPE_CANCEL,it,qt,{discrete:!0}),Jt.addEventListener("click",kt=>kt.preventDefault(),{once:!0})}})})})}),rt.viewport)})]}):null}),ToastAnnounce=e=>{const{__scopeToast:i,children:s,...a}=e,c=useToastProviderContext(TOAST_NAME,i),[d,h]=reactExports.useState(!1),[g,_]=reactExports.useState(!1);return useNextFrame(()=>h(!0)),reactExports.useEffect(()=>{const b=window.setTimeout(()=>_(!0),1e3);return()=>window.clearTimeout(b)},[]),g?null:jsxRuntimeExports.jsx(Portal,{asChild:!0,children:jsxRuntimeExports.jsx(VisuallyHidden,{...a,children:d&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[c.label," ",s]})})})},TITLE_NAME="ToastTitle",ToastTitle$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,...a}=e;return jsxRuntimeExports.jsx(Primitive.div,{...a,ref:i})});ToastTitle$1.displayName=TITLE_NAME;var DESCRIPTION_NAME="ToastDescription",ToastDescription$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,...a}=e;return jsxRuntimeExports.jsx(Primitive.div,{...a,ref:i})});ToastDescription$1.displayName=DESCRIPTION_NAME;var ACTION_NAME="ToastAction",ToastAction$1=reactExports.forwardRef((e,i)=>{const{altText:s,...a}=e;return s.trim()?jsxRuntimeExports.jsx(ToastAnnounceExclude,{altText:s,asChild:!0,children:jsxRuntimeExports.jsx(ToastClose$1,{...a,ref:i})}):(console.error(`Invalid prop \`altText\` supplied to \`${ACTION_NAME}\`. Expected non-empty \`string\`.`),null)});ToastAction$1.displayName=ACTION_NAME;var CLOSE_NAME="ToastClose",ToastClose$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,...a}=e,c=useToastInteractiveContext(CLOSE_NAME,s);return jsxRuntimeExports.jsx(ToastAnnounceExclude,{asChild:!0,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",...a,ref:i,onClick:composeEventHandlers(e.onClick,c.onClose)})})});ToastClose$1.displayName=CLOSE_NAME;var ToastAnnounceExclude=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,altText:a,...c}=e;return jsxRuntimeExports.jsx(Primitive.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...c,ref:i})});function getAnnounceTextContent(e){const i=[];return Array.from(e.childNodes).forEach(a=>{if(a.nodeType===a.TEXT_NODE&&a.textContent&&i.push(a.textContent),isHTMLElement$1(a)){const c=a.ariaHidden||a.hidden||a.style.display==="none",d=a.dataset.radixToastAnnounceExclude==="";if(!c)if(d){const h=a.dataset.radixToastAnnounceAlt;h&&i.push(h)}else i.push(...getAnnounceTextContent(a))}}),i}function handleAndDispatchCustomEvent(e,i,s,{discrete:a}){const c=s.originalEvent.currentTarget,d=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:s});i&&c.addEventListener(e,i,{once:!0}),a?dispatchDiscreteCustomEvent(c,d):c.dispatchEvent(d)}var isDeltaInDirection=(e,i,s=0)=>{const a=Math.abs(e.x),c=Math.abs(e.y),d=a>c;return i==="left"||i==="right"?d&&a>s:!d&&c>s};function useNextFrame(e=()=>{}){const i=useCallbackRef(e);useLayoutEffect2(()=>{let s=0,a=0;return s=window.requestAnimationFrame(()=>a=window.requestAnimationFrame(i)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(a)}},[i])}function isHTMLElement$1(e){return e.nodeType===e.ELEMENT_NODE}function getTabbableCandidates(e){const i=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const c=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||c?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)i.push(s.currentNode);return i}function focusFirst(e){const i=document.activeElement;return e.some(s=>s===i?!0:(s.focus(),document.activeElement!==i))}var Provider$1=ToastProvider$1,Viewport=ToastViewport$1,Root2=Toast$1,Title=ToastTitle$1,Description=ToastDescription$1,Action$1=ToastAction$1,Close=ToastClose$1;function r(e){var i,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var c=e.length;for(i=0;i<c;i++)e[i]&&(s=r(e[i]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function clsx(){for(var e,i,s=0,a="",c=arguments.length;s<c;s++)(e=arguments[s])&&(i=r(e))&&(a&&(a+=" "),a+=i);return a}const falsyToString=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,cx=clsx,cva=(e,i)=>s=>{var a;if((i==null?void 0:i.variants)==null)return cx(e,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:c,defaultVariants:d}=i,h=Object.keys(c).map(b=>{const _e=s==null?void 0:s[b],nt=d==null?void 0:d[b];if(_e===null)return null;const it=falsyToString(_e)||falsyToString(nt);return c[b][it]}),g=s&&Object.entries(s).reduce((b,_e)=>{let[nt,it]=_e;return it===void 0||(b[nt]=it),b},{}),_=i==null||(a=i.compoundVariants)===null||a===void 0?void 0:a.reduce((b,_e)=>{let{class:nt,className:it,...et}=_e;return Object.entries(et).every(lt=>{let[rt,at]=lt;return Array.isArray(at)?at.includes({...d,...g}[rt]):{...d,...g}[rt]===at})?[...b,nt,it]:b},[]);return cx(e,h,_,s==null?void 0:s.class,s==null?void 0:s.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((i,s,a)=>!!i&&i.trim()!==""&&a.indexOf(i)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:e="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:c="",children:d,iconNode:h,...g},_)=>reactExports.createElement("svg",{ref:_,...defaultAttributes,width:i,height:i,stroke:e,strokeWidth:a?Number(s)*24/Number(i):s,className:mergeClasses("lucide",c),...g},[...h.map(([b,_e])=>reactExports.createElement(b,_e)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(e,i)=>{const s=reactExports.forwardRef(({className:a,...c},d)=>reactExports.createElement(Icon,{ref:d,iconNode:i,className:mergeClasses(`lucide-${toKebabCase(e)}`,a),...c}));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CircleAlert=createLucideIcon("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CircleCheckBig=createLucideIcon("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileSpreadsheet=createLucideIcon("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LoaderCircle=createLucideIcon("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Moon=createLucideIcon("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rocket=createLucideIcon("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sun=createLucideIcon("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TriangleAlert=createLucideIcon("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),CLASS_PART_SEPARATOR="-",createClassGroupUtils=e=>{const i=createClassMap(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:h=>{const g=h.split(CLASS_PART_SEPARATOR);return g[0]===""&&g.length!==1&&g.shift(),getGroupRecursive(g,i)||getGroupIdForArbitraryProperty(h)},getConflictingClassGroupIds:(h,g)=>{const _=s[h]||[];return g&&a[h]?[..._,...a[h]]:_}}},getGroupRecursive=(e,i)=>{var h;if(e.length===0)return i.classGroupId;const s=e[0],a=i.nextPart.get(s),c=a?getGroupRecursive(e.slice(1),a):void 0;if(c)return c;if(i.validators.length===0)return;const d=e.join(CLASS_PART_SEPARATOR);return(h=i.validators.find(({validator:g})=>g(d)))==null?void 0:h.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=e=>{if(arbitraryPropertyRegex.test(e)){const i=arbitraryPropertyRegex.exec(e)[1],s=i==null?void 0:i.substring(0,i.indexOf(":"));if(s)return"arbitrary.."+s}},createClassMap=e=>{const{theme:i,prefix:s}=e,a={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(e.classGroups),s).forEach(([d,h])=>{processClassesRecursively(h,a,d,i)}),a},processClassesRecursively=(e,i,s,a)=>{e.forEach(c=>{if(typeof c=="string"){const d=c===""?i:getPart(i,c);d.classGroupId=s;return}if(typeof c=="function"){if(isThemeGetter(c)){processClassesRecursively(c(a),i,s,a);return}i.validators.push({validator:c,classGroupId:s});return}Object.entries(c).forEach(([d,h])=>{processClassesRecursively(h,getPart(i,d),s,a)})})},getPart=(e,i)=>{let s=e;return i.split(CLASS_PART_SEPARATOR).forEach(a=>{s.nextPart.has(a)||s.nextPart.set(a,{nextPart:new Map,validators:[]}),s=s.nextPart.get(a)}),s},isThemeGetter=e=>e.isThemeGetter,getPrefixedClassGroupEntries=(e,i)=>i?e.map(([s,a])=>{const c=a.map(d=>typeof d=="string"?i+d:typeof d=="object"?Object.fromEntries(Object.entries(d).map(([h,g])=>[i+h,g])):d);return[s,c]}):e,createLruCache=e=>{if(e<1)return{get:()=>{},set:()=>{}};let i=0,s=new Map,a=new Map;const c=(d,h)=>{s.set(d,h),i++,i>e&&(i=0,a=s,s=new Map)};return{get(d){let h=s.get(d);if(h!==void 0)return h;if((h=a.get(d))!==void 0)return c(d,h),h},set(d,h){s.has(d)?s.set(d,h):c(d,h)}}},IMPORTANT_MODIFIER="!",createParseClassName=e=>{const{separator:i,experimentalParseClassName:s}=e,a=i.length===1,c=i[0],d=i.length,h=g=>{const _=[];let b=0,_e=0,nt;for(let at=0;at<g.length;at++){let ot=g[at];if(b===0){if(ot===c&&(a||g.slice(at,at+d)===i)){_.push(g.slice(_e,at)),_e=at+d;continue}if(ot==="/"){nt=at;continue}}ot==="["?b++:ot==="]"&&b--}const it=_.length===0?g:g.substring(_e),et=it.startsWith(IMPORTANT_MODIFIER),lt=et?it.substring(1):it,rt=nt&&nt>_e?nt-_e:void 0;return{modifiers:_,hasImportantModifier:et,baseClassName:lt,maybePostfixModifierPosition:rt}};return s?g=>s({className:g,parseClassName:h}):h},sortModifiers=e=>{if(e.length<=1)return e;const i=[];let s=[];return e.forEach(a=>{a[0]==="["?(i.push(...s.sort(),a),s=[]):s.push(a)}),i.push(...s.sort()),i},createConfigUtils=e=>({cache:createLruCache(e.cacheSize),parseClassName:createParseClassName(e),...createClassGroupUtils(e)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(e,i)=>{const{parseClassName:s,getClassGroupId:a,getConflictingClassGroupIds:c}=i,d=[],h=e.trim().split(SPLIT_CLASSES_REGEX);let g="";for(let _=h.length-1;_>=0;_-=1){const b=h[_],{modifiers:_e,hasImportantModifier:nt,baseClassName:it,maybePostfixModifierPosition:et}=s(b);let lt=!!et,rt=a(lt?it.substring(0,et):it);if(!rt){if(!lt){g=b+(g.length>0?" "+g:g);continue}if(rt=a(it),!rt){g=b+(g.length>0?" "+g:g);continue}lt=!1}const at=sortModifiers(_e).join(":"),ot=nt?at+IMPORTANT_MODIFIER:at,st=ot+rt;if(d.includes(st))continue;d.push(st);const ct=c(rt,lt);for(let mt=0;mt<ct.length;++mt){const pt=ct[mt];d.push(ot+pt)}g=b+(g.length>0?" "+g:g)}return g};function twJoin(){let e=0,i,s,a="";for(;e<arguments.length;)(i=arguments[e++])&&(s=toValue(i))&&(a&&(a+=" "),a+=s);return a}const toValue=e=>{if(typeof e=="string")return e;let i,s="";for(let a=0;a<e.length;a++)e[a]&&(i=toValue(e[a]))&&(s&&(s+=" "),s+=i);return s};function createTailwindMerge(e,...i){let s,a,c,d=h;function h(_){const b=i.reduce((_e,nt)=>nt(_e),e());return s=createConfigUtils(b),a=s.cache.get,c=s.cache.set,d=g,g(_)}function g(_){const b=a(_);if(b)return b;const _e=mergeClassList(_,s);return c(_,_e),_e}return function(){return d(twJoin.apply(null,arguments))}}const fromTheme=e=>{const i=s=>s[e]||[];return i.isThemeGetter=!0,i},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=e=>isNumber(e)||stringLengths.has(e)||fractionRegex.test(e),isArbitraryLength=e=>getIsArbitraryValue(e,"length",isLengthOnly),isNumber=e=>!!e&&!Number.isNaN(Number(e)),isArbitraryNumber=e=>getIsArbitraryValue(e,"number",isNumber),isInteger=e=>!!e&&Number.isInteger(Number(e)),isPercent=e=>e.endsWith("%")&&isNumber(e.slice(0,-1)),isArbitraryValue=e=>arbitraryValueRegex.test(e),isTshirtSize=e=>tshirtUnitRegex.test(e),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=e=>getIsArbitraryValue(e,sizeLabels,isNever),isArbitraryPosition=e=>getIsArbitraryValue(e,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=e=>getIsArbitraryValue(e,imageLabels,isImage),isArbitraryShadow=e=>getIsArbitraryValue(e,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(e,i,s)=>{const a=arbitraryValueRegex.exec(e);return a?a[1]?typeof i=="string"?a[1]===i:i.has(a[1]):s(a[2]):!1},isLengthOnly=e=>lengthUnitRegex.test(e)&&!colorFunctionRegex.test(e),isNever=()=>!1,isShadow=e=>shadowRegex.test(e),isImage=e=>imageRegex.test(e),getDefaultConfig=()=>{const e=fromTheme("colors"),i=fromTheme("spacing"),s=fromTheme("blur"),a=fromTheme("brightness"),c=fromTheme("borderColor"),d=fromTheme("borderRadius"),h=fromTheme("borderSpacing"),g=fromTheme("borderWidth"),_=fromTheme("contrast"),b=fromTheme("grayscale"),_e=fromTheme("hueRotate"),nt=fromTheme("invert"),it=fromTheme("gap"),et=fromTheme("gradientColorStops"),lt=fromTheme("gradientColorStopPositions"),rt=fromTheme("inset"),at=fromTheme("margin"),ot=fromTheme("opacity"),st=fromTheme("padding"),ct=fromTheme("saturate"),mt=fromTheme("scale"),pt=fromTheme("sepia"),Et=fromTheme("skew"),ut=fromTheme("space"),gt=fromTheme("translate"),xt=()=>["auto","contain","none"],Pt=()=>["auto","hidden","clip","visible","scroll"],St=()=>["auto",isArbitraryValue,i],Ct=()=>[isArbitraryValue,i],Lt=()=>["",isLength,isArbitraryLength],er=()=>["auto",isNumber,isArbitraryValue],Kt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],nr=()=>["solid","dashed","dotted","double","none"],Jt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],qt=()=>["start","end","center","between","around","evenly","stretch"],kt=()=>["","0",isArbitraryValue],Xt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],sr=()=>[isNumber,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:sr(),borderColor:[e],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:Ct(),borderWidth:Lt(),contrast:sr(),grayscale:kt(),hueRotate:sr(),invert:kt(),gap:Ct(),gradientColorStops:[e],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:St(),margin:St(),opacity:sr(),padding:Ct(),saturate:sr(),scale:sr(),sepia:kt(),skew:sr(),space:Ct(),translate:Ct()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":Xt()}],"break-before":[{"break-before":Xt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Kt(),isArbitraryValue]}],overflow:[{overflow:Pt()}],"overflow-x":[{"overflow-x":Pt()}],"overflow-y":[{"overflow-y":Pt()}],overscroll:[{overscroll:xt()}],"overscroll-x":[{"overscroll-x":xt()}],"overscroll-y":[{"overscroll-y":xt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[rt]}],"inset-x":[{"inset-x":[rt]}],"inset-y":[{"inset-y":[rt]}],start:[{start:[rt]}],end:[{end:[rt]}],top:[{top:[rt]}],right:[{right:[rt]}],bottom:[{bottom:[rt]}],left:[{left:[rt]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:St()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:kt()}],shrink:[{shrink:kt()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":er()}],"col-end":[{"col-end":er()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":er()}],"row-end":[{"row-end":er()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[it]}],"gap-x":[{"gap-x":[it]}],"gap-y":[{"gap-y":[it]}],"justify-content":[{justify:["normal",...qt()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...qt(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...qt(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[st]}],px:[{px:[st]}],py:[{py:[st]}],ps:[{ps:[st]}],pe:[{pe:[st]}],pt:[{pt:[st]}],pr:[{pr:[st]}],pb:[{pb:[st]}],pl:[{pl:[st]}],m:[{m:[at]}],mx:[{mx:[at]}],my:[{my:[at]}],ms:[{ms:[at]}],me:[{me:[at]}],mt:[{mt:[at]}],mr:[{mr:[at]}],mb:[{mb:[at]}],ml:[{ml:[at]}],"space-x":[{"space-x":[ut]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ut]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,i]}],"min-w":[{"min-w":[isArbitraryValue,i,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,i,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,i,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,i,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,i,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,i,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[ot]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[ot]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...nr(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Ct()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[ot]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Kt(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[lt]}],"gradient-via-pos":[{via:[lt]}],"gradient-to-pos":[{to:[lt]}],"gradient-from":[{from:[et]}],"gradient-via":[{via:[et]}],"gradient-to":[{to:[et]}],rounded:[{rounded:[d]}],"rounded-s":[{"rounded-s":[d]}],"rounded-e":[{"rounded-e":[d]}],"rounded-t":[{"rounded-t":[d]}],"rounded-r":[{"rounded-r":[d]}],"rounded-b":[{"rounded-b":[d]}],"rounded-l":[{"rounded-l":[d]}],"rounded-ss":[{"rounded-ss":[d]}],"rounded-se":[{"rounded-se":[d]}],"rounded-ee":[{"rounded-ee":[d]}],"rounded-es":[{"rounded-es":[d]}],"rounded-tl":[{"rounded-tl":[d]}],"rounded-tr":[{"rounded-tr":[d]}],"rounded-br":[{"rounded-br":[d]}],"rounded-bl":[{"rounded-bl":[d]}],"border-w":[{border:[g]}],"border-w-x":[{"border-x":[g]}],"border-w-y":[{"border-y":[g]}],"border-w-s":[{"border-s":[g]}],"border-w-e":[{"border-e":[g]}],"border-w-t":[{"border-t":[g]}],"border-w-r":[{"border-r":[g]}],"border-w-b":[{"border-b":[g]}],"border-w-l":[{"border-l":[g]}],"border-opacity":[{"border-opacity":[ot]}],"border-style":[{border:[...nr(),"hidden"]}],"divide-x":[{"divide-x":[g]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[g]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[ot]}],"divide-style":[{divide:nr()}],"border-color":[{border:[c]}],"border-color-x":[{"border-x":[c]}],"border-color-y":[{"border-y":[c]}],"border-color-s":[{"border-s":[c]}],"border-color-e":[{"border-e":[c]}],"border-color-t":[{"border-t":[c]}],"border-color-r":[{"border-r":[c]}],"border-color-b":[{"border-b":[c]}],"border-color-l":[{"border-l":[c]}],"divide-color":[{divide:[c]}],"outline-style":[{outline:["",...nr()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Lt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[ot]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[ot]}],"mix-blend":[{"mix-blend":[...Jt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Jt()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[a]}],contrast:[{contrast:[_]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[b]}],"hue-rotate":[{"hue-rotate":[_e]}],invert:[{invert:[nt]}],saturate:[{saturate:[ct]}],sepia:[{sepia:[pt]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[_]}],"backdrop-grayscale":[{"backdrop-grayscale":[b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[_e]}],"backdrop-invert":[{"backdrop-invert":[nt]}],"backdrop-opacity":[{"backdrop-opacity":[ot]}],"backdrop-saturate":[{"backdrop-saturate":[ct]}],"backdrop-sepia":[{"backdrop-sepia":[pt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:sr()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:sr()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[mt]}],"scale-x":[{"scale-x":[mt]}],"scale-y":[{"scale-y":[mt]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[gt]}],"translate-y":[{"translate-y":[gt]}],"skew-x":[{"skew-x":[Et]}],"skew-y":[{"skew-y":[Et]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Ct()}],"scroll-mx":[{"scroll-mx":Ct()}],"scroll-my":[{"scroll-my":Ct()}],"scroll-ms":[{"scroll-ms":Ct()}],"scroll-me":[{"scroll-me":Ct()}],"scroll-mt":[{"scroll-mt":Ct()}],"scroll-mr":[{"scroll-mr":Ct()}],"scroll-mb":[{"scroll-mb":Ct()}],"scroll-ml":[{"scroll-ml":Ct()}],"scroll-p":[{"scroll-p":Ct()}],"scroll-px":[{"scroll-px":Ct()}],"scroll-py":[{"scroll-py":Ct()}],"scroll-ps":[{"scroll-ps":Ct()}],"scroll-pe":[{"scroll-pe":Ct()}],"scroll-pt":[{"scroll-pt":Ct()}],"scroll-pr":[{"scroll-pr":Ct()}],"scroll-pb":[{"scroll-pb":Ct()}],"scroll-pl":[{"scroll-pl":Ct()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...e){return twMerge(clsx(e))}function getMonthName(e){return["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][e-1]||""}function getCurrentMonthYear(){const e=new Date;return{month:e.getMonth()+1,year:e.getFullYear()}}function getMonthYearFromDate(e){if(!e)return null;const i=e.split("/");if(i.length!==3)return null;const s=parseInt(i[1],10),a=parseInt(i[2],10);return isNaN(s)||isNaN(a)?null:{month:s,year:a}}const ToastProvider=Provider$1,ToastViewport=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Viewport,{ref:s,className:cn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...i}));ToastViewport.displayName=Viewport.displayName;const toastVariants=cva("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Toast=reactExports.forwardRef(({className:e,variant:i,...s},a)=>jsxRuntimeExports.jsx(Root2,{ref:a,className:cn(toastVariants({variant:i}),e),...s}));Toast.displayName=Root2.displayName;const ToastAction=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Action$1,{ref:s,className:cn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...i}));ToastAction.displayName=Action$1.displayName;const ToastClose=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Close,{ref:s,className:cn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...i,children:jsxRuntimeExports.jsx(X,{className:"h-4 w-4"})}));ToastClose.displayName=Close.displayName;const ToastTitle=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Title,{ref:s,className:cn("text-sm font-semibold",e),...i}));ToastTitle.displayName=Title.displayName;const ToastDescription=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Description,{ref:s,className:cn("text-sm opacity-90",e),...i}));ToastDescription.displayName=Description.displayName;function Toaster$1(){const{toasts:e}=useToast();return jsxRuntimeExports.jsxs(ToastProvider,{children:[e.map(function({id:i,title:s,description:a,action:c,...d}){return jsxRuntimeExports.jsxs(Toast,{...d,children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-1",children:[s&&jsxRuntimeExports.jsx(ToastTitle,{children:s}),a&&jsxRuntimeExports.jsx(ToastDescription,{children:a})]}),c,jsxRuntimeExports.jsx(ToastClose,{})]},i)}),jsxRuntimeExports.jsx(ToastViewport,{})]})}var P=["light","dark"],E="(prefers-color-scheme: dark)",L=reactExports.createContext(void 0),D={setTheme:e=>{},themes:[]},j=()=>{var e;return(e=reactExports.useContext(L))!=null?e:D};reactExports.memo(({forcedTheme:e,storageKey:i,attribute:s,enableSystem:a,enableColorScheme:c,defaultTheme:d,value:h,attrs:g,nonce:_})=>{let b=d==="system",_e=s==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${g.map(lt=>`'${lt}'`).join(",")})`};`:`var d=document.documentElement,n='${s}',s='setAttribute';`,nt=c?P.includes(d)&&d?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${d}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",it=(lt,rt=!1,at=!0)=>{let ot=h?h[lt]:lt,st=rt?lt+"|| ''":`'${ot}'`,ct="";return c&&at&&!rt&&P.includes(lt)&&(ct+=`d.style.colorScheme = '${lt}';`),s==="class"?rt||ot?ct+=`c.add(${st})`:ct+="null":ot&&(ct+=`d[s](n,${st})`),ct},et=e?`!function(){${_e}${it(e)}}()`:a?`!function(){try{${_e}var e=localStorage.getItem('${i}');if('system'===e||(!e&&${b})){var t='${E}',m=window.matchMedia(t);if(m.media!==t||m.matches){${it("dark")}}else{${it("light")}}}else if(e){${h?`var x=${JSON.stringify(h)};`:""}${it(h?"x[e]":"e",!0)}}${b?"":"else{"+it(d,!1,!1)+"}"}${nt}}catch(e){}}()`:`!function(){try{${_e}var e=localStorage.getItem('${i}');if(e){${h?`var x=${JSON.stringify(h)};`:""}${it(h?"x[e]":"e",!0)}}else{${it(d,!1,!1)};}${nt}}catch(t){}}();`;return reactExports.createElement("script",{nonce:_,dangerouslySetInnerHTML:{__html:et}})});var jt=e=>{switch(e){case"success":return ee;case"info":return ae;case"warning":return oe;case"error":return se;default:return null}},te=Array(12).fill(0),Yt=({visible:e,className:i})=>o.createElement("div",{className:["sonner-loading-wrapper",i].filter(Boolean).join(" "),"data-visible":e},o.createElement("div",{className:"sonner-spinner"},te.map((s,a)=>o.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),ee=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),oe=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),ae=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),se=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ot=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},o.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Ft=()=>{let[e,i]=o.useState(document.hidden);return o.useEffect(()=>{let s=()=>{i(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),e},bt=1,yt=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let i=this.subscribers.indexOf(e);this.subscribers.splice(i,1)}),this.publish=e=>{this.subscribers.forEach(i=>i(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var i;let{message:s,...a}=e,c=typeof(e==null?void 0:e.id)=="number"||((i=e.id)==null?void 0:i.length)>0?e.id:bt++,d=this.toasts.find(g=>g.id===c),h=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(c)&&this.dismissedToasts.delete(c),d?this.toasts=this.toasts.map(g=>g.id===c?(this.publish({...g,...e,id:c,title:s}),{...g,...e,id:c,dismissible:h,title:s}):g):this.addToast({title:s,...a,dismissible:h,id:c}),c},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(i=>{this.subscribers.forEach(s=>s({id:i.id,dismiss:!0}))}),this.subscribers.forEach(i=>i({id:e,dismiss:!0})),e),this.message=(e,i)=>this.create({...i,message:e}),this.error=(e,i)=>this.create({...i,message:e,type:"error"}),this.success=(e,i)=>this.create({...i,type:"success",message:e}),this.info=(e,i)=>this.create({...i,type:"info",message:e}),this.warning=(e,i)=>this.create({...i,type:"warning",message:e}),this.loading=(e,i)=>this.create({...i,type:"loading",message:e}),this.promise=(e,i)=>{if(!i)return;let s;i.loading!==void 0&&(s=this.create({...i,promise:e,type:"loading",message:i.loading,description:typeof i.description!="function"?i.description:void 0}));let a=e instanceof Promise?e:e(),c=s!==void 0,d,h=a.then(async _=>{if(d=["resolve",_],o.isValidElement(_))c=!1,this.create({id:s,type:"default",message:_});else if(ie(_)&&!_.ok){c=!1;let b=typeof i.error=="function"?await i.error(`HTTP error! status: ${_.status}`):i.error,_e=typeof i.description=="function"?await i.description(`HTTP error! status: ${_.status}`):i.description;this.create({id:s,type:"error",message:b,description:_e})}else if(i.success!==void 0){c=!1;let b=typeof i.success=="function"?await i.success(_):i.success,_e=typeof i.description=="function"?await i.description(_):i.description;this.create({id:s,type:"success",message:b,description:_e})}}).catch(async _=>{if(d=["reject",_],i.error!==void 0){c=!1;let b=typeof i.error=="function"?await i.error(_):i.error,_e=typeof i.description=="function"?await i.description(_):i.description;this.create({id:s,type:"error",message:b,description:_e})}}).finally(()=>{var _;c&&(this.dismiss(s),s=void 0),(_=i.finally)==null||_.call(i)}),g=()=>new Promise((_,b)=>h.then(()=>d[0]==="reject"?b(d[1]):_(d[1])).catch(b));return typeof s!="string"&&typeof s!="number"?{unwrap:g}:Object.assign(s,{unwrap:g})},this.custom=(e,i)=>{let s=(i==null?void 0:i.id)||bt++;return this.create({jsx:e(s),id:s,...i}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},v=new yt,ne=(e,i)=>{let s=(i==null?void 0:i.id)||bt++;return v.addToast({title:e,...i,id:s}),s},ie=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",le=ne,ce=()=>v.toasts,de=()=>v.getActiveToasts();Object.assign(le,{success:v.success,info:v.info,warning:v.warning,error:v.error,custom:v.custom,message:v.message,promise:v.promise,dismiss:v.dismiss,loading:v.loading},{getHistory:ce,getToasts:de});function wt(e,{insertAt:i}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}wt(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function tt(e){return e.label!==void 0}var pe=3,me="32px",ge="16px",Wt=4e3,he=356,be=14,ye=20,we=200;function M(...e){return e.filter(Boolean).join(" ")}function xe(e){let[i,s]=e.split("-"),a=[];return i&&a.push(i),s&&a.push(s),a}var ve=e=>{var i,s,a,c,d,h,g,_,b,_e,nt;let{invert:it,toast:et,unstyled:lt,interacting:rt,setHeights:at,visibleToasts:ot,heights:st,index:ct,toasts:mt,expanded:pt,removeToast:Et,defaultRichColors:ut,closeButton:gt,style:xt,cancelButtonStyle:Pt,actionButtonStyle:St,className:Ct="",descriptionClassName:Lt="",duration:er,position:Kt,gap:nr,loadingIcon:Jt,expandByDefault:qt,classNames:kt,icons:Xt,closeButtonAriaLabel:sr="Close toast",pauseWhenPageIsHidden:At}=e,[ht,dt]=o.useState(null),[Tt,Mt]=o.useState(null),[It,Ut]=o.useState(!1),[Zt,rr]=o.useState(!1),[_r,pr]=o.useState(!1),[Ar,Sr]=o.useState(!1),[Fr,ur]=o.useState(!1),[ir,Bt]=o.useState(0),[Qt,fr]=o.useState(0),hr=o.useRef(et.duration||er||Wt),Tr=o.useRef(null),Mr=o.useRef(null),kr=ct===0,dr=ct+1<=ot,Nr=et.type,Dr=et.dismissible!==!1,Jr=et.className||"",Qr=et.descriptionClassName||"",en=o.useMemo(()=>st.findIndex(Ir=>Ir.toastId===et.id)||0,[st,et.id]),Vr=o.useMemo(()=>{var Ir;return(Ir=et.closeButton)!=null?Ir:gt},[et.closeButton,gt]),Kr=o.useMemo(()=>et.duration||er||Wt,[et.duration,er]),tn=o.useRef(0),nn=o.useRef(0),Or=o.useRef(0),mr=o.useRef(null),[vr,Hr]=Kt.split("-"),rn=o.useMemo(()=>st.reduce((Ir,jr,Vt)=>Vt>=en?Ir:Ir+jr.height,0),[st,en]),Zr=Ft(),tr=et.invert||it,Rr=Nr==="loading";nn.current=o.useMemo(()=>en*nr+rn,[en,rn]),o.useEffect(()=>{hr.current=Kr},[Kr]),o.useEffect(()=>{Ut(!0)},[]),o.useEffect(()=>{let Ir=Mr.current;if(Ir){let jr=Ir.getBoundingClientRect().height;return fr(jr),at(Vt=>[{toastId:et.id,height:jr,position:et.position},...Vt]),()=>at(Vt=>Vt.filter($t=>$t.toastId!==et.id))}},[at,et.id]),o.useLayoutEffect(()=>{if(!It)return;let Ir=Mr.current,jr=Ir.style.height;Ir.style.height="auto";let Vt=Ir.getBoundingClientRect().height;Ir.style.height=jr,fr(Vt),at($t=>$t.find(ar=>ar.toastId===et.id)?$t.map(ar=>ar.toastId===et.id?{...ar,height:Vt}:ar):[{toastId:et.id,height:Vt,position:et.position},...$t])},[It,et.title,et.description,at,et.id]);let Br=o.useCallback(()=>{rr(!0),Bt(nn.current),at(Ir=>Ir.filter(jr=>jr.toastId!==et.id)),setTimeout(()=>{Et(et)},we)},[et,Et,at,nn]);o.useEffect(()=>{if(et.promise&&Nr==="loading"||et.duration===1/0||et.type==="loading")return;let Ir;return pt||rt||At&&Zr?(()=>{if(Or.current<tn.current){let jr=new Date().getTime()-tn.current;hr.current=hr.current-jr}Or.current=new Date().getTime()})():hr.current!==1/0&&(tn.current=new Date().getTime(),Ir=setTimeout(()=>{var jr;(jr=et.onAutoClose)==null||jr.call(et,et),Br()},hr.current)),()=>clearTimeout(Ir)},[pt,rt,et,Nr,At,Zr,Br]),o.useEffect(()=>{et.delete&&Br()},[Br,et.delete]);function zr(){var Ir,jr,Vt;return Xt!=null&&Xt.loading?o.createElement("div",{className:M(kt==null?void 0:kt.loader,(Ir=et==null?void 0:et.classNames)==null?void 0:Ir.loader,"sonner-loader"),"data-visible":Nr==="loading"},Xt.loading):Jt?o.createElement("div",{className:M(kt==null?void 0:kt.loader,(jr=et==null?void 0:et.classNames)==null?void 0:jr.loader,"sonner-loader"),"data-visible":Nr==="loading"},Jt):o.createElement(Yt,{className:M(kt==null?void 0:kt.loader,(Vt=et==null?void 0:et.classNames)==null?void 0:Vt.loader),visible:Nr==="loading"})}return o.createElement("li",{tabIndex:0,ref:Mr,className:M(Ct,Jr,kt==null?void 0:kt.toast,(i=et==null?void 0:et.classNames)==null?void 0:i.toast,kt==null?void 0:kt.default,kt==null?void 0:kt[Nr],(s=et==null?void 0:et.classNames)==null?void 0:s[Nr]),"data-sonner-toast":"","data-rich-colors":(a=et.richColors)!=null?a:ut,"data-styled":!(et.jsx||et.unstyled||lt),"data-mounted":It,"data-promise":!!et.promise,"data-swiped":Fr,"data-removed":Zt,"data-visible":dr,"data-y-position":vr,"data-x-position":Hr,"data-index":ct,"data-front":kr,"data-swiping":_r,"data-dismissible":Dr,"data-type":Nr,"data-invert":tr,"data-swipe-out":Ar,"data-swipe-direction":Tt,"data-expanded":!!(pt||qt&&It),style:{"--index":ct,"--toasts-before":ct,"--z-index":mt.length-ct,"--offset":`${Zt?ir:nn.current}px`,"--initial-height":qt?"auto":`${Qt}px`,...xt,...et.style},onDragEnd:()=>{pr(!1),dt(null),mr.current=null},onPointerDown:Ir=>{Rr||!Dr||(Tr.current=new Date,Bt(nn.current),Ir.target.setPointerCapture(Ir.pointerId),Ir.target.tagName!=="BUTTON"&&(pr(!0),mr.current={x:Ir.clientX,y:Ir.clientY}))},onPointerUp:()=>{var Ir,jr,Vt,$t;if(Ar||!Dr)return;mr.current=null;let ar=Number(((Ir=Mr.current)==null?void 0:Ir.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),xr=Number(((jr=Mr.current)==null?void 0:jr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Er=new Date().getTime()-((Vt=Tr.current)==null?void 0:Vt.getTime()),Pr=ht==="x"?ar:xr,Lr=Math.abs(Pr)/Er;if(Math.abs(Pr)>=ye||Lr>.11){Bt(nn.current),($t=et.onDismiss)==null||$t.call(et,et),Mt(ht==="x"?ar>0?"right":"left":xr>0?"down":"up"),Br(),Sr(!0),ur(!1);return}pr(!1),dt(null)},onPointerMove:Ir=>{var jr,Vt,$t,ar;if(!mr.current||!Dr||((jr=window.getSelection())==null?void 0:jr.toString().length)>0)return;let xr=Ir.clientY-mr.current.y,Er=Ir.clientX-mr.current.x,Pr=(Vt=e.swipeDirections)!=null?Vt:xe(Kt);!ht&&(Math.abs(Er)>1||Math.abs(xr)>1)&&dt(Math.abs(Er)>Math.abs(xr)?"x":"y");let Lr={x:0,y:0};ht==="y"?(Pr.includes("top")||Pr.includes("bottom"))&&(Pr.includes("top")&&xr<0||Pr.includes("bottom")&&xr>0)&&(Lr.y=xr):ht==="x"&&(Pr.includes("left")||Pr.includes("right"))&&(Pr.includes("left")&&Er<0||Pr.includes("right")&&Er>0)&&(Lr.x=Er),(Math.abs(Lr.x)>0||Math.abs(Lr.y)>0)&&ur(!0),($t=Mr.current)==null||$t.style.setProperty("--swipe-amount-x",`${Lr.x}px`),(ar=Mr.current)==null||ar.style.setProperty("--swipe-amount-y",`${Lr.y}px`)}},Vr&&!et.jsx?o.createElement("button",{"aria-label":sr,"data-disabled":Rr,"data-close-button":!0,onClick:Rr||!Dr?()=>{}:()=>{var Ir;Br(),(Ir=et.onDismiss)==null||Ir.call(et,et)},className:M(kt==null?void 0:kt.closeButton,(c=et==null?void 0:et.classNames)==null?void 0:c.closeButton)},(d=Xt==null?void 0:Xt.close)!=null?d:Ot):null,et.jsx||reactExports.isValidElement(et.title)?et.jsx?et.jsx:typeof et.title=="function"?et.title():et.title:o.createElement(o.Fragment,null,Nr||et.icon||et.promise?o.createElement("div",{"data-icon":"",className:M(kt==null?void 0:kt.icon,(h=et==null?void 0:et.classNames)==null?void 0:h.icon)},et.promise||et.type==="loading"&&!et.icon?et.icon||zr():null,et.type!=="loading"?et.icon||(Xt==null?void 0:Xt[Nr])||jt(Nr):null):null,o.createElement("div",{"data-content":"",className:M(kt==null?void 0:kt.content,(g=et==null?void 0:et.classNames)==null?void 0:g.content)},o.createElement("div",{"data-title":"",className:M(kt==null?void 0:kt.title,(_=et==null?void 0:et.classNames)==null?void 0:_.title)},typeof et.title=="function"?et.title():et.title),et.description?o.createElement("div",{"data-description":"",className:M(Lt,Qr,kt==null?void 0:kt.description,(b=et==null?void 0:et.classNames)==null?void 0:b.description)},typeof et.description=="function"?et.description():et.description):null),reactExports.isValidElement(et.cancel)?et.cancel:et.cancel&&tt(et.cancel)?o.createElement("button",{"data-button":!0,"data-cancel":!0,style:et.cancelButtonStyle||Pt,onClick:Ir=>{var jr,Vt;tt(et.cancel)&&Dr&&((Vt=(jr=et.cancel).onClick)==null||Vt.call(jr,Ir),Br())},className:M(kt==null?void 0:kt.cancelButton,(_e=et==null?void 0:et.classNames)==null?void 0:_e.cancelButton)},et.cancel.label):null,reactExports.isValidElement(et.action)?et.action:et.action&&tt(et.action)?o.createElement("button",{"data-button":!0,"data-action":!0,style:et.actionButtonStyle||St,onClick:Ir=>{var jr,Vt;tt(et.action)&&((Vt=(jr=et.action).onClick)==null||Vt.call(jr,Ir),!Ir.defaultPrevented&&Br())},className:M(kt==null?void 0:kt.actionButton,(nt=et==null?void 0:et.classNames)==null?void 0:nt.actionButton)},et.action.label):null))};function _t(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Te(e,i){let s={};return[e,i].forEach((a,c)=>{let d=c===1,h=d?"--mobile-offset":"--offset",g=d?ge:me;function _(b){["top","right","bottom","left"].forEach(_e=>{s[`${h}-${_e}`]=typeof b=="number"?`${b}px`:b})}typeof a=="number"||typeof a=="string"?_(a):typeof a=="object"?["top","right","bottom","left"].forEach(b=>{a[b]===void 0?s[`${h}-${b}`]=g:s[`${h}-${b}`]=typeof a[b]=="number"?`${a[b]}px`:a[b]}):_(g)}),s}var $e=reactExports.forwardRef(function(e,i){let{invert:s,position:a="bottom-right",hotkey:c=["altKey","KeyT"],expand:d,closeButton:h,className:g,offset:_,mobileOffset:b,theme:_e="light",richColors:nt,duration:it,style:et,visibleToasts:lt=pe,toastOptions:rt,dir:at=_t(),gap:ot=be,loadingIcon:st,icons:ct,containerAriaLabel:mt="Notifications",pauseWhenPageIsHidden:pt}=e,[Et,ut]=o.useState([]),gt=o.useMemo(()=>Array.from(new Set([a].concat(Et.filter(At=>At.position).map(At=>At.position)))),[Et,a]),[xt,Pt]=o.useState([]),[St,Ct]=o.useState(!1),[Lt,er]=o.useState(!1),[Kt,nr]=o.useState(_e!=="system"?_e:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Jt=o.useRef(null),qt=c.join("+").replace(/Key/g,"").replace(/Digit/g,""),kt=o.useRef(null),Xt=o.useRef(!1),sr=o.useCallback(At=>{ut(ht=>{var dt;return(dt=ht.find(Tt=>Tt.id===At.id))!=null&&dt.delete||v.dismiss(At.id),ht.filter(({id:Tt})=>Tt!==At.id)})},[]);return o.useEffect(()=>v.subscribe(At=>{if(At.dismiss){ut(ht=>ht.map(dt=>dt.id===At.id?{...dt,delete:!0}:dt));return}setTimeout(()=>{vt.flushSync(()=>{ut(ht=>{let dt=ht.findIndex(Tt=>Tt.id===At.id);return dt!==-1?[...ht.slice(0,dt),{...ht[dt],...At},...ht.slice(dt+1)]:[At,...ht]})})})}),[]),o.useEffect(()=>{if(_e!=="system"){nr(_e);return}if(_e==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?nr("dark"):nr("light")),typeof window>"u")return;let At=window.matchMedia("(prefers-color-scheme: dark)");try{At.addEventListener("change",({matches:ht})=>{nr(ht?"dark":"light")})}catch{At.addListener(({matches:dt})=>{try{nr(dt?"dark":"light")}catch(Tt){console.error(Tt)}})}},[_e]),o.useEffect(()=>{Et.length<=1&&Ct(!1)},[Et]),o.useEffect(()=>{let At=ht=>{var dt,Tt;c.every(Mt=>ht[Mt]||ht.code===Mt)&&(Ct(!0),(dt=Jt.current)==null||dt.focus()),ht.code==="Escape"&&(document.activeElement===Jt.current||(Tt=Jt.current)!=null&&Tt.contains(document.activeElement))&&Ct(!1)};return document.addEventListener("keydown",At),()=>document.removeEventListener("keydown",At)},[c]),o.useEffect(()=>{if(Jt.current)return()=>{kt.current&&(kt.current.focus({preventScroll:!0}),kt.current=null,Xt.current=!1)}},[Jt.current]),o.createElement("section",{ref:i,"aria-label":`${mt} ${qt}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},gt.map((At,ht)=>{var dt;let[Tt,Mt]=At.split("-");return Et.length?o.createElement("ol",{key:At,dir:at==="auto"?_t():at,tabIndex:-1,ref:Jt,className:g,"data-sonner-toaster":!0,"data-theme":Kt,"data-y-position":Tt,"data-lifted":St&&Et.length>1&&!d,"data-x-position":Mt,style:{"--front-toast-height":`${((dt=xt[0])==null?void 0:dt.height)||0}px`,"--width":`${he}px`,"--gap":`${ot}px`,...et,...Te(_,b)},onBlur:It=>{Xt.current&&!It.currentTarget.contains(It.relatedTarget)&&(Xt.current=!1,kt.current&&(kt.current.focus({preventScroll:!0}),kt.current=null))},onFocus:It=>{It.target instanceof HTMLElement&&It.target.dataset.dismissible==="false"||Xt.current||(Xt.current=!0,kt.current=It.relatedTarget)},onMouseEnter:()=>Ct(!0),onMouseMove:()=>Ct(!0),onMouseLeave:()=>{Lt||Ct(!1)},onDragEnd:()=>Ct(!1),onPointerDown:It=>{It.target instanceof HTMLElement&&It.target.dataset.dismissible==="false"||er(!0)},onPointerUp:()=>er(!1)},Et.filter(It=>!It.position&&ht===0||It.position===At).map((It,Ut)=>{var Zt,rr;return o.createElement(ve,{key:It.id,icons:ct,index:Ut,toast:It,defaultRichColors:nt,duration:(Zt=rt==null?void 0:rt.duration)!=null?Zt:it,className:rt==null?void 0:rt.className,descriptionClassName:rt==null?void 0:rt.descriptionClassName,invert:s,visibleToasts:lt,closeButton:(rr=rt==null?void 0:rt.closeButton)!=null?rr:h,interacting:Lt,position:At,style:rt==null?void 0:rt.style,unstyled:rt==null?void 0:rt.unstyled,classNames:rt==null?void 0:rt.classNames,cancelButtonStyle:rt==null?void 0:rt.cancelButtonStyle,actionButtonStyle:rt==null?void 0:rt.actionButtonStyle,removeToast:sr,toasts:Et.filter(_r=>_r.position==It.position),heights:xt.filter(_r=>_r.position==It.position),setHeights:Pt,expandByDefault:d,gap:ot,loadingIcon:st,expanded:St,pauseWhenPageIsHidden:pt,swipeDirections:e.swipeDirections})})):null}))});const Toaster=({...e})=>{const{theme:i="system"}=j();return jsxRuntimeExports.jsx($e,{theme:i,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=e=>({x:e,y:e}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp(e,i,s){return max(e,min(i,s))}function evaluate(e,i){return typeof e=="function"?e(i):e}function getSide(e){return e.split("-")[0]}function getAlignment(e){return e.split("-")[1]}function getOppositeAxis(e){return e==="x"?"y":"x"}function getAxisLength(e){return e==="y"?"height":"width"}const yAxisSides=new Set(["top","bottom"]);function getSideAxis(e){return yAxisSides.has(getSide(e))?"y":"x"}function getAlignmentAxis(e){return getOppositeAxis(getSideAxis(e))}function getAlignmentSides(e,i,s){s===void 0&&(s=!1);const a=getAlignment(e),c=getAlignmentAxis(e),d=getAxisLength(c);let h=c==="x"?a===(s?"end":"start")?"right":"left":a==="start"?"bottom":"top";return i.reference[d]>i.floating[d]&&(h=getOppositePlacement(h)),[h,getOppositePlacement(h)]}function getExpandedPlacements(e){const i=getOppositePlacement(e);return[getOppositeAlignmentPlacement(e),i,getOppositeAlignmentPlacement(i)]}function getOppositeAlignmentPlacement(e){return e.replace(/start|end/g,i=>oppositeAlignmentMap[i])}const lrPlacement=["left","right"],rlPlacement=["right","left"],tbPlacement=["top","bottom"],btPlacement=["bottom","top"];function getSideList(e,i,s){switch(e){case"top":case"bottom":return s?i?rlPlacement:lrPlacement:i?lrPlacement:rlPlacement;case"left":case"right":return i?tbPlacement:btPlacement;default:return[]}}function getOppositeAxisPlacements(e,i,s,a){const c=getAlignment(e);let d=getSideList(getSide(e),s==="start",a);return c&&(d=d.map(h=>h+"-"+c),i&&(d=d.concat(d.map(getOppositeAlignmentPlacement)))),d}function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,i=>oppositeSideMap[i])}function expandPaddingObject(e){return{top:0,right:0,bottom:0,left:0,...e}}function getPaddingObject(e){return typeof e!="number"?expandPaddingObject(e):{top:e,right:e,bottom:e,left:e}}function rectToClientRect(e){const{x:i,y:s,width:a,height:c}=e;return{width:a,height:c,top:s,left:i,right:i+a,bottom:s+c,x:i,y:s}}function computeCoordsFromPlacement(e,i,s){let{reference:a,floating:c}=e;const d=getSideAxis(i),h=getAlignmentAxis(i),g=getAxisLength(h),_=getSide(i),b=d==="y",_e=a.x+a.width/2-c.width/2,nt=a.y+a.height/2-c.height/2,it=a[g]/2-c[g]/2;let et;switch(_){case"top":et={x:_e,y:a.y-c.height};break;case"bottom":et={x:_e,y:a.y+a.height};break;case"right":et={x:a.x+a.width,y:nt};break;case"left":et={x:a.x-c.width,y:nt};break;default:et={x:a.x,y:a.y}}switch(getAlignment(i)){case"start":et[h]-=it*(s&&b?-1:1);break;case"end":et[h]+=it*(s&&b?-1:1);break}return et}const computePosition$1=async(e,i,s)=>{const{placement:a="bottom",strategy:c="absolute",middleware:d=[],platform:h}=s,g=d.filter(Boolean),_=await(h.isRTL==null?void 0:h.isRTL(i));let b=await h.getElementRects({reference:e,floating:i,strategy:c}),{x:_e,y:nt}=computeCoordsFromPlacement(b,a,_),it=a,et={},lt=0;for(let rt=0;rt<g.length;rt++){const{name:at,fn:ot}=g[rt],{x:st,y:ct,data:mt,reset:pt}=await ot({x:_e,y:nt,initialPlacement:a,placement:it,strategy:c,middlewareData:et,rects:b,platform:h,elements:{reference:e,floating:i}});_e=st??_e,nt=ct??nt,et={...et,[at]:{...et[at],...mt}},pt&&lt<=50&&(lt++,typeof pt=="object"&&(pt.placement&&(it=pt.placement),pt.rects&&(b=pt.rects===!0?await h.getElementRects({reference:e,floating:i,strategy:c}):pt.rects),{x:_e,y:nt}=computeCoordsFromPlacement(b,it,_)),rt=-1)}return{x:_e,y:nt,placement:it,strategy:c,middlewareData:et}};async function detectOverflow(e,i){var s;i===void 0&&(i={});const{x:a,y:c,platform:d,rects:h,elements:g,strategy:_}=e,{boundary:b="clippingAncestors",rootBoundary:_e="viewport",elementContext:nt="floating",altBoundary:it=!1,padding:et=0}=evaluate(i,e),lt=getPaddingObject(et),at=g[it?nt==="floating"?"reference":"floating":nt],ot=rectToClientRect(await d.getClippingRect({element:(s=await(d.isElement==null?void 0:d.isElement(at)))==null||s?at:at.contextElement||await(d.getDocumentElement==null?void 0:d.getDocumentElement(g.floating)),boundary:b,rootBoundary:_e,strategy:_})),st=nt==="floating"?{x:a,y:c,width:h.floating.width,height:h.floating.height}:h.reference,ct=await(d.getOffsetParent==null?void 0:d.getOffsetParent(g.floating)),mt=await(d.isElement==null?void 0:d.isElement(ct))?await(d.getScale==null?void 0:d.getScale(ct))||{x:1,y:1}:{x:1,y:1},pt=rectToClientRect(d.convertOffsetParentRelativeRectToViewportRelativeRect?await d.convertOffsetParentRelativeRectToViewportRelativeRect({elements:g,rect:st,offsetParent:ct,strategy:_}):st);return{top:(ot.top-pt.top+lt.top)/mt.y,bottom:(pt.bottom-ot.bottom+lt.bottom)/mt.y,left:(ot.left-pt.left+lt.left)/mt.x,right:(pt.right-ot.right+lt.right)/mt.x}}const arrow$3=e=>({name:"arrow",options:e,async fn(i){const{x:s,y:a,placement:c,rects:d,platform:h,elements:g,middlewareData:_}=i,{element:b,padding:_e=0}=evaluate(e,i)||{};if(b==null)return{};const nt=getPaddingObject(_e),it={x:s,y:a},et=getAlignmentAxis(c),lt=getAxisLength(et),rt=await h.getDimensions(b),at=et==="y",ot=at?"top":"left",st=at?"bottom":"right",ct=at?"clientHeight":"clientWidth",mt=d.reference[lt]+d.reference[et]-it[et]-d.floating[lt],pt=it[et]-d.reference[et],Et=await(h.getOffsetParent==null?void 0:h.getOffsetParent(b));let ut=Et?Et[ct]:0;(!ut||!await(h.isElement==null?void 0:h.isElement(Et)))&&(ut=g.floating[ct]||d.floating[lt]);const gt=mt/2-pt/2,xt=ut/2-rt[lt]/2-1,Pt=min(nt[ot],xt),St=min(nt[st],xt),Ct=Pt,Lt=ut-rt[lt]-St,er=ut/2-rt[lt]/2+gt,Kt=clamp(Ct,er,Lt),nr=!_.arrow&&getAlignment(c)!=null&&er!==Kt&&d.reference[lt]/2-(er<Ct?Pt:St)-rt[lt]/2<0,Jt=nr?er<Ct?er-Ct:er-Lt:0;return{[et]:it[et]+Jt,data:{[et]:Kt,centerOffset:er-Kt-Jt,...nr&&{alignmentOffset:Jt}},reset:nr}}}),flip$2=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(i){var s,a;const{placement:c,middlewareData:d,rects:h,initialPlacement:g,platform:_,elements:b}=i,{mainAxis:_e=!0,crossAxis:nt=!0,fallbackPlacements:it,fallbackStrategy:et="bestFit",fallbackAxisSideDirection:lt="none",flipAlignment:rt=!0,...at}=evaluate(e,i);if((s=d.arrow)!=null&&s.alignmentOffset)return{};const ot=getSide(c),st=getSideAxis(g),ct=getSide(g)===g,mt=await(_.isRTL==null?void 0:_.isRTL(b.floating)),pt=it||(ct||!rt?[getOppositePlacement(g)]:getExpandedPlacements(g)),Et=lt!=="none";!it&&Et&&pt.push(...getOppositeAxisPlacements(g,rt,lt,mt));const ut=[g,...pt],gt=await detectOverflow(i,at),xt=[];let Pt=((a=d.flip)==null?void 0:a.overflows)||[];if(_e&&xt.push(gt[ot]),nt){const er=getAlignmentSides(c,h,mt);xt.push(gt[er[0]],gt[er[1]])}if(Pt=[...Pt,{placement:c,overflows:xt}],!xt.every(er=>er<=0)){var St,Ct;const er=(((St=d.flip)==null?void 0:St.index)||0)+1,Kt=ut[er];if(Kt&&(!(nt==="alignment"?st!==getSideAxis(Kt):!1)||Pt.every(qt=>qt.overflows[0]>0&&getSideAxis(qt.placement)===st)))return{data:{index:er,overflows:Pt},reset:{placement:Kt}};let nr=(Ct=Pt.filter(Jt=>Jt.overflows[0]<=0).sort((Jt,qt)=>Jt.overflows[1]-qt.overflows[1])[0])==null?void 0:Ct.placement;if(!nr)switch(et){case"bestFit":{var Lt;const Jt=(Lt=Pt.filter(qt=>{if(Et){const kt=getSideAxis(qt.placement);return kt===st||kt==="y"}return!0}).map(qt=>[qt.placement,qt.overflows.filter(kt=>kt>0).reduce((kt,Xt)=>kt+Xt,0)]).sort((qt,kt)=>qt[1]-kt[1])[0])==null?void 0:Lt[0];Jt&&(nr=Jt);break}case"initialPlacement":nr=g;break}if(c!==nr)return{reset:{placement:nr}}}return{}}}};function getSideOffsets(e,i){return{top:e.top-i.height,right:e.right-i.width,bottom:e.bottom-i.height,left:e.left-i.width}}function isAnySideFullyClipped(e){return sides.some(i=>e[i]>=0)}const hide$2=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(i){const{rects:s}=i,{strategy:a="referenceHidden",...c}=evaluate(e,i);switch(a){case"referenceHidden":{const d=await detectOverflow(i,{...c,elementContext:"reference"}),h=getSideOffsets(d,s.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:isAnySideFullyClipped(h)}}}case"escaped":{const d=await detectOverflow(i,{...c,altBoundary:!0}),h=getSideOffsets(d,s.floating);return{data:{escapedOffsets:h,escaped:isAnySideFullyClipped(h)}}}default:return{}}}}},originSides=new Set(["left","top"]);async function convertValueToCoords(e,i){const{placement:s,platform:a,elements:c}=e,d=await(a.isRTL==null?void 0:a.isRTL(c.floating)),h=getSide(s),g=getAlignment(s),_=getSideAxis(s)==="y",b=originSides.has(h)?-1:1,_e=d&&_?-1:1,nt=evaluate(i,e);let{mainAxis:it,crossAxis:et,alignmentAxis:lt}=typeof nt=="number"?{mainAxis:nt,crossAxis:0,alignmentAxis:null}:{mainAxis:nt.mainAxis||0,crossAxis:nt.crossAxis||0,alignmentAxis:nt.alignmentAxis};return g&&typeof lt=="number"&&(et=g==="end"?lt*-1:lt),_?{x:et*_e,y:it*b}:{x:it*b,y:et*_e}}const offset$2=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(i){var s,a;const{x:c,y:d,placement:h,middlewareData:g}=i,_=await convertValueToCoords(i,e);return h===((s=g.offset)==null?void 0:s.placement)&&(a=g.arrow)!=null&&a.alignmentOffset?{}:{x:c+_.x,y:d+_.y,data:{..._,placement:h}}}}},shift$2=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(i){const{x:s,y:a,placement:c}=i,{mainAxis:d=!0,crossAxis:h=!1,limiter:g={fn:at=>{let{x:ot,y:st}=at;return{x:ot,y:st}}},..._}=evaluate(e,i),b={x:s,y:a},_e=await detectOverflow(i,_),nt=getSideAxis(getSide(c)),it=getOppositeAxis(nt);let et=b[it],lt=b[nt];if(d){const at=it==="y"?"top":"left",ot=it==="y"?"bottom":"right",st=et+_e[at],ct=et-_e[ot];et=clamp(st,et,ct)}if(h){const at=nt==="y"?"top":"left",ot=nt==="y"?"bottom":"right",st=lt+_e[at],ct=lt-_e[ot];lt=clamp(st,lt,ct)}const rt=g.fn({...i,[it]:et,[nt]:lt});return{...rt,data:{x:rt.x-s,y:rt.y-a,enabled:{[it]:d,[nt]:h}}}}}},limitShift$2=function(e){return e===void 0&&(e={}),{options:e,fn(i){const{x:s,y:a,placement:c,rects:d,middlewareData:h}=i,{offset:g=0,mainAxis:_=!0,crossAxis:b=!0}=evaluate(e,i),_e={x:s,y:a},nt=getSideAxis(c),it=getOppositeAxis(nt);let et=_e[it],lt=_e[nt];const rt=evaluate(g,i),at=typeof rt=="number"?{mainAxis:rt,crossAxis:0}:{mainAxis:0,crossAxis:0,...rt};if(_){const ct=it==="y"?"height":"width",mt=d.reference[it]-d.floating[ct]+at.mainAxis,pt=d.reference[it]+d.reference[ct]-at.mainAxis;et<mt?et=mt:et>pt&&(et=pt)}if(b){var ot,st;const ct=it==="y"?"width":"height",mt=originSides.has(getSide(c)),pt=d.reference[nt]-d.floating[ct]+(mt&&((ot=h.offset)==null?void 0:ot[nt])||0)+(mt?0:at.crossAxis),Et=d.reference[nt]+d.reference[ct]+(mt?0:((st=h.offset)==null?void 0:st[nt])||0)-(mt?at.crossAxis:0);lt<pt?lt=pt:lt>Et&&(lt=Et)}return{[it]:et,[nt]:lt}}}},size$2=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(i){var s,a;const{placement:c,rects:d,platform:h,elements:g}=i,{apply:_=()=>{},...b}=evaluate(e,i),_e=await detectOverflow(i,b),nt=getSide(c),it=getAlignment(c),et=getSideAxis(c)==="y",{width:lt,height:rt}=d.floating;let at,ot;nt==="top"||nt==="bottom"?(at=nt,ot=it===(await(h.isRTL==null?void 0:h.isRTL(g.floating))?"start":"end")?"left":"right"):(ot=nt,at=it==="end"?"top":"bottom");const st=rt-_e.top-_e.bottom,ct=lt-_e.left-_e.right,mt=min(rt-_e[at],st),pt=min(lt-_e[ot],ct),Et=!i.middlewareData.shift;let ut=mt,gt=pt;if((s=i.middlewareData.shift)!=null&&s.enabled.x&&(gt=ct),(a=i.middlewareData.shift)!=null&&a.enabled.y&&(ut=st),Et&&!it){const Pt=max(_e.left,0),St=max(_e.right,0),Ct=max(_e.top,0),Lt=max(_e.bottom,0);et?gt=lt-2*(Pt!==0||St!==0?Pt+St:max(_e.left,_e.right)):ut=rt-2*(Ct!==0||Lt!==0?Ct+Lt:max(_e.top,_e.bottom))}await _({...i,availableWidth:gt,availableHeight:ut});const xt=await h.getDimensions(g.floating);return lt!==xt.width||rt!==xt.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(e){return isNode(e)?(e.nodeName||"").toLowerCase():"#document"}function getWindow(e){var i;return(e==null||(i=e.ownerDocument)==null?void 0:i.defaultView)||window}function getDocumentElement(e){var i;return(i=(isNode(e)?e.ownerDocument:e.document)||window.document)==null?void 0:i.documentElement}function isNode(e){return hasWindow()?e instanceof Node||e instanceof getWindow(e).Node:!1}function isElement(e){return hasWindow()?e instanceof Element||e instanceof getWindow(e).Element:!1}function isHTMLElement(e){return hasWindow()?e instanceof HTMLElement||e instanceof getWindow(e).HTMLElement:!1}function isShadowRoot(e){return!hasWindow()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof getWindow(e).ShadowRoot}const invalidOverflowDisplayValues=new Set(["inline","contents"]);function isOverflowElement(e){const{overflow:i,overflowX:s,overflowY:a,display:c}=getComputedStyle$1(e);return/auto|scroll|overlay|hidden|clip/.test(i+a+s)&&!invalidOverflowDisplayValues.has(c)}const tableElements=new Set(["table","td","th"]);function isTableElement(e){return tableElements.has(getNodeName(e))}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(e){return topLayerSelectors.some(i=>{try{return e.matches(i)}catch{return!1}})}const transformProperties=["transform","translate","scale","rotate","perspective"],willChangeValues=["transform","translate","scale","rotate","perspective","filter"],containValues=["paint","layout","strict","content"];function isContainingBlock(e){const i=isWebKit(),s=isElement(e)?getComputedStyle$1(e):e;return transformProperties.some(a=>s[a]?s[a]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!i&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!i&&(s.filter?s.filter!=="none":!1)||willChangeValues.some(a=>(s.willChange||"").includes(a))||containValues.some(a=>(s.contain||"").includes(a))}function getContainingBlock(e){let i=getParentNode(e);for(;isHTMLElement(i)&&!isLastTraversableNode(i);){if(isContainingBlock(i))return i;if(isTopLayer(i))return null;i=getParentNode(i)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lastTraversableNodeNames=new Set(["html","body","#document"]);function isLastTraversableNode(e){return lastTraversableNodeNames.has(getNodeName(e))}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function getNodeScroll(e){return isElement(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function getParentNode(e){if(getNodeName(e)==="html")return e;const i=e.assignedSlot||e.parentNode||isShadowRoot(e)&&e.host||getDocumentElement(e);return isShadowRoot(i)?i.host:i}function getNearestOverflowAncestor(e){const i=getParentNode(e);return isLastTraversableNode(i)?e.ownerDocument?e.ownerDocument.body:e.body:isHTMLElement(i)&&isOverflowElement(i)?i:getNearestOverflowAncestor(i)}function getOverflowAncestors(e,i,s){var a;i===void 0&&(i=[]),s===void 0&&(s=!0);const c=getNearestOverflowAncestor(e),d=c===((a=e.ownerDocument)==null?void 0:a.body),h=getWindow(c);if(d){const g=getFrameElement(h);return i.concat(h,h.visualViewport||[],isOverflowElement(c)?c:[],g&&s?getOverflowAncestors(g):[])}return i.concat(c,getOverflowAncestors(c,[],s))}function getFrameElement(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function getCssDimensions(e){const i=getComputedStyle$1(e);let s=parseFloat(i.width)||0,a=parseFloat(i.height)||0;const c=isHTMLElement(e),d=c?e.offsetWidth:s,h=c?e.offsetHeight:a,g=round(s)!==d||round(a)!==h;return g&&(s=d,a=h),{width:s,height:a,$:g}}function unwrapElement(e){return isElement(e)?e:e.contextElement}function getScale(e){const i=unwrapElement(e);if(!isHTMLElement(i))return createCoords(1);const s=i.getBoundingClientRect(),{width:a,height:c,$:d}=getCssDimensions(i);let h=(d?round(s.width):s.width)/a,g=(d?round(s.height):s.height)/c;return(!h||!Number.isFinite(h))&&(h=1),(!g||!Number.isFinite(g))&&(g=1),{x:h,y:g}}const noOffsets=createCoords(0);function getVisualOffsets(e){const i=getWindow(e);return!isWebKit()||!i.visualViewport?noOffsets:{x:i.visualViewport.offsetLeft,y:i.visualViewport.offsetTop}}function shouldAddVisualOffsets(e,i,s){return i===void 0&&(i=!1),!s||i&&s!==getWindow(e)?!1:i}function getBoundingClientRect(e,i,s,a){i===void 0&&(i=!1),s===void 0&&(s=!1);const c=e.getBoundingClientRect(),d=unwrapElement(e);let h=createCoords(1);i&&(a?isElement(a)&&(h=getScale(a)):h=getScale(e));const g=shouldAddVisualOffsets(d,s,a)?getVisualOffsets(d):createCoords(0);let _=(c.left+g.x)/h.x,b=(c.top+g.y)/h.y,_e=c.width/h.x,nt=c.height/h.y;if(d){const it=getWindow(d),et=a&&isElement(a)?getWindow(a):a;let lt=it,rt=getFrameElement(lt);for(;rt&&a&&et!==lt;){const at=getScale(rt),ot=rt.getBoundingClientRect(),st=getComputedStyle$1(rt),ct=ot.left+(rt.clientLeft+parseFloat(st.paddingLeft))*at.x,mt=ot.top+(rt.clientTop+parseFloat(st.paddingTop))*at.y;_*=at.x,b*=at.y,_e*=at.x,nt*=at.y,_+=ct,b+=mt,lt=getWindow(rt),rt=getFrameElement(lt)}}return rectToClientRect({width:_e,height:nt,x:_,y:b})}function getWindowScrollBarX(e,i){const s=getNodeScroll(e).scrollLeft;return i?i.left+s:getBoundingClientRect(getDocumentElement(e)).left+s}function getHTMLOffset(e,i,s){s===void 0&&(s=!1);const a=e.getBoundingClientRect(),c=a.left+i.scrollLeft-(s?0:getWindowScrollBarX(e,a)),d=a.top+i.scrollTop;return{x:c,y:d}}function convertOffsetParentRelativeRectToViewportRelativeRect(e){let{elements:i,rect:s,offsetParent:a,strategy:c}=e;const d=c==="fixed",h=getDocumentElement(a),g=i?isTopLayer(i.floating):!1;if(a===h||g&&d)return s;let _={scrollLeft:0,scrollTop:0},b=createCoords(1);const _e=createCoords(0),nt=isHTMLElement(a);if((nt||!nt&&!d)&&((getNodeName(a)!=="body"||isOverflowElement(h))&&(_=getNodeScroll(a)),isHTMLElement(a))){const et=getBoundingClientRect(a);b=getScale(a),_e.x=et.x+a.clientLeft,_e.y=et.y+a.clientTop}const it=h&&!nt&&!d?getHTMLOffset(h,_,!0):createCoords(0);return{width:s.width*b.x,height:s.height*b.y,x:s.x*b.x-_.scrollLeft*b.x+_e.x+it.x,y:s.y*b.y-_.scrollTop*b.y+_e.y+it.y}}function getClientRects(e){return Array.from(e.getClientRects())}function getDocumentRect(e){const i=getDocumentElement(e),s=getNodeScroll(e),a=e.ownerDocument.body,c=max(i.scrollWidth,i.clientWidth,a.scrollWidth,a.clientWidth),d=max(i.scrollHeight,i.clientHeight,a.scrollHeight,a.clientHeight);let h=-s.scrollLeft+getWindowScrollBarX(e);const g=-s.scrollTop;return getComputedStyle$1(a).direction==="rtl"&&(h+=max(i.clientWidth,a.clientWidth)-c),{width:c,height:d,x:h,y:g}}function getViewportRect(e,i){const s=getWindow(e),a=getDocumentElement(e),c=s.visualViewport;let d=a.clientWidth,h=a.clientHeight,g=0,_=0;if(c){d=c.width,h=c.height;const b=isWebKit();(!b||b&&i==="fixed")&&(g=c.offsetLeft,_=c.offsetTop)}return{width:d,height:h,x:g,y:_}}const absoluteOrFixed=new Set(["absolute","fixed"]);function getInnerBoundingClientRect(e,i){const s=getBoundingClientRect(e,!0,i==="fixed"),a=s.top+e.clientTop,c=s.left+e.clientLeft,d=isHTMLElement(e)?getScale(e):createCoords(1),h=e.clientWidth*d.x,g=e.clientHeight*d.y,_=c*d.x,b=a*d.y;return{width:h,height:g,x:_,y:b}}function getClientRectFromClippingAncestor(e,i,s){let a;if(i==="viewport")a=getViewportRect(e,s);else if(i==="document")a=getDocumentRect(getDocumentElement(e));else if(isElement(i))a=getInnerBoundingClientRect(i,s);else{const c=getVisualOffsets(e);a={x:i.x-c.x,y:i.y-c.y,width:i.width,height:i.height}}return rectToClientRect(a)}function hasFixedPositionAncestor(e,i){const s=getParentNode(e);return s===i||!isElement(s)||isLastTraversableNode(s)?!1:getComputedStyle$1(s).position==="fixed"||hasFixedPositionAncestor(s,i)}function getClippingElementAncestors(e,i){const s=i.get(e);if(s)return s;let a=getOverflowAncestors(e,[],!1).filter(g=>isElement(g)&&getNodeName(g)!=="body"),c=null;const d=getComputedStyle$1(e).position==="fixed";let h=d?getParentNode(e):e;for(;isElement(h)&&!isLastTraversableNode(h);){const g=getComputedStyle$1(h),_=isContainingBlock(h);!_&&g.position==="fixed"&&(c=null),(d?!_&&!c:!_&&g.position==="static"&&!!c&&absoluteOrFixed.has(c.position)||isOverflowElement(h)&&!_&&hasFixedPositionAncestor(e,h))?a=a.filter(_e=>_e!==h):c=g,h=getParentNode(h)}return i.set(e,a),a}function getClippingRect(e){let{element:i,boundary:s,rootBoundary:a,strategy:c}=e;const h=[...s==="clippingAncestors"?isTopLayer(i)?[]:getClippingElementAncestors(i,this._c):[].concat(s),a],g=h[0],_=h.reduce((b,_e)=>{const nt=getClientRectFromClippingAncestor(i,_e,c);return b.top=max(nt.top,b.top),b.right=min(nt.right,b.right),b.bottom=min(nt.bottom,b.bottom),b.left=max(nt.left,b.left),b},getClientRectFromClippingAncestor(i,g,c));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function getDimensions(e){const{width:i,height:s}=getCssDimensions(e);return{width:i,height:s}}function getRectRelativeToOffsetParent(e,i,s){const a=isHTMLElement(i),c=getDocumentElement(i),d=s==="fixed",h=getBoundingClientRect(e,!0,d,i);let g={scrollLeft:0,scrollTop:0};const _=createCoords(0);function b(){_.x=getWindowScrollBarX(c)}if(a||!a&&!d)if((getNodeName(i)!=="body"||isOverflowElement(c))&&(g=getNodeScroll(i)),a){const et=getBoundingClientRect(i,!0,d,i);_.x=et.x+i.clientLeft,_.y=et.y+i.clientTop}else c&&b();d&&!a&&c&&b();const _e=c&&!a&&!d?getHTMLOffset(c,g):createCoords(0),nt=h.left+g.scrollLeft-_.x-_e.x,it=h.top+g.scrollTop-_.y-_e.y;return{x:nt,y:it,width:h.width,height:h.height}}function isStaticPositioned(e){return getComputedStyle$1(e).position==="static"}function getTrueOffsetParent(e,i){if(!isHTMLElement(e)||getComputedStyle$1(e).position==="fixed")return null;if(i)return i(e);let s=e.offsetParent;return getDocumentElement(e)===s&&(s=s.ownerDocument.body),s}function getOffsetParent(e,i){const s=getWindow(e);if(isTopLayer(e))return s;if(!isHTMLElement(e)){let c=getParentNode(e);for(;c&&!isLastTraversableNode(c);){if(isElement(c)&&!isStaticPositioned(c))return c;c=getParentNode(c)}return s}let a=getTrueOffsetParent(e,i);for(;a&&isTableElement(a)&&isStaticPositioned(a);)a=getTrueOffsetParent(a,i);return a&&isLastTraversableNode(a)&&isStaticPositioned(a)&&!isContainingBlock(a)?s:a||getContainingBlock(e)||s}const getElementRects=async function(e){const i=this.getOffsetParent||getOffsetParent,s=this.getDimensions,a=await s(e.floating);return{reference:getRectRelativeToOffsetParent(e.reference,await i(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function isRTL(e){return getComputedStyle$1(e).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function rectsAreEqual(e,i){return e.x===i.x&&e.y===i.y&&e.width===i.width&&e.height===i.height}function observeMove(e,i){let s=null,a;const c=getDocumentElement(e);function d(){var g;clearTimeout(a),(g=s)==null||g.disconnect(),s=null}function h(g,_){g===void 0&&(g=!1),_===void 0&&(_=1),d();const b=e.getBoundingClientRect(),{left:_e,top:nt,width:it,height:et}=b;if(g||i(),!it||!et)return;const lt=floor(nt),rt=floor(c.clientWidth-(_e+it)),at=floor(c.clientHeight-(nt+et)),ot=floor(_e),ct={rootMargin:-lt+"px "+-rt+"px "+-at+"px "+-ot+"px",threshold:max(0,min(1,_))||1};let mt=!0;function pt(Et){const ut=Et[0].intersectionRatio;if(ut!==_){if(!mt)return h();ut?h(!1,ut):a=setTimeout(()=>{h(!1,1e-7)},1e3)}ut===1&&!rectsAreEqual(b,e.getBoundingClientRect())&&h(),mt=!1}try{s=new IntersectionObserver(pt,{...ct,root:c.ownerDocument})}catch{s=new IntersectionObserver(pt,ct)}s.observe(e)}return h(!0),d}function autoUpdate(e,i,s,a){a===void 0&&(a={});const{ancestorScroll:c=!0,ancestorResize:d=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:g=typeof IntersectionObserver=="function",animationFrame:_=!1}=a,b=unwrapElement(e),_e=c||d?[...b?getOverflowAncestors(b):[],...getOverflowAncestors(i)]:[];_e.forEach(ot=>{c&&ot.addEventListener("scroll",s,{passive:!0}),d&&ot.addEventListener("resize",s)});const nt=b&&g?observeMove(b,s):null;let it=-1,et=null;h&&(et=new ResizeObserver(ot=>{let[st]=ot;st&&st.target===b&&et&&(et.unobserve(i),cancelAnimationFrame(it),it=requestAnimationFrame(()=>{var ct;(ct=et)==null||ct.observe(i)})),s()}),b&&!_&&et.observe(b),et.observe(i));let lt,rt=_?getBoundingClientRect(e):null;_&&at();function at(){const ot=getBoundingClientRect(e);rt&&!rectsAreEqual(rt,ot)&&s(),rt=ot,lt=requestAnimationFrame(at)}return s(),()=>{var ot;_e.forEach(st=>{c&&st.removeEventListener("scroll",s),d&&st.removeEventListener("resize",s)}),nt==null||nt(),(ot=et)==null||ot.disconnect(),et=null,_&&cancelAnimationFrame(lt)}}const offset$1=offset$2,shift$1=shift$2,flip$1=flip$2,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(e,i,s)=>{const a=new Map,c={platform,...s},d={...c.platform,_c:a};return computePosition$1(e,i,{...c,platform:d})};var isClient=typeof document<"u",noop$1=function(){},index=isClient?reactExports.useLayoutEffect:noop$1;function deepEqual(e,i){if(e===i)return!0;if(typeof e!=typeof i)return!1;if(typeof e=="function"&&e.toString()===i.toString())return!0;let s,a,c;if(e&&i&&typeof e=="object"){if(Array.isArray(e)){if(s=e.length,s!==i.length)return!1;for(a=s;a--!==0;)if(!deepEqual(e[a],i[a]))return!1;return!0}if(c=Object.keys(e),s=c.length,s!==Object.keys(i).length)return!1;for(a=s;a--!==0;)if(!{}.hasOwnProperty.call(i,c[a]))return!1;for(a=s;a--!==0;){const d=c[a];if(!(d==="_owner"&&e.$$typeof)&&!deepEqual(e[d],i[d]))return!1}return!0}return e!==e&&i!==i}function getDPR(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(e,i){const s=getDPR(e);return Math.round(i*s)/s}function useLatestRef(e){const i=reactExports.useRef(e);return index(()=>{i.current=e}),i}function useFloating(e){e===void 0&&(e={});const{placement:i="bottom",strategy:s="absolute",middleware:a=[],platform:c,elements:{reference:d,floating:h}={},transform:g=!0,whileElementsMounted:_,open:b}=e,[_e,nt]=reactExports.useState({x:0,y:0,strategy:s,placement:i,middlewareData:{},isPositioned:!1}),[it,et]=reactExports.useState(a);deepEqual(it,a)||et(a);const[lt,rt]=reactExports.useState(null),[at,ot]=reactExports.useState(null),st=reactExports.useCallback(qt=>{qt!==Et.current&&(Et.current=qt,rt(qt))},[]),ct=reactExports.useCallback(qt=>{qt!==ut.current&&(ut.current=qt,ot(qt))},[]),mt=d||lt,pt=h||at,Et=reactExports.useRef(null),ut=reactExports.useRef(null),gt=reactExports.useRef(_e),xt=_!=null,Pt=useLatestRef(_),St=useLatestRef(c),Ct=useLatestRef(b),Lt=reactExports.useCallback(()=>{if(!Et.current||!ut.current)return;const qt={placement:i,strategy:s,middleware:it};St.current&&(qt.platform=St.current),computePosition(Et.current,ut.current,qt).then(kt=>{const Xt={...kt,isPositioned:Ct.current!==!1};er.current&&!deepEqual(gt.current,Xt)&&(gt.current=Xt,reactDomExports.flushSync(()=>{nt(Xt)}))})},[it,i,s,St,Ct]);index(()=>{b===!1&&gt.current.isPositioned&&(gt.current.isPositioned=!1,nt(qt=>({...qt,isPositioned:!1})))},[b]);const er=reactExports.useRef(!1);index(()=>(er.current=!0,()=>{er.current=!1}),[]),index(()=>{if(mt&&(Et.current=mt),pt&&(ut.current=pt),mt&&pt){if(Pt.current)return Pt.current(mt,pt,Lt);Lt()}},[mt,pt,Lt,Pt,xt]);const Kt=reactExports.useMemo(()=>({reference:Et,floating:ut,setReference:st,setFloating:ct}),[st,ct]),nr=reactExports.useMemo(()=>({reference:mt,floating:pt}),[mt,pt]),Jt=reactExports.useMemo(()=>{const qt={position:s,left:0,top:0};if(!nr.floating)return qt;const kt=roundByDPR(nr.floating,_e.x),Xt=roundByDPR(nr.floating,_e.y);return g?{...qt,transform:"translate("+kt+"px, "+Xt+"px)",...getDPR(nr.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:kt,top:Xt}},[s,g,nr.floating,_e.x,_e.y]);return reactExports.useMemo(()=>({..._e,update:Lt,refs:Kt,elements:nr,floatingStyles:Jt}),[_e,Lt,Kt,nr,Jt])}const arrow$1=e=>{function i(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:e,fn(s){const{element:a,padding:c}=typeof e=="function"?e(s):e;return a&&i(a)?a.current!=null?arrow$2({element:a.current,padding:c}).fn(s):{}:a?arrow$2({element:a,padding:c}).fn(s):{}}}},offset=(e,i)=>({...offset$1(e),options:[e,i]}),shift=(e,i)=>({...shift$1(e),options:[e,i]}),limitShift=(e,i)=>({...limitShift$1(e),options:[e,i]}),flip=(e,i)=>({...flip$1(e),options:[e,i]}),size=(e,i)=>({...size$1(e),options:[e,i]}),hide=(e,i)=>({...hide$1(e),options:[e,i]}),arrow=(e,i)=>({...arrow$1(e),options:[e,i]});var NAME="Arrow",Arrow$1=reactExports.forwardRef((e,i)=>{const{children:s,width:a=10,height:c=5,...d}=e;return jsxRuntimeExports.jsx(Primitive.svg,{...d,ref:i,width:a,height:c,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?s:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME;var Root=Arrow$1;function useSize(e){const[i,s]=reactExports.useState(void 0);return useLayoutEffect2(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});const a=new ResizeObserver(c=>{if(!Array.isArray(c)||!c.length)return;const d=c[0];let h,g;if("borderBoxSize"in d){const _=d.borderBoxSize,b=Array.isArray(_)?_[0]:_;h=b.inlineSize,g=b.blockSize}else h=e.offsetWidth,g=e.offsetHeight;s({width:h,height:g})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}else s(void 0)},[e]),i}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),ANCHOR_NAME="PopperAnchor",PopperAnchor=reactExports.forwardRef((e,i)=>{const{__scopePopper:s,virtualRef:a,...c}=e,d=usePopperContext(ANCHOR_NAME,s),h=reactExports.useRef(null),g=useComposedRefs(i,h);return reactExports.useEffect(()=>{d.onAnchorChange((a==null?void 0:a.current)||h.current)}),a?null:jsxRuntimeExports.jsx(Primitive.div,{...c,ref:g})});PopperAnchor.displayName=ANCHOR_NAME;var CONTENT_NAME$1="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$1),PopperContent=reactExports.forwardRef((e,i)=>{var It,Ut,Zt,rr,_r,pr;const{__scopePopper:s,side:a="bottom",sideOffset:c=0,align:d="center",alignOffset:h=0,arrowPadding:g=0,avoidCollisions:_=!0,collisionBoundary:b=[],collisionPadding:_e=0,sticky:nt="partial",hideWhenDetached:it=!1,updatePositionStrategy:et="optimized",onPlaced:lt,...rt}=e,at=usePopperContext(CONTENT_NAME$1,s),[ot,st]=reactExports.useState(null),ct=useComposedRefs(i,Ar=>st(Ar)),[mt,pt]=reactExports.useState(null),Et=useSize(mt),ut=(Et==null?void 0:Et.width)??0,gt=(Et==null?void 0:Et.height)??0,xt=a+(d!=="center"?"-"+d:""),Pt=typeof _e=="number"?_e:{top:0,right:0,bottom:0,left:0,..._e},St=Array.isArray(b)?b:[b],Ct=St.length>0,Lt={padding:Pt,boundary:St.filter(isNotNull),altBoundary:Ct},{refs:er,floatingStyles:Kt,placement:nr,isPositioned:Jt,middlewareData:qt}=useFloating({strategy:"fixed",placement:xt,whileElementsMounted:(...Ar)=>autoUpdate(...Ar,{animationFrame:et==="always"}),elements:{reference:at.anchor},middleware:[offset({mainAxis:c+gt,alignmentAxis:h}),_&&shift({mainAxis:!0,crossAxis:!1,limiter:nt==="partial"?limitShift():void 0,...Lt}),_&&flip({...Lt}),size({...Lt,apply:({elements:Ar,rects:Sr,availableWidth:Fr,availableHeight:ur})=>{const{width:ir,height:Bt}=Sr.reference,Qt=Ar.floating.style;Qt.setProperty("--radix-popper-available-width",`${Fr}px`),Qt.setProperty("--radix-popper-available-height",`${ur}px`),Qt.setProperty("--radix-popper-anchor-width",`${ir}px`),Qt.setProperty("--radix-popper-anchor-height",`${Bt}px`)}}),mt&&arrow({element:mt,padding:g}),transformOrigin({arrowWidth:ut,arrowHeight:gt}),it&&hide({strategy:"referenceHidden",...Lt})]}),[kt,Xt]=getSideAndAlignFromPlacement(nr),sr=useCallbackRef(lt);useLayoutEffect2(()=>{Jt&&(sr==null||sr())},[Jt,sr]);const At=(It=qt.arrow)==null?void 0:It.x,ht=(Ut=qt.arrow)==null?void 0:Ut.y,dt=((Zt=qt.arrow)==null?void 0:Zt.centerOffset)!==0,[Tt,Mt]=reactExports.useState();return useLayoutEffect2(()=>{ot&&Mt(window.getComputedStyle(ot).zIndex)},[ot]),jsxRuntimeExports.jsx("div",{ref:er.setFloating,"data-radix-popper-content-wrapper":"",style:{...Kt,transform:Jt?Kt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Tt,"--radix-popper-transform-origin":[(rr=qt.transformOrigin)==null?void 0:rr.x,(_r=qt.transformOrigin)==null?void 0:_r.y].join(" "),...((pr=qt.hide)==null?void 0:pr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:s,placedSide:kt,onArrowChange:pt,arrowX:At,arrowY:ht,shouldHideArrow:dt,children:jsxRuntimeExports.jsx(Primitive.div,{"data-side":kt,"data-align":Xt,...rt,ref:ct,style:{...rt.style,animation:Jt?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$1;var ARROW_NAME$1="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function(i,s){const{__scopePopper:a,...c}=i,d=useContentContext(ARROW_NAME$1,a),h=OPPOSITE_SIDE[d.placedSide];return jsxRuntimeExports.jsx("span",{ref:d.onArrowChange,style:{position:"absolute",left:d.arrowX,top:d.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[d.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[d.placedSide],visibility:d.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root,{...c,ref:s,style:{...c.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$1;function isNotNull(e){return e!==null}var transformOrigin=e=>({name:"transformOrigin",options:e,fn(i){var at,ot,st;const{placement:s,rects:a,middlewareData:c}=i,h=((at=c.arrow)==null?void 0:at.centerOffset)!==0,g=h?0:e.arrowWidth,_=h?0:e.arrowHeight,[b,_e]=getSideAndAlignFromPlacement(s),nt={start:"0%",center:"50%",end:"100%"}[_e],it=(((ot=c.arrow)==null?void 0:ot.x)??0)+g/2,et=(((st=c.arrow)==null?void 0:st.y)??0)+_/2;let lt="",rt="";return b==="bottom"?(lt=h?nt:`${it}px`,rt=`${-_}px`):b==="top"?(lt=h?nt:`${it}px`,rt=`${a.floating.height+_}px`):b==="right"?(lt=`${-_}px`,rt=h?nt:`${et}px`):b==="left"&&(lt=`${a.floating.width+_}px`,rt=h?nt:`${et}px`),{data:{x:lt,y:rt}}}});function getSideAndAlignFromPlacement(e){const[i,s="center"]=e.split("-");return[i,s]}var Anchor=PopperAnchor,Content=PopperContent,Arrow=PopperArrow,[createTooltipContext,createTooltipScope]=createContextScope("Tooltip",[createPopperScope]),usePopperScope=createPopperScope(),PROVIDER_NAME="TooltipProvider",DEFAULT_DELAY_DURATION=700,TOOLTIP_OPEN="tooltip.open",[TooltipProviderContextProvider,useTooltipProviderContext]=createTooltipContext(PROVIDER_NAME),TooltipProvider$1=e=>{const{__scopeTooltip:i,delayDuration:s=DEFAULT_DELAY_DURATION,skipDelayDuration:a=300,disableHoverableContent:c=!1,children:d}=e,h=reactExports.useRef(!0),g=reactExports.useRef(!1),_=reactExports.useRef(0);return reactExports.useEffect(()=>{const b=_.current;return()=>window.clearTimeout(b)},[]),jsxRuntimeExports.jsx(TooltipProviderContextProvider,{scope:i,isOpenDelayedRef:h,delayDuration:s,onOpen:reactExports.useCallback(()=>{window.clearTimeout(_.current),h.current=!1},[]),onClose:reactExports.useCallback(()=>{window.clearTimeout(_.current),_.current=window.setTimeout(()=>h.current=!0,a)},[a]),isPointerInTransitRef:g,onPointerInTransitChange:reactExports.useCallback(b=>{g.current=b},[]),disableHoverableContent:c,children:d})};TooltipProvider$1.displayName=PROVIDER_NAME;var TOOLTIP_NAME="Tooltip",[TooltipContextProvider,useTooltipContext]=createTooltipContext(TOOLTIP_NAME),TRIGGER_NAME="TooltipTrigger",TooltipTrigger=reactExports.forwardRef((e,i)=>{const{__scopeTooltip:s,...a}=e,c=useTooltipContext(TRIGGER_NAME,s),d=useTooltipProviderContext(TRIGGER_NAME,s),h=usePopperScope(s),g=reactExports.useRef(null),_=useComposedRefs(i,g,c.onTriggerChange),b=reactExports.useRef(!1),_e=reactExports.useRef(!1),nt=reactExports.useCallback(()=>b.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",nt),[nt]),jsxRuntimeExports.jsx(Anchor,{asChild:!0,...h,children:jsxRuntimeExports.jsx(Primitive.button,{"aria-describedby":c.open?c.contentId:void 0,"data-state":c.stateAttribute,...a,ref:_,onPointerMove:composeEventHandlers(e.onPointerMove,it=>{it.pointerType!=="touch"&&!_e.current&&!d.isPointerInTransitRef.current&&(c.onTriggerEnter(),_e.current=!0)}),onPointerLeave:composeEventHandlers(e.onPointerLeave,()=>{c.onTriggerLeave(),_e.current=!1}),onPointerDown:composeEventHandlers(e.onPointerDown,()=>{c.open&&c.onClose(),b.current=!0,document.addEventListener("pointerup",nt,{once:!0})}),onFocus:composeEventHandlers(e.onFocus,()=>{b.current||c.onOpen()}),onBlur:composeEventHandlers(e.onBlur,c.onClose),onClick:composeEventHandlers(e.onClick,c.onClose)})})});TooltipTrigger.displayName=TRIGGER_NAME;var PORTAL_NAME="TooltipPortal",[PortalProvider,usePortalContext]=createTooltipContext(PORTAL_NAME,{forceMount:void 0}),CONTENT_NAME="TooltipContent",TooltipContent$1=reactExports.forwardRef((e,i)=>{const s=usePortalContext(CONTENT_NAME,e.__scopeTooltip),{forceMount:a=s.forceMount,side:c="top",...d}=e,h=useTooltipContext(CONTENT_NAME,e.__scopeTooltip);return jsxRuntimeExports.jsx(Presence,{present:a||h.open,children:h.disableHoverableContent?jsxRuntimeExports.jsx(TooltipContentImpl,{side:c,...d,ref:i}):jsxRuntimeExports.jsx(TooltipContentHoverable,{side:c,...d,ref:i})})}),TooltipContentHoverable=reactExports.forwardRef((e,i)=>{const s=useTooltipContext(CONTENT_NAME,e.__scopeTooltip),a=useTooltipProviderContext(CONTENT_NAME,e.__scopeTooltip),c=reactExports.useRef(null),d=useComposedRefs(i,c),[h,g]=reactExports.useState(null),{trigger:_,onClose:b}=s,_e=c.current,{onPointerInTransitChange:nt}=a,it=reactExports.useCallback(()=>{g(null),nt(!1)},[nt]),et=reactExports.useCallback((lt,rt)=>{const at=lt.currentTarget,ot={x:lt.clientX,y:lt.clientY},st=getExitSideFromRect(ot,at.getBoundingClientRect()),ct=getPaddedExitPoints(ot,st),mt=getPointsFromRect(rt.getBoundingClientRect()),pt=getHull([...ct,...mt]);g(pt),nt(!0)},[nt]);return reactExports.useEffect(()=>()=>it(),[it]),reactExports.useEffect(()=>{if(_&&_e){const lt=at=>et(at,_e),rt=at=>et(at,_);return _.addEventListener("pointerleave",lt),_e.addEventListener("pointerleave",rt),()=>{_.removeEventListener("pointerleave",lt),_e.removeEventListener("pointerleave",rt)}}},[_,_e,et,it]),reactExports.useEffect(()=>{if(h){const lt=rt=>{const at=rt.target,ot={x:rt.clientX,y:rt.clientY},st=(_==null?void 0:_.contains(at))||(_e==null?void 0:_e.contains(at)),ct=!isPointInPolygon(ot,h);st?it():ct&&(it(),b())};return document.addEventListener("pointermove",lt),()=>document.removeEventListener("pointermove",lt)}},[_,_e,h,b,it]),jsxRuntimeExports.jsx(TooltipContentImpl,{...e,ref:d})}),[VisuallyHiddenContentContextProvider,useVisuallyHiddenContentContext]=createTooltipContext(TOOLTIP_NAME,{isInside:!1}),Slottable=createSlottable("TooltipContent"),TooltipContentImpl=reactExports.forwardRef((e,i)=>{const{__scopeTooltip:s,children:a,"aria-label":c,onEscapeKeyDown:d,onPointerDownOutside:h,...g}=e,_=useTooltipContext(CONTENT_NAME,s),b=usePopperScope(s),{onClose:_e}=_;return reactExports.useEffect(()=>(document.addEventListener(TOOLTIP_OPEN,_e),()=>document.removeEventListener(TOOLTIP_OPEN,_e)),[_e]),reactExports.useEffect(()=>{if(_.trigger){const nt=it=>{const et=it.target;et!=null&&et.contains(_.trigger)&&_e()};return window.addEventListener("scroll",nt,{capture:!0}),()=>window.removeEventListener("scroll",nt,{capture:!0})}},[_.trigger,_e]),jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:d,onPointerDownOutside:h,onFocusOutside:nt=>nt.preventDefault(),onDismiss:_e,children:jsxRuntimeExports.jsxs(Content,{"data-state":_.stateAttribute,...b,...g,ref:i,style:{...g.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[jsxRuntimeExports.jsx(Slottable,{children:a}),jsxRuntimeExports.jsx(VisuallyHiddenContentContextProvider,{scope:s,isInside:!0,children:jsxRuntimeExports.jsx(Root$1,{id:_.contentId,role:"tooltip",children:c||a})})]})})});TooltipContent$1.displayName=CONTENT_NAME;var ARROW_NAME="TooltipArrow",TooltipArrow=reactExports.forwardRef((e,i)=>{const{__scopeTooltip:s,...a}=e,c=usePopperScope(s);return useVisuallyHiddenContentContext(ARROW_NAME,s).isInside?null:jsxRuntimeExports.jsx(Arrow,{...c,...a,ref:i})});TooltipArrow.displayName=ARROW_NAME;function getExitSideFromRect(e,i){const s=Math.abs(i.top-e.y),a=Math.abs(i.bottom-e.y),c=Math.abs(i.right-e.x),d=Math.abs(i.left-e.x);switch(Math.min(s,a,c,d)){case d:return"left";case c:return"right";case s:return"top";case a:return"bottom";default:throw new Error("unreachable")}}function getPaddedExitPoints(e,i,s=5){const a=[];switch(i){case"top":a.push({x:e.x-s,y:e.y+s},{x:e.x+s,y:e.y+s});break;case"bottom":a.push({x:e.x-s,y:e.y-s},{x:e.x+s,y:e.y-s});break;case"left":a.push({x:e.x+s,y:e.y-s},{x:e.x+s,y:e.y+s});break;case"right":a.push({x:e.x-s,y:e.y-s},{x:e.x-s,y:e.y+s});break}return a}function getPointsFromRect(e){const{top:i,right:s,bottom:a,left:c}=e;return[{x:c,y:i},{x:s,y:i},{x:s,y:a},{x:c,y:a}]}function isPointInPolygon(e,i){const{x:s,y:a}=e;let c=!1;for(let d=0,h=i.length-1;d<i.length;h=d++){const g=i[d],_=i[h],b=g.x,_e=g.y,nt=_.x,it=_.y;_e>a!=it>a&&s<(nt-b)*(a-_e)/(it-_e)+b&&(c=!c)}return c}function getHull(e){const i=e.slice();return i.sort((s,a)=>s.x<a.x?-1:s.x>a.x?1:s.y<a.y?-1:s.y>a.y?1:0),getHullPresorted(i)}function getHullPresorted(e){if(e.length<=1)return e.slice();const i=[];for(let a=0;a<e.length;a++){const c=e[a];for(;i.length>=2;){const d=i[i.length-1],h=i[i.length-2];if((d.x-h.x)*(c.y-h.y)>=(d.y-h.y)*(c.x-h.x))i.pop();else break}i.push(c)}i.pop();const s=[];for(let a=e.length-1;a>=0;a--){const c=e[a];for(;s.length>=2;){const d=s[s.length-1],h=s[s.length-2];if((d.x-h.x)*(c.y-h.y)>=(d.y-h.y)*(c.x-h.x))s.pop();else break}s.push(c)}return s.pop(),i.length===1&&s.length===1&&i[0].x===s[0].x&&i[0].y===s[0].y?i:i.concat(s)}var Provider=TooltipProvider$1,Content2=TooltipContent$1;const TooltipProvider=Provider,TooltipContent=reactExports.forwardRef(({className:e,sideOffset:i=4,...s},a)=>jsxRuntimeExports.jsx(Content2,{ref:a,sideOffset:i,className:cn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));TooltipContent.displayName=Content2.displayName;var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},isServer=typeof window>"u"||"Deno"in globalThis;function noop(){}function functionalUpdate(e,i){return typeof e=="function"?e(i):e}function isValidTimeout(e){return typeof e=="number"&&e>=0&&e!==1/0}function timeUntilStale(e,i){return Math.max(e+(i||0)-Date.now(),0)}function resolveStaleTime(e,i){return typeof e=="function"?e(i):e}function resolveEnabled(e,i){return typeof e=="function"?e(i):e}function matchQuery(e,i){const{type:s="all",exact:a,fetchStatus:c,predicate:d,queryKey:h,stale:g}=e;if(h){if(a){if(i.queryHash!==hashQueryKeyByOptions(h,i.options))return!1}else if(!partialMatchKey(i.queryKey,h))return!1}if(s!=="all"){const _=i.isActive();if(s==="active"&&!_||s==="inactive"&&_)return!1}return!(typeof g=="boolean"&&i.isStale()!==g||c&&c!==i.state.fetchStatus||d&&!d(i))}function matchMutation(e,i){const{exact:s,status:a,predicate:c,mutationKey:d}=e;if(d){if(!i.options.mutationKey)return!1;if(s){if(hashKey(i.options.mutationKey)!==hashKey(d))return!1}else if(!partialMatchKey(i.options.mutationKey,d))return!1}return!(a&&i.state.status!==a||c&&!c(i))}function hashQueryKeyByOptions(e,i){return((i==null?void 0:i.queryKeyHashFn)||hashKey)(e)}function hashKey(e){return JSON.stringify(e,(i,s)=>isPlainObject(s)?Object.keys(s).sort().reduce((a,c)=>(a[c]=s[c],a),{}):s)}function partialMatchKey(e,i){return e===i?!0:typeof e!=typeof i?!1:e&&i&&typeof e=="object"&&typeof i=="object"?Object.keys(i).every(s=>partialMatchKey(e[s],i[s])):!1}function replaceEqualDeep(e,i){if(e===i)return e;const s=isPlainArray(e)&&isPlainArray(i);if(s||isPlainObject(e)&&isPlainObject(i)){const a=s?e:Object.keys(e),c=a.length,d=s?i:Object.keys(i),h=d.length,g=s?[]:{},_=new Set(a);let b=0;for(let _e=0;_e<h;_e++){const nt=s?_e:d[_e];(!s&&_.has(nt)||s)&&e[nt]===void 0&&i[nt]===void 0?(g[nt]=void 0,b++):(g[nt]=replaceEqualDeep(e[nt],i[nt]),g[nt]===e[nt]&&e[nt]!==void 0&&b++)}return c===h&&b===c?e:g}return i}function isPlainArray(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function isPlainObject(e){if(!hasObjectPrototype(e))return!1;const i=e.constructor;if(i===void 0)return!0;const s=i.prototype;return!(!hasObjectPrototype(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function hasObjectPrototype(e){return Object.prototype.toString.call(e)==="[object Object]"}function sleep(e){return new Promise(i=>{setTimeout(i,e)})}function replaceData(e,i,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,i):s.structuralSharing!==!1?replaceEqualDeep(e,i):i}function addToEnd(e,i,s=0){const a=[...e,i];return s&&a.length>s?a.slice(1):a}function addToStart(e,i,s=0){const a=[i,...e];return s&&a.length>s?a.slice(0,-1):a}var skipToken=Symbol();function ensureQueryFn(e,i){return!e.queryFn&&(i!=null&&i.initialPromise)?()=>i.initialPromise:!e.queryFn||e.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Ln,Cn,zn,to,FocusManager=(to=class extends Subscribable{constructor(){super();cr(this,Ln);cr(this,Cn);cr(this,zn);lr(this,zn,i=>{if(!isServer&&window.addEventListener){const s=()=>i();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){ft(this,Cn)||this.setEventListener(ft(this,zn))}onUnsubscribe(){var i;this.hasListeners()||((i=ft(this,Cn))==null||i.call(this),lr(this,Cn,void 0))}setEventListener(i){var s;lr(this,zn,i),(s=ft(this,Cn))==null||s.call(this),lr(this,Cn,i(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(i){ft(this,Ln)!==i&&(lr(this,Ln,i),this.onFocus())}onFocus(){const i=this.isFocused();this.listeners.forEach(s=>{s(i)})}isFocused(){var i;return typeof ft(this,Ln)=="boolean"?ft(this,Ln):((i=globalThis.document)==null?void 0:i.visibilityState)!=="hidden"}},Ln=new WeakMap,Cn=new WeakMap,zn=new WeakMap,to),focusManager=new FocusManager,Xn,Rn,Gn,ro,OnlineManager=(ro=class extends Subscribable{constructor(){super();cr(this,Xn,!0);cr(this,Rn);cr(this,Gn);lr(this,Gn,i=>{if(!isServer&&window.addEventListener){const s=()=>i(!0),a=()=>i(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}}})}onSubscribe(){ft(this,Rn)||this.setEventListener(ft(this,Gn))}onUnsubscribe(){var i;this.hasListeners()||((i=ft(this,Rn))==null||i.call(this),lr(this,Rn,void 0))}setEventListener(i){var s;lr(this,Gn,i),(s=ft(this,Rn))==null||s.call(this),lr(this,Rn,i(this.setOnline.bind(this)))}setOnline(i){ft(this,Xn)!==i&&(lr(this,Xn,i),this.listeners.forEach(a=>{a(i)}))}isOnline(){return ft(this,Xn)}},Xn=new WeakMap,Rn=new WeakMap,Gn=new WeakMap,ro),onlineManager=new OnlineManager;function pendingThenable(){let e,i;const s=new Promise((c,d)=>{e=c,i=d});s.status="pending",s.catch(()=>{});function a(c){Object.assign(s,c),delete s.resolve,delete s.reject}return s.resolve=c=>{a({status:"fulfilled",value:c}),e(c)},s.reject=c=>{a({status:"rejected",reason:c}),i(c)},s}function defaultRetryDelay(e){return Math.min(1e3*2**e,3e4)}function canFetch(e){return(e??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function isCancelledError(e){return e instanceof CancelledError}function createRetryer(e){let i=!1,s=0,a=!1,c;const d=pendingThenable(),h=rt=>{var at;a||(it(new CancelledError(rt)),(at=e.abort)==null||at.call(e))},g=()=>{i=!0},_=()=>{i=!1},b=()=>focusManager.isFocused()&&(e.networkMode==="always"||onlineManager.isOnline())&&e.canRun(),_e=()=>canFetch(e.networkMode)&&e.canRun(),nt=rt=>{var at;a||(a=!0,(at=e.onSuccess)==null||at.call(e,rt),c==null||c(),d.resolve(rt))},it=rt=>{var at;a||(a=!0,(at=e.onError)==null||at.call(e,rt),c==null||c(),d.reject(rt))},et=()=>new Promise(rt=>{var at;c=ot=>{(a||b())&&rt(ot)},(at=e.onPause)==null||at.call(e)}).then(()=>{var rt;c=void 0,a||(rt=e.onContinue)==null||rt.call(e)}),lt=()=>{if(a)return;let rt;const at=s===0?e.initialPromise:void 0;try{rt=at??e.fn()}catch(ot){rt=Promise.reject(ot)}Promise.resolve(rt).then(nt).catch(ot=>{var Et;if(a)return;const st=e.retry??(isServer?0:3),ct=e.retryDelay??defaultRetryDelay,mt=typeof ct=="function"?ct(s,ot):ct,pt=st===!0||typeof st=="number"&&s<st||typeof st=="function"&&st(s,ot);if(i||!pt){it(ot);return}s++,(Et=e.onFail)==null||Et.call(e,s,ot),sleep(mt).then(()=>b()?void 0:et()).then(()=>{i?it(ot):lt()})})};return{promise:d,cancel:h,continue:()=>(c==null||c(),d),cancelRetry:g,continueRetry:_,canStart:_e,start:()=>(_e()?lt():et().then(lt),d)}}var defaultScheduler=e=>setTimeout(e,0);function createNotifyManager(){let e=[],i=0,s=g=>{g()},a=g=>{g()},c=defaultScheduler;const d=g=>{i?e.push(g):c(()=>{s(g)})},h=()=>{const g=e;e=[],g.length&&c(()=>{a(()=>{g.forEach(_=>{s(_)})})})};return{batch:g=>{let _;i++;try{_=g()}finally{i--,i||h()}return _},batchCalls:g=>(..._)=>{d(()=>{g(..._)})},schedule:d,setNotifyFunction:g=>{s=g},setBatchNotifyFunction:g=>{a=g},setScheduler:g=>{c=g}}}var notifyManager=createNotifyManager(),Dn,no,Removable=(no=class{constructor(){cr(this,Dn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&lr(this,Dn,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(isServer?1/0:5*60*1e3))}clearGcTimeout(){ft(this,Dn)&&(clearTimeout(ft(this,Dn)),lr(this,Dn,void 0))}},Dn=new WeakMap,no),Kn,In,mn,Nn,dn,ls,Bn,gn,En,io,Query=(io=class extends Removable{constructor(i){super();cr(this,gn);cr(this,Kn);cr(this,In);cr(this,mn);cr(this,Nn);cr(this,dn);cr(this,ls);cr(this,Bn);lr(this,Bn,!1),lr(this,ls,i.defaultOptions),this.setOptions(i.options),this.observers=[],lr(this,Nn,i.client),lr(this,mn,ft(this,Nn).getQueryCache()),this.queryKey=i.queryKey,this.queryHash=i.queryHash,lr(this,Kn,getDefaultState$1(this.options)),this.state=i.state??ft(this,Kn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var i;return(i=ft(this,dn))==null?void 0:i.promise}setOptions(i){this.options={...ft(this,ls),...i},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ft(this,mn).remove(this)}setData(i,s){const a=replaceData(this.state.data,i,this.options);return or(this,gn,En).call(this,{data:a,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),a}setState(i,s){or(this,gn,En).call(this,{type:"setState",state:i,setStateOptions:s})}cancel(i){var a,c;const s=(a=ft(this,dn))==null?void 0:a.promise;return(c=ft(this,dn))==null||c.cancel(i),s?s.then(noop).catch(noop):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ft(this,Kn))}isActive(){return this.observers.some(i=>resolveEnabled(i.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(i=>resolveStaleTime(i.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(i=>i.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(i=0){return this.state.data===void 0?!0:i==="static"?!1:this.state.isInvalidated?!0:!timeUntilStale(this.state.dataUpdatedAt,i)}onFocus(){var s;const i=this.observers.find(a=>a.shouldFetchOnWindowFocus());i==null||i.refetch({cancelRefetch:!1}),(s=ft(this,dn))==null||s.continue()}onOnline(){var s;const i=this.observers.find(a=>a.shouldFetchOnReconnect());i==null||i.refetch({cancelRefetch:!1}),(s=ft(this,dn))==null||s.continue()}addObserver(i){this.observers.includes(i)||(this.observers.push(i),this.clearGcTimeout(),ft(this,mn).notify({type:"observerAdded",query:this,observer:i}))}removeObserver(i){this.observers.includes(i)&&(this.observers=this.observers.filter(s=>s!==i),this.observers.length||(ft(this,dn)&&(ft(this,Bn)?ft(this,dn).cancel({revert:!0}):ft(this,dn).cancelRetry()),this.scheduleGc()),ft(this,mn).notify({type:"observerRemoved",query:this,observer:i}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||or(this,gn,En).call(this,{type:"invalidate"})}fetch(i,s){var b,_e,nt;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(ft(this,dn))return ft(this,dn).continueRetry(),ft(this,dn).promise}if(i&&this.setOptions(i),!this.options.queryFn){const it=this.observers.find(et=>et.options.queryFn);it&&this.setOptions(it.options)}const a=new AbortController,c=it=>{Object.defineProperty(it,"signal",{enumerable:!0,get:()=>(lr(this,Bn,!0),a.signal)})},d=()=>{const it=ensureQueryFn(this.options,s),lt=(()=>{const rt={client:ft(this,Nn),queryKey:this.queryKey,meta:this.meta};return c(rt),rt})();return lr(this,Bn,!1),this.options.persister?this.options.persister(it,lt,this):it(lt)},g=(()=>{const it={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:ft(this,Nn),state:this.state,fetchFn:d};return c(it),it})();(b=this.options.behavior)==null||b.onFetch(g,this),lr(this,In,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((_e=g.fetchOptions)==null?void 0:_e.meta))&&or(this,gn,En).call(this,{type:"fetch",meta:(nt=g.fetchOptions)==null?void 0:nt.meta});const _=it=>{var et,lt,rt,at;isCancelledError(it)&&it.silent||or(this,gn,En).call(this,{type:"error",error:it}),isCancelledError(it)||((lt=(et=ft(this,mn).config).onError)==null||lt.call(et,it,this),(at=(rt=ft(this,mn).config).onSettled)==null||at.call(rt,this.state.data,it,this)),this.scheduleGc()};return lr(this,dn,createRetryer({initialPromise:s==null?void 0:s.initialPromise,fn:g.fetchFn,abort:a.abort.bind(a),onSuccess:it=>{var et,lt,rt,at;if(it===void 0){_(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(it)}catch(ot){_(ot);return}(lt=(et=ft(this,mn).config).onSuccess)==null||lt.call(et,it,this),(at=(rt=ft(this,mn).config).onSettled)==null||at.call(rt,it,this.state.error,this),this.scheduleGc()},onError:_,onFail:(it,et)=>{or(this,gn,En).call(this,{type:"failed",failureCount:it,error:et})},onPause:()=>{or(this,gn,En).call(this,{type:"pause"})},onContinue:()=>{or(this,gn,En).call(this,{type:"continue"})},retry:g.options.retry,retryDelay:g.options.retryDelay,networkMode:g.options.networkMode,canRun:()=>!0})),ft(this,dn).start()}},Kn=new WeakMap,In=new WeakMap,mn=new WeakMap,Nn=new WeakMap,dn=new WeakMap,ls=new WeakMap,Bn=new WeakMap,gn=new WeakSet,En=function(i){const s=a=>{switch(i.type){case"failed":return{...a,fetchFailureCount:i.failureCount,fetchFailureReason:i.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...fetchState(a.data,this.options),fetchMeta:i.meta??null};case"success":return lr(this,In,void 0),{...a,data:i.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:i.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!i.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const c=i.error;return isCancelledError(c)&&c.revert&&ft(this,In)?{...ft(this,In),fetchStatus:"idle"}:{...a,error:c,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:c,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...i.state}}};this.state=s(this.state),notifyManager.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),ft(this,mn).notify({query:this,type:"updated",action:i})})},io);function fetchState(e,i){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(i.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function getDefaultState$1(e){const i=typeof e.initialData=="function"?e.initialData():e.initialData,s=i!==void 0,a=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:i,dataUpdateCount:0,dataUpdatedAt:s?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var vn,so,QueryCache=(so=class extends Subscribable{constructor(i={}){super();cr(this,vn);this.config=i,lr(this,vn,new Map)}build(i,s,a){const c=s.queryKey,d=s.queryHash??hashQueryKeyByOptions(c,s);let h=this.get(d);return h||(h=new Query({client:i,queryKey:c,queryHash:d,options:i.defaultQueryOptions(s),state:a,defaultOptions:i.getQueryDefaults(c)}),this.add(h)),h}add(i){ft(this,vn).has(i.queryHash)||(ft(this,vn).set(i.queryHash,i),this.notify({type:"added",query:i}))}remove(i){const s=ft(this,vn).get(i.queryHash);s&&(i.destroy(),s===i&&ft(this,vn).delete(i.queryHash),this.notify({type:"removed",query:i}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(i=>{this.remove(i)})})}get(i){return ft(this,vn).get(i)}getAll(){return[...ft(this,vn).values()]}find(i){const s={exact:!0,...i};return this.getAll().find(a=>matchQuery(s,a))}findAll(i={}){const s=this.getAll();return Object.keys(i).length>0?s.filter(a=>matchQuery(i,a)):s}notify(i){notifyManager.batch(()=>{this.listeners.forEach(s=>{s(i)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(i=>{i.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(i=>{i.onOnline()})})}},vn=new WeakMap,so),xn,hn,jn,wn,bn,ao,Mutation=(ao=class extends Removable{constructor(i){super();cr(this,wn);cr(this,xn);cr(this,hn);cr(this,jn);this.mutationId=i.mutationId,lr(this,hn,i.mutationCache),lr(this,xn,[]),this.state=i.state||getDefaultState(),this.setOptions(i.options),this.scheduleGc()}setOptions(i){this.options=i,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(i){ft(this,xn).includes(i)||(ft(this,xn).push(i),this.clearGcTimeout(),ft(this,hn).notify({type:"observerAdded",mutation:this,observer:i}))}removeObserver(i){lr(this,xn,ft(this,xn).filter(s=>s!==i)),this.scheduleGc(),ft(this,hn).notify({type:"observerRemoved",mutation:this,observer:i})}optionalRemove(){ft(this,xn).length||(this.state.status==="pending"?this.scheduleGc():ft(this,hn).remove(this))}continue(){var i;return((i=ft(this,jn))==null?void 0:i.continue())??this.execute(this.state.variables)}async execute(i){var d,h,g,_,b,_e,nt,it,et,lt,rt,at,ot,st,ct,mt,pt,Et,ut,gt;const s=()=>{or(this,wn,bn).call(this,{type:"continue"})};lr(this,jn,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(i):Promise.reject(new Error("No mutationFn found")),onFail:(xt,Pt)=>{or(this,wn,bn).call(this,{type:"failed",failureCount:xt,error:Pt})},onPause:()=>{or(this,wn,bn).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ft(this,hn).canRun(this)}));const a=this.state.status==="pending",c=!ft(this,jn).canStart();try{if(a)s();else{or(this,wn,bn).call(this,{type:"pending",variables:i,isPaused:c}),await((h=(d=ft(this,hn).config).onMutate)==null?void 0:h.call(d,i,this));const Pt=await((_=(g=this.options).onMutate)==null?void 0:_.call(g,i));Pt!==this.state.context&&or(this,wn,bn).call(this,{type:"pending",context:Pt,variables:i,isPaused:c})}const xt=await ft(this,jn).start();return await((_e=(b=ft(this,hn).config).onSuccess)==null?void 0:_e.call(b,xt,i,this.state.context,this)),await((it=(nt=this.options).onSuccess)==null?void 0:it.call(nt,xt,i,this.state.context)),await((lt=(et=ft(this,hn).config).onSettled)==null?void 0:lt.call(et,xt,null,this.state.variables,this.state.context,this)),await((at=(rt=this.options).onSettled)==null?void 0:at.call(rt,xt,null,i,this.state.context)),or(this,wn,bn).call(this,{type:"success",data:xt}),xt}catch(xt){try{throw await((st=(ot=ft(this,hn).config).onError)==null?void 0:st.call(ot,xt,i,this.state.context,this)),await((mt=(ct=this.options).onError)==null?void 0:mt.call(ct,xt,i,this.state.context)),await((Et=(pt=ft(this,hn).config).onSettled)==null?void 0:Et.call(pt,void 0,xt,this.state.variables,this.state.context,this)),await((gt=(ut=this.options).onSettled)==null?void 0:gt.call(ut,void 0,xt,i,this.state.context)),xt}finally{or(this,wn,bn).call(this,{type:"error",error:xt})}}finally{ft(this,hn).runNext(this)}}},xn=new WeakMap,hn=new WeakMap,jn=new WeakMap,wn=new WeakSet,bn=function(i){const s=a=>{switch(i.type){case"failed":return{...a,failureCount:i.failureCount,failureReason:i.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:i.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:i.isPaused,status:"pending",variables:i.variables,submittedAt:Date.now()};case"success":return{...a,data:i.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:i.error,failureCount:a.failureCount+1,failureReason:i.error,isPaused:!1,status:"error"}}};this.state=s(this.state),notifyManager.batch(()=>{ft(this,xn).forEach(a=>{a.onMutationUpdate(i)}),ft(this,hn).notify({mutation:this,type:"updated",action:i})})},ao);function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var An,_n,cs,oo,MutationCache=(oo=class extends Subscribable{constructor(i={}){super();cr(this,An);cr(this,_n);cr(this,cs);this.config=i,lr(this,An,new Set),lr(this,_n,new Map),lr(this,cs,0)}build(i,s,a){const c=new Mutation({mutationCache:this,mutationId:++Tn(this,cs)._,options:i.defaultMutationOptions(s),state:a});return this.add(c),c}add(i){ft(this,An).add(i);const s=scopeFor(i);if(typeof s=="string"){const a=ft(this,_n).get(s);a?a.push(i):ft(this,_n).set(s,[i])}this.notify({type:"added",mutation:i})}remove(i){if(ft(this,An).delete(i)){const s=scopeFor(i);if(typeof s=="string"){const a=ft(this,_n).get(s);if(a)if(a.length>1){const c=a.indexOf(i);c!==-1&&a.splice(c,1)}else a[0]===i&&ft(this,_n).delete(s)}}this.notify({type:"removed",mutation:i})}canRun(i){const s=scopeFor(i);if(typeof s=="string"){const a=ft(this,_n).get(s),c=a==null?void 0:a.find(d=>d.state.status==="pending");return!c||c===i}else return!0}runNext(i){var a;const s=scopeFor(i);if(typeof s=="string"){const c=(a=ft(this,_n).get(s))==null?void 0:a.find(d=>d!==i&&d.state.isPaused);return(c==null?void 0:c.continue())??Promise.resolve()}else return Promise.resolve()}clear(){notifyManager.batch(()=>{ft(this,An).forEach(i=>{this.notify({type:"removed",mutation:i})}),ft(this,An).clear(),ft(this,_n).clear()})}getAll(){return Array.from(ft(this,An))}find(i){const s={exact:!0,...i};return this.getAll().find(a=>matchMutation(s,a))}findAll(i={}){return this.getAll().filter(s=>matchMutation(i,s))}notify(i){notifyManager.batch(()=>{this.listeners.forEach(s=>{s(i)})})}resumePausedMutations(){const i=this.getAll().filter(s=>s.state.isPaused);return notifyManager.batch(()=>Promise.all(i.map(s=>s.continue().catch(noop))))}},An=new WeakMap,_n=new WeakMap,cs=new WeakMap,oo);function scopeFor(e){var i;return(i=e.options.scope)==null?void 0:i.id}function infiniteQueryBehavior(e){return{onFetch:(i,s)=>{var _e,nt,it,et,lt;const a=i.options,c=(it=(nt=(_e=i.fetchOptions)==null?void 0:_e.meta)==null?void 0:nt.fetchMore)==null?void 0:it.direction,d=((et=i.state.data)==null?void 0:et.pages)||[],h=((lt=i.state.data)==null?void 0:lt.pageParams)||[];let g={pages:[],pageParams:[]},_=0;const b=async()=>{let rt=!1;const at=ct=>{Object.defineProperty(ct,"signal",{enumerable:!0,get:()=>(i.signal.aborted?rt=!0:i.signal.addEventListener("abort",()=>{rt=!0}),i.signal)})},ot=ensureQueryFn(i.options,i.fetchOptions),st=async(ct,mt,pt)=>{if(rt)return Promise.reject();if(mt==null&&ct.pages.length)return Promise.resolve(ct);const ut=(()=>{const St={client:i.client,queryKey:i.queryKey,pageParam:mt,direction:pt?"backward":"forward",meta:i.options.meta};return at(St),St})(),gt=await ot(ut),{maxPages:xt}=i.options,Pt=pt?addToStart:addToEnd;return{pages:Pt(ct.pages,gt,xt),pageParams:Pt(ct.pageParams,mt,xt)}};if(c&&d.length){const ct=c==="backward",mt=ct?getPreviousPageParam:getNextPageParam,pt={pages:d,pageParams:h},Et=mt(a,pt);g=await st(pt,Et,ct)}else{const ct=e??d.length;do{const mt=_===0?h[0]??a.initialPageParam:getNextPageParam(a,g);if(_>0&&mt==null)break;g=await st(g,mt),_++}while(_<ct)}return g};i.options.persister?i.fetchFn=()=>{var rt,at;return(at=(rt=i.options).persister)==null?void 0:at.call(rt,b,{client:i.client,queryKey:i.queryKey,meta:i.options.meta,signal:i.signal},s)}:i.fetchFn=b}}}function getNextPageParam(e,{pages:i,pageParams:s}){const a=i.length-1;return i.length>0?e.getNextPageParam(i[a],i,s[a],s):void 0}function getPreviousPageParam(e,{pages:i,pageParams:s}){var a;return i.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,i[0],i,s[0],s):void 0}var un,Pn,kn,Yn,qn,Fn,Qn,Jn,lo,QueryClient=(lo=class{constructor(e={}){cr(this,un);cr(this,Pn);cr(this,kn);cr(this,Yn);cr(this,qn);cr(this,Fn);cr(this,Qn);cr(this,Jn);lr(this,un,e.queryCache||new QueryCache),lr(this,Pn,e.mutationCache||new MutationCache),lr(this,kn,e.defaultOptions||{}),lr(this,Yn,new Map),lr(this,qn,new Map),lr(this,Fn,0)}mount(){Tn(this,Fn)._++,ft(this,Fn)===1&&(lr(this,Qn,focusManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),ft(this,un).onFocus())})),lr(this,Jn,onlineManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),ft(this,un).onOnline())})))}unmount(){var e,i;Tn(this,Fn)._--,ft(this,Fn)===0&&((e=ft(this,Qn))==null||e.call(this),lr(this,Qn,void 0),(i=ft(this,Jn))==null||i.call(this),lr(this,Jn,void 0))}isFetching(e){return ft(this,un).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ft(this,Pn).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const i=this.defaultQueryOptions({queryKey:e});return(s=ft(this,un).get(i.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const i=this.defaultQueryOptions(e),s=ft(this,un).build(this,i),a=s.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(resolveStaleTime(i.staleTime,s))&&this.prefetchQuery(i),Promise.resolve(a))}getQueriesData(e){return ft(this,un).findAll(e).map(({queryKey:i,state:s})=>{const a=s.data;return[i,a]})}setQueryData(e,i,s){const a=this.defaultQueryOptions({queryKey:e}),c=ft(this,un).get(a.queryHash),d=c==null?void 0:c.state.data,h=functionalUpdate(i,d);if(h!==void 0)return ft(this,un).build(this,a).setData(h,{...s,manual:!0})}setQueriesData(e,i,s){return notifyManager.batch(()=>ft(this,un).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,i,s)]))}getQueryState(e){var s;const i=this.defaultQueryOptions({queryKey:e});return(s=ft(this,un).get(i.queryHash))==null?void 0:s.state}removeQueries(e){const i=ft(this,un);notifyManager.batch(()=>{i.findAll(e).forEach(s=>{i.remove(s)})})}resetQueries(e,i){const s=ft(this,un);return notifyManager.batch(()=>(s.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},i)))}cancelQueries(e,i={}){const s={revert:!0,...i},a=notifyManager.batch(()=>ft(this,un).findAll(e).map(c=>c.cancel(s)));return Promise.all(a).then(noop).catch(noop)}invalidateQueries(e,i={}){return notifyManager.batch(()=>(ft(this,un).findAll(e).forEach(s=>{s.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},i)))}refetchQueries(e,i={}){const s={...i,cancelRefetch:i.cancelRefetch??!0},a=notifyManager.batch(()=>ft(this,un).findAll(e).filter(c=>!c.isDisabled()&&!c.isStatic()).map(c=>{let d=c.fetch(void 0,s);return s.throwOnError||(d=d.catch(noop)),c.state.fetchStatus==="paused"?Promise.resolve():d}));return Promise.all(a).then(noop)}fetchQuery(e){const i=this.defaultQueryOptions(e);i.retry===void 0&&(i.retry=!1);const s=ft(this,un).build(this,i);return s.isStaleByTime(resolveStaleTime(i.staleTime,s))?s.fetch(i):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(noop).catch(noop)}fetchInfiniteQuery(e){return e.behavior=infiniteQueryBehavior(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(noop).catch(noop)}ensureInfiniteQueryData(e){return e.behavior=infiniteQueryBehavior(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return onlineManager.isOnline()?ft(this,Pn).resumePausedMutations():Promise.resolve()}getQueryCache(){return ft(this,un)}getMutationCache(){return ft(this,Pn)}getDefaultOptions(){return ft(this,kn)}setDefaultOptions(e){lr(this,kn,e)}setQueryDefaults(e,i){ft(this,Yn).set(hashKey(e),{queryKey:e,defaultOptions:i})}getQueryDefaults(e){const i=[...ft(this,Yn).values()],s={};return i.forEach(a=>{partialMatchKey(e,a.queryKey)&&Object.assign(s,a.defaultOptions)}),s}setMutationDefaults(e,i){ft(this,qn).set(hashKey(e),{mutationKey:e,defaultOptions:i})}getMutationDefaults(e){const i=[...ft(this,qn).values()],s={};return i.forEach(a=>{partialMatchKey(e,a.mutationKey)&&Object.assign(s,a.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const i={...ft(this,kn).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return i.queryHash||(i.queryHash=hashQueryKeyByOptions(i.queryKey,i)),i.refetchOnReconnect===void 0&&(i.refetchOnReconnect=i.networkMode!=="always"),i.throwOnError===void 0&&(i.throwOnError=!!i.suspense),!i.networkMode&&i.persister&&(i.networkMode="offlineFirst"),i.queryFn===skipToken&&(i.enabled=!1),i}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ft(this,kn).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ft(this,un).clear(),ft(this,Pn).clear()}},un=new WeakMap,Pn=new WeakMap,kn=new WeakMap,Yn=new WeakMap,qn=new WeakMap,Fn=new WeakMap,Qn=new WeakMap,Jn=new WeakMap,lo),QueryClientContext=reactExports.createContext(void 0),QueryClientProvider=({client:e,children:i})=>(reactExports.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:e,children:i}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends$1.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function i(a,c){let{pathname:d,search:h,hash:g}=a.location;return createLocation("",{pathname:d,search:h,hash:g},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function s(a,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(i,s,null,e)}function invariant(e,i){if(e===!1||e===null||typeof e>"u")throw new Error(i)}function warning(e,i){if(!e){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,i){return{usr:e.state,key:e.key,idx:i}}function createLocation(e,i,s,a){return s===void 0&&(s=null),_extends$1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof i=="string"?parsePath(i):i,{state:s,key:i&&i.key||a||createKey()})}function createPath(e){let{pathname:i="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(i+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(i+=a.charAt(0)==="#"?a:"#"+a),i}function parsePath(e){let i={};if(e){let s=e.indexOf("#");s>=0&&(i.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(i.search=e.substr(a),e=e.substr(0,a)),e&&(i.pathname=e)}return i}function getUrlBasedHistory(e,i,s,a){a===void 0&&(a={});let{window:c=document.defaultView,v5Compat:d=!1}=a,h=c.history,g=Action.Pop,_=null,b=_e();b==null&&(b=0,h.replaceState(_extends$1({},h.state,{idx:b}),""));function _e(){return(h.state||{idx:null}).idx}function nt(){g=Action.Pop;let at=_e(),ot=at==null?null:at-b;b=at,_&&_({action:g,location:rt.location,delta:ot})}function it(at,ot){g=Action.Push;let st=createLocation(rt.location,at,ot);b=_e()+1;let ct=getHistoryState(st,b),mt=rt.createHref(st);try{h.pushState(ct,"",mt)}catch(pt){if(pt instanceof DOMException&&pt.name==="DataCloneError")throw pt;c.location.assign(mt)}d&&_&&_({action:g,location:rt.location,delta:1})}function et(at,ot){g=Action.Replace;let st=createLocation(rt.location,at,ot);b=_e();let ct=getHistoryState(st,b),mt=rt.createHref(st);h.replaceState(ct,"",mt),d&&_&&_({action:g,location:rt.location,delta:0})}function lt(at){let ot=c.location.origin!=="null"?c.location.origin:c.location.href,st=typeof at=="string"?at:createPath(at);return st=st.replace(/ $/,"%20"),invariant(ot,"No window.location.(origin|href) available to create URL for href: "+st),new URL(st,ot)}let rt={get action(){return g},get location(){return e(c,h)},listen(at){if(_)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,nt),_=at,()=>{c.removeEventListener(PopStateEventType,nt),_=null}},createHref(at){return i(c,at)},createURL:lt,encodeLocation(at){let ot=lt(at);return{pathname:ot.pathname,search:ot.search,hash:ot.hash}},push:it,replace:et,go(at){return h.go(at)}};return rt}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function matchRoutes(e,i,s){return s===void 0&&(s="/"),matchRoutesImpl(e,i,s,!1)}function matchRoutesImpl(e,i,s,a){let c=typeof i=="string"?parsePath(i):i,d=stripBasename(c.pathname||"/",s);if(d==null)return null;let h=flattenRoutes(e);rankRouteBranches(h);let g=null;for(let _=0;g==null&&_<h.length;++_){let b=decodePath(d);g=matchRouteBranch(h[_],b,a)}return g}function flattenRoutes(e,i,s,a){i===void 0&&(i=[]),s===void 0&&(s=[]),a===void 0&&(a="");let c=(d,h,g)=>{let _={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:h,route:d};_.relativePath.startsWith("/")&&(invariant(_.relativePath.startsWith(a),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(a.length));let b=joinPaths([a,_.relativePath]),_e=s.concat(_);d.children&&d.children.length>0&&(invariant(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),flattenRoutes(d.children,i,_e,b)),!(d.path==null&&!d.index)&&i.push({path:b,score:computeScore(b,d.index),routesMeta:_e})};return e.forEach((d,h)=>{var g;if(d.path===""||!((g=d.path)!=null&&g.includes("?")))c(d,h);else for(let _ of explodeOptionalSegments(d.path))c(d,h,_)}),i}function explodeOptionalSegments(e){let i=e.split("/");if(i.length===0)return[];let[s,...a]=i,c=s.endsWith("?"),d=s.replace(/\?$/,"");if(a.length===0)return c?[d,""]:[d];let h=explodeOptionalSegments(a.join("/")),g=[];return g.push(...h.map(_=>_===""?d:[d,_].join("/"))),c&&g.push(...h),g.map(_=>e.startsWith("/")&&_===""?"/":_)}function rankRouteBranches(e){e.sort((i,s)=>i.score!==s.score?s.score-i.score:compareIndexes(i.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,i){let s=e.split("/"),a=s.length;return s.some(isSplat)&&(a+=splatPenalty),i&&(a+=indexRouteValue),s.filter(c=>!isSplat(c)).reduce((c,d)=>c+(paramRe.test(d)?dynamicSegmentValue:d===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(e,i){return e.length===i.length&&e.slice(0,-1).every((a,c)=>a===i[c])?e[e.length-1]-i[i.length-1]:0}function matchRouteBranch(e,i,s){let{routesMeta:a}=e,c={},d="/",h=[];for(let g=0;g<a.length;++g){let _=a[g],b=g===a.length-1,_e=d==="/"?i:i.slice(d.length)||"/",nt=matchPath({path:_.relativePath,caseSensitive:_.caseSensitive,end:b},_e),it=_.route;if(!nt&&b&&s&&!a[a.length-1].route.index&&(nt=matchPath({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},_e)),!nt)return null;Object.assign(c,nt.params),h.push({params:c,pathname:joinPaths([d,nt.pathname]),pathnameBase:normalizePathname(joinPaths([d,nt.pathnameBase])),route:it}),nt.pathnameBase!=="/"&&(d=joinPaths([d,nt.pathnameBase]))}return h}function matchPath(e,i){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=compilePath(e.path,e.caseSensitive,e.end),c=i.match(s);if(!c)return null;let d=c[0],h=d.replace(/(.)\/+$/,"$1"),g=c.slice(1);return{params:a.reduce((b,_e,nt)=>{let{paramName:it,isOptional:et}=_e;if(it==="*"){let rt=g[nt]||"";h=d.slice(0,d.length-rt.length).replace(/(.)\/+$/,"$1")}const lt=g[nt];return et&&!lt?b[it]=void 0:b[it]=(lt||"").replace(/%2F/g,"/"),b},{}),pathname:d,pathnameBase:h,pattern:e}}function compilePath(e,i,s){i===void 0&&(i=!1),s===void 0&&(s=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,g,_)=>(a.push({paramName:g,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,i?void 0:"i"),a]}function decodePath(e){try{return e.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),e}}function stripBasename(e,i){if(i==="/")return e;if(!e.toLowerCase().startsWith(i.toLowerCase()))return null;let s=i.endsWith("/")?i.length-1:i.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useRoutes(e,i){return useRoutesImpl(e,i)}function useRoutesImpl(e,i,s,a){useInRouterContext()||invariant(!1);let{navigator:c}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),h=d[d.length-1],g=h?h.params:{};h&&h.pathname;let _=h?h.pathnameBase:"/";h&&h.route;let b=useLocation(),_e;if(i){var nt;let at=typeof i=="string"?parsePath(i):i;_==="/"||(nt=at.pathname)!=null&&nt.startsWith(_)||invariant(!1),_e=at}else _e=b;let it=_e.pathname||"/",et=it;if(_!=="/"){let at=_.replace(/^\//,"").split("/");et="/"+it.replace(/^\//,"").split("/").slice(at.length).join("/")}let lt=matchRoutes(e,{pathname:et}),rt=_renderMatches(lt&&lt.map(at=>Object.assign({},at,{params:Object.assign({},g,at.params),pathname:joinPaths([_,c.encodeLocation?c.encodeLocation(at.pathname).pathname:at.pathname]),pathnameBase:at.pathnameBase==="/"?_:joinPaths([_,c.encodeLocation?c.encodeLocation(at.pathnameBase).pathname:at.pathnameBase])})),d,s,a);return i&&rt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends({pathname:"/",search:"",hash:"",state:null,key:"default"},_e),navigationType:Action.Pop}},rt):rt}function DefaultErrorComponent(){let e=useRouteError(),i=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},i),s?reactExports.createElement("pre",{style:c},s):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,s){return s.location!==i.location||s.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:s.error,location:s.location,revalidation:i.revalidation||s.revalidation}}componentDidCatch(i,s){console.error("React Router caught the following error during render",i,s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:i,match:s,children:a}=e,c=reactExports.useContext(DataRouterContext);return c&&c.static&&c.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=s.route.id),reactExports.createElement(RouteContext.Provider,{value:i},a)}function _renderMatches(e,i,s,a){var c;if(i===void 0&&(i=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var d;if(!s)return null;if(s.errors)e=s.matches;else if((d=a)!=null&&d.v7_partialHydration&&i.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let h=e,g=(c=s)==null?void 0:c.errors;if(g!=null){let _e=h.findIndex(nt=>nt.route.id&&(g==null?void 0:g[nt.route.id])!==void 0);_e>=0||invariant(!1),h=h.slice(0,Math.min(h.length,_e+1))}let _=!1,b=-1;if(s&&a&&a.v7_partialHydration)for(let _e=0;_e<h.length;_e++){let nt=h[_e];if((nt.route.HydrateFallback||nt.route.hydrateFallbackElement)&&(b=_e),nt.route.id){let{loaderData:it,errors:et}=s,lt=nt.route.loader&&it[nt.route.id]===void 0&&(!et||et[nt.route.id]===void 0);if(nt.route.lazy||lt){_=!0,b>=0?h=h.slice(0,b+1):h=[h[0]];break}}}return h.reduceRight((_e,nt,it)=>{let et,lt=!1,rt=null,at=null;s&&(et=g&&nt.route.id?g[nt.route.id]:void 0,rt=nt.route.errorElement||defaultErrorElement,_&&(b<0&&it===0?(lt=!0,at=null):b===it&&(lt=!0,at=nt.route.hydrateFallbackElement||null)));let ot=i.concat(h.slice(0,it+1)),st=()=>{let ct;return et?ct=rt:lt?ct=at:nt.route.Component?ct=reactExports.createElement(nt.route.Component,null):nt.route.element?ct=nt.route.element:ct=_e,reactExports.createElement(RenderedRoute,{match:nt,routeContext:{outlet:_e,matches:ot,isDataRoute:s!=null},children:ct})};return s&&(nt.route.ErrorBoundary||nt.route.errorElement||it===0)?reactExports.createElement(RenderErrorBoundary,{location:s.location,revalidation:s.revalidation,component:rt,error:et,children:st(),routeContext:{outlet:null,matches:ot,isDataRoute:!0}}):st()},null)}var DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterState(e){let i=reactExports.useContext(DataRouterStateContext);return i||invariant(!1),i}function useRouteContext(e){let i=reactExports.useContext(RouteContext);return i||invariant(!1),i}function useCurrentRouteId(e){let i=useRouteContext(),s=i.matches[i.matches.length-1];return s.route.id||invariant(!1),s.route.id}function useRouteError(){var e;let i=reactExports.useContext(RouteErrorContext),s=useDataRouterState(DataRouterStateHook$1.UseRouteError),a=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return i!==void 0?i:(e=s.errors)==null?void 0:e[a]}function logV6DeprecationWarnings(e,i){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Route(e){invariant(!1)}function Router(e){let{basename:i="/",children:s=null,location:a,navigationType:c=Action.Pop,navigator:d,static:h=!1,future:g}=e;useInRouterContext()&&invariant(!1);let _=i.replace(/^\/*/,"/"),b=reactExports.useMemo(()=>({basename:_,navigator:d,static:h,future:_extends({v7_relativeSplatPath:!1},g)}),[_,g,d,h]);typeof a=="string"&&(a=parsePath(a));let{pathname:_e="/",search:nt="",hash:it="",state:et=null,key:lt="default"}=a,rt=reactExports.useMemo(()=>{let at=stripBasename(_e,_);return at==null?null:{location:{pathname:at,search:nt,hash:it,state:et,key:lt},navigationType:c}},[_,_e,nt,it,et,lt,c]);return rt==null?null:reactExports.createElement(NavigationContext.Provider,{value:b},reactExports.createElement(LocationContext.Provider,{children:s,value:rt}))}function Routes(e){let{children:i,location:s}=e;return useRoutes(createRoutesFromChildren(i),s)}new Promise(()=>{});function createRoutesFromChildren(e,i){i===void 0&&(i=[]);let s=[];return reactExports.Children.forEach(e,(a,c)=>{if(!reactExports.isValidElement(a))return;let d=[...i,c];if(a.type===reactExports.Fragment){s.push.apply(s,createRoutesFromChildren(a.props.children,d));return}a.type!==Route&&invariant(!1),!a.props.index||!a.props.children||invariant(!1);let h={id:a.props.id||d.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(h.children=createRoutesFromChildren(a.props.children,d)),s.push(h)}),s}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React[START_TRANSITION];function BrowserRouter(e){let{basename:i,children:s,future:a,window:c}=e,d=reactExports.useRef();d.current==null&&(d.current=createBrowserHistory({window:c,v5Compat:!0}));let h=d.current,[g,_]=reactExports.useState({action:h.action,location:h.location}),{v7_startTransition:b}=a||{},_e=reactExports.useCallback(nt=>{b&&startTransitionImpl?startTransitionImpl(()=>_(nt)):_(nt)},[_,b]);return reactExports.useLayoutEffect(()=>h.listen(_e),[h,_e]),reactExports.useEffect(()=>logV6DeprecationWarnings(a),[a]),reactExports.createElement(Router,{basename:i,children:s,location:g.location,navigationType:g.action,navigator:h,future:a})}var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));const buttonVariants=cva("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Button=reactExports.forwardRef(({className:e,variant:i,size:s,asChild:a=!1,...c},d)=>{const h=a?Slot:"button";return jsxRuntimeExports.jsx(h,{className:cn(buttonVariants({variant:i,size:s,className:e})),ref:d,...c})});Button.displayName="Button";const Sidebar=({darkMode:e,onToggleDarkMode:i})=>jsxRuntimeExports.jsxs("aside",{className:"w-56 min-h-screen bg-sidebar border-r-2 border-sidebar-border flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"p-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 border-2 border-foreground bg-primary",children:jsxRuntimeExports.jsx(FileText,{className:"w-6 h-6 text-primary-foreground"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-bold tracking-tight",children:"CT-e para Excel"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:"v1.0"})]})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t-2 border-sidebar-border",children:jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:i,className:"w-full justify-center gap-2 font-medium",children:e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Sun,{className:"w-4 h-4"}),"Modo Claro"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Moon,{className:"w-4 h-4"}),"Modo Escuro"]})})})]}),UploadArea=({file:e,onFileSelect:i,disabled:s})=>{const a=reactExports.useCallback(g=>{if(g.preventDefault(),s)return;const _=g.dataTransfer.files[0];(_==null?void 0:_.type)==="application/pdf"&&i(_)},[i,s]),c=g=>{g.preventDefault()},d=g=>{var b;const _=(b=g.target.files)==null?void 0:b[0];(_==null?void 0:_.type)==="application/pdf"&&i(_),g.target.value=""},h=g=>g<1024?g+" B":g<1024*1024?(g/1024).toFixed(1)+" KB":(g/(1024*1024)).toFixed(2)+" MB";return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{onClick:()=>{var g;return!s&&((g=document.getElementById("file-input"))==null?void 0:g.click())},onDrop:a,onDragOver:c,className:`
          border-2 border-dashed p-12 text-center cursor-pointer
          transition-all duration-200 bg-secondary/30
          ${s?"opacity-50 cursor-not-allowed":"hover:bg-secondary/50 hover:border-primary active:shadow-xs"}
        `,children:[jsxRuntimeExports.jsx(Upload,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold mb-2",children:"Arraste o CT-e aqui ou clique"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:"Apenas arquivos PDF (mx. 10MB)"}),jsxRuntimeExports.jsx("input",{id:"file-input",type:"file",accept:".pdf,application/pdf",onChange:d,className:"hidden",disabled:s})]}),e&&jsxRuntimeExports.jsxs("div",{className:"p-4 bg-secondary border-2 border-border flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-primary",children:jsxRuntimeExports.jsx(FileText,{className:"w-5 h-5 text-primary-foreground"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold truncate max-w-xs",children:e.name}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:h(e.size)})]})]}),jsxRuntimeExports.jsxs(Button,{variant:"destructive",size:"sm",onClick:g=>{g.stopPropagation(),i(null)},className:"gap-1",children:[jsxRuntimeExports.jsx(X,{className:"w-4 h-4"}),"Remover"]})]})]})},ResultCard=({data:e,fieldsCount:i,missingFields:s,onDownload:a})=>jsxRuntimeExports.jsxs("div",{className:"border-2 border-border p-6 bg-card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-primary",children:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-6 h-6 text-primary-foreground"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-1",children:" CT-e processado!"}),jsxRuntimeExports.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 font-mono",children:[jsxRuntimeExports.jsxs("li",{children:[" ",i," campos extrados"]}),jsxRuntimeExports.jsxs("li",{children:[" CT-e n ",e.numeroCTe||"N/A"]}),jsxRuntimeExports.jsx("li",{children:" Download iniciado automaticamente"})]})]})]}),s.length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-4 p-3 bg-destructive/10 border border-destructive/20",children:[jsxRuntimeExports.jsxs("p",{className:"text-xs font-bold text-destructive uppercase mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-3 h-3"}),"Campos no encontrados:"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:s.map(c=>jsxRuntimeExports.jsx("span",{className:"text-[10px] bg-destructive/20 text-destructive px-1.5 py-0.5 font-mono",children:c},c))})]}),jsxRuntimeExports.jsx("div",{className:"p-4 bg-accent border-2 border-border mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-foreground flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("p",{className:"text-sm",children:[jsxRuntimeExports.jsx("strong",{children:"Lembre-se:"}),' Preencha a coluna "Placa Veculo" na planilha usando sua programao de carregamento']})]})}),jsxRuntimeExports.jsxs(Button,{onClick:a,className:"w-full gap-2 font-semibold",size:"lg",children:[jsxRuntimeExports.jsx(Download,{className:"w-5 h-5"}),"Baixar Excel Novamente"]})]}),ErrorMessage=({message:e})=>jsxRuntimeExports.jsxs("div",{className:"border-2 border-destructive bg-destructive/10 p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-bold text-destructive",children:"Erro"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-foreground",children:e})]})]});function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(i,s){module.exports=i.pdfjsLib=s()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,i)=>{var nn;Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PromiseCapability=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationReplyType=i.AnnotationPrefix=i.AnnotationMode=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=kt,i.bytesToString=_r,i.createValidAbsoluteUrl=sr,i.getModificationDate=Dr,i.getUuid=Kr,i.getVerbosityLevel=Kt,i.info=nr,i.isArrayBuffer=dr,i.isArrayEqual=Nr,i.isNodeJS=void 0,i.normalizeUnicode=Vr,i.objectFromMap=Fr,i.objectSize=Sr,i.setVerbosityLevel=er,i.shadow=At,i.string32=Ar,i.stringToBytes=pr,i.stringToPDFString=Tr,i.stringToUTF8String=Mr,i.unreachable=qt,i.utf8StringToString=kr,i.warn=Jt;const s=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=s;const a=[1,0,0,1,0,0];i.IDENTITY_MATRIX=a;const c=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=c;const d=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=d;const h=1.35;i.LINE_FACTOR=h;const g=.35;i.LINE_DESCENT_FACTOR=g;const _=g/h;i.BASELINE_FACTOR=_;const b={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=b;const _e={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=_e;const nt="pdfjs_internal_editor_";i.AnnotationEditorPrefix=nt;const it={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};i.AnnotationEditorType=it;const et={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};i.AnnotationEditorParamsType=et;const lt={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=lt;const rt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=rt;const at={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=at;const ot={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=ot;const st={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=st;const ct={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=ct;const mt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=mt;const pt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=pt;const Et={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=Et;const ut={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=ut;const gt={O:"PageOpen",C:"PageClose"};i.PageActionEventType=gt;const xt={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=xt;const Pt={NONE:0,BINARY:1};i.CMapCompressionType=Pt;const St={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=St;const Ct={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=Ct;let Lt=xt.WARNINGS;function er(Or){Number.isInteger(Or)&&(Lt=Or)}function Kt(){return Lt}function nr(Or){Lt>=xt.INFOS&&console.log(`Info: ${Or}`)}function Jt(Or){Lt>=xt.WARNINGS&&console.log(`Warning: ${Or}`)}function qt(Or){throw new Error(Or)}function kt(Or,mr){Or||qt(mr)}function Xt(Or){switch(Or==null?void 0:Or.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function sr(Or,mr=null,vr=null){if(!Or)return null;try{if(vr&&typeof Or=="string"){if(vr.addDefaultProtocol&&Or.startsWith("www.")){const rn=Or.match(/\./g);(rn==null?void 0:rn.length)>=2&&(Or=`http://${Or}`)}if(vr.tryConvertEncoding)try{Or=Mr(Or)}catch{}}const Hr=mr?new URL(Or,mr):new URL(Or);if(Xt(Hr))return Hr}catch{}return null}function At(Or,mr,vr,Hr=!1){return Object.defineProperty(Or,mr,{value:vr,enumerable:!Hr,configurable:!0,writable:!1}),vr}const ht=function(){function mr(vr,Hr){this.constructor===mr&&qt("Cannot initialize BaseException."),this.message=vr,this.name=Hr}return mr.prototype=new Error,mr.constructor=mr,mr}();i.BaseException=ht;class dt extends ht{constructor(mr,vr){super(mr,"PasswordException"),this.code=vr}}i.PasswordException=dt;class Tt extends ht{constructor(mr,vr){super(mr,"UnknownErrorException"),this.details=vr}}i.UnknownErrorException=Tt;class Mt extends ht{constructor(mr){super(mr,"InvalidPDFException")}}i.InvalidPDFException=Mt;class It extends ht{constructor(mr){super(mr,"MissingPDFException")}}i.MissingPDFException=It;class Ut extends ht{constructor(mr,vr){super(mr,"UnexpectedResponseException"),this.status=vr}}i.UnexpectedResponseException=Ut;class Zt extends ht{constructor(mr){super(mr,"FormatError")}}i.FormatError=Zt;class rr extends ht{constructor(mr){super(mr,"AbortException")}}i.AbortException=rr;function _r(Or){(typeof Or!="object"||(Or==null?void 0:Or.length)===void 0)&&qt("Invalid argument for bytesToString");const mr=Or.length,vr=8192;if(mr<vr)return String.fromCharCode.apply(null,Or);const Hr=[];for(let rn=0;rn<mr;rn+=vr){const Zr=Math.min(rn+vr,mr),tr=Or.subarray(rn,Zr);Hr.push(String.fromCharCode.apply(null,tr))}return Hr.join("")}function pr(Or){typeof Or!="string"&&qt("Invalid argument for stringToBytes");const mr=Or.length,vr=new Uint8Array(mr);for(let Hr=0;Hr<mr;++Hr)vr[Hr]=Or.charCodeAt(Hr)&255;return vr}function Ar(Or){return String.fromCharCode(Or>>24&255,Or>>16&255,Or>>8&255,Or&255)}function Sr(Or){return Object.keys(Or).length}function Fr(Or){const mr=Object.create(null);for(const[vr,Hr]of Or)mr[vr]=Hr;return mr}function ur(){const Or=new Uint8Array(4);return Or[0]=1,new Uint32Array(Or.buffer,0,1)[0]===1}function ir(){try{return new Function(""),!0}catch{return!1}}class Bt{static get isLittleEndian(){return At(this,"isLittleEndian",ur())}static get isEvalSupported(){return At(this,"isEvalSupported",ir())}static get isOffscreenCanvasSupported(){return At(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?At(this,"platform",{isWin:!1,isMac:!1}):At(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var mr,vr;return At(this,"isCSSRoundSupported",(vr=(mr=globalThis.CSS)==null?void 0:mr.supports)==null?void 0:vr.call(mr,"width: round(1.5px, 1px)"))}}i.FeatureTest=Bt;const Qt=[...Array(256).keys()].map(Or=>Or.toString(16).padStart(2,"0"));class fr{static makeHexColor(mr,vr,Hr){return`#${Qt[mr]}${Qt[vr]}${Qt[Hr]}`}static scaleMinMax(mr,vr){let Hr;mr[0]?(mr[0]<0&&(Hr=vr[0],vr[0]=vr[1],vr[1]=Hr),vr[0]*=mr[0],vr[1]*=mr[0],mr[3]<0&&(Hr=vr[2],vr[2]=vr[3],vr[3]=Hr),vr[2]*=mr[3],vr[3]*=mr[3]):(Hr=vr[0],vr[0]=vr[2],vr[2]=Hr,Hr=vr[1],vr[1]=vr[3],vr[3]=Hr,mr[1]<0&&(Hr=vr[2],vr[2]=vr[3],vr[3]=Hr),vr[2]*=mr[1],vr[3]*=mr[1],mr[2]<0&&(Hr=vr[0],vr[0]=vr[1],vr[1]=Hr),vr[0]*=mr[2],vr[1]*=mr[2]),vr[0]+=mr[4],vr[1]+=mr[4],vr[2]+=mr[5],vr[3]+=mr[5]}static transform(mr,vr){return[mr[0]*vr[0]+mr[2]*vr[1],mr[1]*vr[0]+mr[3]*vr[1],mr[0]*vr[2]+mr[2]*vr[3],mr[1]*vr[2]+mr[3]*vr[3],mr[0]*vr[4]+mr[2]*vr[5]+mr[4],mr[1]*vr[4]+mr[3]*vr[5]+mr[5]]}static applyTransform(mr,vr){const Hr=mr[0]*vr[0]+mr[1]*vr[2]+vr[4],rn=mr[0]*vr[1]+mr[1]*vr[3]+vr[5];return[Hr,rn]}static applyInverseTransform(mr,vr){const Hr=vr[0]*vr[3]-vr[1]*vr[2],rn=(mr[0]*vr[3]-mr[1]*vr[2]+vr[2]*vr[5]-vr[4]*vr[3])/Hr,Zr=(-mr[0]*vr[1]+mr[1]*vr[0]+vr[4]*vr[1]-vr[5]*vr[0])/Hr;return[rn,Zr]}static getAxialAlignedBoundingBox(mr,vr){const Hr=this.applyTransform(mr,vr),rn=this.applyTransform(mr.slice(2,4),vr),Zr=this.applyTransform([mr[0],mr[3]],vr),tr=this.applyTransform([mr[2],mr[1]],vr);return[Math.min(Hr[0],rn[0],Zr[0],tr[0]),Math.min(Hr[1],rn[1],Zr[1],tr[1]),Math.max(Hr[0],rn[0],Zr[0],tr[0]),Math.max(Hr[1],rn[1],Zr[1],tr[1])]}static inverseTransform(mr){const vr=mr[0]*mr[3]-mr[1]*mr[2];return[mr[3]/vr,-mr[1]/vr,-mr[2]/vr,mr[0]/vr,(mr[2]*mr[5]-mr[4]*mr[3])/vr,(mr[4]*mr[1]-mr[5]*mr[0])/vr]}static singularValueDecompose2dScale(mr){const vr=[mr[0],mr[2],mr[1],mr[3]],Hr=mr[0]*vr[0]+mr[1]*vr[2],rn=mr[0]*vr[1]+mr[1]*vr[3],Zr=mr[2]*vr[0]+mr[3]*vr[2],tr=mr[2]*vr[1]+mr[3]*vr[3],Rr=(Hr+tr)/2,Br=Math.sqrt((Hr+tr)**2-4*(Hr*tr-Zr*rn))/2,zr=Rr+Br||1,Ir=Rr-Br||1;return[Math.sqrt(zr),Math.sqrt(Ir)]}static normalizeRect(mr){const vr=mr.slice(0);return mr[0]>mr[2]&&(vr[0]=mr[2],vr[2]=mr[0]),mr[1]>mr[3]&&(vr[1]=mr[3],vr[3]=mr[1]),vr}static intersect(mr,vr){const Hr=Math.max(Math.min(mr[0],mr[2]),Math.min(vr[0],vr[2])),rn=Math.min(Math.max(mr[0],mr[2]),Math.max(vr[0],vr[2]));if(Hr>rn)return null;const Zr=Math.max(Math.min(mr[1],mr[3]),Math.min(vr[1],vr[3])),tr=Math.min(Math.max(mr[1],mr[3]),Math.max(vr[1],vr[3]));return Zr>tr?null:[Hr,Zr,rn,tr]}static bezierBoundingBox(mr,vr,Hr,rn,Zr,tr,Rr,Br){const zr=[],Ir=[[],[]];let jr,Vt,$t,ar,xr,Er,Pr,Lr;for(let zt=0;zt<2;++zt){if(zt===0?(Vt=6*mr-12*Hr+6*Zr,jr=-3*mr+9*Hr-9*Zr+3*Rr,$t=3*Hr-3*mr):(Vt=6*vr-12*rn+6*tr,jr=-3*vr+9*rn-9*tr+3*Br,$t=3*rn-3*vr),Math.abs(jr)<1e-12){if(Math.abs(Vt)<1e-12)continue;ar=-$t/Vt,0<ar&&ar<1&&zr.push(ar);continue}Pr=Vt*Vt-4*$t*jr,Lr=Math.sqrt(Pr),!(Pr<0)&&(xr=(-Vt+Lr)/(2*jr),0<xr&&xr<1&&zr.push(xr),Er=(-Vt-Lr)/(2*jr),0<Er&&Er<1&&zr.push(Er))}let Gr=zr.length,Xr;const Rt=Gr;for(;Gr--;)ar=zr[Gr],Xr=1-ar,Ir[0][Gr]=Xr*Xr*Xr*mr+3*Xr*Xr*ar*Hr+3*Xr*ar*ar*Zr+ar*ar*ar*Rr,Ir[1][Gr]=Xr*Xr*Xr*vr+3*Xr*Xr*ar*rn+3*Xr*ar*ar*tr+ar*ar*ar*Br;return Ir[0][Rt]=mr,Ir[1][Rt]=vr,Ir[0][Rt+1]=Rr,Ir[1][Rt+1]=Br,Ir[0].length=Ir[1].length=Rt+2,[Math.min(...Ir[0]),Math.min(...Ir[1]),Math.max(...Ir[0]),Math.max(...Ir[1])]}}i.Util=fr;const hr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Tr(Or){if(Or[0]>=""){let vr;if(Or[0]===""&&Or[1]===""?vr="utf-16be":Or[0]===""&&Or[1]===""?vr="utf-16le":Or[0]===""&&Or[1]===""&&Or[2]===""&&(vr="utf-8"),vr)try{const Hr=new TextDecoder(vr,{fatal:!0}),rn=pr(Or);return Hr.decode(rn)}catch(Hr){Jt(`stringToPDFString: "${Hr}".`)}}const mr=[];for(let vr=0,Hr=Or.length;vr<Hr;vr++){const rn=hr[Or.charCodeAt(vr)];mr.push(rn?String.fromCharCode(rn):Or.charAt(vr))}return mr.join("")}function Mr(Or){return decodeURIComponent(escape(Or))}function kr(Or){return unescape(encodeURIComponent(Or))}function dr(Or){return typeof Or=="object"&&(Or==null?void 0:Or.byteLength)!==void 0}function Nr(Or,mr){if(Or.length!==mr.length)return!1;for(let vr=0,Hr=Or.length;vr<Hr;vr++)if(Or[vr]!==mr[vr])return!1;return!0}function Dr(Or=new Date){return[Or.getUTCFullYear().toString(),(Or.getUTCMonth()+1).toString().padStart(2,"0"),Or.getUTCDate().toString().padStart(2,"0"),Or.getUTCHours().toString().padStart(2,"0"),Or.getUTCMinutes().toString().padStart(2,"0"),Or.getUTCSeconds().toString().padStart(2,"0")].join("")}class Jr{constructor(){cr(this,nn,!1);this.promise=new Promise((mr,vr)=>{this.resolve=Hr=>{lr(this,nn,!0),mr(Hr)},this.reject=Hr=>{lr(this,nn,!0),vr(Hr)}})}get settled(){return ft(this,nn)}}nn=new WeakMap,i.PromiseCapability=Jr;let Qr=null,en=null;function Vr(Or){return Qr||(Qr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,en=new Map([["","t"]])),Or.replaceAll(Qr,(mr,vr,Hr)=>vr?vr.normalize("NFKC"):en.get(Hr))}function Kr(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Or=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Or);else for(let mr=0;mr<32;mr++)Or[mr]=Math.floor(Math.random()*255);return _r(Or)}const tn="pdfjs_internal_id_";i.AnnotationPrefix=tn},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var e,s,a,c,Un,us,g,_,b,_e,nt,it,et,lt,rt,fs,ot,st,bs,mt,pt;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(ut){if(typeof ut=="string"||ut instanceof URL?ut={url:ut}:(0,_util.isArrayBuffer)(ut)&&(ut={data:ut}),typeof ut!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!ut.url&&!ut.data&&!ut.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const gt=new PDFDocumentLoadingTask,{docId:xt}=gt,Pt=ut.url?getUrlProp(ut.url):null,St=ut.data?getDataProp(ut.data):null,Ct=ut.httpHeaders||null,Lt=ut.withCredentials===!0,er=ut.password??null,Kt=ut.range instanceof PDFDataRangeTransport?ut.range:null,nr=Number.isInteger(ut.rangeChunkSize)&&ut.rangeChunkSize>0?ut.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Jt=ut.worker instanceof PDFWorker?ut.worker:null;const qt=ut.verbosity,kt=typeof ut.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(ut.docBaseUrl)?ut.docBaseUrl:null,Xt=typeof ut.cMapUrl=="string"?ut.cMapUrl:null,sr=ut.cMapPacked!==!1,At=ut.CMapReaderFactory||DefaultCMapReaderFactory,ht=typeof ut.standardFontDataUrl=="string"?ut.standardFontDataUrl:null,dt=ut.StandardFontDataFactory||DefaultStandardFontDataFactory,Tt=ut.stopAtErrors!==!0,Mt=Number.isInteger(ut.maxImageSize)&&ut.maxImageSize>-1?ut.maxImageSize:-1,It=ut.isEvalSupported!==!1,Ut=typeof ut.isOffscreenCanvasSupported=="boolean"?ut.isOffscreenCanvasSupported:!_util.isNodeJS,Zt=Number.isInteger(ut.canvasMaxAreaInBytes)?ut.canvasMaxAreaInBytes:-1,rr=typeof ut.disableFontFace=="boolean"?ut.disableFontFace:_util.isNodeJS,_r=ut.fontExtraProperties===!0,pr=ut.enableXfa===!0,Ar=ut.ownerDocument||globalThis.document,Sr=ut.disableRange===!0,Fr=ut.disableStream===!0,ur=ut.disableAutoFetch===!0,ir=ut.pdfBug===!0,Bt=Kt?Kt.length:ut.length??NaN,Qt=typeof ut.useSystemFonts=="boolean"?ut.useSystemFonts:!_util.isNodeJS&&!rr,fr=typeof ut.useWorkerFetch=="boolean"?ut.useWorkerFetch:At===_display_utils.DOMCMapReaderFactory&&dt===_display_utils.DOMStandardFontDataFactory&&Xt&&ht&&(0,_display_utils.isValidFetchUrl)(Xt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ht,document.baseURI),hr=ut.canvasFactory||new DefaultCanvasFactory({ownerDocument:Ar}),Tr=ut.filterFactory||new DefaultFilterFactory({docId:xt,ownerDocument:Ar}),Mr=null;(0,_util.setVerbosityLevel)(qt);const kr={canvasFactory:hr,filterFactory:Tr};if(fr||(kr.cMapReaderFactory=new At({baseUrl:Xt,isCompressed:sr}),kr.standardFontDataFactory=new dt({baseUrl:ht})),!Jt){const Dr={verbosity:qt,port:_worker_options.GlobalWorkerOptions.workerPort};Jt=Dr.port?PDFWorker.fromPort(Dr):new PDFWorker(Dr),gt._worker=Jt}const dr={docId:xt,apiVersion:"3.11.174",data:St,password:er,disableAutoFetch:ur,rangeChunkSize:nr,length:Bt,docBaseUrl:kt,enableXfa:pr,evaluatorOptions:{maxImageSize:Mt,disableFontFace:rr,ignoreErrors:Tt,isEvalSupported:It,isOffscreenCanvasSupported:Ut,canvasMaxAreaInBytes:Zt,fontExtraProperties:_r,useSystemFonts:Qt,cMapUrl:fr?Xt:null,standardFontDataUrl:fr?ht:null}},Nr={ignoreErrors:Tt,isEvalSupported:It,disableFontFace:rr,fontExtraProperties:_r,enableXfa:pr,ownerDocument:Ar,disableAutoFetch:ur,pdfBug:ir,styleElement:Mr};return Jt.promise.then(function(){if(gt.destroyed)throw new Error("Loading aborted");const Dr=_fetchDocument(Jt,dr),Jr=new Promise(function(Qr){let en;Kt?en=new _transport_stream.PDFDataTransportStream({length:Bt,initialData:Kt.initialData,progressiveDone:Kt.progressiveDone,contentDispositionFilename:Kt.contentDispositionFilename,disableRange:Sr,disableStream:Fr},Kt):St||(en=(Kr=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Kr):(0,_display_utils.isValidFetchUrl)(Kr.url)?new _displayFetch_stream.PDFFetchStream(Kr):new _displayNetwork.PDFNetworkStream(Kr))({url:Pt,length:Bt,httpHeaders:Ct,withCredentials:Lt,rangeChunkSize:nr,disableRange:Sr,disableStream:Fr})),Qr(en)});return Promise.all([Dr,Jr]).then(function([Qr,en]){if(gt.destroyed)throw new Error("Loading aborted");const Vr=new _message_handler.MessageHandler(xt,Qr,Jt.port),Kr=new WorkerTransport(Vr,gt,en,Nr,kr);gt._transport=Kr,Vr.send("Ready",null)})}).catch(gt._capability.reject),gt}async function _fetchDocument(ut,gt){if(ut.destroyed)throw new Error("Worker was destroyed");const xt=await ut.messageHandler.sendWithPromise("GetDocRequest",gt,gt.data?[gt.data.buffer]:null);if(ut.destroyed)throw new Error("Worker was destroyed");return xt}function getUrlProp(ut){if(ut instanceof URL)return ut.href;try{return new URL(ut,window.location).href}catch{if(_util.isNodeJS&&typeof ut=="string")return ut}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(ut){if(_util.isNodeJS&&typeof Buffer<"u"&&ut instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(ut instanceof Uint8Array&&ut.byteLength===ut.buffer.byteLength)return ut;if(typeof ut=="string")return(0,_util.stringToBytes)(ut);if(typeof ut=="object"&&!isNaN(ut==null?void 0:ut.length)||(0,_util.isArrayBuffer)(ut))return new Uint8Array(ut);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class i{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Tn(i,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var gt,xt,Pt;this.destroyed=!0;try{(gt=this._worker)!=null&&gt.port&&(this._worker._pendingDestroy=!0),await((xt=this._transport)==null?void 0:xt.destroy())}catch(St){throw(Pt=this._worker)!=null&&Pt.port&&delete this._worker._pendingDestroy,St}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,cr(i,e,0);let PDFDocumentLoadingTask=i;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(gt,xt,Pt=!1,St=null){this.length=gt,this.initialData=xt,this.progressiveDone=Pt,this.contentDispositionFilename=St,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(gt){this._rangeListeners.push(gt)}addProgressListener(gt){this._progressListeners.push(gt)}addProgressiveReadListener(gt){this._progressiveReadListeners.push(gt)}addProgressiveDoneListener(gt){this._progressiveDoneListeners.push(gt)}onDataRange(gt,xt){for(const Pt of this._rangeListeners)Pt(gt,xt)}onDataProgress(gt,xt){this._readyCapability.promise.then(()=>{for(const Pt of this._progressListeners)Pt(gt,xt)})}onDataProgressiveRead(gt){this._readyCapability.promise.then(()=>{for(const xt of this._progressiveReadListeners)xt(gt)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const gt of this._progressiveDoneListeners)gt()})}transportReady(){this._readyCapability.resolve()}requestDataRange(gt,xt){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(gt,xt){this._pdfInfo=gt,this._transport=xt,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(Pt=>{if(!Pt)return Pt;const St=[];for(const Ct in Pt)St.push(...Pt[Ct]);return St}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(gt){return this._transport.getPage(gt)}getPageIndex(gt){return this._transport.getPageIndex(gt)}getDestinations(){return this._transport.getDestinations()}getDestination(gt){return this._transport.getDestination(gt)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(gt=!1){return this._transport.startCleanup(gt||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(gt,xt,Pt,St=!1){cr(this,c);cr(this,s,null);cr(this,a,!1);this._pageIndex=gt,this._pageInfo=xt,this._transport=Pt,this._stats=St?new _display_utils.StatTimer:null,this._pdfBug=St,this.commonObjs=Pt.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:gt,rotation:xt=this.rotate,offsetX:Pt=0,offsetY:St=0,dontFlip:Ct=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:gt,rotation:xt,offsetX:Pt,offsetY:St,dontFlip:Ct})}getAnnotations({intent:gt="display"}={}){const xt=this._transport.getRenderingIntent(gt);return this._transport.getAnnotations(this._pageIndex,xt.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var gt;return((gt=this._transport._htmlForXfa)==null?void 0:gt.children[this._pageIndex])||null}render({canvasContext:gt,viewport:xt,intent:Pt="display",annotationMode:St=_util.AnnotationMode.ENABLE,transform:Ct=null,background:Lt=null,optionalContentConfigPromise:er=null,annotationCanvasMap:Kt=null,pageColors:nr=null,printAnnotationStorage:Jt=null}){var dt,Tt;(dt=this._stats)==null||dt.time("Overall");const qt=this._transport.getRenderingIntent(Pt,St,Jt);lr(this,a,!1),or(this,c,us).call(this),er||(er=this._transport.getOptionalContentConfig());let kt=this._intentStates.get(qt.cacheKey);kt||(kt=Object.create(null),this._intentStates.set(qt.cacheKey,kt)),kt.streamReaderCancelTimeout&&(clearTimeout(kt.streamReaderCancelTimeout),kt.streamReaderCancelTimeout=null);const Xt=!!(qt.renderingIntent&_util.RenderingIntentFlag.PRINT);kt.displayReadyCapability||(kt.displayReadyCapability=new _util.PromiseCapability,kt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Tt=this._stats)==null||Tt.time("Page Request"),this._pumpOperatorList(qt));const sr=Mt=>{var It,Ut;kt.renderTasks.delete(At),(this._maybeCleanupAfterRender||Xt)&&lr(this,a,!0),or(this,c,Un).call(this,!Xt),Mt?(At.capability.reject(Mt),this._abortOperatorList({intentState:kt,reason:Mt instanceof Error?Mt:new Error(Mt)})):At.capability.resolve(),(It=this._stats)==null||It.timeEnd("Rendering"),(Ut=this._stats)==null||Ut.timeEnd("Overall")},At=new InternalRenderTask({callback:sr,params:{canvasContext:gt,viewport:xt,transform:Ct,background:Lt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Kt,operatorList:kt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Xt,pdfBug:this._pdfBug,pageColors:nr});(kt.renderTasks||(kt.renderTasks=new Set)).add(At);const ht=At.task;return Promise.all([kt.displayReadyCapability.promise,er]).then(([Mt,It])=>{var Ut;if(this.destroyed){sr();return}(Ut=this._stats)==null||Ut.time("Rendering"),At.initializeGraphics({transparency:Mt,optionalContentConfig:It}),At.operatorListChanged()}).catch(sr),ht}getOperatorList({intent:gt="display",annotationMode:xt=_util.AnnotationMode.ENABLE,printAnnotationStorage:Pt=null}={}){var Kt;function St(){Lt.operatorList.lastChunk&&(Lt.opListReadCapability.resolve(Lt.operatorList),Lt.renderTasks.delete(er))}const Ct=this._transport.getRenderingIntent(gt,xt,Pt,!0);let Lt=this._intentStates.get(Ct.cacheKey);Lt||(Lt=Object.create(null),this._intentStates.set(Ct.cacheKey,Lt));let er;return Lt.opListReadCapability||(er=Object.create(null),er.operatorListChanged=St,Lt.opListReadCapability=new _util.PromiseCapability,(Lt.renderTasks||(Lt.renderTasks=new Set)).add(er),Lt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Kt=this._stats)==null||Kt.time("Page Request"),this._pumpOperatorList(Ct)),Lt.opListReadCapability.promise}streamTextContent({includeMarkedContent:gt=!1,disableNormalization:xt=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:gt===!0,disableNormalization:xt===!0},{highWaterMark:100,size(St){return St.items.length}})}getTextContent(gt={}){if(this._transport._htmlForXfa)return this.getXfa().then(Pt=>_xfa_text.XfaText.textContent(Pt));const xt=this.streamTextContent(gt);return new Promise(function(Pt,St){function Ct(){Lt.read().then(function({value:Kt,done:nr}){if(nr){Pt(er);return}Object.assign(er.styles,Kt.styles),er.items.push(...Kt.items),Ct()},St)}const Lt=xt.getReader(),er={items:[],styles:Object.create(null)};Ct()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const gt=[];for(const xt of this._intentStates.values())if(this._abortOperatorList({intentState:xt,reason:new Error("Page was destroyed."),force:!0}),!xt.opListReadCapability)for(const Pt of xt.renderTasks)gt.push(Pt.completed),Pt.cancel();return this.objs.clear(),lr(this,a,!1),or(this,c,us).call(this),Promise.all(gt)}cleanup(gt=!1){lr(this,a,!0);const xt=or(this,c,Un).call(this,!1);return gt&&xt&&this._stats&&(this._stats=new _display_utils.StatTimer),xt}_startRenderPage(gt,xt){var St,Ct;const Pt=this._intentStates.get(xt);Pt&&((St=this._stats)==null||St.timeEnd("Page Request"),(Ct=Pt.displayReadyCapability)==null||Ct.resolve(gt))}_renderPageChunk(gt,xt){for(let Pt=0,St=gt.length;Pt<St;Pt++)xt.operatorList.fnArray.push(gt.fnArray[Pt]),xt.operatorList.argsArray.push(gt.argsArray[Pt]);xt.operatorList.lastChunk=gt.lastChunk,xt.operatorList.separateAnnots=gt.separateAnnots;for(const Pt of xt.renderTasks)Pt.operatorListChanged();gt.lastChunk&&or(this,c,Un).call(this,!0)}_pumpOperatorList({renderingIntent:gt,cacheKey:xt,annotationStorageSerializable:Pt}){const{map:St,transfers:Ct}=Pt,er=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:gt,cacheKey:xt,annotationStorage:St},Ct).getReader(),Kt=this._intentStates.get(xt);Kt.streamReader=er;const nr=()=>{er.read().then(({value:Jt,done:qt})=>{if(qt){Kt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Jt,Kt),nr())},Jt=>{if(Kt.streamReader=null,!this._transport.destroyed){if(Kt.operatorList){Kt.operatorList.lastChunk=!0;for(const qt of Kt.renderTasks)qt.operatorListChanged();or(this,c,Un).call(this,!0)}if(Kt.displayReadyCapability)Kt.displayReadyCapability.reject(Jt);else if(Kt.opListReadCapability)Kt.opListReadCapability.reject(Jt);else throw Jt}})};nr()}_abortOperatorList({intentState:gt,reason:xt,force:Pt=!1}){if(gt.streamReader){if(gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null),!Pt){if(gt.renderTasks.size>0)return;if(xt instanceof _display_utils.RenderingCancelledException){let St=RENDERING_CANCELLED_TIMEOUT;xt.extraDelay>0&&xt.extraDelay<1e3&&(St+=xt.extraDelay),gt.streamReaderCancelTimeout=setTimeout(()=>{gt.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:gt,reason:xt,force:!0})},St);return}}if(gt.streamReader.cancel(new _util.AbortException(xt.message)).catch(()=>{}),gt.streamReader=null,!this._transport.destroyed){for(const[St,Ct]of this._intentStates)if(Ct===gt){this._intentStates.delete(St);break}this.cleanup()}}}get stats(){return this._stats}}s=new WeakMap,a=new WeakMap,c=new WeakSet,Un=function(gt=!1){if(or(this,c,us).call(this),!ft(this,a)||this.destroyed)return!1;if(gt)return lr(this,s,setTimeout(()=>{lr(this,s,null),or(this,c,Un).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:xt,operatorList:Pt}of this._intentStates.values())if(xt.size>0||!Pt.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),lr(this,a,!1),!0},us=function(){ft(this,s)&&(clearTimeout(ft(this,s)),lr(this,s,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){cr(this,g,new Set);cr(this,_,Promise.resolve())}postMessage(gt,xt){const Pt={data:structuredClone(gt,xt?{transfer:xt}:null)};ft(this,_).then(()=>{for(const St of ft(this,g))St.call(this,Pt)})}addEventListener(gt,xt){ft(this,g).add(xt)}removeEventListener(gt,xt){ft(this,g).delete(xt)}terminate(){ft(this,g).clear()}}g=new WeakMap,_=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const ut=(b=document==null?void 0:document.currentScript)==null?void 0:b.src;ut&&(PDFWorkerUtil.fallbackWorkerSrc=ut.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(ut,gt){let xt;try{if(xt=new URL(ut),!xt.origin||xt.origin==="null")return!1}catch{return!1}const Pt=new URL(gt,xt);return xt.origin===Pt.origin},PDFWorkerUtil.createCDNWrapper=function(ut){const gt=`importScripts("${ut}");`;return URL.createObjectURL(new Blob([gt]))}}const _PDFWorker=class _PDFWorker{constructor({name:ut=null,port:gt=null,verbosity:xt=(0,_util.getVerbosityLevel)()}={}){var Pt;if(this.name=ut,this.destroyed=!1,this.verbosity=xt,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,gt){if((Pt=ft(_PDFWorker,_e))!=null&&Pt.has(gt))throw new Error("Cannot use more than one PDFWorker per port.");(ft(_PDFWorker,_e)||lr(_PDFWorker,_e,new WeakMap)).set(gt,this),this._initializeFromPort(gt);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(ut){this._port=ut,this._messageHandler=new _message_handler.MessageHandler("main","worker",ut),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:ut}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,ut)||(ut=PDFWorkerUtil.createCDNWrapper(new URL(ut,window.location).href));const gt=new Worker(ut),xt=new _message_handler.MessageHandler("main","worker",gt),Pt=()=>{gt.removeEventListener("error",St),xt.destroy(),gt.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},St=()=>{this._webWorker||Pt()};gt.addEventListener("error",St),xt.on("test",Lt=>{if(gt.removeEventListener("error",St),this.destroyed){Pt();return}Lt?(this._messageHandler=xt,this._port=gt,this._webWorker=gt,this._readyCapability.resolve(),xt.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),xt.destroy(),gt.terminate())}),xt.on("ready",Lt=>{if(gt.removeEventListener("error",St),this.destroyed){Pt();return}try{Ct()}catch{this._setupFakeWorker()}});const Ct=()=>{const Lt=new Uint8Array;xt.send("test",Lt,[Lt.buffer])};Ct();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(ut=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const gt=new LoopbackPort;this._port=gt;const xt=`fake${PDFWorkerUtil.fakeWorkerId++}`,Pt=new _message_handler.MessageHandler(xt+"_worker",xt,gt);ut.setup(Pt,gt);const St=new _message_handler.MessageHandler(xt,xt+"_worker",gt);this._messageHandler=St,this._readyCapability.resolve(),St.send("configure",{verbosity:this.verbosity})}).catch(ut=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${ut.message}".`))})}destroy(){var ut;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(ut=ft(_PDFWorker,_e))==null||ut.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(ut){var xt;if(!(ut!=null&&ut.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const gt=(xt=ft(this,_e))==null?void 0:xt.get(ut.port);if(gt){if(gt._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return gt}return new _PDFWorker(ut)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var ut;try{return((ut=globalThis.pdfjsWorker)==null?void 0:ut.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};_e=new WeakMap,cr(_PDFWorker,_e);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(gt,xt,Pt,St,Ct){cr(this,rt);cr(this,nt,new Map);cr(this,it,new Map);cr(this,et,new Map);cr(this,lt,null);this.messageHandler=gt,this.loadingTask=xt,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:St.ownerDocument,styleElement:St.styleElement}),this._params=St,this.canvasFactory=Ct.canvasFactory,this.filterFactory=Ct.filterFactory,this.cMapReaderFactory=Ct.cMapReaderFactory,this.standardFontDataFactory=Ct.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Pt,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(gt,xt=_util.AnnotationMode.ENABLE,Pt=null,St=!1){let Ct=_util.RenderingIntentFlag.DISPLAY,Lt=_annotation_storage.SerializableEmpty;switch(gt){case"any":Ct=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Ct=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${gt}`)}switch(xt){case _util.AnnotationMode.DISABLE:Ct+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Ct+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Ct+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Lt=(Ct&_util.RenderingIntentFlag.PRINT&&Pt instanceof _annotation_storage.PrintAnnotationStorage?Pt:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${xt}`)}return St&&(Ct+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Ct,cacheKey:`${Ct}_${Lt.hash}`,annotationStorageSerializable:Lt}}destroy(){var Pt;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(Pt=ft(this,lt))==null||Pt.reject(new Error("Worker was destroyed during onPassword callback"));const gt=[];for(const St of ft(this,it).values())gt.push(St._destroy());ft(this,it).clear(),ft(this,et).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const xt=this.messageHandler.sendWithPromise("Terminate",null);return gt.push(xt),Promise.all(gt).then(()=>{var St;this.commonObjs.clear(),this.fontLoader.clear(),ft(this,nt).clear(),this.filterFactory.destroy(),(St=this._networkStream)==null||St.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:gt,loadingTask:xt}=this;gt.on("GetReader",(Pt,St)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Ct=>{this._lastProgress={loaded:Ct.loaded,total:Ct.total}},St.onPull=()=>{this._fullReader.read().then(function({value:Ct,done:Lt}){if(Lt){St.close();return}(0,_util.assert)(Ct instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),St.enqueue(new Uint8Array(Ct),1,[Ct])}).catch(Ct=>{St.error(Ct)})},St.onCancel=Ct=>{this._fullReader.cancel(Ct),St.ready.catch(Lt=>{if(!this.destroyed)throw Lt})}}),gt.on("ReaderHeadersReady",Pt=>{const St=new _util.PromiseCapability,Ct=this._fullReader;return Ct.headersReady.then(()=>{var Lt;(!Ct.isStreamingSupported||!Ct.isRangeSupported)&&(this._lastProgress&&((Lt=xt.onProgress)==null||Lt.call(xt,this._lastProgress)),Ct.onProgress=er=>{var Kt;(Kt=xt.onProgress)==null||Kt.call(xt,{loaded:er.loaded,total:er.total})}),St.resolve({isStreamingSupported:Ct.isStreamingSupported,isRangeSupported:Ct.isRangeSupported,contentLength:Ct.contentLength})},St.reject),St.promise}),gt.on("GetRangeReader",(Pt,St)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Ct=this._networkStream.getRangeReader(Pt.begin,Pt.end);if(!Ct){St.close();return}St.onPull=()=>{Ct.read().then(function({value:Lt,done:er}){if(er){St.close();return}(0,_util.assert)(Lt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),St.enqueue(new Uint8Array(Lt),1,[Lt])}).catch(Lt=>{St.error(Lt)})},St.onCancel=Lt=>{Ct.cancel(Lt),St.ready.catch(er=>{if(!this.destroyed)throw er})}}),gt.on("GetDoc",({pdfInfo:Pt})=>{this._numPages=Pt.numPages,this._htmlForXfa=Pt.htmlForXfa,delete Pt.htmlForXfa,xt._capability.resolve(new PDFDocumentProxy(Pt,this))}),gt.on("DocException",function(Pt){let St;switch(Pt.name){case"PasswordException":St=new _util.PasswordException(Pt.message,Pt.code);break;case"InvalidPDFException":St=new _util.InvalidPDFException(Pt.message);break;case"MissingPDFException":St=new _util.MissingPDFException(Pt.message);break;case"UnexpectedResponseException":St=new _util.UnexpectedResponseException(Pt.message,Pt.status);break;case"UnknownErrorException":St=new _util.UnknownErrorException(Pt.message,Pt.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}xt._capability.reject(St)}),gt.on("PasswordRequest",Pt=>{if(lr(this,lt,new _util.PromiseCapability),xt.onPassword){const St=Ct=>{Ct instanceof Error?ft(this,lt).reject(Ct):ft(this,lt).resolve({password:Ct})};try{xt.onPassword(St,Pt.code)}catch(Ct){ft(this,lt).reject(Ct)}}else ft(this,lt).reject(new _util.PasswordException(Pt.message,Pt.code));return ft(this,lt).promise}),gt.on("DataLoaded",Pt=>{var St;(St=xt.onProgress)==null||St.call(xt,{loaded:Pt.length,total:Pt.length}),this.downloadInfoCapability.resolve(Pt)}),gt.on("StartRenderPage",Pt=>{if(this.destroyed)return;ft(this,it).get(Pt.pageIndex)._startRenderPage(Pt.transparency,Pt.cacheKey)}),gt.on("commonobj",([Pt,St,Ct])=>{var Lt;if(!this.destroyed&&!this.commonObjs.has(Pt))switch(St){case"Font":const er=this._params;if("error"in Ct){const Jt=Ct.error;(0,_util.warn)(`Error during font loading: ${Jt}`),this.commonObjs.resolve(Pt,Jt);break}const Kt=er.pdfBug&&((Lt=globalThis.FontInspector)!=null&&Lt.enabled)?(Jt,qt)=>globalThis.FontInspector.fontAdded(Jt,qt):null,nr=new _font_loader.FontFaceObject(Ct,{isEvalSupported:er.isEvalSupported,disableFontFace:er.disableFontFace,ignoreErrors:er.ignoreErrors,inspectFont:Kt});this.fontLoader.bind(nr).catch(Jt=>gt.sendWithPromise("FontFallback",{id:Pt})).finally(()=>{!er.fontExtraProperties&&nr.data&&(nr.data=null),this.commonObjs.resolve(Pt,nr)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Pt,Ct);break;default:throw new Error(`Got unknown common object type ${St}`)}}),gt.on("obj",([Pt,St,Ct,Lt])=>{var Kt;if(this.destroyed)return;const er=ft(this,it).get(St);if(!er.objs.has(Pt))switch(Ct){case"Image":if(er.objs.resolve(Pt,Lt),Lt){let nr;if(Lt.bitmap){const{width:Jt,height:qt}=Lt;nr=Jt*qt*4}else nr=((Kt=Lt.data)==null?void 0:Kt.length)||0;nr>_util.MAX_IMAGE_SIZE_TO_CACHE&&(er._maybeCleanupAfterRender=!0)}break;case"Pattern":er.objs.resolve(Pt,Lt);break;default:throw new Error(`Got unknown object type ${Ct}`)}}),gt.on("DocProgress",Pt=>{var St;this.destroyed||(St=xt.onProgress)==null||St.call(xt,{loaded:Pt.loaded,total:Pt.total})}),gt.on("FetchBuiltInCMap",Pt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Pt):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),gt.on("FetchStandardFontData",Pt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Pt):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Pt;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:gt,transfers:xt}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:gt,filename:((Pt=this._fullReader)==null?void 0:Pt.filename)??null},xt).finally(()=>{this.annotationStorage.resetModified()})}getPage(gt){if(!Number.isInteger(gt)||gt<=0||gt>this._numPages)return Promise.reject(new Error("Invalid page request."));const xt=gt-1,Pt=ft(this,et).get(xt);if(Pt)return Pt;const St=this.messageHandler.sendWithPromise("GetPage",{pageIndex:xt}).then(Ct=>{if(this.destroyed)throw new Error("Transport destroyed");const Lt=new PDFPageProxy(xt,Ct,this,this._params.pdfBug);return ft(this,it).set(xt,Lt),Lt});return ft(this,et).set(xt,St),St}getPageIndex(gt){return typeof gt!="object"||gt===null||!Number.isInteger(gt.num)||gt.num<0||!Number.isInteger(gt.gen)||gt.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:gt.num,gen:gt.gen})}getAnnotations(gt,xt){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:gt,intent:xt})}getFieldObjects(){return or(this,rt,fs).call(this,"GetFieldObjects")}hasJSActions(){return or(this,rt,fs).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(gt){return typeof gt!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:gt})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return or(this,rt,fs).call(this,"GetDocJSActions")}getPageJSActions(gt){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:gt})}getStructTree(gt){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:gt})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(gt=>new _optional_content_config.OptionalContentConfig(gt))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const gt="GetMetadata",xt=ft(this,nt).get(gt);if(xt)return xt;const Pt=this.messageHandler.sendWithPromise(gt,null).then(St=>{var Ct,Lt;return{info:St[0],metadata:St[1]?new _metadata.Metadata(St[1]):null,contentDispositionFilename:((Ct=this._fullReader)==null?void 0:Ct.filename)??null,contentLength:((Lt=this._fullReader)==null?void 0:Lt.contentLength)??null}});return ft(this,nt).set(gt,Pt),Pt}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(gt=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const xt of ft(this,it).values())if(!xt.cleanup())throw new Error(`startCleanup: Page ${xt.pageNumber} is currently rendering.`);this.commonObjs.clear(),gt||this.fontLoader.clear(),ft(this,nt).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:gt,enableXfa:xt}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:gt,enableXfa:xt})}}nt=new WeakMap,it=new WeakMap,et=new WeakMap,lt=new WeakMap,rt=new WeakSet,fs=function(gt,xt=null){const Pt=ft(this,nt).get(gt);if(Pt)return Pt;const St=this.messageHandler.sendWithPromise(gt,xt);return ft(this,nt).set(gt,St),St};class PDFObjects{constructor(){cr(this,st);cr(this,ot,Object.create(null))}get(gt,xt=null){if(xt){const St=or(this,st,bs).call(this,gt);return St.capability.promise.then(()=>xt(St.data)),null}const Pt=ft(this,ot)[gt];if(!(Pt!=null&&Pt.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${gt}.`);return Pt.data}has(gt){const xt=ft(this,ot)[gt];return(xt==null?void 0:xt.capability.settled)||!1}resolve(gt,xt=null){const Pt=or(this,st,bs).call(this,gt);Pt.data=xt,Pt.capability.resolve()}clear(){var gt;for(const xt in ft(this,ot)){const{data:Pt}=ft(this,ot)[xt];(gt=Pt==null?void 0:Pt.bitmap)==null||gt.close()}lr(this,ot,Object.create(null))}}ot=new WeakMap,st=new WeakSet,bs=function(gt){var xt;return(xt=ft(this,ot))[gt]||(xt[gt]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(gt){cr(this,mt,null);lr(this,mt,gt),this.onContinue=null}get promise(){return ft(this,mt).capability.promise}cancel(gt=0){ft(this,mt).cancel(null,gt)}get separateAnnots(){const{separateAnnots:gt}=ft(this,mt).operatorList;if(!gt)return!1;const{annotationCanvasMap:xt}=ft(this,mt);return gt.form||gt.canvas&&(xt==null?void 0:xt.size)>0}}mt=new WeakMap,exports.RenderTask=RenderTask;const Et=class Et{constructor({callback:gt,params:xt,objs:Pt,commonObjs:St,annotationCanvasMap:Ct,operatorList:Lt,pageIndex:er,canvasFactory:Kt,filterFactory:nr,useRequestAnimationFrame:Jt=!1,pdfBug:qt=!1,pageColors:kt=null}){this.callback=gt,this.params=xt,this.objs=Pt,this.commonObjs=St,this.annotationCanvasMap=Ct,this.operatorListIdx=null,this.operatorList=Lt,this._pageIndex=er,this.canvasFactory=Kt,this.filterFactory=nr,this._pdfBug=qt,this.pageColors=kt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Jt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=xt.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:gt=!1,optionalContentConfig:xt}){var er,Kt;if(this.cancelled)return;if(this._canvas){if(ft(Et,pt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ft(Et,pt).add(this._canvas)}this._pdfBug&&((er=globalThis.StepperManager)!=null&&er.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Pt,viewport:St,transform:Ct,background:Lt}=this.params;this.gfx=new _canvas.CanvasGraphics(Pt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:xt},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Ct,viewport:St,transparency:gt,background:Lt}),this.operatorListIdx=0,this.graphicsReady=!0,(Kt=this.graphicsReadyCallback)==null||Kt.call(this)}cancel(gt=null,xt=0){var Pt;this.running=!1,this.cancelled=!0,(Pt=this.gfx)==null||Pt.endDrawing(),ft(Et,pt).delete(this._canvas),this.callback(gt||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,xt))}operatorListChanged(){var gt;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(gt=this.stepper)==null||gt.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ft(Et,pt).delete(this._canvas),this.callback())))}};pt=new WeakMap,cr(Et,pt,new WeakSet);let InternalRenderTask=Et;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(e,i,s)=>{var b,_e,nt,co,et;Object.defineProperty(i,"__esModule",{value:!0}),i.SerializableEmpty=i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var a=s(1),c=s(4),d=s(8);const h=Object.freeze({map:null,hash:"",transfers:void 0});i.SerializableEmpty=h;class g{constructor(){cr(this,nt);cr(this,b,!1);cr(this,_e,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(rt,at){const ot=ft(this,_e).get(rt);return ot===void 0?at:Object.assign(at,ot)}getRawValue(rt){return ft(this,_e).get(rt)}remove(rt){if(ft(this,_e).delete(rt),ft(this,_e).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const at of ft(this,_e).values())if(at instanceof c.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(rt,at){const ot=ft(this,_e).get(rt);let st=!1;if(ot!==void 0)for(const[ct,mt]of Object.entries(at))ot[ct]!==mt&&(st=!0,ot[ct]=mt);else st=!0,ft(this,_e).set(rt,at);st&&or(this,nt,co).call(this),at instanceof c.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(at.constructor._type)}has(rt){return ft(this,_e).has(rt)}getAll(){return ft(this,_e).size>0?(0,a.objectFromMap)(ft(this,_e)):null}setAll(rt){for(const[at,ot]of Object.entries(rt))this.setValue(at,ot)}get size(){return ft(this,_e).size}resetModified(){ft(this,b)&&(lr(this,b,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new _(this)}get serializable(){if(ft(this,_e).size===0)return h;const rt=new Map,at=new d.MurmurHash3_64,ot=[],st=Object.create(null);let ct=!1;for(const[mt,pt]of ft(this,_e)){const Et=pt instanceof c.AnnotationEditor?pt.serialize(!1,st):pt;Et&&(rt.set(mt,Et),at.update(`${mt}:${JSON.stringify(Et)}`),ct||(ct=!!Et.bitmap))}if(ct)for(const mt of rt.values())mt.bitmap&&ot.push(mt.bitmap);return rt.size>0?{map:rt,hash:at.hexdigest(),transfers:ot}:h}}b=new WeakMap,_e=new WeakMap,nt=new WeakSet,co=function(){ft(this,b)||(lr(this,b,!0),typeof this.onSetModified=="function"&&this.onSetModified())},i.AnnotationStorage=g;class _ extends g{constructor(at){super();cr(this,et);const{map:ot,hash:st,transfers:ct}=at.serializable,mt=structuredClone(ot,ct?{transfer:ct}:null);lr(this,et,{map:mt,hash:st,transfers:ct})}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return ft(this,et)}}et=new WeakMap,i.PrintAnnotationStorage=_},(e,i,s)=>{var _,b,_e,nt,it,et,lt,rt,at,ot,st,ct,mt,pt,Et,Cs,Rs,xt,Ps,ks,uo,fo,ho,Fs,po;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var a=s(5),c=s(1),d=s(6);const Jt=class Jt{constructor(kt){cr(this,Et);cr(this,_,"");cr(this,b,!1);cr(this,_e,null);cr(this,nt,null);cr(this,it,null);cr(this,et,!1);cr(this,lt,null);cr(this,rt,this.focusin.bind(this));cr(this,at,this.focusout.bind(this));cr(this,ot,!1);cr(this,st,!1);cr(this,ct,!1);an(this,"_initialOptions",Object.create(null));an(this,"_uiManager",null);an(this,"_focusEventsAllowed",!0);an(this,"_l10nPromise",null);cr(this,mt,!1);cr(this,pt,Jt._zIndex++);this.constructor===Jt&&(0,c.unreachable)("Cannot initialize AnnotationEditor."),this.parent=kt.parent,this.id=kt.id,this.width=this.height=null,this.pageIndex=kt.parent.pageIndex,this.name=kt.name,this.div=null,this._uiManager=kt.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=kt.isCentered,this._structTreeParentId=null;const{rotation:Xt,rawDims:{pageWidth:sr,pageHeight:At,pageX:ht,pageY:dt}}=this.parent.viewport;this.rotation=Xt,this.pageRotation=(360+Xt-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[sr,At],this.pageTranslation=[ht,dt];const[Tt,Mt]=this.parentDimensions;this.x=kt.x/Tt,this.y=kt.y/Mt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,c.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(kt){const Xt=new g({id:kt.parent.getNextId(),parent:kt.parent,uiManager:kt._uiManager});Xt.annotationElementId=kt.annotationElementId,Xt.deleted=!0,Xt._uiManager.addToAnnotationStorage(Xt)}static initialize(kt,Xt=null){if(Jt._l10nPromise||(Jt._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(At=>[At,kt.get(At)]))),Xt!=null&&Xt.strings)for(const At of Xt.strings)Jt._l10nPromise.set(At,kt.get(At));if(Jt._borderLineWidth!==-1)return;const sr=getComputedStyle(document.documentElement);Jt._borderLineWidth=parseFloat(sr.getPropertyValue("--outline-width"))||0}static updateDefaultParams(kt,Xt){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(kt){return!1}static paste(kt,Xt){(0,c.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return ft(this,mt)}set _isDraggable(kt){var Xt;lr(this,mt,kt),(Xt=this.div)==null||Xt.classList.toggle("draggable",kt)}center(){const[kt,Xt]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Xt/(kt*2),this.y+=this.width*kt/(Xt*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Xt/(kt*2),this.y-=this.width*kt/(Xt*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(kt){this._uiManager.addCommands(kt)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=ft(this,pt)}setParent(kt){kt!==null&&(this.pageIndex=kt.pageIndex,this.pageDimensions=kt.pageDimensions),this.parent=kt}focusin(kt){this._focusEventsAllowed&&(ft(this,ot)?lr(this,ot,!1):this.parent.setSelected(this))}focusout(kt){var sr;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Xt=kt.relatedTarget;Xt!=null&&Xt.closest(`#${this.id}`)||(kt.preventDefault(),(sr=this.parent)!=null&&sr.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(kt,Xt,sr,At){const[ht,dt]=this.parentDimensions;[sr,At]=this.screenToPageTranslation(sr,At),this.x=(kt+sr)/ht,this.y=(Xt+At)/dt,this.fixAndSetPosition()}translate(kt,Xt){or(this,Et,Cs).call(this,this.parentDimensions,kt,Xt)}translateInPage(kt,Xt){or(this,Et,Cs).call(this,this.pageDimensions,kt,Xt),this.div.scrollIntoView({block:"nearest"})}drag(kt,Xt){const[sr,At]=this.parentDimensions;if(this.x+=kt/sr,this.y+=Xt/At,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:It,y:Ut}=this.div.getBoundingClientRect();this.parent.findNewParent(this,It,Ut)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:ht,y:dt}=this;const[Tt,Mt]=or(this,Et,Rs).call(this);ht+=Tt,dt+=Mt,this.div.style.left=`${(100*ht).toFixed(2)}%`,this.div.style.top=`${(100*dt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[kt,Xt]=this.pageDimensions;let{x:sr,y:At,width:ht,height:dt}=this;switch(ht*=kt,dt*=Xt,sr*=kt,At*=Xt,this.rotation){case 0:sr=Math.max(0,Math.min(kt-ht,sr)),At=Math.max(0,Math.min(Xt-dt,At));break;case 90:sr=Math.max(0,Math.min(kt-dt,sr)),At=Math.min(Xt,Math.max(ht,At));break;case 180:sr=Math.min(kt,Math.max(ht,sr)),At=Math.min(Xt,Math.max(dt,At));break;case 270:sr=Math.min(kt,Math.max(dt,sr)),At=Math.max(0,Math.min(Xt-ht,At));break}this.x=sr/=kt,this.y=At/=Xt;const[Tt,Mt]=or(this,Et,Rs).call(this);sr+=Tt,At+=Mt;const{style:It}=this.div;It.left=`${(100*sr).toFixed(2)}%`,It.top=`${(100*At).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(kt,Xt){var sr;return or(sr=Jt,xt,Ps).call(sr,kt,Xt,this.parentRotation)}pageTranslationToScreen(kt,Xt){var sr;return or(sr=Jt,xt,Ps).call(sr,kt,Xt,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:kt,pageDimensions:[Xt,sr]}=this,At=Xt*kt,ht=sr*kt;return c.FeatureTest.isCSSRoundSupported?[Math.round(At),Math.round(ht)]:[At,ht]}setDims(kt,Xt){var ht;const[sr,At]=this.parentDimensions;this.div.style.width=`${(100*kt/sr).toFixed(2)}%`,ft(this,et)||(this.div.style.height=`${(100*Xt/At).toFixed(2)}%`),(ht=ft(this,_e))==null||ht.classList.toggle("small",kt<Jt.SMALL_EDITOR_SIZE||Xt<Jt.SMALL_EDITOR_SIZE)}fixDims(){const{style:kt}=this.div,{height:Xt,width:sr}=kt,At=sr.endsWith("%"),ht=!ft(this,et)&&Xt.endsWith("%");if(At&&ht)return;const[dt,Tt]=this.parentDimensions;At||(kt.width=`${(100*parseFloat(sr)/dt).toFixed(2)}%`),!ft(this,et)&&!ht&&(kt.height=`${(100*parseFloat(Xt)/Tt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(ft(this,_e))return;const kt=lr(this,_e,document.createElement("button"));kt.className="altText";const Xt=await Jt._l10nPromise.get("editor_alt_text_button_label");kt.textContent=Xt,kt.setAttribute("aria-label",Xt),kt.tabIndex="0",kt.addEventListener("contextmenu",d.noContextMenu),kt.addEventListener("pointerdown",sr=>sr.stopPropagation()),kt.addEventListener("click",sr=>{sr.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),kt.addEventListener("keydown",sr=>{sr.target===kt&&sr.key==="Enter"&&(sr.preventDefault(),this._uiManager.editAltText(this))}),or(this,Et,Fs).call(this),this.div.append(kt),Jt.SMALL_EDITOR_SIZE||(Jt.SMALL_EDITOR_SIZE=Math.min(128,Math.round(kt.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:ft(this,_),decorative:ft(this,b)}}set altTextData({altText:kt,decorative:Xt}){ft(this,_)===kt&&ft(this,b)===Xt||(lr(this,_,kt),lr(this,b,Xt),or(this,Et,Fs).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",ft(this,rt)),this.div.addEventListener("focusout",ft(this,at));const[kt,Xt]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Xt/kt).toFixed(2)}%`,this.div.style.maxHeight=`${(100*kt/Xt).toFixed(2)}%`);const[sr,At]=this.getInitialTranslation();return this.translate(sr,At),(0,a.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(kt){const{isMac:Xt}=c.FeatureTest.platform;if(kt.button!==0||kt.ctrlKey&&Xt){kt.preventDefault();return}lr(this,ot,!0),or(this,Et,po).call(this,kt)}moveInDOM(){var kt;(kt=this.parent)==null||kt.moveEditorInDOM(this)}_setParentAndPosition(kt,Xt,sr){kt.changeParent(this),this.x=Xt,this.y=sr,this.fixAndSetPosition()}getRect(kt,Xt){const sr=this.parentScale,[At,ht]=this.pageDimensions,[dt,Tt]=this.pageTranslation,Mt=kt/sr,It=Xt/sr,Ut=this.x*At,Zt=this.y*ht,rr=this.width*At,_r=this.height*ht;switch(this.rotation){case 0:return[Ut+Mt+dt,ht-Zt-It-_r+Tt,Ut+Mt+rr+dt,ht-Zt-It+Tt];case 90:return[Ut+It+dt,ht-Zt+Mt+Tt,Ut+It+_r+dt,ht-Zt+Mt+rr+Tt];case 180:return[Ut-Mt-rr+dt,ht-Zt+It+Tt,Ut-Mt+dt,ht-Zt+It+_r+Tt];case 270:return[Ut-It-_r+dt,ht-Zt-Mt-rr+Tt,Ut-It+dt,ht-Zt-Mt+Tt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(kt,Xt){const[sr,At,ht,dt]=kt,Tt=ht-sr,Mt=dt-At;switch(this.rotation){case 0:return[sr,Xt-dt,Tt,Mt];case 90:return[sr,Xt-At,Mt,Tt];case 180:return[ht,Xt-At,Tt,Mt];case 270:return[ht,Xt-dt,Mt,Tt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lr(this,ct,!0)}disableEditMode(){lr(this,ct,!1)}isInEditMode(){return ft(this,ct)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var kt,Xt;(kt=this.div)==null||kt.addEventListener("focusin",ft(this,rt)),(Xt=this.div)==null||Xt.addEventListener("focusout",ft(this,at))}serialize(kt=!1,Xt=null){(0,c.unreachable)("An editor must be serializable")}static deserialize(kt,Xt,sr){const At=new this.prototype.constructor({parent:Xt,id:Xt.getNextId(),uiManager:sr});At.rotation=kt.rotation;const[ht,dt]=At.pageDimensions,[Tt,Mt,It,Ut]=At.getRectInCurrentCoords(kt.rect,dt);return At.x=Tt/ht,At.y=Mt/dt,At.width=It/ht,At.height=Ut/dt,At}remove(){var kt;this.div.removeEventListener("focusin",ft(this,rt)),this.div.removeEventListener("focusout",ft(this,at)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(kt=ft(this,_e))==null||kt.remove(),lr(this,_e,null),lr(this,nt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(or(this,Et,uo).call(this),ft(this,lt).classList.remove("hidden"))}select(){var kt;this.makeResizable(),(kt=this.div)==null||kt.classList.add("selectedEditor")}unselect(){var kt,Xt,sr;(kt=ft(this,lt))==null||kt.classList.add("hidden"),(Xt=this.div)==null||Xt.classList.remove("selectedEditor"),(sr=this.div)!=null&&sr.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(kt,Xt){}disableEditing(){ft(this,_e)&&(ft(this,_e).hidden=!0)}enableEditing(){ft(this,_e)&&(ft(this,_e).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return ft(this,st)}set isEditing(kt){lr(this,st,kt),this.parent&&(kt?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(kt,Xt){lr(this,et,!0);const sr=kt/Xt,{style:At}=this.div;At.aspectRatio=sr,At.height="auto"}static get MIN_SIZE(){return 16}};_=new WeakMap,b=new WeakMap,_e=new WeakMap,nt=new WeakMap,it=new WeakMap,et=new WeakMap,lt=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakMap,st=new WeakMap,ct=new WeakMap,mt=new WeakMap,pt=new WeakMap,Et=new WeakSet,Cs=function([kt,Xt],sr,At){[sr,At]=this.screenToPageTranslation(sr,At),this.x+=sr/kt,this.y+=At/Xt,this.fixAndSetPosition()},Rs=function(){const[kt,Xt]=this.parentDimensions,{_borderLineWidth:sr}=Jt,At=sr/kt,ht=sr/Xt;switch(this.rotation){case 90:return[-At,ht];case 180:return[At,ht];case 270:return[At,-ht];default:return[-At,-ht]}},xt=new WeakSet,Ps=function(kt,Xt,sr){switch(sr){case 90:return[Xt,-kt];case 180:return[-kt,-Xt];case 270:return[-Xt,kt];default:return[kt,Xt]}},ks=function(kt){switch(kt){case 90:{const[Xt,sr]=this.pageDimensions;return[0,-Xt/sr,sr/Xt,0]}case 180:return[-1,0,0,-1];case 270:{const[Xt,sr]=this.pageDimensions;return[0,Xt/sr,-sr/Xt,0]}default:return[1,0,0,1]}},uo=function(){if(ft(this,lt))return;lr(this,lt,document.createElement("div")),ft(this,lt).classList.add("resizers");const kt=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||kt.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Xt of kt){const sr=document.createElement("div");ft(this,lt).append(sr),sr.classList.add("resizer",Xt),sr.addEventListener("pointerdown",or(this,Et,fo).bind(this,Xt)),sr.addEventListener("contextmenu",d.noContextMenu)}this.div.prepend(ft(this,lt))},fo=function(kt,Xt){Xt.preventDefault();const{isMac:sr}=c.FeatureTest.platform;if(Xt.button!==0||Xt.ctrlKey&&sr)return;const At=or(this,Et,ho).bind(this,kt),ht=this._isDraggable;this._isDraggable=!1;const dt={passive:!0,capture:!0};window.addEventListener("pointermove",At,dt);const Tt=this.x,Mt=this.y,It=this.width,Ut=this.height,Zt=this.parent.div.style.cursor,rr=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Xt.target).cursor;const _r=()=>{this._isDraggable=ht,window.removeEventListener("pointerup",_r),window.removeEventListener("blur",_r),window.removeEventListener("pointermove",At,dt),this.parent.div.style.cursor=Zt,this.div.style.cursor=rr;const pr=this.x,Ar=this.y,Sr=this.width,Fr=this.height;pr===Tt&&Ar===Mt&&Sr===It&&Fr===Ut||this.addCommands({cmd:()=>{this.width=Sr,this.height=Fr,this.x=pr,this.y=Ar;const[ur,ir]=this.parentDimensions;this.setDims(ur*Sr,ir*Fr),this.fixAndSetPosition()},undo:()=>{this.width=It,this.height=Ut,this.x=Tt,this.y=Mt;const[ur,ir]=this.parentDimensions;this.setDims(ur*It,ir*Ut),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",_r),window.addEventListener("blur",_r)},ho=function(kt,Xt){const[sr,At]=this.parentDimensions,ht=this.x,dt=this.y,Tt=this.width,Mt=this.height,It=Jt.MIN_SIZE/sr,Ut=Jt.MIN_SIZE/At,Zt=Vr=>Math.round(Vr*1e4)/1e4,rr=or(this,Et,ks).call(this,this.rotation),_r=(Vr,Kr)=>[rr[0]*Vr+rr[2]*Kr,rr[1]*Vr+rr[3]*Kr],pr=or(this,Et,ks).call(this,360-this.rotation),Ar=(Vr,Kr)=>[pr[0]*Vr+pr[2]*Kr,pr[1]*Vr+pr[3]*Kr];let Sr,Fr,ur=!1,ir=!1;switch(kt){case"topLeft":ur=!0,Sr=(Vr,Kr)=>[0,0],Fr=(Vr,Kr)=>[Vr,Kr];break;case"topMiddle":Sr=(Vr,Kr)=>[Vr/2,0],Fr=(Vr,Kr)=>[Vr/2,Kr];break;case"topRight":ur=!0,Sr=(Vr,Kr)=>[Vr,0],Fr=(Vr,Kr)=>[0,Kr];break;case"middleRight":ir=!0,Sr=(Vr,Kr)=>[Vr,Kr/2],Fr=(Vr,Kr)=>[0,Kr/2];break;case"bottomRight":ur=!0,Sr=(Vr,Kr)=>[Vr,Kr],Fr=(Vr,Kr)=>[0,0];break;case"bottomMiddle":Sr=(Vr,Kr)=>[Vr/2,Kr],Fr=(Vr,Kr)=>[Vr/2,0];break;case"bottomLeft":ur=!0,Sr=(Vr,Kr)=>[0,Kr],Fr=(Vr,Kr)=>[Vr,0];break;case"middleLeft":ir=!0,Sr=(Vr,Kr)=>[0,Kr/2],Fr=(Vr,Kr)=>[Vr,Kr/2];break}const Bt=Sr(Tt,Mt),Qt=Fr(Tt,Mt);let fr=_r(...Qt);const hr=Zt(ht+fr[0]),Tr=Zt(dt+fr[1]);let Mr=1,kr=1,[dr,Nr]=this.screenToPageTranslation(Xt.movementX,Xt.movementY);if([dr,Nr]=Ar(dr/sr,Nr/At),ur){const Vr=Math.hypot(Tt,Mt);Mr=kr=Math.max(Math.min(Math.hypot(Qt[0]-Bt[0]-dr,Qt[1]-Bt[1]-Nr)/Vr,1/Tt,1/Mt),It/Tt,Ut/Mt)}else ir?Mr=Math.max(It,Math.min(1,Math.abs(Qt[0]-Bt[0]-dr)))/Tt:kr=Math.max(Ut,Math.min(1,Math.abs(Qt[1]-Bt[1]-Nr)))/Mt;const Dr=Zt(Tt*Mr),Jr=Zt(Mt*kr);fr=_r(...Fr(Dr,Jr));const Qr=hr-fr[0],en=Tr-fr[1];this.width=Dr,this.height=Jr,this.x=Qr,this.y=en,this.setDims(sr*Dr,At*Jr),this.fixAndSetPosition()},Fs=async function(){var sr;const kt=ft(this,_e);if(!kt)return;if(!ft(this,_)&&!ft(this,b)){kt.classList.remove("done"),(sr=ft(this,nt))==null||sr.remove();return}Jt._l10nPromise.get("editor_alt_text_edit_button_label").then(At=>{kt.setAttribute("aria-label",At)});let Xt=ft(this,nt);if(!Xt){lr(this,nt,Xt=document.createElement("span")),Xt.className="tooltip",Xt.setAttribute("role","tooltip");const At=Xt.id=`alt-text-tooltip-${this.id}`;kt.setAttribute("aria-describedby",At);const ht=100;kt.addEventListener("mouseenter",()=>{lr(this,it,setTimeout(()=>{lr(this,it,null),ft(this,nt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},ht))}),kt.addEventListener("mouseleave",()=>{var dt;clearTimeout(ft(this,it)),lr(this,it,null),(dt=ft(this,nt))==null||dt.classList.remove("show")})}kt.classList.add("done"),Xt.innerText=ft(this,b)?await Jt._l10nPromise.get("editor_alt_text_decorative_tooltip"):ft(this,_),Xt.parentNode||kt.append(Xt)},po=function(kt){if(!this._isDraggable)return;const Xt=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let sr,At;Xt&&(sr={passive:!0,capture:!0},At=dt=>{const[Tt,Mt]=this.screenToPageTranslation(dt.movementX,dt.movementY);this._uiManager.dragSelectedEditors(Tt,Mt)},window.addEventListener("pointermove",At,sr));const ht=()=>{if(window.removeEventListener("pointerup",ht),window.removeEventListener("blur",ht),Xt&&window.removeEventListener("pointermove",At,sr),lr(this,ot,!1),!this._uiManager.endDragSession()){const{isMac:dt}=c.FeatureTest.platform;kt.ctrlKey&&!dt||kt.shiftKey||kt.metaKey&&dt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",ht),window.addEventListener("blur",ht)},cr(Jt,xt),an(Jt,"_borderLineWidth",-1),an(Jt,"_colorManager",new a.ColorManager),an(Jt,"_zIndex",1),an(Jt,"SMALL_EDITOR_SIZE",0);let h=Jt;i.AnnotationEditor=h;class g extends h{constructor(kt){super(kt),this.annotationElementId=kt.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,i,s)=>{var et,lt,rt,at,ot,Ms,mt,pt,Et,ut,gt,mo,St,Ct,Lt,er,Kt,nr,Jt,qt,kt,Xt,sr,At,ht,dt,Tt,Mt,It,Ut,Zt,rr,_r,pr,Ar,Sr,Fr,ur,ir,Bt,Qt,fr,hr,Tr,Mr,kr,dr,go,Os,Ls,ds,Ds,Is,pn,ts,_o,vo,Ns,rs,Bs;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=d,i.opacityToHex=h;var a=s(1),c=s(6);function d(Zr,tr,Rr){for(const Br of Rr)tr.addEventListener(Br,Zr[Br].bind(Zr))}function h(Zr){return Math.round(Math.min(255,Math.max(1,255*Zr))).toString(16).padStart(2,"0")}class g{constructor(){cr(this,et,0)}getId(){return`${a.AnnotationEditorPrefix}${Tn(this,et)._++}`}}et=new WeakMap;const ct=class ct{constructor(){cr(this,ot);cr(this,lt,(0,a.getUuid)());cr(this,rt,0);cr(this,at,null)}static get _isSVGFittingCanvas(){const tr='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Br=new OffscreenCanvas(1,3).getContext("2d"),zr=new Image;zr.src=tr;const Ir=zr.decode().then(()=>(Br.drawImage(zr,0,0,1,1,0,0,1,3),new Uint32Array(Br.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,a.shadow)(this,"_isSVGFittingCanvas",Ir)}async getFromFile(tr){const{lastModified:Rr,name:Br,size:zr,type:Ir}=tr;return or(this,ot,Ms).call(this,`${Rr}_${Br}_${zr}_${Ir}`,tr)}async getFromUrl(tr){return or(this,ot,Ms).call(this,tr,tr)}async getFromId(tr){ft(this,at)||lr(this,at,new Map);const Rr=ft(this,at).get(tr);return Rr?Rr.bitmap?(Rr.refCounter+=1,Rr):Rr.file?this.getFromFile(Rr.file):this.getFromUrl(Rr.url):null}getSvgUrl(tr){const Rr=ft(this,at).get(tr);return Rr!=null&&Rr.isSvg?Rr.svgUrl:null}deleteId(tr){ft(this,at)||lr(this,at,new Map);const Rr=ft(this,at).get(tr);Rr&&(Rr.refCounter-=1,Rr.refCounter===0&&(Rr.bitmap=null))}isValidId(tr){return tr.startsWith(`image_${ft(this,lt)}_`)}};lt=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakSet,Ms=async function(tr,Rr){ft(this,at)||lr(this,at,new Map);let Br=ft(this,at).get(tr);if(Br===null)return null;if(Br!=null&&Br.bitmap)return Br.refCounter+=1,Br;try{Br||(Br={bitmap:null,id:`image_${ft(this,lt)}_${Tn(this,rt)._++}`,refCounter:0,isSvg:!1});let zr;if(typeof Rr=="string"){Br.url=Rr;const Ir=await fetch(Rr);if(!Ir.ok)throw new Error(Ir.statusText);zr=await Ir.blob()}else zr=Br.file=Rr;if(zr.type==="image/svg+xml"){const Ir=ct._isSVGFittingCanvas,jr=new FileReader,Vt=new Image,$t=new Promise((ar,xr)=>{Vt.onload=()=>{Br.bitmap=Vt,Br.isSvg=!0,ar()},jr.onload=async()=>{const Er=Br.svgUrl=jr.result;Vt.src=await Ir?`${Er}#svgView(preserveAspectRatio(none))`:Er},Vt.onerror=jr.onerror=xr});jr.readAsDataURL(zr),await $t}else Br.bitmap=await createImageBitmap(zr);Br.refCounter=1}catch(zr){console.error(zr),Br=null}return ft(this,at).set(tr,Br),Br&&ft(this,at).set(Br.id,Br),Br};let _=ct;class b{constructor(tr=128){cr(this,mt,[]);cr(this,pt,!1);cr(this,Et);cr(this,ut,-1);lr(this,Et,tr)}add({cmd:tr,undo:Rr,mustExec:Br,type:zr=NaN,overwriteIfSameType:Ir=!1,keepUndo:jr=!1}){if(Br&&tr(),ft(this,pt))return;const Vt={cmd:tr,undo:Rr,type:zr};if(ft(this,ut)===-1){ft(this,mt).length>0&&(ft(this,mt).length=0),lr(this,ut,0),ft(this,mt).push(Vt);return}if(Ir&&ft(this,mt)[ft(this,ut)].type===zr){jr&&(Vt.undo=ft(this,mt)[ft(this,ut)].undo),ft(this,mt)[ft(this,ut)]=Vt;return}const $t=ft(this,ut)+1;$t===ft(this,Et)?ft(this,mt).splice(0,1):(lr(this,ut,$t),$t<ft(this,mt).length&&ft(this,mt).splice($t)),ft(this,mt).push(Vt)}undo(){ft(this,ut)!==-1&&(lr(this,pt,!0),ft(this,mt)[ft(this,ut)].undo(),lr(this,pt,!1),lr(this,ut,ft(this,ut)-1))}redo(){ft(this,ut)<ft(this,mt).length-1&&(lr(this,ut,ft(this,ut)+1),lr(this,pt,!0),ft(this,mt)[ft(this,ut)].cmd(),lr(this,pt,!1))}hasSomethingToUndo(){return ft(this,ut)!==-1}hasSomethingToRedo(){return ft(this,ut)<ft(this,mt).length-1}destroy(){lr(this,mt,null)}}mt=new WeakMap,pt=new WeakMap,Et=new WeakMap,ut=new WeakMap,i.CommandManager=b;class _e{constructor(tr){cr(this,gt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Rr}=a.FeatureTest.platform;for(const[Br,zr,Ir={}]of tr)for(const jr of Br){const Vt=jr.startsWith("mac+");Rr&&Vt?(this.callbacks.set(jr.slice(4),{callback:zr,options:Ir}),this.allKeys.add(jr.split("+").at(-1))):!Rr&&!Vt&&(this.callbacks.set(jr,{callback:zr,options:Ir}),this.allKeys.add(jr.split("+").at(-1)))}}exec(tr,Rr){if(!this.allKeys.has(Rr.key))return;const Br=this.callbacks.get(or(this,gt,mo).call(this,Rr));if(!Br)return;const{callback:zr,options:{bubbles:Ir=!1,args:jr=[],checker:Vt=null}}=Br;Vt&&!Vt(tr,Rr)||(zr.bind(tr,...jr)(),Ir||(Rr.stopPropagation(),Rr.preventDefault()))}}gt=new WeakSet,mo=function(tr){tr.altKey&&this.buffer.push("alt"),tr.ctrlKey&&this.buffer.push("ctrl"),tr.metaKey&&this.buffer.push("meta"),tr.shiftKey&&this.buffer.push("shift"),this.buffer.push(tr.key);const Rr=this.buffer.join("+");return this.buffer.length=0,Rr},i.KeyboardManager=_e;const Pt=class Pt{get _colors(){const tr=new Map([["CanvasText",null],["Canvas",null]]);return(0,c.getColorValues)(tr),(0,a.shadow)(this,"_colors",tr)}convert(tr){const Rr=(0,c.getRGB)(tr);if(!window.matchMedia("(forced-colors: active)").matches)return Rr;for(const[Br,zr]of this._colors)if(zr.every((Ir,jr)=>Ir===Rr[jr]))return Pt._colorsMapping.get(Br);return Rr}getHexCode(tr){const Rr=this._colors.get(tr);return Rr?a.Util.makeHexColor(...Rr):tr}};an(Pt,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let nt=Pt;i.ColorManager=nt;const rn=class rn{constructor(tr,Rr,Br,zr,Ir,jr){cr(this,dr);cr(this,St,null);cr(this,Ct,new Map);cr(this,Lt,new Map);cr(this,er,null);cr(this,Kt,null);cr(this,nr,new b);cr(this,Jt,0);cr(this,qt,new Set);cr(this,kt,null);cr(this,Xt,null);cr(this,sr,new Set);cr(this,At,null);cr(this,ht,new g);cr(this,dt,!1);cr(this,Tt,!1);cr(this,Mt,null);cr(this,It,a.AnnotationEditorType.NONE);cr(this,Ut,new Set);cr(this,Zt,null);cr(this,rr,this.blur.bind(this));cr(this,_r,this.focus.bind(this));cr(this,pr,this.copy.bind(this));cr(this,Ar,this.cut.bind(this));cr(this,Sr,this.paste.bind(this));cr(this,Fr,this.keydown.bind(this));cr(this,ur,this.onEditingAction.bind(this));cr(this,ir,this.onPageChanging.bind(this));cr(this,Bt,this.onScaleChanging.bind(this));cr(this,Qt,this.onRotationChanging.bind(this));cr(this,fr,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});cr(this,hr,[0,0]);cr(this,Tr,null);cr(this,Mr,null);cr(this,kr,null);lr(this,Mr,tr),lr(this,kr,Rr),lr(this,er,Br),this._eventBus=zr,this._eventBus._on("editingaction",ft(this,ur)),this._eventBus._on("pagechanging",ft(this,ir)),this._eventBus._on("scalechanging",ft(this,Bt)),this._eventBus._on("rotationchanging",ft(this,Qt)),lr(this,Kt,Ir.annotationStorage),lr(this,At,Ir.filterFactory),lr(this,Zt,jr),this.viewParameters={realScale:c.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const tr=rn.prototype,Rr=Ir=>{const{activeElement:jr}=document;return jr&&ft(Ir,Mr).contains(jr)&&Ir.hasSomethingToControl()},Br=this.TRANSLATE_SMALL,zr=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new _e([[["ctrl+a","mac+meta+a"],tr.selectAll],[["ctrl+z","mac+meta+z"],tr.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],tr.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],tr.delete],[["Escape","mac+Escape"],tr.unselectAll],[["ArrowLeft","mac+ArrowLeft"],tr.translateSelectedEditors,{args:[-Br,0],checker:Rr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],tr.translateSelectedEditors,{args:[-zr,0],checker:Rr}],[["ArrowRight","mac+ArrowRight"],tr.translateSelectedEditors,{args:[Br,0],checker:Rr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],tr.translateSelectedEditors,{args:[zr,0],checker:Rr}],[["ArrowUp","mac+ArrowUp"],tr.translateSelectedEditors,{args:[0,-Br],checker:Rr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],tr.translateSelectedEditors,{args:[0,-zr],checker:Rr}],[["ArrowDown","mac+ArrowDown"],tr.translateSelectedEditors,{args:[0,Br],checker:Rr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],tr.translateSelectedEditors,{args:[0,zr],checker:Rr}]]))}destroy(){or(this,dr,ds).call(this),or(this,dr,Os).call(this),this._eventBus._off("editingaction",ft(this,ur)),this._eventBus._off("pagechanging",ft(this,ir)),this._eventBus._off("scalechanging",ft(this,Bt)),this._eventBus._off("rotationchanging",ft(this,Qt));for(const tr of ft(this,Lt).values())tr.destroy();ft(this,Lt).clear(),ft(this,Ct).clear(),ft(this,sr).clear(),lr(this,St,null),ft(this,Ut).clear(),ft(this,nr).destroy(),ft(this,er).destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",ft(this,Zt)?ft(this,At).addHCMFilter(ft(this,Zt).foreground,ft(this,Zt).background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle(ft(this,Mr)).direction)}editAltText(tr){var Rr;(Rr=ft(this,er))==null||Rr.editAltText(this,tr)}onPageChanging({pageNumber:tr}){lr(this,Jt,tr-1)}focusMainContainer(){ft(this,Mr).focus()}findParent(tr,Rr){for(const Br of ft(this,Lt).values()){const{x:zr,y:Ir,width:jr,height:Vt}=Br.div.getBoundingClientRect();if(tr>=zr&&tr<=zr+jr&&Rr>=Ir&&Rr<=Ir+Vt)return Br}return null}disableUserSelect(tr=!1){ft(this,kr).classList.toggle("noUserSelect",tr)}addShouldRescale(tr){ft(this,sr).add(tr)}removeShouldRescale(tr){ft(this,sr).delete(tr)}onScaleChanging({scale:tr}){this.commitOrRemove(),this.viewParameters.realScale=tr*c.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Rr of ft(this,sr))Rr.onScaleChanging()}onRotationChanging({pagesRotation:tr}){this.commitOrRemove(),this.viewParameters.rotation=tr}addToAnnotationStorage(tr){!tr.isEmpty()&&ft(this,Kt)&&!ft(this,Kt).has(tr.id)&&ft(this,Kt).setValue(tr.id,tr)}blur(){if(!this.hasSelection)return;const{activeElement:tr}=document;for(const Rr of ft(this,Ut))if(Rr.div.contains(tr)){lr(this,Mt,[Rr,tr]),Rr._focusEventsAllowed=!1;break}}focus(){if(!ft(this,Mt))return;const[tr,Rr]=ft(this,Mt);lr(this,Mt,null),Rr.addEventListener("focusin",()=>{tr._focusEventsAllowed=!0},{once:!0}),Rr.focus()}addEditListeners(){or(this,dr,Ls).call(this),or(this,dr,Ds).call(this)}removeEditListeners(){or(this,dr,ds).call(this),or(this,dr,Is).call(this)}copy(tr){var Br;if(tr.preventDefault(),(Br=ft(this,St))==null||Br.commitOrRemove(),!this.hasSelection)return;const Rr=[];for(const zr of ft(this,Ut)){const Ir=zr.serialize(!0);Ir&&Rr.push(Ir)}Rr.length!==0&&tr.clipboardData.setData("application/pdfjs",JSON.stringify(Rr))}cut(tr){this.copy(tr),this.delete()}paste(tr){tr.preventDefault();const{clipboardData:Rr}=tr;for(const Ir of Rr.items)for(const jr of ft(this,Xt))if(jr.isHandlingMimeForPasting(Ir.type)){jr.paste(Ir,this.currentLayer);return}let Br=Rr.getData("application/pdfjs");if(!Br)return;try{Br=JSON.parse(Br)}catch(Ir){(0,a.warn)(`paste: "${Ir.message}".`);return}if(!Array.isArray(Br))return;this.unselectAll();const zr=this.currentLayer;try{const Ir=[];for(const $t of Br){const ar=zr.deserialize($t);if(!ar)return;Ir.push(ar)}const jr=()=>{for(const $t of Ir)or(this,dr,Ns).call(this,$t);or(this,dr,Bs).call(this,Ir)},Vt=()=>{for(const $t of Ir)$t.remove()};this.addCommands({cmd:jr,undo:Vt,mustExec:!0})}catch(Ir){(0,a.warn)(`paste: "${Ir.message}".`)}}keydown(tr){var Rr;(Rr=this.getActive())!=null&&Rr.shouldGetKeyboardEvents()||rn._keyboardManager.exec(this,tr)}onEditingAction(tr){["undo","redo","delete","selectAll"].includes(tr.name)&&this[tr.name]()}setEditingState(tr){tr?(or(this,dr,go).call(this),or(this,dr,Ls).call(this),or(this,dr,Ds).call(this),or(this,dr,pn).call(this,{isEditing:ft(this,It)!==a.AnnotationEditorType.NONE,isEmpty:or(this,dr,rs).call(this),hasSomethingToUndo:ft(this,nr).hasSomethingToUndo(),hasSomethingToRedo:ft(this,nr).hasSomethingToRedo(),hasSelectedEditor:!1})):(or(this,dr,Os).call(this),or(this,dr,ds).call(this),or(this,dr,Is).call(this),or(this,dr,pn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(tr){if(!ft(this,Xt)){lr(this,Xt,tr);for(const Rr of ft(this,Xt))or(this,dr,ts).call(this,Rr.defaultPropertiesToUpdate)}}getId(){return ft(this,ht).getId()}get currentLayer(){return ft(this,Lt).get(ft(this,Jt))}getLayer(tr){return ft(this,Lt).get(tr)}get currentPageIndex(){return ft(this,Jt)}addLayer(tr){ft(this,Lt).set(tr.pageIndex,tr),ft(this,dt)?tr.enable():tr.disable()}removeLayer(tr){ft(this,Lt).delete(tr.pageIndex)}updateMode(tr,Rr=null){if(ft(this,It)!==tr){if(lr(this,It,tr),tr===a.AnnotationEditorType.NONE){this.setEditingState(!1),or(this,dr,vo).call(this);return}this.setEditingState(!0),or(this,dr,_o).call(this),this.unselectAll();for(const Br of ft(this,Lt).values())Br.updateMode(tr);if(Rr){for(const Br of ft(this,Ct).values())if(Br.annotationElementId===Rr){this.setSelected(Br),Br.enterInEditMode();break}}}}updateToolbar(tr){tr!==ft(this,It)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:tr})}updateParams(tr,Rr){if(ft(this,Xt)){if(tr===a.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(tr);return}for(const Br of ft(this,Ut))Br.updateParams(tr,Rr);for(const Br of ft(this,Xt))Br.updateDefaultParams(tr,Rr)}}enableWaiting(tr=!1){if(ft(this,Tt)!==tr){lr(this,Tt,tr);for(const Rr of ft(this,Lt).values())tr?Rr.disableClick():Rr.enableClick(),Rr.div.classList.toggle("waiting",tr)}}getEditors(tr){const Rr=[];for(const Br of ft(this,Ct).values())Br.pageIndex===tr&&Rr.push(Br);return Rr}getEditor(tr){return ft(this,Ct).get(tr)}addEditor(tr){ft(this,Ct).set(tr.id,tr)}removeEditor(tr){var Rr;ft(this,Ct).delete(tr.id),this.unselect(tr),(!tr.annotationElementId||!ft(this,qt).has(tr.annotationElementId))&&((Rr=ft(this,Kt))==null||Rr.remove(tr.id))}addDeletedAnnotationElement(tr){ft(this,qt).add(tr.annotationElementId),tr.deleted=!0}isDeletedAnnotationElement(tr){return ft(this,qt).has(tr)}removeDeletedAnnotationElement(tr){ft(this,qt).delete(tr.annotationElementId),tr.deleted=!1}setActiveEditor(tr){ft(this,St)!==tr&&(lr(this,St,tr),tr&&or(this,dr,ts).call(this,tr.propertiesToUpdate))}toggleSelected(tr){if(ft(this,Ut).has(tr)){ft(this,Ut).delete(tr),tr.unselect(),or(this,dr,pn).call(this,{hasSelectedEditor:this.hasSelection});return}ft(this,Ut).add(tr),tr.select(),or(this,dr,ts).call(this,tr.propertiesToUpdate),or(this,dr,pn).call(this,{hasSelectedEditor:!0})}setSelected(tr){for(const Rr of ft(this,Ut))Rr!==tr&&Rr.unselect();ft(this,Ut).clear(),ft(this,Ut).add(tr),tr.select(),or(this,dr,ts).call(this,tr.propertiesToUpdate),or(this,dr,pn).call(this,{hasSelectedEditor:!0})}isSelected(tr){return ft(this,Ut).has(tr)}unselect(tr){tr.unselect(),ft(this,Ut).delete(tr),or(this,dr,pn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return ft(this,Ut).size!==0}undo(){ft(this,nr).undo(),or(this,dr,pn).call(this,{hasSomethingToUndo:ft(this,nr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:or(this,dr,rs).call(this)})}redo(){ft(this,nr).redo(),or(this,dr,pn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:ft(this,nr).hasSomethingToRedo(),isEmpty:or(this,dr,rs).call(this)})}addCommands(tr){ft(this,nr).add(tr),or(this,dr,pn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:or(this,dr,rs).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const tr=[...ft(this,Ut)],Rr=()=>{for(const zr of tr)zr.remove()},Br=()=>{for(const zr of tr)or(this,dr,Ns).call(this,zr)};this.addCommands({cmd:Rr,undo:Br,mustExec:!0})}commitOrRemove(){var tr;(tr=ft(this,St))==null||tr.commitOrRemove()}hasSomethingToControl(){return ft(this,St)||this.hasSelection}selectAll(){for(const tr of ft(this,Ut))tr.commit();or(this,dr,Bs).call(this,ft(this,Ct).values())}unselectAll(){if(ft(this,St)){ft(this,St).commitOrRemove();return}if(this.hasSelection){for(const tr of ft(this,Ut))tr.unselect();ft(this,Ut).clear(),or(this,dr,pn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(tr,Rr,Br=!1){if(Br||this.commitOrRemove(),!this.hasSelection)return;ft(this,hr)[0]+=tr,ft(this,hr)[1]+=Rr;const[zr,Ir]=ft(this,hr),jr=[...ft(this,Ut)],Vt=1e3;ft(this,Tr)&&clearTimeout(ft(this,Tr)),lr(this,Tr,setTimeout(()=>{lr(this,Tr,null),ft(this,hr)[0]=ft(this,hr)[1]=0,this.addCommands({cmd:()=>{for(const $t of jr)ft(this,Ct).has($t.id)&&$t.translateInPage(zr,Ir)},undo:()=>{for(const $t of jr)ft(this,Ct).has($t.id)&&$t.translateInPage(-zr,-Ir)},mustExec:!1})},Vt));for(const $t of jr)$t.translateInPage(tr,Rr)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),lr(this,kt,new Map);for(const tr of ft(this,Ut))ft(this,kt).set(tr,{savedX:tr.x,savedY:tr.y,savedPageIndex:tr.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!ft(this,kt))return!1;this.disableUserSelect(!1);const tr=ft(this,kt);lr(this,kt,null);let Rr=!1;for(const[{x:zr,y:Ir,pageIndex:jr},Vt]of tr)Vt.newX=zr,Vt.newY=Ir,Vt.newPageIndex=jr,Rr||(Rr=zr!==Vt.savedX||Ir!==Vt.savedY||jr!==Vt.savedPageIndex);if(!Rr)return!1;const Br=(zr,Ir,jr,Vt)=>{if(ft(this,Ct).has(zr.id)){const $t=ft(this,Lt).get(Vt);$t?zr._setParentAndPosition($t,Ir,jr):(zr.pageIndex=Vt,zr.x=Ir,zr.y=jr)}};return this.addCommands({cmd:()=>{for(const[zr,{newX:Ir,newY:jr,newPageIndex:Vt}]of tr)Br(zr,Ir,jr,Vt)},undo:()=>{for(const[zr,{savedX:Ir,savedY:jr,savedPageIndex:Vt}]of tr)Br(zr,Ir,jr,Vt)},mustExec:!0}),!0}dragSelectedEditors(tr,Rr){if(ft(this,kt))for(const Br of ft(this,kt).keys())Br.drag(tr,Rr)}rebuild(tr){if(tr.parent===null){const Rr=this.getLayer(tr.pageIndex);Rr?(Rr.changeParent(tr),Rr.addOrRebuild(tr)):(this.addEditor(tr),this.addToAnnotationStorage(tr),tr.rebuild())}else tr.parent.addOrRebuild(tr)}isActive(tr){return ft(this,St)===tr}getActive(){return ft(this,St)}getMode(){return ft(this,It)}get imageManager(){return(0,a.shadow)(this,"imageManager",new _)}};St=new WeakMap,Ct=new WeakMap,Lt=new WeakMap,er=new WeakMap,Kt=new WeakMap,nr=new WeakMap,Jt=new WeakMap,qt=new WeakMap,kt=new WeakMap,Xt=new WeakMap,sr=new WeakMap,At=new WeakMap,ht=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Mt=new WeakMap,It=new WeakMap,Ut=new WeakMap,Zt=new WeakMap,rr=new WeakMap,_r=new WeakMap,pr=new WeakMap,Ar=new WeakMap,Sr=new WeakMap,Fr=new WeakMap,ur=new WeakMap,ir=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,fr=new WeakMap,hr=new WeakMap,Tr=new WeakMap,Mr=new WeakMap,kr=new WeakMap,dr=new WeakSet,go=function(){window.addEventListener("focus",ft(this,_r)),window.addEventListener("blur",ft(this,rr))},Os=function(){window.removeEventListener("focus",ft(this,_r)),window.removeEventListener("blur",ft(this,rr))},Ls=function(){window.addEventListener("keydown",ft(this,Fr),{capture:!0})},ds=function(){window.removeEventListener("keydown",ft(this,Fr),{capture:!0})},Ds=function(){document.addEventListener("copy",ft(this,pr)),document.addEventListener("cut",ft(this,Ar)),document.addEventListener("paste",ft(this,Sr))},Is=function(){document.removeEventListener("copy",ft(this,pr)),document.removeEventListener("cut",ft(this,Ar)),document.removeEventListener("paste",ft(this,Sr))},pn=function(tr){Object.entries(tr).some(([Br,zr])=>ft(this,fr)[Br]!==zr)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(ft(this,fr),tr)})},ts=function(tr){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:tr})},_o=function(){if(!ft(this,dt)){lr(this,dt,!0);for(const tr of ft(this,Lt).values())tr.enable()}},vo=function(){if(this.unselectAll(),ft(this,dt)){lr(this,dt,!1);for(const tr of ft(this,Lt).values())tr.disable()}},Ns=function(tr){const Rr=ft(this,Lt).get(tr.pageIndex);Rr?Rr.addOrRebuild(tr):this.addEditor(tr)},rs=function(){if(ft(this,Ct).size===0)return!0;if(ft(this,Ct).size===1)for(const tr of ft(this,Ct).values())return tr.isEmpty();return!1},Bs=function(tr){ft(this,Ut).clear();for(const Rr of tr)Rr.isEmpty()||(ft(this,Ut).add(Rr),Rr.select());or(this,dr,pn).call(this,{hasSelectedEditor:!0})},an(rn,"TRANSLATE_SMALL",1),an(rn,"TRANSLATE_BIG",10);let it=rn;i.AnnotationEditorUIManager=it},(e,i,s)=>{var Jt,qt,kt,Xt,sr,At,ht,dt,Tt,Mt,It,Ut,$n,Wn,js,hs,ps,ns,is;Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=void 0,i.deprecated=ut,i.getColorValues=Ct,i.getCurrentTransform=Lt,i.getCurrentTransformInverse=er,i.getFilenameFromUrl=ot,i.getPdfFilenameFromUrl=st,i.getRGB=St,i.getXfaPageViewport=Pt,i.isDataScheme=rt,i.isPdfFile=at,i.isValidFetchUrl=mt,i.loadScript=Et,i.noContextMenu=pt,i.setLayerDimensions=Kt;var a=s(7),c=s(1);const d="http://www.w3.org/2000/svg",nr=class nr{};an(nr,"CSS",96),an(nr,"PDF",72),an(nr,"PDF_TO_CSS_UNITS",nr.CSS/nr.PDF);let h=nr;i.PixelsPerInch=h;class g extends a.BaseFilterFactory{constructor({docId:Bt,ownerDocument:Qt=globalThis.document}={}){super();cr(this,Ut);cr(this,Jt);cr(this,qt);cr(this,kt);cr(this,Xt);cr(this,sr);cr(this,At);cr(this,ht);cr(this,dt);cr(this,Tt);cr(this,Mt);cr(this,It,0);lr(this,kt,Bt),lr(this,Xt,Qt)}addFilter(Bt){if(!Bt)return"none";let Qt=ft(this,Ut,$n).get(Bt);if(Qt)return Qt;let fr,hr,Tr,Mr;if(Bt.length===1){const Dr=Bt[0],Jr=new Array(256);for(let Qr=0;Qr<256;Qr++)Jr[Qr]=Dr[Qr]/255;Mr=fr=hr=Tr=Jr.join(",")}else{const[Dr,Jr,Qr]=Bt,en=new Array(256),Vr=new Array(256),Kr=new Array(256);for(let tn=0;tn<256;tn++)en[tn]=Dr[tn]/255,Vr[tn]=Jr[tn]/255,Kr[tn]=Qr[tn]/255;fr=en.join(","),hr=Vr.join(","),Tr=Kr.join(","),Mr=`${fr}${hr}${Tr}`}if(Qt=ft(this,Ut,$n).get(Mr),Qt)return ft(this,Ut,$n).set(Bt,Qt),Qt;const kr=`g_${ft(this,kt)}_transfer_map_${Tn(this,It)._++}`,dr=`url(#${kr})`;ft(this,Ut,$n).set(Bt,dr),ft(this,Ut,$n).set(Mr,dr);const Nr=or(this,Ut,hs).call(this,kr);return or(this,Ut,ns).call(this,fr,hr,Tr,Nr),dr}addHCMFilter(Bt,Qt){var Jr;const fr=`${Bt}-${Qt}`;if(ft(this,At)===fr)return ft(this,ht);if(lr(this,At,fr),lr(this,ht,"none"),(Jr=ft(this,sr))==null||Jr.remove(),!Bt||!Qt)return ft(this,ht);const hr=or(this,Ut,is).call(this,Bt);Bt=c.Util.makeHexColor(...hr);const Tr=or(this,Ut,is).call(this,Qt);if(Qt=c.Util.makeHexColor(...Tr),ft(this,Ut,Wn).style.color="",Bt==="#000000"&&Qt==="#ffffff"||Bt===Qt)return ft(this,ht);const Mr=new Array(256);for(let Qr=0;Qr<=255;Qr++){const en=Qr/255;Mr[Qr]=en<=.03928?en/12.92:((en+.055)/1.055)**2.4}const kr=Mr.join(","),dr=`g_${ft(this,kt)}_hcm_filter`,Nr=lr(this,dt,or(this,Ut,hs).call(this,dr));or(this,Ut,ns).call(this,kr,kr,kr,Nr),or(this,Ut,js).call(this,Nr);const Dr=(Qr,en)=>{const Vr=hr[Qr]/255,Kr=Tr[Qr]/255,tn=new Array(en+1);for(let nn=0;nn<=en;nn++)tn[nn]=Vr+nn/en*(Kr-Vr);return tn.join(",")};return or(this,Ut,ns).call(this,Dr(0,5),Dr(1,5),Dr(2,5),Nr),lr(this,ht,`url(#${dr})`),ft(this,ht)}addHighlightHCMFilter(Bt,Qt,fr,hr){var Kr;const Tr=`${Bt}-${Qt}-${fr}-${hr}`;if(ft(this,Tt)===Tr)return ft(this,Mt);if(lr(this,Tt,Tr),lr(this,Mt,"none"),(Kr=ft(this,dt))==null||Kr.remove(),!Bt||!Qt)return ft(this,Mt);const[Mr,kr]=[Bt,Qt].map(or(this,Ut,is).bind(this));let dr=Math.round(.2126*Mr[0]+.7152*Mr[1]+.0722*Mr[2]),Nr=Math.round(.2126*kr[0]+.7152*kr[1]+.0722*kr[2]),[Dr,Jr]=[fr,hr].map(or(this,Ut,is).bind(this));Nr<dr&&([dr,Nr,Dr,Jr]=[Nr,dr,Jr,Dr]),ft(this,Ut,Wn).style.color="";const Qr=(tn,nn,Or)=>{const mr=new Array(256),vr=(Nr-dr)/Or,Hr=tn/255,rn=(nn-tn)/(255*Or);let Zr=0;for(let tr=0;tr<=Or;tr++){const Rr=Math.round(dr+tr*vr),Br=Hr+tr*rn;for(let zr=Zr;zr<=Rr;zr++)mr[zr]=Br;Zr=Rr+1}for(let tr=Zr;tr<256;tr++)mr[tr]=mr[Zr-1];return mr.join(",")},en=`g_${ft(this,kt)}_hcm_highlight_filter`,Vr=lr(this,dt,or(this,Ut,hs).call(this,en));return or(this,Ut,js).call(this,Vr),or(this,Ut,ns).call(this,Qr(Dr[0],Jr[0],5),Qr(Dr[1],Jr[1],5),Qr(Dr[2],Jr[2],5),Vr),lr(this,Mt,`url(#${en})`),ft(this,Mt)}destroy(Bt=!1){Bt&&(ft(this,ht)||ft(this,Mt))||(ft(this,qt)&&(ft(this,qt).parentNode.parentNode.remove(),lr(this,qt,null)),ft(this,Jt)&&(ft(this,Jt).clear(),lr(this,Jt,null)),lr(this,It,0))}}Jt=new WeakMap,qt=new WeakMap,kt=new WeakMap,Xt=new WeakMap,sr=new WeakMap,At=new WeakMap,ht=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Mt=new WeakMap,It=new WeakMap,Ut=new WeakSet,$n=function(){return ft(this,Jt)||lr(this,Jt,new Map)},Wn=function(){if(!ft(this,qt)){const Bt=ft(this,Xt).createElement("div"),{style:Qt}=Bt;Qt.visibility="hidden",Qt.contain="strict",Qt.width=Qt.height=0,Qt.position="absolute",Qt.top=Qt.left=0,Qt.zIndex=-1;const fr=ft(this,Xt).createElementNS(d,"svg");fr.setAttribute("width",0),fr.setAttribute("height",0),lr(this,qt,ft(this,Xt).createElementNS(d,"defs")),Bt.append(fr),fr.append(ft(this,qt)),ft(this,Xt).body.append(Bt)}return ft(this,qt)},js=function(Bt){const Qt=ft(this,Xt).createElementNS(d,"feColorMatrix");Qt.setAttribute("type","matrix"),Qt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Bt.append(Qt)},hs=function(Bt){const Qt=ft(this,Xt).createElementNS(d,"filter");return Qt.setAttribute("color-interpolation-filters","sRGB"),Qt.setAttribute("id",Bt),ft(this,Ut,Wn).append(Qt),Qt},ps=function(Bt,Qt,fr){const hr=ft(this,Xt).createElementNS(d,Qt);hr.setAttribute("type","discrete"),hr.setAttribute("tableValues",fr),Bt.append(hr)},ns=function(Bt,Qt,fr,hr){const Tr=ft(this,Xt).createElementNS(d,"feComponentTransfer");hr.append(Tr),or(this,Ut,ps).call(this,Tr,"feFuncR",Bt),or(this,Ut,ps).call(this,Tr,"feFuncG",Qt),or(this,Ut,ps).call(this,Tr,"feFuncB",fr)},is=function(Bt){return ft(this,Ut,Wn).style.color=Bt,St(getComputedStyle(ft(this,Ut,Wn)).getPropertyValue("color"))},i.DOMFilterFactory=g;class _ extends a.BaseCanvasFactory{constructor({ownerDocument:ir=globalThis.document}={}){super(),this._document=ir}_createCanvas(ir,Bt){const Qt=this._document.createElement("canvas");return Qt.width=ir,Qt.height=Bt,Qt}}i.DOMCanvasFactory=_;async function b(ur,ir=!1){if(mt(ur,document.baseURI)){const Bt=await fetch(ur);if(!Bt.ok)throw new Error(Bt.statusText);return ir?new Uint8Array(await Bt.arrayBuffer()):(0,c.stringToBytes)(await Bt.text())}return new Promise((Bt,Qt)=>{const fr=new XMLHttpRequest;fr.open("GET",ur,!0),ir&&(fr.responseType="arraybuffer"),fr.onreadystatechange=()=>{if(fr.readyState===XMLHttpRequest.DONE){if(fr.status===200||fr.status===0){let hr;if(ir&&fr.response?hr=new Uint8Array(fr.response):!ir&&fr.responseText&&(hr=(0,c.stringToBytes)(fr.responseText)),hr){Bt(hr);return}}Qt(new Error(fr.statusText))}},fr.send(null)})}class _e extends a.BaseCMapReaderFactory{_fetchData(ir,Bt){return b(ir,this.isCompressed).then(Qt=>({cMapData:Qt,compressionType:Bt}))}}i.DOMCMapReaderFactory=_e;class nt extends a.BaseStandardFontDataFactory{_fetchData(ir){return b(ir,!0)}}i.DOMStandardFontDataFactory=nt;class it extends a.BaseSVGFactory{_createSVG(ir){return document.createElementNS(d,ir)}}i.DOMSVGFactory=it;class et{constructor({viewBox:ir,scale:Bt,rotation:Qt,offsetX:fr=0,offsetY:hr=0,dontFlip:Tr=!1}){this.viewBox=ir,this.scale=Bt,this.rotation=Qt,this.offsetX=fr,this.offsetY=hr;const Mr=(ir[2]+ir[0])/2,kr=(ir[3]+ir[1])/2;let dr,Nr,Dr,Jr;switch(Qt%=360,Qt<0&&(Qt+=360),Qt){case 180:dr=-1,Nr=0,Dr=0,Jr=1;break;case 90:dr=0,Nr=1,Dr=1,Jr=0;break;case 270:dr=0,Nr=-1,Dr=-1,Jr=0;break;case 0:dr=1,Nr=0,Dr=0,Jr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Tr&&(Dr=-Dr,Jr=-Jr);let Qr,en,Vr,Kr;dr===0?(Qr=Math.abs(kr-ir[1])*Bt+fr,en=Math.abs(Mr-ir[0])*Bt+hr,Vr=(ir[3]-ir[1])*Bt,Kr=(ir[2]-ir[0])*Bt):(Qr=Math.abs(Mr-ir[0])*Bt+fr,en=Math.abs(kr-ir[1])*Bt+hr,Vr=(ir[2]-ir[0])*Bt,Kr=(ir[3]-ir[1])*Bt),this.transform=[dr*Bt,Nr*Bt,Dr*Bt,Jr*Bt,Qr-dr*Bt*Mr-Dr*Bt*kr,en-Nr*Bt*Mr-Jr*Bt*kr],this.width=Vr,this.height=Kr}get rawDims(){const{viewBox:ir}=this;return(0,c.shadow)(this,"rawDims",{pageWidth:ir[2]-ir[0],pageHeight:ir[3]-ir[1],pageX:ir[0],pageY:ir[1]})}clone({scale:ir=this.scale,rotation:Bt=this.rotation,offsetX:Qt=this.offsetX,offsetY:fr=this.offsetY,dontFlip:hr=!1}={}){return new et({viewBox:this.viewBox.slice(),scale:ir,rotation:Bt,offsetX:Qt,offsetY:fr,dontFlip:hr})}convertToViewportPoint(ir,Bt){return c.Util.applyTransform([ir,Bt],this.transform)}convertToViewportRectangle(ir){const Bt=c.Util.applyTransform([ir[0],ir[1]],this.transform),Qt=c.Util.applyTransform([ir[2],ir[3]],this.transform);return[Bt[0],Bt[1],Qt[0],Qt[1]]}convertToPdfPoint(ir,Bt){return c.Util.applyInverseTransform([ir,Bt],this.transform)}}i.PageViewport=et;class lt extends c.BaseException{constructor(ir,Bt=0){super(ir,"RenderingCancelledException"),this.extraDelay=Bt}}i.RenderingCancelledException=lt;function rt(ur){const ir=ur.length;let Bt=0;for(;Bt<ir&&ur[Bt].trim()==="";)Bt++;return ur.substring(Bt,Bt+5).toLowerCase()==="data:"}function at(ur){return typeof ur=="string"&&/\.pdf$/i.test(ur)}function ot(ur,ir=!1){return ir||([ur]=ur.split(/[#?]/,1)),ur.substring(ur.lastIndexOf("/")+1)}function st(ur,ir="document.pdf"){if(typeof ur!="string")return ir;if(rt(ur))return(0,c.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),ir;const Bt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Qt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,fr=Bt.exec(ur);let hr=Qt.exec(fr[1])||Qt.exec(fr[2])||Qt.exec(fr[3]);if(hr&&(hr=hr[0],hr.includes("%")))try{hr=Qt.exec(decodeURIComponent(hr))[0]}catch{}return hr||ir}class ct{constructor(){an(this,"started",Object.create(null));an(this,"times",[])}time(ir){ir in this.started&&(0,c.warn)(`Timer is already running for ${ir}`),this.started[ir]=Date.now()}timeEnd(ir){ir in this.started||(0,c.warn)(`Timer has not been started for ${ir}`),this.times.push({name:ir,start:this.started[ir],end:Date.now()}),delete this.started[ir]}toString(){const ir=[];let Bt=0;for(const{name:Qt}of this.times)Bt=Math.max(Qt.length,Bt);for(const{name:Qt,start:fr,end:hr}of this.times)ir.push(`${Qt.padEnd(Bt)} ${hr-fr}ms
`);return ir.join("")}}i.StatTimer=ct;function mt(ur,ir){try{const{protocol:Bt}=ir?new URL(ur,ir):new URL(ur);return Bt==="http:"||Bt==="https:"}catch{return!1}}function pt(ur){ur.preventDefault()}function Et(ur,ir=!1){return new Promise((Bt,Qt)=>{const fr=document.createElement("script");fr.src=ur,fr.onload=function(hr){ir&&fr.remove(),Bt(hr)},fr.onerror=function(){Qt(new Error(`Cannot load script at: ${fr.src}`))},(document.head||document.documentElement).append(fr)})}function ut(ur){console.log("Deprecated API usage: "+ur)}let gt;class xt{static toDateObject(ir){if(!ir||typeof ir!="string")return null;gt||(gt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Bt=gt.exec(ir);if(!Bt)return null;const Qt=parseInt(Bt[1],10);let fr=parseInt(Bt[2],10);fr=fr>=1&&fr<=12?fr-1:0;let hr=parseInt(Bt[3],10);hr=hr>=1&&hr<=31?hr:1;let Tr=parseInt(Bt[4],10);Tr=Tr>=0&&Tr<=23?Tr:0;let Mr=parseInt(Bt[5],10);Mr=Mr>=0&&Mr<=59?Mr:0;let kr=parseInt(Bt[6],10);kr=kr>=0&&kr<=59?kr:0;const dr=Bt[7]||"Z";let Nr=parseInt(Bt[8],10);Nr=Nr>=0&&Nr<=23?Nr:0;let Dr=parseInt(Bt[9],10)||0;return Dr=Dr>=0&&Dr<=59?Dr:0,dr==="-"?(Tr+=Nr,Mr+=Dr):dr==="+"&&(Tr-=Nr,Mr-=Dr),new Date(Date.UTC(Qt,fr,hr,Tr,Mr,kr))}}i.PDFDateString=xt;function Pt(ur,{scale:ir=1,rotation:Bt=0}){const{width:Qt,height:fr}=ur.attributes.style,hr=[0,0,parseInt(Qt),parseInt(fr)];return new et({viewBox:hr,scale:ir,rotation:Bt})}function St(ur){if(ur.startsWith("#")){const ir=parseInt(ur.slice(1),16);return[(ir&16711680)>>16,(ir&65280)>>8,ir&255]}return ur.startsWith("rgb(")?ur.slice(4,-1).split(",").map(ir=>parseInt(ir)):ur.startsWith("rgba(")?ur.slice(5,-1).split(",").map(ir=>parseInt(ir)).slice(0,3):((0,c.warn)(`Not a valid color format: "${ur}"`),[0,0,0])}function Ct(ur){const ir=document.createElement("span");ir.style.visibility="hidden",document.body.append(ir);for(const Bt of ur.keys()){ir.style.color=Bt;const Qt=window.getComputedStyle(ir).color;ur.set(Bt,St(Qt))}ir.remove()}function Lt(ur){const{a:ir,b:Bt,c:Qt,d:fr,e:hr,f:Tr}=ur.getTransform();return[ir,Bt,Qt,fr,hr,Tr]}function er(ur){const{a:ir,b:Bt,c:Qt,d:fr,e:hr,f:Tr}=ur.getTransform().invertSelf();return[ir,Bt,Qt,fr,hr,Tr]}function Kt(ur,ir,Bt=!1,Qt=!0){if(ir instanceof et){const{pageWidth:fr,pageHeight:hr}=ir.rawDims,{style:Tr}=ur,Mr=c.FeatureTest.isCSSRoundSupported,kr=`var(--scale-factor) * ${fr}px`,dr=`var(--scale-factor) * ${hr}px`,Nr=Mr?`round(${kr}, 1px)`:`calc(${kr})`,Dr=Mr?`round(${dr}, 1px)`:`calc(${dr})`;!Bt||ir.rotation%180===0?(Tr.width=Nr,Tr.height=Dr):(Tr.width=Dr,Tr.height=Nr)}Qt&&ur.setAttribute("data-main-rotation",ir.rotation)}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var a=s(1);class c{constructor(){this.constructor===c&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(_e){return"none"}addHCMFilter(_e,nt){return"none"}addHighlightHCMFilter(_e,nt,it,et){return"none"}destroy(_e=!1){}}i.BaseFilterFactory=c;class d{constructor(){this.constructor===d&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_e,nt){if(_e<=0||nt<=0)throw new Error("Invalid canvas size");const it=this._createCanvas(_e,nt);return{canvas:it,context:it.getContext("2d")}}reset(_e,nt,it){if(!_e.canvas)throw new Error("Canvas is not specified");if(nt<=0||it<=0)throw new Error("Invalid canvas size");_e.canvas.width=nt,_e.canvas.height=it}destroy(_e){if(!_e.canvas)throw new Error("Canvas is not specified");_e.canvas.width=0,_e.canvas.height=0,_e.canvas=null,_e.context=null}_createCanvas(_e,nt){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=d;class h{constructor({baseUrl:_e=null,isCompressed:nt=!0}){this.constructor===h&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_e,this.isCompressed=nt}async fetch({name:_e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_e)throw new Error("CMap name must be specified.");const nt=this.baseUrl+_e+(this.isCompressed?".bcmap":""),it=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(nt,it).catch(et=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${nt}`)})}_fetchData(_e,nt){(0,a.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=h;class g{constructor({baseUrl:_e=null}){this.constructor===g&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_e}async fetch({filename:_e}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_e)throw new Error("Font filename must be specified.");const nt=`${this.baseUrl}${_e}`;return this._fetchData(nt).catch(it=>{throw new Error(`Unable to load font data at: ${nt}`)})}_fetchData(_e){(0,a.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=g;class _{constructor(){this.constructor===_&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(_e,nt,it=!1){if(_e<=0||nt<=0)throw new Error("Invalid SVG dimensions");const et=this._createSVG("svg:svg");return et.setAttribute("version","1.1"),it||(et.setAttribute("width",`${_e}px`),et.setAttribute("height",`${nt}px`)),et.setAttribute("preserveAspectRatio","none"),et.setAttribute("viewBox",`0 0 ${_e} ${nt}`),et}createElement(_e){if(typeof _e!="string")throw new Error("Invalid SVG element type");return this._createSVG(_e)}_createSVG(_e){(0,a.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=_},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var a=s(1);const c=3285377520,d=4294901760,h=65535;class g{constructor(b){this.h1=b?b&4294967295:c,this.h2=b?b&4294967295:c}update(b){let _e,nt;if(typeof b=="string"){_e=new Uint8Array(b.length*2),nt=0;for(let ut=0,gt=b.length;ut<gt;ut++){const xt=b.charCodeAt(ut);xt<=255?_e[nt++]=xt:(_e[nt++]=xt>>>8,_e[nt++]=xt&255)}}else if((0,a.isArrayBuffer)(b))_e=b.slice(),nt=_e.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const it=nt>>2,et=nt-it*4,lt=new Uint32Array(_e.buffer,0,it);let rt=0,at=0,ot=this.h1,st=this.h2;const ct=3432918353,mt=461845907,pt=ct&h,Et=mt&h;for(let ut=0;ut<it;ut++)ut&1?(rt=lt[ut],rt=rt*ct&d|rt*pt&h,rt=rt<<15|rt>>>17,rt=rt*mt&d|rt*Et&h,ot^=rt,ot=ot<<13|ot>>>19,ot=ot*5+3864292196):(at=lt[ut],at=at*ct&d|at*pt&h,at=at<<15|at>>>17,at=at*mt&d|at*Et&h,st^=at,st=st<<13|st>>>19,st=st*5+3864292196);switch(rt=0,et){case 3:rt^=_e[it*4+2]<<16;case 2:rt^=_e[it*4+1]<<8;case 1:rt^=_e[it*4],rt=rt*ct&d|rt*pt&h,rt=rt<<15|rt>>>17,rt=rt*mt&d|rt*Et&h,it&1?ot^=rt:st^=rt}this.h1=ot,this.h2=st}hexdigest(){let b=this.h1,_e=this.h2;return b^=_e>>>1,b=b*3981806797&d|b*36045&h,_e=_e*4283543511&d|((_e<<16|b>>>16)*2950163797&d)>>>16,b^=_e>>>1,b=b*444984403&d|b*60499&h,_e=_e*3301882366&d|((_e<<16|b>>>16)*3120437893&d)>>>16,b^=_e>>>1,(b>>>0).toString(16).padStart(8,"0")+(_e>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=g},(e,i,s)=>{var h;Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var a=s(1);class c{constructor({ownerDocument:_=globalThis.document,styleElement:b=null}){cr(this,h,new Set);this._document=_,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(_){this.nativeFontFaces.add(_),this._document.fonts.add(_)}removeNativeFontFace(_){this.nativeFontFaces.delete(_),this._document.fonts.delete(_)}insertRule(_){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const b=this.styleElement.sheet;b.insertRule(_,b.cssRules.length)}clear(){for(const _ of this.nativeFontFaces)this._document.fonts.delete(_);this.nativeFontFaces.clear(),ft(this,h).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(_){if(!(!_||ft(this,h).has(_.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:b,src:_e,style:nt}=_,it=new FontFace(b,_e,nt);this.addNativeFontFace(it);try{await it.load(),ft(this,h).add(b)}catch{(0,a.warn)(`Cannot load system font: ${_.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(it)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(_){if(_.attached||_.missingFile&&!_.systemFontInfo)return;if(_.attached=!0,_.systemFontInfo){await this.loadSystemFont(_.systemFontInfo);return}if(this.isFontLoadingAPISupported){const _e=_.createNativeFontFace();if(_e){this.addNativeFontFace(_e);try{await _e.loaded}catch(nt){throw(0,a.warn)(`Failed to load font '${_e.family}': '${nt}'.`),_.disableFontFace=!0,nt}}return}const b=_.createFontFaceRule();if(b){if(this.insertRule(b),this.isSyncFontLoadingSupported)return;await new Promise(_e=>{const nt=this._queueLoadingCallback(_e);this._prepareFontLoadEvent(_,nt)})}}get isFontLoadingAPISupported(){var b;const _=!!((b=this._document)!=null&&b.fonts);return(0,a.shadow)(this,"isFontLoadingAPISupported",_)}get isSyncFontLoadingSupported(){let _=!1;return(a.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(_=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",_)}_queueLoadingCallback(_){function b(){for((0,a.assert)(!nt.done,"completeRequest() cannot be called twice."),nt.done=!0;_e.length>0&&_e[0].done;){const it=_e.shift();setTimeout(it.callback,0)}}const{loadingRequests:_e}=this,nt={done:!1,complete:b,callback:_};return _e.push(nt),nt}get _loadTestFont(){const _=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",_)}_prepareFontLoadEvent(_,b){function _e(St,Ct){return St.charCodeAt(Ct)<<24|St.charCodeAt(Ct+1)<<16|St.charCodeAt(Ct+2)<<8|St.charCodeAt(Ct+3)&255}function nt(St,Ct,Lt,er){const Kt=St.substring(0,Ct),nr=St.substring(Ct+Lt);return Kt+er+nr}let it,et;const lt=this._document.createElement("canvas");lt.width=1,lt.height=1;const rt=lt.getContext("2d");let at=0;function ot(St,Ct){if(++at>30){(0,a.warn)("Load test font never loaded."),Ct();return}if(rt.font="30px "+St,rt.fillText(".",0,20),rt.getImageData(0,0,1,1).data[3]>0){Ct();return}setTimeout(ot.bind(null,St,Ct))}const st=`lt${Date.now()}${this.loadTestFontId++}`;let ct=this._loadTestFont;ct=nt(ct,976,st.length,st);const pt=16,Et=1482184792;let ut=_e(ct,pt);for(it=0,et=st.length-3;it<et;it+=4)ut=ut-Et+_e(st,it)|0;it<st.length&&(ut=ut-Et+_e(st+"XXX",it)|0),ct=nt(ct,pt,4,(0,a.string32)(ut));const gt=`url(data:font/opentype;base64,${btoa(ct)});`,xt=`@font-face {font-family:"${st}";src:${gt}}`;this.insertRule(xt);const Pt=this._document.createElement("div");Pt.style.visibility="hidden",Pt.style.width=Pt.style.height="10px",Pt.style.position="absolute",Pt.style.top=Pt.style.left="0px";for(const St of[_.loadedName,st]){const Ct=this._document.createElement("span");Ct.textContent="Hi",Ct.style.fontFamily=St,Pt.append(Ct)}this._document.body.append(Pt),ot(st,()=>{Pt.remove(),b.complete()})}}h=new WeakMap,i.FontLoader=c;class d{constructor(_,{isEvalSupported:b=!0,disableFontFace:_e=!1,ignoreErrors:nt=!1,inspectFont:it=null}){this.compiledGlyphs=Object.create(null);for(const et in _)this[et]=_[et];this.isEvalSupported=b!==!1,this.disableFontFace=_e===!0,this.ignoreErrors=nt===!0,this._inspectFont=it}createNativeFontFace(){var b;if(!this.data||this.disableFontFace)return null;let _;if(!this.cssFontInfo)_=new FontFace(this.loadedName,this.data,{});else{const _e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),_=new FontFace(this.cssFontInfo.fontFamily,this.data,_e)}return(b=this._inspectFont)==null||b.call(this,this),_}createFontFaceRule(){var nt;if(!this.data||this.disableFontFace)return null;const _=(0,a.bytesToString)(this.data),b=`url(data:${this.mimetype};base64,${btoa(_)});`;let _e;if(!this.cssFontInfo)_e=`@font-face {font-family:"${this.loadedName}";src:${b}}`;else{let it=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(it+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),_e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${it}src:${b}}`}return(nt=this._inspectFont)==null||nt.call(this,this,b),_e}getPathGenerator(_,b){if(this.compiledGlyphs[b]!==void 0)return this.compiledGlyphs[b];let _e;try{_e=_.get(this.loadedName+"_path_"+b)}catch(nt){if(!this.ignoreErrors)throw nt;return(0,a.warn)(`getPathGenerator - ignoring character: "${nt}".`),this.compiledGlyphs[b]=function(it,et){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const nt=[];for(const it of _e){const et=it.args!==void 0?it.args.join(","):"";nt.push("c.",it.cmd,"(",et,`);
`)}return this.compiledGlyphs[b]=new Function("c","size",nt.join(""))}return this.compiledGlyphs[b]=function(nt,it){for(const et of _e)et.cmd==="scale"&&(et.args=[it,-it]),nt[et.cmd].apply(nt,et.args)}}}i.FontFaceObject=d},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var a=s(7);s(1);const c=function(b){return new Promise((_e,nt)=>{require$$5.readFile(b,(et,lt)=>{if(et||!lt){nt(new Error(et));return}_e(new Uint8Array(lt))})})};class d extends a.BaseFilterFactory{}i.NodeFilterFactory=d;class h extends a.BaseCanvasFactory{_createCanvas(_e,nt){return require$$5.createCanvas(_e,nt)}}i.NodeCanvasFactory=h;class g extends a.BaseCMapReaderFactory{_fetchData(_e,nt){return c(_e).then(it=>({cMapData:it,compressionType:nt}))}}i.NodeCMapReaderFactory=g;class _ extends a.BaseStandardFontDataFactory{_fetchData(_e){return c(_e)}}i.NodeStandardFontDataFactory=_},(e,i,s)=>{var qt,Us,$s;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var a=s(1),c=s(6),d=s(12),h=s(13);const g=16,_=100,b=4096,_e=15,nt=10,it=1e3,et=16;function lt(At,ht){if(At._removeMirroring)throw new Error("Context is already forwarding operations.");At.__originalSave=At.save,At.__originalRestore=At.restore,At.__originalRotate=At.rotate,At.__originalScale=At.scale,At.__originalTranslate=At.translate,At.__originalTransform=At.transform,At.__originalSetTransform=At.setTransform,At.__originalResetTransform=At.resetTransform,At.__originalClip=At.clip,At.__originalMoveTo=At.moveTo,At.__originalLineTo=At.lineTo,At.__originalBezierCurveTo=At.bezierCurveTo,At.__originalRect=At.rect,At.__originalClosePath=At.closePath,At.__originalBeginPath=At.beginPath,At._removeMirroring=()=>{At.save=At.__originalSave,At.restore=At.__originalRestore,At.rotate=At.__originalRotate,At.scale=At.__originalScale,At.translate=At.__originalTranslate,At.transform=At.__originalTransform,At.setTransform=At.__originalSetTransform,At.resetTransform=At.__originalResetTransform,At.clip=At.__originalClip,At.moveTo=At.__originalMoveTo,At.lineTo=At.__originalLineTo,At.bezierCurveTo=At.__originalBezierCurveTo,At.rect=At.__originalRect,At.closePath=At.__originalClosePath,At.beginPath=At.__originalBeginPath,delete At._removeMirroring},At.save=function(){ht.save(),this.__originalSave()},At.restore=function(){ht.restore(),this.__originalRestore()},At.translate=function(Tt,Mt){ht.translate(Tt,Mt),this.__originalTranslate(Tt,Mt)},At.scale=function(Tt,Mt){ht.scale(Tt,Mt),this.__originalScale(Tt,Mt)},At.transform=function(Tt,Mt,It,Ut,Zt,rr){ht.transform(Tt,Mt,It,Ut,Zt,rr),this.__originalTransform(Tt,Mt,It,Ut,Zt,rr)},At.setTransform=function(Tt,Mt,It,Ut,Zt,rr){ht.setTransform(Tt,Mt,It,Ut,Zt,rr),this.__originalSetTransform(Tt,Mt,It,Ut,Zt,rr)},At.resetTransform=function(){ht.resetTransform(),this.__originalResetTransform()},At.rotate=function(Tt){ht.rotate(Tt),this.__originalRotate(Tt)},At.clip=function(Tt){ht.clip(Tt),this.__originalClip(Tt)},At.moveTo=function(dt,Tt){ht.moveTo(dt,Tt),this.__originalMoveTo(dt,Tt)},At.lineTo=function(dt,Tt){ht.lineTo(dt,Tt),this.__originalLineTo(dt,Tt)},At.bezierCurveTo=function(dt,Tt,Mt,It,Ut,Zt){ht.bezierCurveTo(dt,Tt,Mt,It,Ut,Zt),this.__originalBezierCurveTo(dt,Tt,Mt,It,Ut,Zt)},At.rect=function(dt,Tt,Mt,It){ht.rect(dt,Tt,Mt,It),this.__originalRect(dt,Tt,Mt,It)},At.closePath=function(){ht.closePath(),this.__originalClosePath()},At.beginPath=function(){ht.beginPath(),this.__originalBeginPath()}}class rt{constructor(ht){this.canvasFactory=ht,this.cache=Object.create(null)}getCanvas(ht,dt,Tt){let Mt;return this.cache[ht]!==void 0?(Mt=this.cache[ht],this.canvasFactory.reset(Mt,dt,Tt)):(Mt=this.canvasFactory.create(dt,Tt),this.cache[ht]=Mt),Mt}delete(ht){delete this.cache[ht]}clear(){for(const ht in this.cache){const dt=this.cache[ht];this.canvasFactory.destroy(dt),delete this.cache[ht]}}}function at(At,ht,dt,Tt,Mt,It,Ut,Zt,rr,_r){const[pr,Ar,Sr,Fr,ur,ir]=(0,c.getCurrentTransform)(At);if(Ar===0&&Sr===0){const fr=Ut*pr+ur,hr=Math.round(fr),Tr=Zt*Fr+ir,Mr=Math.round(Tr),kr=(Ut+rr)*pr+ur,dr=Math.abs(Math.round(kr)-hr)||1,Nr=(Zt+_r)*Fr+ir,Dr=Math.abs(Math.round(Nr)-Mr)||1;return At.setTransform(Math.sign(pr),0,0,Math.sign(Fr),hr,Mr),At.drawImage(ht,dt,Tt,Mt,It,0,0,dr,Dr),At.setTransform(pr,Ar,Sr,Fr,ur,ir),[dr,Dr]}if(pr===0&&Fr===0){const fr=Zt*Sr+ur,hr=Math.round(fr),Tr=Ut*Ar+ir,Mr=Math.round(Tr),kr=(Zt+_r)*Sr+ur,dr=Math.abs(Math.round(kr)-hr)||1,Nr=(Ut+rr)*Ar+ir,Dr=Math.abs(Math.round(Nr)-Mr)||1;return At.setTransform(0,Math.sign(Ar),Math.sign(Sr),0,hr,Mr),At.drawImage(ht,dt,Tt,Mt,It,0,0,Dr,dr),At.setTransform(pr,Ar,Sr,Fr,ur,ir),[Dr,dr]}At.drawImage(ht,dt,Tt,Mt,It,Ut,Zt,rr,_r);const Bt=Math.hypot(pr,Ar),Qt=Math.hypot(Sr,Fr);return[Bt*rr,Qt*_r]}function ot(At){const{width:ht,height:dt}=At;if(ht>it||dt>it)return null;const Tt=1e3,Mt=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),It=ht+1;let Ut=new Uint8Array(It*(dt+1)),Zt,rr,_r;const pr=ht+7&-8;let Ar=new Uint8Array(pr*dt),Sr=0;for(const Qt of At.data){let fr=128;for(;fr>0;)Ar[Sr++]=Qt&fr?0:255,fr>>=1}let Fr=0;for(Sr=0,Ar[Sr]!==0&&(Ut[0]=1,++Fr),rr=1;rr<ht;rr++)Ar[Sr]!==Ar[Sr+1]&&(Ut[rr]=Ar[Sr]?2:1,++Fr),Sr++;for(Ar[Sr]!==0&&(Ut[rr]=2,++Fr),Zt=1;Zt<dt;Zt++){Sr=Zt*pr,_r=Zt*It,Ar[Sr-pr]!==Ar[Sr]&&(Ut[_r]=Ar[Sr]?1:8,++Fr);let Qt=(Ar[Sr]?4:0)+(Ar[Sr-pr]?8:0);for(rr=1;rr<ht;rr++)Qt=(Qt>>2)+(Ar[Sr+1]?4:0)+(Ar[Sr-pr+1]?8:0),Mt[Qt]&&(Ut[_r+rr]=Mt[Qt],++Fr),Sr++;if(Ar[Sr-pr]!==Ar[Sr]&&(Ut[_r+rr]=Ar[Sr]?2:4,++Fr),Fr>Tt)return null}for(Sr=pr*(dt-1),_r=Zt*It,Ar[Sr]!==0&&(Ut[_r]=8,++Fr),rr=1;rr<ht;rr++)Ar[Sr]!==Ar[Sr+1]&&(Ut[_r+rr]=Ar[Sr]?4:8,++Fr),Sr++;if(Ar[Sr]!==0&&(Ut[_r+rr]=4,++Fr),Fr>Tt)return null;const ur=new Int32Array([0,It,-1,0,-It,0,0,0,1]),ir=new Path2D;for(Zt=0;Fr&&Zt<=dt;Zt++){let Qt=Zt*It;const fr=Qt+ht;for(;Qt<fr&&!Ut[Qt];)Qt++;if(Qt===fr)continue;ir.moveTo(Qt%It,Zt);const hr=Qt;let Tr=Ut[Qt];do{const Mr=ur[Tr];do Qt+=Mr;while(!Ut[Qt]);const kr=Ut[Qt];kr!==5&&kr!==10?(Tr=kr,Ut[Qt]=0):(Tr=kr&51*Tr>>4,Ut[Qt]&=Tr>>2|Tr<<2),ir.lineTo(Qt%It,Qt/It|0),Ut[Qt]||--Fr}while(hr!==Qt);--Zt}return Ar=null,Ut=null,function(Qt){Qt.save(),Qt.scale(1/ht,-1/dt),Qt.translate(0,-dt),Qt.fill(ir),Qt.beginPath(),Qt.restore()}}class st{constructor(ht,dt){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ht,dt])}clone(){const ht=Object.create(this);return ht.clipBox=this.clipBox.slice(),ht}setCurrentPoint(ht,dt){this.x=ht,this.y=dt}updatePathMinMax(ht,dt,Tt){[dt,Tt]=a.Util.applyTransform([dt,Tt],ht),this.minX=Math.min(this.minX,dt),this.minY=Math.min(this.minY,Tt),this.maxX=Math.max(this.maxX,dt),this.maxY=Math.max(this.maxY,Tt)}updateRectMinMax(ht,dt){const Tt=a.Util.applyTransform(dt,ht),Mt=a.Util.applyTransform(dt.slice(2),ht);this.minX=Math.min(this.minX,Tt[0],Mt[0]),this.minY=Math.min(this.minY,Tt[1],Mt[1]),this.maxX=Math.max(this.maxX,Tt[0],Mt[0]),this.maxY=Math.max(this.maxY,Tt[1],Mt[1])}updateScalingPathMinMax(ht,dt){a.Util.scaleMinMax(ht,dt),this.minX=Math.min(this.minX,dt[0]),this.maxX=Math.max(this.maxX,dt[1]),this.minY=Math.min(this.minY,dt[2]),this.maxY=Math.max(this.maxY,dt[3])}updateCurvePathMinMax(ht,dt,Tt,Mt,It,Ut,Zt,rr,_r,pr){const Ar=a.Util.bezierBoundingBox(dt,Tt,Mt,It,Ut,Zt,rr,_r);if(pr){pr[0]=Math.min(pr[0],Ar[0],Ar[2]),pr[1]=Math.max(pr[1],Ar[0],Ar[2]),pr[2]=Math.min(pr[2],Ar[1],Ar[3]),pr[3]=Math.max(pr[3],Ar[1],Ar[3]);return}this.updateRectMinMax(ht,Ar)}getPathBoundingBox(ht=d.PathType.FILL,dt=null){const Tt=[this.minX,this.minY,this.maxX,this.maxY];if(ht===d.PathType.STROKE){dt||(0,a.unreachable)("Stroke bounding box must include transform.");const Mt=a.Util.singularValueDecompose2dScale(dt),It=Mt[0]*this.lineWidth/2,Ut=Mt[1]*this.lineWidth/2;Tt[0]-=It,Tt[1]-=Ut,Tt[2]+=It,Tt[3]+=Ut}return Tt}updateClipFromPath(){const ht=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ht||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ht){this.clipBox=ht,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ht=d.PathType.FILL,dt=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(ht,dt))}}function ct(At,ht){if(typeof ImageData<"u"&&ht instanceof ImageData){At.putImageData(ht,0,0);return}const dt=ht.height,Tt=ht.width,Mt=dt%et,It=(dt-Mt)/et,Ut=Mt===0?It:It+1,Zt=At.createImageData(Tt,et);let rr=0,_r;const pr=ht.data,Ar=Zt.data;let Sr,Fr,ur,ir;if(ht.kind===a.ImageKind.GRAYSCALE_1BPP){const Bt=pr.byteLength,Qt=new Uint32Array(Ar.buffer,0,Ar.byteLength>>2),fr=Qt.length,hr=Tt+7>>3,Tr=4294967295,Mr=a.FeatureTest.isLittleEndian?4278190080:255;for(Sr=0;Sr<Ut;Sr++){for(ur=Sr<It?et:Mt,_r=0,Fr=0;Fr<ur;Fr++){const kr=Bt-rr;let dr=0;const Nr=kr>hr?Tt:kr*8-7,Dr=Nr&-8;let Jr=0,Qr=0;for(;dr<Dr;dr+=8)Qr=pr[rr++],Qt[_r++]=Qr&128?Tr:Mr,Qt[_r++]=Qr&64?Tr:Mr,Qt[_r++]=Qr&32?Tr:Mr,Qt[_r++]=Qr&16?Tr:Mr,Qt[_r++]=Qr&8?Tr:Mr,Qt[_r++]=Qr&4?Tr:Mr,Qt[_r++]=Qr&2?Tr:Mr,Qt[_r++]=Qr&1?Tr:Mr;for(;dr<Nr;dr++)Jr===0&&(Qr=pr[rr++],Jr=128),Qt[_r++]=Qr&Jr?Tr:Mr,Jr>>=1}for(;_r<fr;)Qt[_r++]=0;At.putImageData(Zt,0,Sr*et)}}else if(ht.kind===a.ImageKind.RGBA_32BPP){for(Fr=0,ir=Tt*et*4,Sr=0;Sr<It;Sr++)Ar.set(pr.subarray(rr,rr+ir)),rr+=ir,At.putImageData(Zt,0,Fr),Fr+=et;Sr<Ut&&(ir=Tt*Mt*4,Ar.set(pr.subarray(rr,rr+ir)),At.putImageData(Zt,0,Fr))}else if(ht.kind===a.ImageKind.RGB_24BPP)for(ur=et,ir=Tt*ur,Sr=0;Sr<Ut;Sr++){for(Sr>=It&&(ur=Mt,ir=Tt*ur),_r=0,Fr=ir;Fr--;)Ar[_r++]=pr[rr++],Ar[_r++]=pr[rr++],Ar[_r++]=pr[rr++],Ar[_r++]=255;At.putImageData(Zt,0,Sr*et)}else throw new Error(`bad image kind: ${ht.kind}`)}function mt(At,ht){if(ht.bitmap){At.drawImage(ht.bitmap,0,0);return}const dt=ht.height,Tt=ht.width,Mt=dt%et,It=(dt-Mt)/et,Ut=Mt===0?It:It+1,Zt=At.createImageData(Tt,et);let rr=0;const _r=ht.data,pr=Zt.data;for(let Ar=0;Ar<Ut;Ar++){const Sr=Ar<It?et:Mt;({srcPos:rr}=(0,h.convertBlackAndWhiteToRGBA)({src:_r,srcPos:rr,dest:pr,width:Tt,height:Sr,nonBlackColor:0})),At.putImageData(Zt,0,Ar*et)}}function pt(At,ht){const dt=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const Tt of dt)At[Tt]!==void 0&&(ht[Tt]=At[Tt]);At.setLineDash!==void 0&&(ht.setLineDash(At.getLineDash()),ht.lineDashOffset=At.lineDashOffset)}function Et(At){if(At.strokeStyle=At.fillStyle="#000000",At.fillRule="nonzero",At.globalAlpha=1,At.lineWidth=1,At.lineCap="butt",At.lineJoin="miter",At.miterLimit=10,At.globalCompositeOperation="source-over",At.font="10px sans-serif",At.setLineDash!==void 0&&(At.setLineDash([]),At.lineDashOffset=0),!a.isNodeJS){const{filter:ht}=At;ht!=="none"&&ht!==""&&(At.filter="none")}}function ut(At,ht,dt,Tt){const Mt=At.length;for(let It=3;It<Mt;It+=4){const Ut=At[It];if(Ut===0)At[It-3]=ht,At[It-2]=dt,At[It-1]=Tt;else if(Ut<255){const Zt=255-Ut;At[It-3]=At[It-3]*Ut+ht*Zt>>8,At[It-2]=At[It-2]*Ut+dt*Zt>>8,At[It-1]=At[It-1]*Ut+Tt*Zt>>8}}}function gt(At,ht,dt){const Tt=At.length,Mt=1/255;for(let It=3;It<Tt;It+=4){const Ut=dt?dt[At[It]]:At[It];ht[It]=ht[It]*Ut*Mt|0}}function xt(At,ht,dt){const Tt=At.length;for(let Mt=3;Mt<Tt;Mt+=4){const It=At[Mt-3]*77+At[Mt-2]*152+At[Mt-1]*28;ht[Mt]=dt?ht[Mt]*dt[It>>8]>>8:ht[Mt]*It>>16}}function Pt(At,ht,dt,Tt,Mt,It,Ut,Zt,rr,_r,pr){const Ar=!!It,Sr=Ar?It[0]:0,Fr=Ar?It[1]:0,ur=Ar?It[2]:0,ir=Mt==="Luminosity"?xt:gt,Qt=Math.min(Tt,Math.ceil(1048576/dt));for(let fr=0;fr<Tt;fr+=Qt){const hr=Math.min(Qt,Tt-fr),Tr=At.getImageData(Zt-_r,fr+(rr-pr),dt,hr),Mr=ht.getImageData(Zt,fr+rr,dt,hr);Ar&&ut(Tr.data,Sr,Fr,ur),ir(Tr.data,Mr.data,Ut),ht.putImageData(Mr,Zt,fr+rr)}}function St(At,ht,dt,Tt){const Mt=Tt[0],It=Tt[1],Ut=Tt[2]-Mt,Zt=Tt[3]-It;Ut===0||Zt===0||(Pt(ht.context,dt,Ut,Zt,ht.subtype,ht.backdrop,ht.transferMap,Mt,It,ht.offsetX,ht.offsetY),At.save(),At.globalAlpha=1,At.globalCompositeOperation="source-over",At.setTransform(1,0,0,1,0,0),At.drawImage(dt.canvas,0,0),At.restore())}function Ct(At,ht){const dt=a.Util.singularValueDecompose2dScale(At);dt[0]=Math.fround(dt[0]),dt[1]=Math.fround(dt[1]);const Tt=Math.fround((globalThis.devicePixelRatio||1)*c.PixelsPerInch.PDF_TO_CSS_UNITS);return ht!==void 0?ht:dt[0]<=Tt||dt[1]<=Tt}const Lt=["butt","round","square"],er=["miter","round","bevel"],Kt={},nr={},sr=class sr{constructor(ht,dt,Tt,Mt,It,{optionalContentConfig:Ut,markedContentStack:Zt=null},rr,_r){cr(this,qt);this.ctx=ht,this.current=new st(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=dt,this.objs=Tt,this.canvasFactory=Mt,this.filterFactory=It,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Zt||[],this.optionalContentConfig=Ut,this.cachedCanvases=new rt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=rr,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=_r,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ht,dt=null){return typeof ht=="string"?ht.startsWith("g_")?this.commonObjs.get(ht):this.objs.get(ht):dt}beginDrawing({transform:ht,viewport:dt,transparency:Tt=!1,background:Mt=null}){const It=this.ctx.canvas.width,Ut=this.ctx.canvas.height,Zt=this.ctx.fillStyle;if(this.ctx.fillStyle=Mt||"#ffffff",this.ctx.fillRect(0,0,It,Ut),this.ctx.fillStyle=Zt,Tt){const rr=this.cachedCanvases.getCanvas("transparent",It,Ut);this.compositeCtx=this.ctx,this.transparentCanvas=rr.canvas,this.ctx=rr.context,this.ctx.save(),this.ctx.transform(...(0,c.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Et(this.ctx),ht&&(this.ctx.transform(...ht),this.outputScaleX=ht[0],this.outputScaleY=ht[0]),this.ctx.transform(...dt.transform),this.viewportScale=dt.scale,this.baseTransform=(0,c.getCurrentTransform)(this.ctx)}executeOperatorList(ht,dt,Tt,Mt){const It=ht.argsArray,Ut=ht.fnArray;let Zt=dt||0;const rr=It.length;if(rr===Zt)return Zt;const _r=rr-Zt>nt&&typeof Tt=="function",pr=_r?Date.now()+_e:0;let Ar=0;const Sr=this.commonObjs,Fr=this.objs;let ur;for(;;){if(Mt!==void 0&&Zt===Mt.nextBreakPoint)return Mt.breakIt(Zt,Tt),Zt;if(ur=Ut[Zt],ur!==a.OPS.dependency)this[ur].apply(this,It[Zt]);else for(const ir of It[Zt]){const Bt=ir.startsWith("g_")?Sr:Fr;if(!Bt.has(ir))return Bt.get(ir,Tt),Zt}if(Zt++,Zt===rr)return Zt;if(_r&&++Ar>nt){if(Date.now()>pr)return Tt(),Zt;Ar=0}}}endDrawing(){or(this,qt,Us).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ht of this._cachedBitmapsMap.values()){for(const dt of ht.values())typeof HTMLCanvasElement<"u"&&dt instanceof HTMLCanvasElement&&(dt.width=dt.height=0);ht.clear()}this._cachedBitmapsMap.clear(),or(this,qt,$s).call(this)}_scaleImage(ht,dt){const Tt=ht.width,Mt=ht.height;let It=Math.max(Math.hypot(dt[0],dt[1]),1),Ut=Math.max(Math.hypot(dt[2],dt[3]),1),Zt=Tt,rr=Mt,_r="prescale1",pr,Ar;for(;It>2&&Zt>1||Ut>2&&rr>1;){let Sr=Zt,Fr=rr;It>2&&Zt>1&&(Sr=Zt>=16384?Math.floor(Zt/2)-1||1:Math.ceil(Zt/2),It/=Zt/Sr),Ut>2&&rr>1&&(Fr=rr>=16384?Math.floor(rr/2)-1||1:Math.ceil(rr)/2,Ut/=rr/Fr),pr=this.cachedCanvases.getCanvas(_r,Sr,Fr),Ar=pr.context,Ar.clearRect(0,0,Sr,Fr),Ar.drawImage(ht,0,0,Zt,rr,0,0,Sr,Fr),ht=pr.canvas,Zt=Sr,rr=Fr,_r=_r==="prescale1"?"prescale2":"prescale1"}return{img:ht,paintWidth:Zt,paintHeight:rr}}_createMaskCanvas(ht){const dt=this.ctx,{width:Tt,height:Mt}=ht,It=this.current.fillColor,Ut=this.current.patternFill,Zt=(0,c.getCurrentTransform)(dt);let rr,_r,pr,Ar;if((ht.bitmap||ht.data)&&ht.count>1){const dr=ht.bitmap||ht.data.buffer;_r=JSON.stringify(Ut?Zt:[Zt.slice(0,4),It]),rr=this._cachedBitmapsMap.get(dr),rr||(rr=new Map,this._cachedBitmapsMap.set(dr,rr));const Nr=rr.get(_r);if(Nr&&!Ut){const Dr=Math.round(Math.min(Zt[0],Zt[2])+Zt[4]),Jr=Math.round(Math.min(Zt[1],Zt[3])+Zt[5]);return{canvas:Nr,offsetX:Dr,offsetY:Jr}}pr=Nr}pr||(Ar=this.cachedCanvases.getCanvas("maskCanvas",Tt,Mt),mt(Ar.context,ht));let Sr=a.Util.transform(Zt,[1/Tt,0,0,-1/Mt,0,0]);Sr=a.Util.transform(Sr,[1,0,0,1,0,-Mt]);const Fr=a.Util.applyTransform([0,0],Sr),ur=a.Util.applyTransform([Tt,Mt],Sr),ir=a.Util.normalizeRect([Fr[0],Fr[1],ur[0],ur[1]]),Bt=Math.round(ir[2]-ir[0])||1,Qt=Math.round(ir[3]-ir[1])||1,fr=this.cachedCanvases.getCanvas("fillCanvas",Bt,Qt),hr=fr.context,Tr=Math.min(Fr[0],ur[0]),Mr=Math.min(Fr[1],ur[1]);hr.translate(-Tr,-Mr),hr.transform(...Sr),pr||(pr=this._scaleImage(Ar.canvas,(0,c.getCurrentTransformInverse)(hr)),pr=pr.img,rr&&Ut&&rr.set(_r,pr)),hr.imageSmoothingEnabled=Ct((0,c.getCurrentTransform)(hr),ht.interpolate),at(hr,pr,0,0,pr.width,pr.height,0,0,Tt,Mt),hr.globalCompositeOperation="source-in";const kr=a.Util.transform((0,c.getCurrentTransformInverse)(hr),[1,0,0,1,-Tr,-Mr]);return hr.fillStyle=Ut?It.getPattern(dt,this,kr,d.PathType.FILL):It,hr.fillRect(0,0,Tt,Mt),rr&&!Ut&&(this.cachedCanvases.delete("fillCanvas"),rr.set(_r,fr.canvas)),{canvas:fr.canvas,offsetX:Math.round(Tr),offsetY:Math.round(Mr)}}setLineWidth(ht){ht!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ht,this.ctx.lineWidth=ht}setLineCap(ht){this.ctx.lineCap=Lt[ht]}setLineJoin(ht){this.ctx.lineJoin=er[ht]}setMiterLimit(ht){this.ctx.miterLimit=ht}setDash(ht,dt){const Tt=this.ctx;Tt.setLineDash!==void 0&&(Tt.setLineDash(ht),Tt.lineDashOffset=dt)}setRenderingIntent(ht){}setFlatness(ht){}setGState(ht){for(const[dt,Tt]of ht)switch(dt){case"LW":this.setLineWidth(Tt);break;case"LC":this.setLineCap(Tt);break;case"LJ":this.setLineJoin(Tt);break;case"ML":this.setMiterLimit(Tt);break;case"D":this.setDash(Tt[0],Tt[1]);break;case"RI":this.setRenderingIntent(Tt);break;case"FL":this.setFlatness(Tt);break;case"Font":this.setFont(Tt[0],Tt[1]);break;case"CA":this.current.strokeAlpha=Tt;break;case"ca":this.current.fillAlpha=Tt,this.ctx.globalAlpha=Tt;break;case"BM":this.ctx.globalCompositeOperation=Tt;break;case"SMask":this.current.activeSMask=Tt?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(Tt);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ht=this.inSMaskMode;this.current.activeSMask&&!ht?this.beginSMaskMode():!this.current.activeSMask&&ht&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ht=this.ctx.canvas.width,dt=this.ctx.canvas.height,Tt="smaskGroupAt"+this.groupLevel,Mt=this.cachedCanvases.getCanvas(Tt,ht,dt);this.suspendedCtx=this.ctx,this.ctx=Mt.context;const It=this.ctx;It.setTransform(...(0,c.getCurrentTransform)(this.suspendedCtx)),pt(this.suspendedCtx,It),lt(It,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),pt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ht){if(!this.current.activeSMask)return;ht?(ht[0]=Math.floor(ht[0]),ht[1]=Math.floor(ht[1]),ht[2]=Math.ceil(ht[2]),ht[3]=Math.ceil(ht[3])):ht=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const dt=this.current.activeSMask,Tt=this.suspendedCtx;St(Tt,dt,this.ctx,ht),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(pt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ht=this.current;this.stateStack.push(ht),this.current=ht.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),pt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ht,dt,Tt,Mt,It,Ut){this.ctx.transform(ht,dt,Tt,Mt,It,Ut),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ht,dt,Tt){const Mt=this.ctx,It=this.current;let Ut=It.x,Zt=It.y,rr,_r;const pr=(0,c.getCurrentTransform)(Mt),Ar=pr[0]===0&&pr[3]===0||pr[1]===0&&pr[2]===0,Sr=Ar?Tt.slice(0):null;for(let Fr=0,ur=0,ir=ht.length;Fr<ir;Fr++)switch(ht[Fr]|0){case a.OPS.rectangle:Ut=dt[ur++],Zt=dt[ur++];const Bt=dt[ur++],Qt=dt[ur++],fr=Ut+Bt,hr=Zt+Qt;Mt.moveTo(Ut,Zt),Bt===0||Qt===0?Mt.lineTo(fr,hr):(Mt.lineTo(fr,Zt),Mt.lineTo(fr,hr),Mt.lineTo(Ut,hr)),Ar||It.updateRectMinMax(pr,[Ut,Zt,fr,hr]),Mt.closePath();break;case a.OPS.moveTo:Ut=dt[ur++],Zt=dt[ur++],Mt.moveTo(Ut,Zt),Ar||It.updatePathMinMax(pr,Ut,Zt);break;case a.OPS.lineTo:Ut=dt[ur++],Zt=dt[ur++],Mt.lineTo(Ut,Zt),Ar||It.updatePathMinMax(pr,Ut,Zt);break;case a.OPS.curveTo:rr=Ut,_r=Zt,Ut=dt[ur+4],Zt=dt[ur+5],Mt.bezierCurveTo(dt[ur],dt[ur+1],dt[ur+2],dt[ur+3],Ut,Zt),It.updateCurvePathMinMax(pr,rr,_r,dt[ur],dt[ur+1],dt[ur+2],dt[ur+3],Ut,Zt,Sr),ur+=6;break;case a.OPS.curveTo2:rr=Ut,_r=Zt,Mt.bezierCurveTo(Ut,Zt,dt[ur],dt[ur+1],dt[ur+2],dt[ur+3]),It.updateCurvePathMinMax(pr,rr,_r,Ut,Zt,dt[ur],dt[ur+1],dt[ur+2],dt[ur+3],Sr),Ut=dt[ur+2],Zt=dt[ur+3],ur+=4;break;case a.OPS.curveTo3:rr=Ut,_r=Zt,Ut=dt[ur+2],Zt=dt[ur+3],Mt.bezierCurveTo(dt[ur],dt[ur+1],Ut,Zt,Ut,Zt),It.updateCurvePathMinMax(pr,rr,_r,dt[ur],dt[ur+1],Ut,Zt,Ut,Zt,Sr),ur+=4;break;case a.OPS.closePath:Mt.closePath();break}Ar&&It.updateScalingPathMinMax(pr,Sr),It.setCurrentPoint(Ut,Zt)}closePath(){this.ctx.closePath()}stroke(ht=!0){const dt=this.ctx,Tt=this.current.strokeColor;dt.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Tt=="object"&&(Tt!=null&&Tt.getPattern)?(dt.save(),dt.strokeStyle=Tt.getPattern(dt,this,(0,c.getCurrentTransformInverse)(dt),d.PathType.STROKE),this.rescaleAndStroke(!1),dt.restore()):this.rescaleAndStroke(!0)),ht&&this.consumePath(this.current.getClippedPathBoundingBox()),dt.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ht=!0){const dt=this.ctx,Tt=this.current.fillColor,Mt=this.current.patternFill;let It=!1;Mt&&(dt.save(),dt.fillStyle=Tt.getPattern(dt,this,(0,c.getCurrentTransformInverse)(dt),d.PathType.FILL),It=!0);const Ut=this.current.getClippedPathBoundingBox();this.contentVisible&&Ut!==null&&(this.pendingEOFill?(dt.fill("evenodd"),this.pendingEOFill=!1):dt.fill()),It&&dt.restore(),ht&&this.consumePath(Ut)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Kt}eoClip(){this.pendingClip=nr}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ht=this.pendingTextPaths,dt=this.ctx;if(ht===void 0){dt.beginPath();return}dt.save(),dt.beginPath();for(const Tt of ht)dt.setTransform(...Tt.transform),dt.translate(Tt.x,Tt.y),Tt.addToPath(dt,Tt.fontSize);dt.restore(),dt.clip(),dt.beginPath(),delete this.pendingTextPaths}setCharSpacing(ht){this.current.charSpacing=ht}setWordSpacing(ht){this.current.wordSpacing=ht}setHScale(ht){this.current.textHScale=ht/100}setLeading(ht){this.current.leading=-ht}setFont(ht,dt){var pr;const Tt=this.commonObjs.get(ht),Mt=this.current;if(!Tt)throw new Error(`Can't find font for ${ht}`);if(Mt.fontMatrix=Tt.fontMatrix||a.FONT_IDENTITY_MATRIX,(Mt.fontMatrix[0]===0||Mt.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+ht),dt<0?(dt=-dt,Mt.fontDirection=-1):Mt.fontDirection=1,this.current.font=Tt,this.current.fontSize=dt,Tt.isType3Font)return;const It=Tt.loadedName||"sans-serif",Ut=((pr=Tt.systemFontInfo)==null?void 0:pr.css)||`"${It}", ${Tt.fallbackName}`;let Zt="normal";Tt.black?Zt="900":Tt.bold&&(Zt="bold");const rr=Tt.italic?"italic":"normal";let _r=dt;dt<g?_r=g:dt>_&&(_r=_),this.current.fontSizeScale=dt/_r,this.ctx.font=`${rr} ${Zt} ${_r}px ${Ut}`}setTextRenderingMode(ht){this.current.textRenderingMode=ht}setTextRise(ht){this.current.textRise=ht}moveText(ht,dt){this.current.x=this.current.lineX+=ht,this.current.y=this.current.lineY+=dt}setLeadingMoveText(ht,dt){this.setLeading(-dt),this.moveText(ht,dt)}setTextMatrix(ht,dt,Tt,Mt,It,Ut){this.current.textMatrix=[ht,dt,Tt,Mt,It,Ut],this.current.textMatrixScale=Math.hypot(ht,dt),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ht,dt,Tt,Mt){const It=this.ctx,Ut=this.current,Zt=Ut.font,rr=Ut.textRenderingMode,_r=Ut.fontSize/Ut.fontSizeScale,pr=rr&a.TextRenderingMode.FILL_STROKE_MASK,Ar=!!(rr&a.TextRenderingMode.ADD_TO_PATH_FLAG),Sr=Ut.patternFill&&!Zt.missingFile;let Fr;(Zt.disableFontFace||Ar||Sr)&&(Fr=Zt.getPathGenerator(this.commonObjs,ht)),Zt.disableFontFace||Sr?(It.save(),It.translate(dt,Tt),It.beginPath(),Fr(It,_r),Mt&&It.setTransform(...Mt),(pr===a.TextRenderingMode.FILL||pr===a.TextRenderingMode.FILL_STROKE)&&It.fill(),(pr===a.TextRenderingMode.STROKE||pr===a.TextRenderingMode.FILL_STROKE)&&It.stroke(),It.restore()):((pr===a.TextRenderingMode.FILL||pr===a.TextRenderingMode.FILL_STROKE)&&It.fillText(ht,dt,Tt),(pr===a.TextRenderingMode.STROKE||pr===a.TextRenderingMode.FILL_STROKE)&&It.strokeText(ht,dt,Tt)),Ar&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,c.getCurrentTransform)(It),x:dt,y:Tt,fontSize:_r,addToPath:Fr})}get isFontSubpixelAAEnabled(){const{context:ht}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ht.scale(1.5,1),ht.fillText("I",0,10);const dt=ht.getImageData(0,0,10,10).data;let Tt=!1;for(let Mt=3;Mt<dt.length;Mt+=4)if(dt[Mt]>0&&dt[Mt]<255){Tt=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",Tt)}showText(ht){const dt=this.current,Tt=dt.font;if(Tt.isType3Font)return this.showType3Text(ht);const Mt=dt.fontSize;if(Mt===0)return;const It=this.ctx,Ut=dt.fontSizeScale,Zt=dt.charSpacing,rr=dt.wordSpacing,_r=dt.fontDirection,pr=dt.textHScale*_r,Ar=ht.length,Sr=Tt.vertical,Fr=Sr?1:-1,ur=Tt.defaultVMetrics,ir=Mt*dt.fontMatrix[0],Bt=dt.textRenderingMode===a.TextRenderingMode.FILL&&!Tt.disableFontFace&&!dt.patternFill;It.save(),It.transform(...dt.textMatrix),It.translate(dt.x,dt.y+dt.textRise),_r>0?It.scale(pr,-1):It.scale(pr,1);let Qt;if(dt.patternFill){It.save();const kr=dt.fillColor.getPattern(It,this,(0,c.getCurrentTransformInverse)(It),d.PathType.FILL);Qt=(0,c.getCurrentTransform)(It),It.restore(),It.fillStyle=kr}let fr=dt.lineWidth;const hr=dt.textMatrixScale;if(hr===0||fr===0){const kr=dt.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(kr===a.TextRenderingMode.STROKE||kr===a.TextRenderingMode.FILL_STROKE)&&(fr=this.getSinglePixelWidth())}else fr/=hr;if(Ut!==1&&(It.scale(Ut,Ut),fr/=Ut),It.lineWidth=fr,Tt.isInvalidPDFjsFont){const kr=[];let dr=0;for(const Nr of ht)kr.push(Nr.unicode),dr+=Nr.width;It.fillText(kr.join(""),0,0),dt.x+=dr*ir*pr,It.restore(),this.compose();return}let Tr=0,Mr;for(Mr=0;Mr<Ar;++Mr){const kr=ht[Mr];if(typeof kr=="number"){Tr+=Fr*kr*Mt/1e3;continue}let dr=!1;const Nr=(kr.isSpace?rr:0)+Zt,Dr=kr.fontChar,Jr=kr.accent;let Qr,en,Vr=kr.width;if(Sr){const tn=kr.vmetric||ur,nn=-(kr.vmetric?tn[1]:Vr*.5)*ir,Or=tn[2]*ir;Vr=tn?-tn[0]:Vr,Qr=nn/Ut,en=(Tr+Or)/Ut}else Qr=Tr/Ut,en=0;if(Tt.remeasure&&Vr>0){const tn=It.measureText(Dr).width*1e3/Mt*Ut;if(Vr<tn&&this.isFontSubpixelAAEnabled){const nn=Vr/tn;dr=!0,It.save(),It.scale(nn,1),Qr/=nn}else Vr!==tn&&(Qr+=(Vr-tn)/2e3*Mt/Ut)}if(this.contentVisible&&(kr.isInFont||Tt.missingFile)){if(Bt&&!Jr)It.fillText(Dr,Qr,en);else if(this.paintChar(Dr,Qr,en,Qt),Jr){const tn=Qr+Mt*Jr.offset.x/Ut,nn=en-Mt*Jr.offset.y/Ut;this.paintChar(Jr.fontChar,tn,nn,Qt)}}const Kr=Sr?Vr*ir-Nr*_r:Vr*ir+Nr*_r;Tr+=Kr,dr&&It.restore()}Sr?dt.y-=Tr:dt.x+=Tr*pr,It.restore(),this.compose()}showType3Text(ht){const dt=this.ctx,Tt=this.current,Mt=Tt.font,It=Tt.fontSize,Ut=Tt.fontDirection,Zt=Mt.vertical?1:-1,rr=Tt.charSpacing,_r=Tt.wordSpacing,pr=Tt.textHScale*Ut,Ar=Tt.fontMatrix||a.FONT_IDENTITY_MATRIX,Sr=ht.length,Fr=Tt.textRenderingMode===a.TextRenderingMode.INVISIBLE;let ur,ir,Bt,Qt;if(!(Fr||It===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,dt.save(),dt.transform(...Tt.textMatrix),dt.translate(Tt.x,Tt.y),dt.scale(pr,Ut),ur=0;ur<Sr;++ur){if(ir=ht[ur],typeof ir=="number"){Qt=Zt*ir*It/1e3,this.ctx.translate(Qt,0),Tt.x+=Qt*pr;continue}const fr=(ir.isSpace?_r:0)+rr,hr=Mt.charProcOperatorList[ir.operatorListId];if(!hr){(0,a.warn)(`Type3 character "${ir.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ir,this.save(),dt.scale(It,It),dt.transform(...Ar),this.executeOperatorList(hr),this.restore()),Bt=a.Util.applyTransform([ir.width,0],Ar)[0]*It+fr,dt.translate(Bt,0),Tt.x+=Bt*pr}dt.restore(),this.processingType3=null}}setCharWidth(ht,dt){}setCharWidthAndBounds(ht,dt,Tt,Mt,It,Ut){this.ctx.rect(Tt,Mt,It-Tt,Ut-Mt),this.ctx.clip(),this.endPath()}getColorN_Pattern(ht){let dt;if(ht[0]==="TilingPattern"){const Tt=ht[1],Mt=this.baseTransform||(0,c.getCurrentTransform)(this.ctx),It={createCanvasGraphics:Ut=>new sr(Ut,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};dt=new d.TilingPattern(ht,Tt,this.ctx,It,Mt)}else dt=this._getPattern(ht[1],ht[2]);return dt}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ht,dt,Tt){const Mt=a.Util.makeHexColor(ht,dt,Tt);this.ctx.strokeStyle=Mt,this.current.strokeColor=Mt}setFillRGBColor(ht,dt,Tt){const Mt=a.Util.makeHexColor(ht,dt,Tt);this.ctx.fillStyle=Mt,this.current.fillColor=Mt,this.current.patternFill=!1}_getPattern(ht,dt=null){let Tt;return this.cachedPatterns.has(ht)?Tt=this.cachedPatterns.get(ht):(Tt=(0,d.getShadingPattern)(this.getObject(ht)),this.cachedPatterns.set(ht,Tt)),dt&&(Tt.matrix=dt),Tt}shadingFill(ht){if(!this.contentVisible)return;const dt=this.ctx;this.save();const Tt=this._getPattern(ht);dt.fillStyle=Tt.getPattern(dt,this,(0,c.getCurrentTransformInverse)(dt),d.PathType.SHADING);const Mt=(0,c.getCurrentTransformInverse)(dt);if(Mt){const{width:It,height:Ut}=dt.canvas,[Zt,rr,_r,pr]=a.Util.getAxialAlignedBoundingBox([0,0,It,Ut],Mt);this.ctx.fillRect(Zt,rr,_r-Zt,pr-rr)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ht,dt){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ht)&&ht.length===6&&this.transform(...ht),this.baseTransform=(0,c.getCurrentTransform)(this.ctx),dt)){const Tt=dt[2]-dt[0],Mt=dt[3]-dt[1];this.ctx.rect(dt[0],dt[1],Tt,Mt),this.current.updateRectMinMax((0,c.getCurrentTransform)(this.ctx),dt),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ht){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const dt=this.ctx;ht.isolated||(0,a.info)("TODO: Support non-isolated groups."),ht.knockout&&(0,a.warn)("Knockout groups not supported.");const Tt=(0,c.getCurrentTransform)(dt);if(ht.matrix&&dt.transform(...ht.matrix),!ht.bbox)throw new Error("Bounding box is required.");let Mt=a.Util.getAxialAlignedBoundingBox(ht.bbox,(0,c.getCurrentTransform)(dt));const It=[0,0,dt.canvas.width,dt.canvas.height];Mt=a.Util.intersect(Mt,It)||[0,0,0,0];const Ut=Math.floor(Mt[0]),Zt=Math.floor(Mt[1]);let rr=Math.max(Math.ceil(Mt[2])-Ut,1),_r=Math.max(Math.ceil(Mt[3])-Zt,1),pr=1,Ar=1;rr>b&&(pr=rr/b,rr=b),_r>b&&(Ar=_r/b,_r=b),this.current.startNewPathAndClipBox([0,0,rr,_r]);let Sr="groupAt"+this.groupLevel;ht.smask&&(Sr+="_smask_"+this.smaskCounter++%2);const Fr=this.cachedCanvases.getCanvas(Sr,rr,_r),ur=Fr.context;ur.scale(1/pr,1/Ar),ur.translate(-Ut,-Zt),ur.transform(...Tt),ht.smask?this.smaskStack.push({canvas:Fr.canvas,context:ur,offsetX:Ut,offsetY:Zt,scaleX:pr,scaleY:Ar,subtype:ht.smask.subtype,backdrop:ht.smask.backdrop,transferMap:ht.smask.transferMap||null,startTransformInverse:null}):(dt.setTransform(1,0,0,1,0,0),dt.translate(Ut,Zt),dt.scale(pr,Ar),dt.save()),pt(dt,ur),this.ctx=ur,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(dt),this.groupLevel++}endGroup(ht){if(!this.contentVisible)return;this.groupLevel--;const dt=this.ctx,Tt=this.groupStack.pop();if(this.ctx=Tt,this.ctx.imageSmoothingEnabled=!1,ht.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Mt=(0,c.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Mt);const It=a.Util.getAxialAlignedBoundingBox([0,0,dt.canvas.width,dt.canvas.height],Mt);this.ctx.drawImage(dt.canvas,0,0),this.ctx.restore(),this.compose(It)}}beginAnnotation(ht,dt,Tt,Mt,It){if(or(this,qt,Us).call(this),Et(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(dt)&&dt.length===4){const Ut=dt[2]-dt[0],Zt=dt[3]-dt[1];if(It&&this.annotationCanvasMap){Tt=Tt.slice(),Tt[4]-=dt[0],Tt[5]-=dt[1],dt=dt.slice(),dt[0]=dt[1]=0,dt[2]=Ut,dt[3]=Zt;const[rr,_r]=a.Util.singularValueDecompose2dScale((0,c.getCurrentTransform)(this.ctx)),{viewportScale:pr}=this,Ar=Math.ceil(Ut*this.outputScaleX*pr),Sr=Math.ceil(Zt*this.outputScaleY*pr);this.annotationCanvas=this.canvasFactory.create(Ar,Sr);const{canvas:Fr,context:ur}=this.annotationCanvas;this.annotationCanvasMap.set(ht,Fr),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ur,this.ctx.save(),this.ctx.setTransform(rr,0,0,-_r,0,Zt*_r),Et(this.ctx)}else Et(this.ctx),this.ctx.rect(dt[0],dt[1],Ut,Zt),this.ctx.clip(),this.endPath()}this.current=new st(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Tt),this.transform(...Mt)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),or(this,qt,$s).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ht){if(!this.contentVisible)return;const dt=ht.count;ht=this.getObject(ht.data,ht),ht.count=dt;const Tt=this.ctx,Mt=this.processingType3;if(Mt&&(Mt.compiled===void 0&&(Mt.compiled=ot(ht)),Mt.compiled)){Mt.compiled(Tt);return}const It=this._createMaskCanvas(ht),Ut=It.canvas;Tt.save(),Tt.setTransform(1,0,0,1,0,0),Tt.drawImage(Ut,It.offsetX,It.offsetY),Tt.restore(),this.compose()}paintImageMaskXObjectRepeat(ht,dt,Tt=0,Mt=0,It,Ut){if(!this.contentVisible)return;ht=this.getObject(ht.data,ht);const Zt=this.ctx;Zt.save();const rr=(0,c.getCurrentTransform)(Zt);Zt.transform(dt,Tt,Mt,It,0,0);const _r=this._createMaskCanvas(ht);Zt.setTransform(1,0,0,1,_r.offsetX-rr[4],_r.offsetY-rr[5]);for(let pr=0,Ar=Ut.length;pr<Ar;pr+=2){const Sr=a.Util.transform(rr,[dt,Tt,Mt,It,Ut[pr],Ut[pr+1]]),[Fr,ur]=a.Util.applyTransform([0,0],Sr);Zt.drawImage(_r.canvas,Fr,ur)}Zt.restore(),this.compose()}paintImageMaskXObjectGroup(ht){if(!this.contentVisible)return;const dt=this.ctx,Tt=this.current.fillColor,Mt=this.current.patternFill;for(const It of ht){const{data:Ut,width:Zt,height:rr,transform:_r}=It,pr=this.cachedCanvases.getCanvas("maskCanvas",Zt,rr),Ar=pr.context;Ar.save();const Sr=this.getObject(Ut,It);mt(Ar,Sr),Ar.globalCompositeOperation="source-in",Ar.fillStyle=Mt?Tt.getPattern(Ar,this,(0,c.getCurrentTransformInverse)(dt),d.PathType.FILL):Tt,Ar.fillRect(0,0,Zt,rr),Ar.restore(),dt.save(),dt.transform(..._r),dt.scale(1,-1),at(dt,pr.canvas,0,0,Zt,rr,0,-1,1,1),dt.restore()}this.compose()}paintImageXObject(ht){if(!this.contentVisible)return;const dt=this.getObject(ht);if(!dt){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(dt)}paintImageXObjectRepeat(ht,dt,Tt,Mt){if(!this.contentVisible)return;const It=this.getObject(ht);if(!It){(0,a.warn)("Dependent image isn't ready yet");return}const Ut=It.width,Zt=It.height,rr=[];for(let _r=0,pr=Mt.length;_r<pr;_r+=2)rr.push({transform:[dt,0,0,Tt,Mt[_r],Mt[_r+1]],x:0,y:0,w:Ut,h:Zt});this.paintInlineImageXObjectGroup(It,rr)}applyTransferMapsToCanvas(ht){return this.current.transferMaps!=="none"&&(ht.filter=this.current.transferMaps,ht.drawImage(ht.canvas,0,0),ht.filter="none"),ht.canvas}applyTransferMapsToBitmap(ht){if(this.current.transferMaps==="none")return ht.bitmap;const{bitmap:dt,width:Tt,height:Mt}=ht,It=this.cachedCanvases.getCanvas("inlineImage",Tt,Mt),Ut=It.context;return Ut.filter=this.current.transferMaps,Ut.drawImage(dt,0,0),Ut.filter="none",It.canvas}paintInlineImageXObject(ht){if(!this.contentVisible)return;const dt=ht.width,Tt=ht.height,Mt=this.ctx;if(this.save(),!a.isNodeJS){const{filter:Zt}=Mt;Zt!=="none"&&Zt!==""&&(Mt.filter="none")}Mt.scale(1/dt,-1/Tt);let It;if(ht.bitmap)It=this.applyTransferMapsToBitmap(ht);else if(typeof HTMLElement=="function"&&ht instanceof HTMLElement||!ht.data)It=ht;else{const rr=this.cachedCanvases.getCanvas("inlineImage",dt,Tt).context;ct(rr,ht),It=this.applyTransferMapsToCanvas(rr)}const Ut=this._scaleImage(It,(0,c.getCurrentTransformInverse)(Mt));Mt.imageSmoothingEnabled=Ct((0,c.getCurrentTransform)(Mt),ht.interpolate),at(Mt,Ut.img,0,0,Ut.paintWidth,Ut.paintHeight,0,-Tt,dt,Tt),this.compose(),this.restore()}paintInlineImageXObjectGroup(ht,dt){if(!this.contentVisible)return;const Tt=this.ctx;let Mt;if(ht.bitmap)Mt=ht.bitmap;else{const It=ht.width,Ut=ht.height,rr=this.cachedCanvases.getCanvas("inlineImage",It,Ut).context;ct(rr,ht),Mt=this.applyTransferMapsToCanvas(rr)}for(const It of dt)Tt.save(),Tt.transform(...It.transform),Tt.scale(1,-1),at(Tt,Mt,It.x,It.y,It.w,It.h,0,-1,1,1),Tt.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ht){}markPointProps(ht,dt){}beginMarkedContent(ht){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ht,dt){ht==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(dt)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ht){const dt=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ht);const Tt=this.ctx;this.pendingClip&&(dt||(this.pendingClip===nr?Tt.clip("evenodd"):Tt.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Tt.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ht=(0,c.getCurrentTransform)(this.ctx);if(ht[1]===0&&ht[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ht[0]),Math.abs(ht[3]));else{const dt=Math.abs(ht[0]*ht[3]-ht[2]*ht[1]),Tt=Math.hypot(ht[0],ht[2]),Mt=Math.hypot(ht[1],ht[3]);this._cachedGetSinglePixelWidth=Math.max(Tt,Mt)/dt}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ht}=this.current,{a:dt,b:Tt,c:Mt,d:It}=this.ctx.getTransform();let Ut,Zt;if(Tt===0&&Mt===0){const rr=Math.abs(dt),_r=Math.abs(It);if(rr===_r)if(ht===0)Ut=Zt=1/rr;else{const pr=rr*ht;Ut=Zt=pr<1?1/pr:1}else if(ht===0)Ut=1/rr,Zt=1/_r;else{const pr=rr*ht,Ar=_r*ht;Ut=pr<1?1/pr:1,Zt=Ar<1?1/Ar:1}}else{const rr=Math.abs(dt*It-Tt*Mt),_r=Math.hypot(dt,Tt),pr=Math.hypot(Mt,It);if(ht===0)Ut=pr/rr,Zt=_r/rr;else{const Ar=ht*rr;Ut=pr>Ar?pr/Ar:1,Zt=_r>Ar?_r/Ar:1}}this._cachedScaleForStroking[0]=Ut,this._cachedScaleForStroking[1]=Zt}return this._cachedScaleForStroking}rescaleAndStroke(ht){const{ctx:dt}=this,{lineWidth:Tt}=this.current,[Mt,It]=this.getScaleForStroking();if(dt.lineWidth=Tt||1,Mt===1&&It===1){dt.stroke();return}const Ut=dt.getLineDash();if(ht&&dt.save(),dt.scale(Mt,It),Ut.length>0){const Zt=Math.max(Mt,It);dt.setLineDash(Ut.map(rr=>rr/Zt)),dt.lineDashOffset/=Zt}dt.stroke(),ht&&dt.restore()}isContentVisible(){for(let ht=this.markedContentStack.length-1;ht>=0;ht--)if(!this.markedContentStack[ht].visible)return!1;return!0}};qt=new WeakSet,Us=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},$s=function(){if(this.pageColors){const ht=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ht!=="none"){const dt=this.ctx.filter;this.ctx.filter=ht,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=dt}}};let Jt=sr;i.CanvasGraphics=Jt;for(const At in a.OPS)Jt.prototype[At]!==void 0&&(Jt.prototype[a.OPS[At]]=Jt.prototype[At])},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=et;var a=s(1),c=s(6);const d={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=d;function h(ot,st){if(!st)return;const ct=st[2]-st[0],mt=st[3]-st[1],pt=new Path2D;pt.rect(st[0],st[1],ct,mt),ot.clip(pt)}class g{constructor(){this.constructor===g&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class _ extends g{constructor(st){super(),this._type=st[1],this._bbox=st[2],this._colorStops=st[3],this._p0=st[4],this._p1=st[5],this._r0=st[6],this._r1=st[7],this.matrix=null}_createGradient(st){let ct;this._type==="axial"?ct=st.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(ct=st.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const mt of this._colorStops)ct.addColorStop(mt[0],mt[1]);return ct}getPattern(st,ct,mt,pt){let Et;if(pt===d.STROKE||pt===d.FILL){const ut=ct.current.getClippedPathBoundingBox(pt,(0,c.getCurrentTransform)(st))||[0,0,0,0],gt=Math.ceil(ut[2]-ut[0])||1,xt=Math.ceil(ut[3]-ut[1])||1,Pt=ct.cachedCanvases.getCanvas("pattern",gt,xt,!0),St=Pt.context;St.clearRect(0,0,St.canvas.width,St.canvas.height),St.beginPath(),St.rect(0,0,St.canvas.width,St.canvas.height),St.translate(-ut[0],-ut[1]),mt=a.Util.transform(mt,[1,0,0,1,ut[0],ut[1]]),St.transform(...ct.baseTransform),this.matrix&&St.transform(...this.matrix),h(St,this._bbox),St.fillStyle=this._createGradient(St),St.fill(),Et=st.createPattern(Pt.canvas,"no-repeat");const Ct=new DOMMatrix(mt);Et.setTransform(Ct)}else h(st,this._bbox),Et=this._createGradient(st);return Et}}function b(ot,st,ct,mt,pt,Et,ut,gt){const xt=st.coords,Pt=st.colors,St=ot.data,Ct=ot.width*4;let Lt;xt[ct+1]>xt[mt+1]&&(Lt=ct,ct=mt,mt=Lt,Lt=Et,Et=ut,ut=Lt),xt[mt+1]>xt[pt+1]&&(Lt=mt,mt=pt,pt=Lt,Lt=ut,ut=gt,gt=Lt),xt[ct+1]>xt[mt+1]&&(Lt=ct,ct=mt,mt=Lt,Lt=Et,Et=ut,ut=Lt);const er=(xt[ct]+st.offsetX)*st.scaleX,Kt=(xt[ct+1]+st.offsetY)*st.scaleY,nr=(xt[mt]+st.offsetX)*st.scaleX,Jt=(xt[mt+1]+st.offsetY)*st.scaleY,qt=(xt[pt]+st.offsetX)*st.scaleX,kt=(xt[pt+1]+st.offsetY)*st.scaleY;if(Kt>=kt)return;const Xt=Pt[Et],sr=Pt[Et+1],At=Pt[Et+2],ht=Pt[ut],dt=Pt[ut+1],Tt=Pt[ut+2],Mt=Pt[gt],It=Pt[gt+1],Ut=Pt[gt+2],Zt=Math.round(Kt),rr=Math.round(kt);let _r,pr,Ar,Sr,Fr,ur,ir,Bt;for(let Qt=Zt;Qt<=rr;Qt++){if(Qt<Jt){const kr=Qt<Kt?0:(Kt-Qt)/(Kt-Jt);_r=er-(er-nr)*kr,pr=Xt-(Xt-ht)*kr,Ar=sr-(sr-dt)*kr,Sr=At-(At-Tt)*kr}else{let kr;Qt>kt?kr=1:Jt===kt?kr=0:kr=(Jt-Qt)/(Jt-kt),_r=nr-(nr-qt)*kr,pr=ht-(ht-Mt)*kr,Ar=dt-(dt-It)*kr,Sr=Tt-(Tt-Ut)*kr}let fr;Qt<Kt?fr=0:Qt>kt?fr=1:fr=(Kt-Qt)/(Kt-kt),Fr=er-(er-qt)*fr,ur=Xt-(Xt-Mt)*fr,ir=sr-(sr-It)*fr,Bt=At-(At-Ut)*fr;const hr=Math.round(Math.min(_r,Fr)),Tr=Math.round(Math.max(_r,Fr));let Mr=Ct*Qt+hr*4;for(let kr=hr;kr<=Tr;kr++)fr=(_r-kr)/(_r-Fr),fr<0?fr=0:fr>1&&(fr=1),St[Mr++]=pr-(pr-ur)*fr|0,St[Mr++]=Ar-(Ar-ir)*fr|0,St[Mr++]=Sr-(Sr-Bt)*fr|0,St[Mr++]=255}}function _e(ot,st,ct){const mt=st.coords,pt=st.colors;let Et,ut;switch(st.type){case"lattice":const gt=st.verticesPerRow,xt=Math.floor(mt.length/gt)-1,Pt=gt-1;for(Et=0;Et<xt;Et++){let St=Et*gt;for(let Ct=0;Ct<Pt;Ct++,St++)b(ot,ct,mt[St],mt[St+1],mt[St+gt],pt[St],pt[St+1],pt[St+gt]),b(ot,ct,mt[St+gt+1],mt[St+1],mt[St+gt],pt[St+gt+1],pt[St+1],pt[St+gt])}break;case"triangles":for(Et=0,ut=mt.length;Et<ut;Et+=3)b(ot,ct,mt[Et],mt[Et+1],mt[Et+2],pt[Et],pt[Et+1],pt[Et+2]);break;default:throw new Error("illegal figure")}}class nt extends g{constructor(st){super(),this._coords=st[2],this._colors=st[3],this._figures=st[4],this._bounds=st[5],this._bbox=st[7],this._background=st[8],this.matrix=null}_createMeshCanvas(st,ct,mt){const gt=Math.floor(this._bounds[0]),xt=Math.floor(this._bounds[1]),Pt=Math.ceil(this._bounds[2])-gt,St=Math.ceil(this._bounds[3])-xt,Ct=Math.min(Math.ceil(Math.abs(Pt*st[0]*1.1)),3e3),Lt=Math.min(Math.ceil(Math.abs(St*st[1]*1.1)),3e3),er=Pt/Ct,Kt=St/Lt,nr={coords:this._coords,colors:this._colors,offsetX:-gt,offsetY:-xt,scaleX:1/er,scaleY:1/Kt},Jt=Ct+2*2,qt=Lt+2*2,kt=mt.getCanvas("mesh",Jt,qt,!1),Xt=kt.context,sr=Xt.createImageData(Ct,Lt);if(ct){const ht=sr.data;for(let dt=0,Tt=ht.length;dt<Tt;dt+=4)ht[dt]=ct[0],ht[dt+1]=ct[1],ht[dt+2]=ct[2],ht[dt+3]=255}for(const ht of this._figures)_e(sr,ht,nr);return Xt.putImageData(sr,2,2),{canvas:kt.canvas,offsetX:gt-2*er,offsetY:xt-2*Kt,scaleX:er,scaleY:Kt}}getPattern(st,ct,mt,pt){h(st,this._bbox);let Et;if(pt===d.SHADING)Et=a.Util.singularValueDecompose2dScale((0,c.getCurrentTransform)(st));else if(Et=a.Util.singularValueDecompose2dScale(ct.baseTransform),this.matrix){const gt=a.Util.singularValueDecompose2dScale(this.matrix);Et=[Et[0]*gt[0],Et[1]*gt[1]]}const ut=this._createMeshCanvas(Et,pt===d.SHADING?null:this._background,ct.cachedCanvases);return pt!==d.SHADING&&(st.setTransform(...ct.baseTransform),this.matrix&&st.transform(...this.matrix)),st.translate(ut.offsetX,ut.offsetY),st.scale(ut.scaleX,ut.scaleY),st.createPattern(ut.canvas,"no-repeat")}}class it extends g{getPattern(){return"hotpink"}}function et(ot){switch(ot[0]){case"RadialAxial":return new _(ot);case"Mesh":return new nt(ot);case"Dummy":return new it}throw new Error(`Unknown IR type: ${ot[0]}`)}const lt={COLORED:1,UNCOLORED:2},at=class at{constructor(st,ct,mt,pt,Et){this.operatorList=st[2],this.matrix=st[3]||[1,0,0,1,0,0],this.bbox=st[4],this.xstep=st[5],this.ystep=st[6],this.paintType=st[7],this.tilingType=st[8],this.color=ct,this.ctx=mt,this.canvasGraphicsFactory=pt,this.baseTransform=Et}createPatternCanvas(st){const ct=this.operatorList,mt=this.bbox,pt=this.xstep,Et=this.ystep,ut=this.paintType,gt=this.tilingType,xt=this.color,Pt=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+gt);const St=mt[0],Ct=mt[1],Lt=mt[2],er=mt[3],Kt=a.Util.singularValueDecompose2dScale(this.matrix),nr=a.Util.singularValueDecompose2dScale(this.baseTransform),Jt=[Kt[0]*nr[0],Kt[1]*nr[1]],qt=this.getSizeAndScale(pt,this.ctx.canvas.width,Jt[0]),kt=this.getSizeAndScale(Et,this.ctx.canvas.height,Jt[1]),Xt=st.cachedCanvases.getCanvas("pattern",qt.size,kt.size,!0),sr=Xt.context,At=Pt.createCanvasGraphics(sr);At.groupLevel=st.groupLevel,this.setFillAndStrokeStyleToContext(At,ut,xt);let ht=St,dt=Ct,Tt=Lt,Mt=er;return St<0&&(ht=0,Tt+=Math.abs(St)),Ct<0&&(dt=0,Mt+=Math.abs(Ct)),sr.translate(-(qt.scale*ht),-(kt.scale*dt)),At.transform(qt.scale,0,0,kt.scale,0,0),sr.save(),this.clipBbox(At,ht,dt,Tt,Mt),At.baseTransform=(0,c.getCurrentTransform)(At.ctx),At.executeOperatorList(ct),At.endDrawing(),{canvas:Xt.canvas,scaleX:qt.scale,scaleY:kt.scale,offsetX:ht,offsetY:dt}}getSizeAndScale(st,ct,mt){st=Math.abs(st);const pt=Math.max(at.MAX_PATTERN_SIZE,ct);let Et=Math.ceil(st*mt);return Et>=pt?Et=pt:mt=Et/st,{scale:mt,size:Et}}clipBbox(st,ct,mt,pt,Et){const ut=pt-ct,gt=Et-mt;st.ctx.rect(ct,mt,ut,gt),st.current.updateRectMinMax((0,c.getCurrentTransform)(st.ctx),[ct,mt,pt,Et]),st.clip(),st.endPath()}setFillAndStrokeStyleToContext(st,ct,mt){const pt=st.ctx,Et=st.current;switch(ct){case lt.COLORED:const ut=this.ctx;pt.fillStyle=ut.fillStyle,pt.strokeStyle=ut.strokeStyle,Et.fillColor=ut.fillStyle,Et.strokeColor=ut.strokeStyle;break;case lt.UNCOLORED:const gt=a.Util.makeHexColor(mt[0],mt[1],mt[2]);pt.fillStyle=gt,pt.strokeStyle=gt,Et.fillColor=gt,Et.strokeColor=gt;break;default:throw new a.FormatError(`Unsupported paint type: ${ct}`)}}getPattern(st,ct,mt,pt){let Et=mt;pt!==d.SHADING&&(Et=a.Util.transform(Et,ct.baseTransform),this.matrix&&(Et=a.Util.transform(Et,this.matrix)));const ut=this.createPatternCanvas(ct);let gt=new DOMMatrix(Et);gt=gt.translate(ut.offsetX,ut.offsetY),gt=gt.scale(1/ut.scaleX,1/ut.scaleY);const xt=st.createPattern(ut.canvas,"repeat");return xt.setTransform(gt),xt}};an(at,"MAX_PATTERN_SIZE",3e3);let rt=at;i.TilingPattern=rt},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=d,i.convertToRGBA=c,i.grayToRGBA=g;var a=s(1);function c(_){switch(_.kind){case a.ImageKind.GRAYSCALE_1BPP:return d(_);case a.ImageKind.RGB_24BPP:return h(_)}return null}function d({src:_,srcPos:b=0,dest:_e,width:nt,height:it,nonBlackColor:et=4294967295,inverseDecode:lt=!1}){const rt=a.FeatureTest.isLittleEndian?4278190080:255,[at,ot]=lt?[et,rt]:[rt,et],st=nt>>3,ct=nt&7,mt=_.length;_e=new Uint32Array(_e.buffer);let pt=0;for(let Et=0;Et<it;Et++){for(const gt=b+st;b<gt;b++){const xt=b<mt?_[b]:255;_e[pt++]=xt&128?ot:at,_e[pt++]=xt&64?ot:at,_e[pt++]=xt&32?ot:at,_e[pt++]=xt&16?ot:at,_e[pt++]=xt&8?ot:at,_e[pt++]=xt&4?ot:at,_e[pt++]=xt&2?ot:at,_e[pt++]=xt&1?ot:at}if(ct===0)continue;const ut=b<mt?_[b++]:255;for(let gt=0;gt<ct;gt++)_e[pt++]=ut&1<<7-gt?ot:at}return{srcPos:b,destPos:pt}}function h({src:_,srcPos:b=0,dest:_e,destPos:nt=0,width:it,height:et}){let lt=0;const rt=_.length>>2,at=new Uint32Array(_.buffer,b,rt);if(a.FeatureTest.isLittleEndian){for(;lt<rt-2;lt+=3,nt+=4){const ot=at[lt],st=at[lt+1],ct=at[lt+2];_e[nt]=ot|4278190080,_e[nt+1]=ot>>>24|st<<8|4278190080,_e[nt+2]=st>>>16|ct<<16|4278190080,_e[nt+3]=ct>>>8|4278190080}for(let ot=lt*4,st=_.length;ot<st;ot+=3)_e[nt++]=_[ot]|_[ot+1]<<8|_[ot+2]<<16|4278190080}else{for(;lt<rt-2;lt+=3,nt+=4){const ot=at[lt],st=at[lt+1],ct=at[lt+2];_e[nt]=ot|255,_e[nt+1]=ot<<24|st>>>8|255,_e[nt+2]=st<<16|ct>>>16|255,_e[nt+3]=ct<<8|255}for(let ot=lt*4,st=_.length;ot<st;ot+=3)_e[nt++]=_[ot]<<24|_[ot+1]<<16|_[ot+2]<<8|255}return{srcPos:b,destPos:nt}}function g(_,b){if(a.FeatureTest.isLittleEndian)for(let _e=0,nt=_.length;_e<nt;_e++)b[_e]=_[_e]*65793|4278190080;else for(let _e=0,nt=_.length;_e<nt;_e++)b[_e]=_[_e]*16843008|255}},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const s=Object.create(null);i.GlobalWorkerOptions=s,s.workerPort=null,s.workerSrc=""},(e,i,s)=>{var _,xo,wo,ms;Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var a=s(1);const c={UNKNOWN:0,DATA:1,ERROR:2},d={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function h(it){switch(it instanceof Error||typeof it=="object"&&it!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),it.name){case"AbortException":return new a.AbortException(it.message);case"MissingPDFException":return new a.MissingPDFException(it.message);case"PasswordException":return new a.PasswordException(it.message,it.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(it.message,it.status);case"UnknownErrorException":return new a.UnknownErrorException(it.message,it.details);default:return new a.UnknownErrorException(it.message,it.toString())}}class g{constructor(et,lt,rt){cr(this,_);this.sourceName=et,this.targetName=lt,this.comObj=rt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=at=>{const ot=at.data;if(ot.targetName!==this.sourceName)return;if(ot.stream){or(this,_,wo).call(this,ot);return}if(ot.callback){const ct=ot.callbackId,mt=this.callbackCapabilities[ct];if(!mt)throw new Error(`Cannot resolve callback ${ct}`);if(delete this.callbackCapabilities[ct],ot.callback===c.DATA)mt.resolve(ot.data);else if(ot.callback===c.ERROR)mt.reject(h(ot.reason));else throw new Error("Unexpected callback case");return}const st=this.actionHandler[ot.action];if(!st)throw new Error(`Unknown action from worker: ${ot.action}`);if(ot.callbackId){const ct=this.sourceName,mt=ot.sourceName;new Promise(function(pt){pt(st(ot.data))}).then(function(pt){rt.postMessage({sourceName:ct,targetName:mt,callback:c.DATA,callbackId:ot.callbackId,data:pt})},function(pt){rt.postMessage({sourceName:ct,targetName:mt,callback:c.ERROR,callbackId:ot.callbackId,reason:h(pt)})});return}if(ot.streamId){or(this,_,xo).call(this,ot);return}st(ot.data)},rt.addEventListener("message",this._onComObjOnMessage)}on(et,lt){const rt=this.actionHandler;if(rt[et])throw new Error(`There is already an actionName called "${et}"`);rt[et]=lt}send(et,lt,rt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:et,data:lt},rt)}sendWithPromise(et,lt,rt){const at=this.callbackId++,ot=new a.PromiseCapability;this.callbackCapabilities[at]=ot;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:et,callbackId:at,data:lt},rt)}catch(st){ot.reject(st)}return ot.promise}sendWithStream(et,lt,rt,at){const ot=this.streamId++,st=this.sourceName,ct=this.targetName,mt=this.comObj;return new ReadableStream({start:pt=>{const Et=new a.PromiseCapability;return this.streamControllers[ot]={controller:pt,startCall:Et,pullCall:null,cancelCall:null,isClosed:!1},mt.postMessage({sourceName:st,targetName:ct,action:et,streamId:ot,data:lt,desiredSize:pt.desiredSize},at),Et.promise},pull:pt=>{const Et=new a.PromiseCapability;return this.streamControllers[ot].pullCall=Et,mt.postMessage({sourceName:st,targetName:ct,stream:d.PULL,streamId:ot,desiredSize:pt.desiredSize}),Et.promise},cancel:pt=>{(0,a.assert)(pt instanceof Error,"cancel must have a valid reason");const Et=new a.PromiseCapability;return this.streamControllers[ot].cancelCall=Et,this.streamControllers[ot].isClosed=!0,mt.postMessage({sourceName:st,targetName:ct,stream:d.CANCEL,streamId:ot,reason:h(pt)}),Et.promise}},rt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}_=new WeakSet,xo=function(et){const lt=et.streamId,rt=this.sourceName,at=et.sourceName,ot=this.comObj,st=this,ct=this.actionHandler[et.action],mt={enqueue(pt,Et=1,ut){if(this.isCancelled)return;const gt=this.desiredSize;this.desiredSize-=Et,gt>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),ot.postMessage({sourceName:rt,targetName:at,stream:d.ENQUEUE,streamId:lt,chunk:pt},ut)},close(){this.isCancelled||(this.isCancelled=!0,ot.postMessage({sourceName:rt,targetName:at,stream:d.CLOSE,streamId:lt}),delete st.streamSinks[lt])},error(pt){(0,a.assert)(pt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,ot.postMessage({sourceName:rt,targetName:at,stream:d.ERROR,streamId:lt,reason:h(pt)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:et.desiredSize,ready:null};mt.sinkCapability.resolve(),mt.ready=mt.sinkCapability.promise,this.streamSinks[lt]=mt,new Promise(function(pt){pt(ct(et.data,mt))}).then(function(){ot.postMessage({sourceName:rt,targetName:at,stream:d.START_COMPLETE,streamId:lt,success:!0})},function(pt){ot.postMessage({sourceName:rt,targetName:at,stream:d.START_COMPLETE,streamId:lt,reason:h(pt)})})},wo=function(et){const lt=et.streamId,rt=this.sourceName,at=et.sourceName,ot=this.comObj,st=this.streamControllers[lt],ct=this.streamSinks[lt];switch(et.stream){case d.START_COMPLETE:et.success?st.startCall.resolve():st.startCall.reject(h(et.reason));break;case d.PULL_COMPLETE:et.success?st.pullCall.resolve():st.pullCall.reject(h(et.reason));break;case d.PULL:if(!ct){ot.postMessage({sourceName:rt,targetName:at,stream:d.PULL_COMPLETE,streamId:lt,success:!0});break}ct.desiredSize<=0&&et.desiredSize>0&&ct.sinkCapability.resolve(),ct.desiredSize=et.desiredSize,new Promise(function(mt){var pt;mt((pt=ct.onPull)==null?void 0:pt.call(ct))}).then(function(){ot.postMessage({sourceName:rt,targetName:at,stream:d.PULL_COMPLETE,streamId:lt,success:!0})},function(mt){ot.postMessage({sourceName:rt,targetName:at,stream:d.PULL_COMPLETE,streamId:lt,reason:h(mt)})});break;case d.ENQUEUE:if((0,a.assert)(st,"enqueue should have stream controller"),st.isClosed)break;st.controller.enqueue(et.chunk);break;case d.CLOSE:if((0,a.assert)(st,"close should have stream controller"),st.isClosed)break;st.isClosed=!0,st.controller.close(),or(this,_,ms).call(this,st,lt);break;case d.ERROR:(0,a.assert)(st,"error should have stream controller"),st.controller.error(h(et.reason)),or(this,_,ms).call(this,st,lt);break;case d.CANCEL_COMPLETE:et.success?st.cancelCall.resolve():st.cancelCall.reject(h(et.reason)),or(this,_,ms).call(this,st,lt);break;case d.CANCEL:if(!ct)break;new Promise(function(mt){var pt;mt((pt=ct.onCancel)==null?void 0:pt.call(ct,h(et.reason)))}).then(function(){ot.postMessage({sourceName:rt,targetName:at,stream:d.CANCEL_COMPLETE,streamId:lt,success:!0})},function(mt){ot.postMessage({sourceName:rt,targetName:at,stream:d.CANCEL_COMPLETE,streamId:lt,reason:h(mt)})}),ct.sinkCapability.reject(h(et.reason)),ct.isCancelled=!0,delete this.streamSinks[lt];break;default:throw new Error("Unexpected stream case")}},ms=async function(et,lt){var rt,at,ot;await Promise.allSettled([(rt=et.startCall)==null?void 0:rt.promise,(at=et.pullCall)==null?void 0:at.promise,(ot=et.cancelCall)==null?void 0:ot.promise]),delete this.streamControllers[lt]},i.MessageHandler=g},(e,i,s)=>{var d,h;Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var a=s(1);class c{constructor({parsedData:_,rawData:b}){cr(this,d);cr(this,h);lr(this,d,_),lr(this,h,b)}getRaw(){return ft(this,h)}get(_){return ft(this,d).get(_)??null}getAll(){return(0,a.objectFromMap)(ft(this,d))}has(_){return ft(this,d).has(_)}}d=new WeakMap,h=new WeakMap,i.Metadata=c},(e,i,s)=>{var _,b,_e,nt,it,et,Ws;Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var a=s(1),c=s(8);const d=Symbol("INTERNAL");class h{constructor(at,ot){cr(this,_,!0);this.name=at,this.intent=ot}get visible(){return ft(this,_)}_setVisible(at,ot){at!==d&&(0,a.unreachable)("Internal method `_setVisible` called."),lr(this,_,ot)}}_=new WeakMap;class g{constructor(at){cr(this,et);cr(this,b,null);cr(this,_e,new Map);cr(this,nt,null);cr(this,it,null);if(this.name=null,this.creator=null,at!==null){this.name=at.name,this.creator=at.creator,lr(this,it,at.order);for(const ot of at.groups)ft(this,_e).set(ot.id,new h(ot.name,ot.intent));if(at.baseState==="OFF")for(const ot of ft(this,_e).values())ot._setVisible(d,!1);for(const ot of at.on)ft(this,_e).get(ot)._setVisible(d,!0);for(const ot of at.off)ft(this,_e).get(ot)._setVisible(d,!1);lr(this,nt,this.getHash())}}isVisible(at){if(ft(this,_e).size===0)return!0;if(!at)return(0,a.warn)("Optional content group not defined."),!0;if(at.type==="OCG")return ft(this,_e).has(at.id)?ft(this,_e).get(at.id).visible:((0,a.warn)(`Optional content group not found: ${at.id}`),!0);if(at.type==="OCMD"){if(at.expression)return or(this,et,Ws).call(this,at.expression);if(!at.policy||at.policy==="AnyOn"){for(const ot of at.ids){if(!ft(this,_e).has(ot))return(0,a.warn)(`Optional content group not found: ${ot}`),!0;if(ft(this,_e).get(ot).visible)return!0}return!1}else if(at.policy==="AllOn"){for(const ot of at.ids){if(!ft(this,_e).has(ot))return(0,a.warn)(`Optional content group not found: ${ot}`),!0;if(!ft(this,_e).get(ot).visible)return!1}return!0}else if(at.policy==="AnyOff"){for(const ot of at.ids){if(!ft(this,_e).has(ot))return(0,a.warn)(`Optional content group not found: ${ot}`),!0;if(!ft(this,_e).get(ot).visible)return!0}return!1}else if(at.policy==="AllOff"){for(const ot of at.ids){if(!ft(this,_e).has(ot))return(0,a.warn)(`Optional content group not found: ${ot}`),!0;if(ft(this,_e).get(ot).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${at.policy}.`),!0}return(0,a.warn)(`Unknown group type ${at.type}.`),!0}setVisibility(at,ot=!0){if(!ft(this,_e).has(at)){(0,a.warn)(`Optional content group not found: ${at}`);return}ft(this,_e).get(at)._setVisible(d,!!ot),lr(this,b,null)}get hasInitialVisibility(){return ft(this,nt)===null||this.getHash()===ft(this,nt)}getOrder(){return ft(this,_e).size?ft(this,it)?ft(this,it).slice():[...ft(this,_e).keys()]:null}getGroups(){return ft(this,_e).size>0?(0,a.objectFromMap)(ft(this,_e)):null}getGroup(at){return ft(this,_e).get(at)||null}getHash(){if(ft(this,b)!==null)return ft(this,b);const at=new c.MurmurHash3_64;for(const[ot,st]of ft(this,_e))at.update(`${ot}:${st.visible}`);return lr(this,b,at.hexdigest())}}b=new WeakMap,_e=new WeakMap,nt=new WeakMap,it=new WeakMap,et=new WeakSet,Ws=function(at){const ot=at.length;if(ot<2)return!0;const st=at[0];for(let ct=1;ct<ot;ct++){const mt=at[ct];let pt;if(Array.isArray(mt))pt=or(this,et,Ws).call(this,mt);else if(ft(this,_e).has(mt))pt=ft(this,_e).get(mt).visible;else return(0,a.warn)(`Optional content group not found: ${mt}`),!0;switch(st){case"And":if(!pt)return!1;break;case"Or":if(pt)return!0;break;case"Not":return!pt;default:return!0}}return st==="And"},i.OptionalContentConfig=g},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var a=s(1),c=s(6);class d{constructor({length:b,initialData:_e,progressiveDone:nt=!1,contentDispositionFilename:it=null,disableRange:et=!1,disableStream:lt=!1},rt){if((0,a.assert)(rt,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=nt,this._contentDispositionFilename=it,(_e==null?void 0:_e.length)>0){const at=_e instanceof Uint8Array&&_e.byteLength===_e.buffer.byteLength?_e.buffer:new Uint8Array(_e).buffer;this._queuedChunks.push(at)}this._pdfDataRangeTransport=rt,this._isStreamingSupported=!lt,this._isRangeSupported=!et,this._contentLength=b,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((at,ot)=>{this._onReceiveData({begin:at,chunk:ot})}),this._pdfDataRangeTransport.addProgressListener((at,ot)=>{this._onProgress({loaded:at,total:ot})}),this._pdfDataRangeTransport.addProgressiveReadListener(at=>{this._onReceiveData({chunk:at})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:b,chunk:_e}){const nt=_e instanceof Uint8Array&&_e.byteLength===_e.buffer.byteLength?_e.buffer:new Uint8Array(_e).buffer;if(b===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(nt):this._queuedChunks.push(nt);else{const it=this._rangeReaders.some(function(et){return et._begin!==b?!1:(et._enqueue(nt),!0)});(0,a.assert)(it,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var b;return((b=this._fullRequestReader)==null?void 0:b._loaded)??0}_onProgress(b){var _e,nt,it,et;b.total===void 0?(nt=(_e=this._rangeReaders[0])==null?void 0:_e.onProgress)==null||nt.call(_e,{loaded:b.loaded}):(et=(it=this._fullRequestReader)==null?void 0:it.onProgress)==null||et.call(it,{loaded:b.loaded,total:b.total})}_onProgressiveDone(){var b;(b=this._fullRequestReader)==null||b.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(b){const _e=this._rangeReaders.indexOf(b);_e>=0&&this._rangeReaders.splice(_e,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const b=this._queuedChunks;return this._queuedChunks=null,new h(this,b,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(b,_e){if(_e<=this._progressiveDataLength)return null;const nt=new g(this,b,_e);return this._pdfDataRangeTransport.requestDataRange(b,_e),this._rangeReaders.push(nt),nt}cancelAllRequests(b){var _e;(_e=this._fullRequestReader)==null||_e.cancel(b);for(const nt of this._rangeReaders.slice(0))nt.cancel(b);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=d;class h{constructor(b,_e,nt=!1,it=null){this._stream=b,this._done=nt||!1,this._filename=(0,c.isPdfFile)(it)?it:null,this._queuedChunks=_e||[],this._loaded=0;for(const et of this._queuedChunks)this._loaded+=et.byteLength;this._requests=[],this._headersReady=Promise.resolve(),b._fullRequestReader=this,this.onProgress=null}_enqueue(b){this._done||(this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunks.push(b),this._loaded+=b.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const b=new a.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const _e of this._requests)_e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class g{constructor(b,_e,nt){this._stream=b,this._begin=_e,this._end=nt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(b){if(!this._done){if(this._requests.length===0)this._queuedChunk=b;else{this._requests.shift().resolve({value:b,done:!1});for(const nt of this._requests)nt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const _e=this._queuedChunk;return this._queuedChunk=null,{value:_e,done:!1}}if(this._done)return{value:void 0,done:!0};const b=new a.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const _e of this._requests)_e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var a=s(1),c=s(20);function d(nt,it,et){return{method:"GET",headers:nt,signal:et.signal,mode:"cors",credentials:it?"include":"same-origin",redirect:"follow"}}function h(nt){const it=new Headers;for(const et in nt){const lt=nt[et];lt!==void 0&&it.append(et,lt)}return it}function g(nt){return nt instanceof Uint8Array?nt.buffer:nt instanceof ArrayBuffer?nt:((0,a.warn)(`getArrayBuffer - unexpected data format: ${nt}`),new Uint8Array(nt).buffer)}class _{constructor(it){this.source=it,this.isHttp=/^https?:/i.test(it.url),this.httpHeaders=this.isHttp&&it.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var it;return((it=this._fullRequestReader)==null?void 0:it._loaded)??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new b(this),this._fullRequestReader}getRangeReader(it,et){if(et<=this._progressiveDataLength)return null;const lt=new _e(this,it,et);return this._rangeRequestReaders.push(lt),lt}cancelAllRequests(it){var et;(et=this._fullRequestReader)==null||et.cancel(it);for(const lt of this._rangeRequestReaders.slice(0))lt.cancel(it)}}i.PDFFetchStream=_;class b{constructor(it){this._stream=it,this._reader=null,this._loaded=0,this._filename=null;const et=it.source;this._withCredentials=et.withCredentials||!1,this._contentLength=et.length,this._headersCapability=new a.PromiseCapability,this._disableRange=et.disableRange||!1,this._rangeChunkSize=et.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!et.disableStream,this._isRangeSupported=!et.disableRange,this._headers=h(this._stream.httpHeaders);const lt=et.url;fetch(lt,d(this._headers,this._withCredentials,this._abortController)).then(rt=>{if(!(0,c.validateResponseStatus)(rt.status))throw(0,c.createResponseStatusError)(rt.status,lt);this._reader=rt.body.getReader(),this._headersCapability.resolve();const at=ct=>rt.headers.get(ct),{allowRangeRequests:ot,suggestedLength:st}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:at,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ot,this._contentLength=st||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(at),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var lt;await this._headersCapability.promise;const{value:it,done:et}=await this._reader.read();return et?{value:it,done:et}:(this._loaded+=it.byteLength,(lt=this.onProgress)==null||lt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:g(it),done:!1})}cancel(it){var et;(et=this._reader)==null||et.cancel(it),this._abortController.abort()}}class _e{constructor(it,et,lt){this._stream=it,this._reader=null,this._loaded=0;const rt=it.source;this._withCredentials=rt.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!rt.disableStream,this._abortController=new AbortController,this._headers=h(this._stream.httpHeaders),this._headers.append("Range",`bytes=${et}-${lt-1}`);const at=rt.url;fetch(at,d(this._headers,this._withCredentials,this._abortController)).then(ot=>{if(!(0,c.validateResponseStatus)(ot.status))throw(0,c.createResponseStatusError)(ot.status,at);this._readCapability.resolve(),this._reader=ot.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var lt;await this._readCapability.promise;const{value:it,done:et}=await this._reader.read();return et?{value:it,done:et}:(this._loaded+=it.byteLength,(lt=this.onProgress)==null||lt.call(this,{loaded:this._loaded}),{value:g(it),done:!1})}cancel(it){var et;(et=this._reader)==null||et.cancel(it),this._abortController.abort()}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=_,i.extractFilenameFromHeader=g,i.validateRangeRequestCapabilities=h,i.validateResponseStatus=b;var a=s(1),c=s(21),d=s(6);function h({getResponseHeader:_e,isHttp:nt,rangeChunkSize:it,disableRange:et}){const lt={allowRangeRequests:!1,suggestedLength:void 0},rt=parseInt(_e("Content-Length"),10);return!Number.isInteger(rt)||(lt.suggestedLength=rt,rt<=2*it)||et||!nt||_e("Accept-Ranges")!=="bytes"||(_e("Content-Encoding")||"identity")!=="identity"||(lt.allowRangeRequests=!0),lt}function g(_e){const nt=_e("Content-Disposition");if(nt){let it=(0,c.getFilenameFromContentDispositionHeader)(nt);if(it.includes("%"))try{it=decodeURIComponent(it)}catch{}if((0,d.isPdfFile)(it))return it}return null}function _(_e,nt){return _e===404||_e===0&&nt.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+nt+'".'):new a.UnexpectedResponseException(`Unexpected server response (${_e}) while retrieving PDF "${nt}".`,_e)}function b(_e){return _e===200||_e===206}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=c;var a=s(1);function c(d){let h=!0,g=_("filename\\*","i").exec(d);if(g){g=g[1];let rt=it(g);return rt=unescape(rt),rt=et(rt),rt=lt(rt),_e(rt)}if(g=nt(d),g){const rt=lt(g);return _e(rt)}if(g=_("filename","i").exec(d),g){g=g[1];let rt=it(g);return rt=lt(rt),_e(rt)}function _(rt,at){return new RegExp("(?:^|;)\\s*"+rt+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',at)}function b(rt,at){if(rt){if(!/^[\x00-\xFF]+$/.test(at))return at;try{const ot=new TextDecoder(rt,{fatal:!0}),st=(0,a.stringToBytes)(at);at=ot.decode(st),h=!1}catch{}}return at}function _e(rt){return h&&/[\x80-\xff]/.test(rt)&&(rt=b("utf-8",rt),h&&(rt=b("iso-8859-1",rt))),rt}function nt(rt){const at=[];let ot;const st=_("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(ot=st.exec(rt))!==null;){let[,mt,pt,Et]=ot;if(mt=parseInt(mt,10),mt in at){if(mt===0)break;continue}at[mt]=[pt,Et]}const ct=[];for(let mt=0;mt<at.length&&mt in at;++mt){let[pt,Et]=at[mt];Et=it(Et),pt&&(Et=unescape(Et),mt===0&&(Et=et(Et))),ct.push(Et)}return ct.join("")}function it(rt){if(rt.startsWith('"')){const at=rt.slice(1).split('\\"');for(let ot=0;ot<at.length;++ot){const st=at[ot].indexOf('"');st!==-1&&(at[ot]=at[ot].slice(0,st),at.length=ot+1),at[ot]=at[ot].replaceAll(/\\(.)/g,"$1")}rt=at.join('"')}return rt}function et(rt){const at=rt.indexOf("'");if(at===-1)return rt;const ot=rt.slice(0,at),ct=rt.slice(at+1).replace(/^[^']*'/,"");return b(ot,ct)}function lt(rt){return!rt.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(rt)?rt:rt.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(at,ot,st,ct){if(st==="q"||st==="Q")return ct=ct.replaceAll("_"," "),ct=ct.replaceAll(/=([0-9a-fA-F]{2})/g,function(mt,pt){return String.fromCharCode(parseInt(pt,16))}),b(ot,ct);try{ct=atob(ct)}catch{}return b(ot,ct)})}return""}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var a=s(1),c=s(20);const d=200,h=206;function g(it){const et=it.response;return typeof et!="string"?et:(0,a.stringToBytes)(et).buffer}class _{constructor(et,lt={}){this.url=et,this.isHttp=/^https?:/i.test(et),this.httpHeaders=this.isHttp&&lt.httpHeaders||Object.create(null),this.withCredentials=lt.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(et,lt,rt){const at={begin:et,end:lt};for(const ot in rt)at[ot]=rt[ot];return this.request(at)}requestFull(et){return this.request(et)}request(et){const lt=new XMLHttpRequest,rt=this.currXhrId++,at=this.pendingRequests[rt]={xhr:lt};lt.open("GET",this.url),lt.withCredentials=this.withCredentials;for(const ot in this.httpHeaders){const st=this.httpHeaders[ot];st!==void 0&&lt.setRequestHeader(ot,st)}return this.isHttp&&"begin"in et&&"end"in et?(lt.setRequestHeader("Range",`bytes=${et.begin}-${et.end-1}`),at.expectedStatus=h):at.expectedStatus=d,lt.responseType="arraybuffer",et.onError&&(lt.onerror=function(ot){et.onError(lt.status)}),lt.onreadystatechange=this.onStateChange.bind(this,rt),lt.onprogress=this.onProgress.bind(this,rt),at.onHeadersReceived=et.onHeadersReceived,at.onDone=et.onDone,at.onError=et.onError,at.onProgress=et.onProgress,lt.send(null),rt}onProgress(et,lt){var at;const rt=this.pendingRequests[et];rt&&((at=rt.onProgress)==null||at.call(rt,lt))}onStateChange(et,lt){var mt,pt,Et;const rt=this.pendingRequests[et];if(!rt)return;const at=rt.xhr;if(at.readyState>=2&&rt.onHeadersReceived&&(rt.onHeadersReceived(),delete rt.onHeadersReceived),at.readyState!==4||!(et in this.pendingRequests))return;if(delete this.pendingRequests[et],at.status===0&&this.isHttp){(mt=rt.onError)==null||mt.call(rt,at.status);return}const ot=at.status||d;if(!(ot===d&&rt.expectedStatus===h)&&ot!==rt.expectedStatus){(pt=rt.onError)==null||pt.call(rt,at.status);return}const ct=g(at);if(ot===h){const ut=at.getResponseHeader("Content-Range"),gt=/bytes (\d+)-(\d+)\/(\d+)/.exec(ut);rt.onDone({begin:parseInt(gt[1],10),chunk:ct})}else ct?rt.onDone({begin:0,chunk:ct}):(Et=rt.onError)==null||Et.call(rt,at.status)}getRequestXhr(et){return this.pendingRequests[et].xhr}isPendingRequest(et){return et in this.pendingRequests}abortRequest(et){const lt=this.pendingRequests[et].xhr;delete this.pendingRequests[et],lt.abort()}}class b{constructor(et){this._source=et,this._manager=new _(et.url,{httpHeaders:et.httpHeaders,withCredentials:et.withCredentials}),this._rangeChunkSize=et.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(et){const lt=this._rangeRequestReaders.indexOf(et);lt>=0&&this._rangeRequestReaders.splice(lt,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _e(this._manager,this._source),this._fullRequestReader}getRangeReader(et,lt){const rt=new nt(this._manager,et,lt);return rt.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(rt),rt}cancelAllRequests(et){var lt;(lt=this._fullRequestReader)==null||lt.cancel(et);for(const rt of this._rangeRequestReaders.slice(0))rt.cancel(et)}}i.PDFNetworkStream=b;class _e{constructor(et,lt){this._manager=et;const rt={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=lt.url,this._fullRequestId=et.requestFull(rt),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=lt.disableRange||!1,this._contentLength=lt.length,this._rangeChunkSize=lt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const et=this._fullRequestId,lt=this._manager.getRequestXhr(et),rt=st=>lt.getResponseHeader(st),{allowRangeRequests:at,suggestedLength:ot}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:rt,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});at&&(this._isRangeSupported=!0),this._contentLength=ot||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(rt),this._isRangeSupported&&this._manager.abortRequest(et),this._headersReceivedCapability.resolve()}_onDone(et){if(et&&(this._requests.length>0?this._requests.shift().resolve({value:et.chunk,done:!1}):this._cachedChunks.push(et.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(et){this._storedError=(0,c.createResponseStatusError)(et,this._url),this._headersReceivedCapability.reject(this._storedError);for(const lt of this._requests)lt.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(et){var lt;(lt=this.onProgress)==null||lt.call(this,{loaded:et.loaded,total:et.lengthComputable?et.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const et=new a.PromiseCapability;return this._requests.push(et),et.promise}cancel(et){this._done=!0,this._headersReceivedCapability.reject(et);for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class nt{constructor(et,lt,rt){this._manager=et;const at={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=et.url,this._requestId=et.requestRange(lt,rt,at),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var et;(et=this.onClosed)==null||et.call(this,this)}_onDone(et){const lt=et.chunk;this._requests.length>0?this._requests.shift().resolve({value:lt,done:!1}):this._queuedChunk=lt,this._done=!0;for(const rt of this._requests)rt.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(et){this._storedError=(0,c.createResponseStatusError)(et,this._url);for(const lt of this._requests)lt.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(et){var lt;this.isStreamingSupported||(lt=this.onProgress)==null||lt.call(this,{loaded:et.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const lt=this._queuedChunk;return this._queuedChunk=null,{value:lt,done:!1}}if(this._done)return{value:void 0,done:!0};const et=new a.PromiseCapability;return this._requests.push(et),et.promise}cancel(et){this._done=!0;for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var a=s(1),c=s(20);const d=/^file:\/\/\/[a-zA-Z]:\//;function h(rt){const at=require$$5,ot=at.parse(rt);return ot.protocol==="file:"||ot.host?ot:/^[a-z]:[/\\]/i.test(rt)?at.parse(`file:///${rt}`):(ot.host||(ot.protocol="file:"),ot)}class g{constructor(at){this.source=at,this.url=h(at.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&at.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var at;return((at=this._fullRequestReader)==null?void 0:at._loaded)??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new et(this):new nt(this),this._fullRequestReader}getRangeReader(at,ot){if(ot<=this._progressiveDataLength)return null;const st=this.isFsUrl?new lt(this,at,ot):new it(this,at,ot);return this._rangeRequestReaders.push(st),st}cancelAllRequests(at){var ot;(ot=this._fullRequestReader)==null||ot.cancel(at);for(const st of this._rangeRequestReaders.slice(0))st.cancel(at)}}i.PDFNodeStream=g;class _{constructor(at){this._url=at.url,this._done=!1,this._storedError=null,this.onProgress=null;const ot=at.source;this._contentLength=ot.length,this._loaded=0,this._filename=null,this._disableRange=ot.disableRange||!1,this._rangeChunkSize=ot.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!ot.disableStream,this._isRangeSupported=!ot.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const at=this._readableStream.read();return at===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=at.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(at).buffer,done:!1})}cancel(at){if(!this._readableStream){this._error(at);return}this._readableStream.destroy(at)}_error(at){this._storedError=at,this._readCapability.resolve()}_setReadableStream(at){this._readableStream=at,at.on("readable",()=>{this._readCapability.resolve()}),at.on("end",()=>{at.destroy(),this._done=!0,this._readCapability.resolve()}),at.on("error",ot=>{this._error(ot)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class b{constructor(at){this._url=at.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const ot=at.source;this._isStreamingSupported=!ot.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const at=this._readableStream.read();return at===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=at.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded}),{value:new Uint8Array(at).buffer,done:!1})}cancel(at){if(!this._readableStream){this._error(at);return}this._readableStream.destroy(at)}_error(at){this._storedError=at,this._readCapability.resolve()}_setReadableStream(at){this._readableStream=at,at.on("readable",()=>{this._readCapability.resolve()}),at.on("end",()=>{at.destroy(),this._done=!0,this._readCapability.resolve()}),at.on("error",ot=>{this._error(ot)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function _e(rt,at){return{protocol:rt.protocol,auth:rt.auth,host:rt.hostname,port:rt.port,path:rt.path,method:"GET",headers:at}}class nt extends _{constructor(at){super(at);const ot=st=>{if(st.statusCode===404){const Et=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Et,this._headersCapability.reject(Et);return}this._headersCapability.resolve(),this._setReadableStream(st);const ct=Et=>this._readableStream.headers[Et.toLowerCase()],{allowRangeRequests:mt,suggestedLength:pt}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:ct,isHttp:at.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=mt,this._contentLength=pt||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(ct)};if(this._request=null,this._url.protocol==="http:"){const st=require$$5;this._request=st.request(_e(this._url,at.httpHeaders),ot)}else{const st=require$$5;this._request=st.request(_e(this._url,at.httpHeaders),ot)}this._request.on("error",st=>{this._storedError=st,this._headersCapability.reject(st)}),this._request.end()}}class it extends b{constructor(at,ot,st){super(at),this._httpHeaders={};for(const mt in at.httpHeaders){const pt=at.httpHeaders[mt];pt!==void 0&&(this._httpHeaders[mt]=pt)}this._httpHeaders.Range=`bytes=${ot}-${st-1}`;const ct=mt=>{if(mt.statusCode===404){const pt=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=pt;return}this._setReadableStream(mt)};if(this._request=null,this._url.protocol==="http:"){const mt=require$$5;this._request=mt.request(_e(this._url,this._httpHeaders),ct)}else{const mt=require$$5;this._request=mt.request(_e(this._url,this._httpHeaders),ct)}this._request.on("error",mt=>{this._storedError=mt}),this._request.end()}}class et extends _{constructor(at){super(at);let ot=decodeURIComponent(this._url.path);d.test(this._url.href)&&(ot=ot.replace(/^\//,""));const st=require$$5;st.lstat(ot,(ct,mt)=>{if(ct){ct.code==="ENOENT"&&(ct=new a.MissingPDFException(`Missing PDF "${ot}".`)),this._storedError=ct,this._headersCapability.reject(ct);return}this._contentLength=mt.size,this._setReadableStream(st.createReadStream(ot)),this._headersCapability.resolve()})}}class lt extends b{constructor(at,ot,st){super(at);let ct=decodeURIComponent(this._url.path);d.test(this._url.href)&&(ct=ct.replace(/^\//,""));const mt=require$$5;this._setReadableStream(mt.createReadStream(ct,{start:ot,end:st-1}))}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var a=s(6),c=s(1);const d={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h="http://www.w3.org/XML/1998/namespace",g="http://www.w3.org/1999/xlink",_=["butt","round","square"],b=["miter","round","bevel"],_e=function(mt,pt="",Et=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Et)return URL.createObjectURL(new Blob([mt],{type:pt}));const ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let gt=`data:${pt};base64,`;for(let xt=0,Pt=mt.length;xt<Pt;xt+=3){const St=mt[xt]&255,Ct=mt[xt+1]&255,Lt=mt[xt+2]&255,er=St>>2,Kt=(St&3)<<4|Ct>>4,nr=xt+1<Pt?(Ct&15)<<2|Lt>>6:64,Jt=xt+2<Pt?Lt&63:64;gt+=ut[er]+ut[Kt]+ut[nr]+ut[Jt]}return gt},nt=function(){const mt=new Uint8Array([137,80,78,71,13,10,26,10]),pt=12,Et=new Int32Array(256);for(let Lt=0;Lt<256;Lt++){let er=Lt;for(let Kt=0;Kt<8;Kt++)er=er&1?3988292384^er>>1&2147483647:er>>1&2147483647;Et[Lt]=er}function ut(Lt,er,Kt){let nr=-1;for(let Jt=er;Jt<Kt;Jt++){const qt=(nr^Lt[Jt])&255,kt=Et[qt];nr=nr>>>8^kt}return nr^-1}function gt(Lt,er,Kt,nr){let Jt=nr;const qt=er.length;Kt[Jt]=qt>>24&255,Kt[Jt+1]=qt>>16&255,Kt[Jt+2]=qt>>8&255,Kt[Jt+3]=qt&255,Jt+=4,Kt[Jt]=Lt.charCodeAt(0)&255,Kt[Jt+1]=Lt.charCodeAt(1)&255,Kt[Jt+2]=Lt.charCodeAt(2)&255,Kt[Jt+3]=Lt.charCodeAt(3)&255,Jt+=4,Kt.set(er,Jt),Jt+=er.length;const kt=ut(Kt,nr+4,Jt);Kt[Jt]=kt>>24&255,Kt[Jt+1]=kt>>16&255,Kt[Jt+2]=kt>>8&255,Kt[Jt+3]=kt&255}function xt(Lt,er,Kt){let nr=1,Jt=0;for(let qt=er;qt<Kt;++qt)nr=(nr+(Lt[qt]&255))%65521,Jt=(Jt+nr)%65521;return Jt<<16|nr}function Pt(Lt){if(!c.isNodeJS)return St(Lt);try{const er=parseInt(process.versions.node)>=8?Lt:Buffer.from(Lt),Kt=require$$5.deflateSync(er,{level:9});return Kt instanceof Uint8Array?Kt:new Uint8Array(Kt)}catch(er){(0,c.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+er)}return St(Lt)}function St(Lt){let er=Lt.length;const Kt=65535,nr=Math.ceil(er/Kt),Jt=new Uint8Array(2+er+nr*5+4);let qt=0;Jt[qt++]=120,Jt[qt++]=156;let kt=0;for(;er>Kt;)Jt[qt++]=0,Jt[qt++]=255,Jt[qt++]=255,Jt[qt++]=0,Jt[qt++]=0,Jt.set(Lt.subarray(kt,kt+Kt),qt),qt+=Kt,kt+=Kt,er-=Kt;Jt[qt++]=1,Jt[qt++]=er&255,Jt[qt++]=er>>8&255,Jt[qt++]=~er&65535&255,Jt[qt++]=(~er&65535)>>8&255,Jt.set(Lt.subarray(kt),qt),qt+=Lt.length-kt;const Xt=xt(Lt,0,Lt.length);return Jt[qt++]=Xt>>24&255,Jt[qt++]=Xt>>16&255,Jt[qt++]=Xt>>8&255,Jt[qt++]=Xt&255,Jt}function Ct(Lt,er,Kt,nr){const Jt=Lt.width,qt=Lt.height;let kt,Xt,sr;const At=Lt.data;switch(er){case c.ImageKind.GRAYSCALE_1BPP:Xt=0,kt=1,sr=Jt+7>>3;break;case c.ImageKind.RGB_24BPP:Xt=2,kt=8,sr=Jt*3;break;case c.ImageKind.RGBA_32BPP:Xt=6,kt=8,sr=Jt*4;break;default:throw new Error("invalid format")}const ht=new Uint8Array((1+sr)*qt);let dt=0,Tt=0;for(let _r=0;_r<qt;++_r)ht[dt++]=0,ht.set(At.subarray(Tt,Tt+sr),dt),Tt+=sr,dt+=sr;if(er===c.ImageKind.GRAYSCALE_1BPP&&nr){dt=0;for(let _r=0;_r<qt;_r++){dt++;for(let pr=0;pr<sr;pr++)ht[dt++]^=255}}const Mt=new Uint8Array([Jt>>24&255,Jt>>16&255,Jt>>8&255,Jt&255,qt>>24&255,qt>>16&255,qt>>8&255,qt&255,kt,Xt,0,0,0]),It=Pt(ht),Ut=mt.length+pt*3+Mt.length+It.length,Zt=new Uint8Array(Ut);let rr=0;return Zt.set(mt,rr),rr+=mt.length,gt("IHDR",Mt,Zt,rr),rr+=pt+Mt.length,gt("IDATA",It,Zt,rr),rr+=pt+It.length,gt("IEND",new Uint8Array(0),Zt,rr),_e(Zt,"image/png",Kt)}return function(er,Kt,nr){const Jt=er.kind===void 0?c.ImageKind.GRAYSCALE_1BPP:er.kind;return Ct(er,Jt,Kt,nr)}}();class it{constructor(){this.fontSizeScale=1,this.fontWeight=d.fontWeight,this.fontSize=0,this.textMatrix=c.IDENTITY_MATRIX,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=c.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=d.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(pt,Et){this.x=pt,this.y=Et}}function et(mt){let pt=[];const Et=[];for(const ut of mt){if(ut.fn==="save"){pt.push({fnId:92,fn:"group",items:[]}),Et.push(pt),pt=pt.at(-1).items;continue}ut.fn==="restore"?pt=Et.pop():pt.push(ut)}return pt}function lt(mt){if(Number.isInteger(mt))return mt.toString();const pt=mt.toFixed(10);let Et=pt.length-1;if(pt[Et]!=="0")return pt;do Et--;while(pt[Et]==="0");return pt.substring(0,pt[Et]==="."?Et:Et+1)}function rt(mt){if(mt[4]===0&&mt[5]===0){if(mt[1]===0&&mt[2]===0)return mt[0]===1&&mt[3]===1?"":`scale(${lt(mt[0])} ${lt(mt[3])})`;if(mt[0]===mt[3]&&mt[1]===-mt[2]){const pt=Math.acos(mt[0])*180/Math.PI;return`rotate(${lt(pt)})`}}else if(mt[0]===1&&mt[1]===0&&mt[2]===0&&mt[3]===1)return`translate(${lt(mt[4])} ${lt(mt[5])})`;return`matrix(${lt(mt[0])} ${lt(mt[1])} ${lt(mt[2])} ${lt(mt[3])} ${lt(mt[4])} ${lt(mt[5])})`}let at=0,ot=0,st=0;class ct{constructor(pt,Et,ut=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new it,this.transformMatrix=c.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=pt,this.objs=Et,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!ut,this._operatorIdMapping=[];for(const gt in c.OPS)this._operatorIdMapping[c.OPS[gt]]=gt}getObject(pt,Et=null){return typeof pt=="string"?pt.startsWith("g_")?this.commonObjs.get(pt):this.objs.get(pt):Et}save(){this.transformStack.push(this.transformMatrix);const pt=this.current;this.extraStack.push(pt),this.current=pt.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(pt){this.save(),this.executeOpTree(pt),this.restore()}loadDependencies(pt){const Et=pt.fnArray,ut=pt.argsArray;for(let gt=0,xt=Et.length;gt<xt;gt++)if(Et[gt]===c.OPS.dependency)for(const Pt of ut[gt]){const St=Pt.startsWith("g_")?this.commonObjs:this.objs,Ct=new Promise(Lt=>{St.get(Pt,Lt)});this.current.dependencies.push(Ct)}return Promise.all(this.current.dependencies)}transform(pt,Et,ut,gt,xt,Pt){const St=[pt,Et,ut,gt,xt,Pt];this.transformMatrix=c.Util.transform(this.transformMatrix,St),this.tgrp=null}getSVG(pt,Et){this.viewport=Et;const ut=this._initialize(Et);return this.loadDependencies(pt).then(()=>(this.transformMatrix=c.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(pt)),ut))}convertOpList(pt){const Et=this._operatorIdMapping,ut=pt.argsArray,gt=pt.fnArray,xt=[];for(let Pt=0,St=gt.length;Pt<St;Pt++){const Ct=gt[Pt];xt.push({fnId:Ct,fn:Et[Ct],args:ut[Pt]})}return et(xt)}executeOpTree(pt){for(const Et of pt){const ut=Et.fn,gt=Et.fnId,xt=Et.args;switch(gt|0){case c.OPS.beginText:this.beginText();break;case c.OPS.dependency:break;case c.OPS.setLeading:this.setLeading(xt);break;case c.OPS.setLeadingMoveText:this.setLeadingMoveText(xt[0],xt[1]);break;case c.OPS.setFont:this.setFont(xt);break;case c.OPS.showText:this.showText(xt[0]);break;case c.OPS.showSpacedText:this.showText(xt[0]);break;case c.OPS.endText:this.endText();break;case c.OPS.moveText:this.moveText(xt[0],xt[1]);break;case c.OPS.setCharSpacing:this.setCharSpacing(xt[0]);break;case c.OPS.setWordSpacing:this.setWordSpacing(xt[0]);break;case c.OPS.setHScale:this.setHScale(xt[0]);break;case c.OPS.setTextMatrix:this.setTextMatrix(xt[0],xt[1],xt[2],xt[3],xt[4],xt[5]);break;case c.OPS.setTextRise:this.setTextRise(xt[0]);break;case c.OPS.setTextRenderingMode:this.setTextRenderingMode(xt[0]);break;case c.OPS.setLineWidth:this.setLineWidth(xt[0]);break;case c.OPS.setLineJoin:this.setLineJoin(xt[0]);break;case c.OPS.setLineCap:this.setLineCap(xt[0]);break;case c.OPS.setMiterLimit:this.setMiterLimit(xt[0]);break;case c.OPS.setFillRGBColor:this.setFillRGBColor(xt[0],xt[1],xt[2]);break;case c.OPS.setStrokeRGBColor:this.setStrokeRGBColor(xt[0],xt[1],xt[2]);break;case c.OPS.setStrokeColorN:this.setStrokeColorN(xt);break;case c.OPS.setFillColorN:this.setFillColorN(xt);break;case c.OPS.shadingFill:this.shadingFill(xt[0]);break;case c.OPS.setDash:this.setDash(xt[0],xt[1]);break;case c.OPS.setRenderingIntent:this.setRenderingIntent(xt[0]);break;case c.OPS.setFlatness:this.setFlatness(xt[0]);break;case c.OPS.setGState:this.setGState(xt[0]);break;case c.OPS.fill:this.fill();break;case c.OPS.eoFill:this.eoFill();break;case c.OPS.stroke:this.stroke();break;case c.OPS.fillStroke:this.fillStroke();break;case c.OPS.eoFillStroke:this.eoFillStroke();break;case c.OPS.clip:this.clip("nonzero");break;case c.OPS.eoClip:this.clip("evenodd");break;case c.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case c.OPS.paintImageXObject:this.paintImageXObject(xt[0]);break;case c.OPS.paintInlineImageXObject:this.paintInlineImageXObject(xt[0]);break;case c.OPS.paintImageMaskXObject:this.paintImageMaskXObject(xt[0]);break;case c.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(xt[0],xt[1]);break;case c.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case c.OPS.closePath:this.closePath();break;case c.OPS.closeStroke:this.closeStroke();break;case c.OPS.closeFillStroke:this.closeFillStroke();break;case c.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case c.OPS.nextLine:this.nextLine();break;case c.OPS.transform:this.transform(xt[0],xt[1],xt[2],xt[3],xt[4],xt[5]);break;case c.OPS.constructPath:this.constructPath(xt[0],xt[1]);break;case c.OPS.endPath:this.endPath();break;case 92:this.group(Et.items);break;default:(0,c.warn)(`Unimplemented operator ${ut}`);break}}}setWordSpacing(pt){this.current.wordSpacing=pt}setCharSpacing(pt){this.current.charSpacing=pt}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(pt,Et,ut,gt,xt,Pt){const St=this.current;St.textMatrix=St.lineMatrix=[pt,Et,ut,gt,xt,Pt],St.textMatrixScale=Math.hypot(pt,Et),St.x=St.lineX=0,St.y=St.lineY=0,St.xcoords=[],St.ycoords=[],St.tspan=this.svgFactory.createElement("svg:tspan"),St.tspan.setAttributeNS(null,"font-family",St.fontFamily),St.tspan.setAttributeNS(null,"font-size",`${lt(St.fontSize)}px`),St.tspan.setAttributeNS(null,"y",lt(-St.y)),St.txtElement=this.svgFactory.createElement("svg:text"),St.txtElement.append(St.tspan)}beginText(){const pt=this.current;pt.x=pt.lineX=0,pt.y=pt.lineY=0,pt.textMatrix=c.IDENTITY_MATRIX,pt.lineMatrix=c.IDENTITY_MATRIX,pt.textMatrixScale=1,pt.tspan=this.svgFactory.createElement("svg:tspan"),pt.txtElement=this.svgFactory.createElement("svg:text"),pt.txtgrp=this.svgFactory.createElement("svg:g"),pt.xcoords=[],pt.ycoords=[]}moveText(pt,Et){const ut=this.current;ut.x=ut.lineX+=pt,ut.y=ut.lineY+=Et,ut.xcoords=[],ut.ycoords=[],ut.tspan=this.svgFactory.createElement("svg:tspan"),ut.tspan.setAttributeNS(null,"font-family",ut.fontFamily),ut.tspan.setAttributeNS(null,"font-size",`${lt(ut.fontSize)}px`),ut.tspan.setAttributeNS(null,"y",lt(-ut.y))}showText(pt){const Et=this.current,ut=Et.font,gt=Et.fontSize;if(gt===0)return;const xt=Et.fontSizeScale,Pt=Et.charSpacing,St=Et.wordSpacing,Ct=Et.fontDirection,Lt=Et.textHScale*Ct,er=ut.vertical,Kt=er?1:-1,nr=ut.defaultVMetrics,Jt=gt*Et.fontMatrix[0];let qt=0;for(const sr of pt){if(sr===null){qt+=Ct*St;continue}else if(typeof sr=="number"){qt+=Kt*sr*gt/1e3;continue}const At=(sr.isSpace?St:0)+Pt,ht=sr.fontChar;let dt,Tt,Mt=sr.width;if(er){let Ut;const Zt=sr.vmetric||nr;Ut=sr.vmetric?Zt[1]:Mt*.5,Ut=-Ut*Jt;const rr=Zt[2]*Jt;Mt=Zt?-Zt[0]:Mt,dt=Ut/xt,Tt=(qt+rr)/xt}else dt=qt/xt,Tt=0;(sr.isInFont||ut.missingFile)&&(Et.xcoords.push(Et.x+dt),er&&Et.ycoords.push(-Et.y+Tt),Et.tspan.textContent+=ht);const It=er?Mt*Jt-At*Ct:Mt*Jt+At*Ct;qt+=It}Et.tspan.setAttributeNS(null,"x",Et.xcoords.map(lt).join(" ")),er?Et.tspan.setAttributeNS(null,"y",Et.ycoords.map(lt).join(" ")):Et.tspan.setAttributeNS(null,"y",lt(-Et.y)),er?Et.y-=qt:Et.x+=qt*Lt,Et.tspan.setAttributeNS(null,"font-family",Et.fontFamily),Et.tspan.setAttributeNS(null,"font-size",`${lt(Et.fontSize)}px`),Et.fontStyle!==d.fontStyle&&Et.tspan.setAttributeNS(null,"font-style",Et.fontStyle),Et.fontWeight!==d.fontWeight&&Et.tspan.setAttributeNS(null,"font-weight",Et.fontWeight);const kt=Et.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;if(kt===c.TextRenderingMode.FILL||kt===c.TextRenderingMode.FILL_STROKE?(Et.fillColor!==d.fillColor&&Et.tspan.setAttributeNS(null,"fill",Et.fillColor),Et.fillAlpha<1&&Et.tspan.setAttributeNS(null,"fill-opacity",Et.fillAlpha)):Et.textRenderingMode===c.TextRenderingMode.ADD_TO_PATH?Et.tspan.setAttributeNS(null,"fill","transparent"):Et.tspan.setAttributeNS(null,"fill","none"),kt===c.TextRenderingMode.STROKE||kt===c.TextRenderingMode.FILL_STROKE){const sr=1/(Et.textMatrixScale||1);this._setStrokeAttributes(Et.tspan,sr)}let Xt=Et.textMatrix;Et.textRise!==0&&(Xt=Xt.slice(),Xt[5]+=Et.textRise),Et.txtElement.setAttributeNS(null,"transform",`${rt(Xt)} scale(${lt(Lt)}, -1)`),Et.txtElement.setAttributeNS(h,"xml:space","preserve"),Et.txtElement.append(Et.tspan),Et.txtgrp.append(Et.txtElement),this._ensureTransformGroup().append(Et.txtElement)}setLeadingMoveText(pt,Et){this.setLeading(-Et),this.moveText(pt,Et)}addFontStyle(pt){if(!pt.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const Et=_e(pt.data,pt.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${pt.loadedName}"; src: url(${Et}); }
`}setFont(pt){const Et=this.current,ut=this.commonObjs.get(pt[0]);let gt=pt[1];Et.font=ut,this.embedFonts&&!ut.missingFile&&!this.embeddedFonts[ut.loadedName]&&(this.addFontStyle(ut),this.embeddedFonts[ut.loadedName]=ut),Et.fontMatrix=ut.fontMatrix||c.FONT_IDENTITY_MATRIX;let xt="normal";ut.black?xt="900":ut.bold&&(xt="bold");const Pt=ut.italic?"italic":"normal";gt<0?(gt=-gt,Et.fontDirection=-1):Et.fontDirection=1,Et.fontSize=gt,Et.fontFamily=ut.loadedName,Et.fontWeight=xt,Et.fontStyle=Pt,Et.tspan=this.svgFactory.createElement("svg:tspan"),Et.tspan.setAttributeNS(null,"y",lt(-Et.y)),Et.xcoords=[],Et.ycoords=[]}endText(){var Et;const pt=this.current;pt.textRenderingMode&c.TextRenderingMode.ADD_TO_PATH_FLAG&&((Et=pt.txtElement)!=null&&Et.hasChildNodes())&&(pt.element=pt.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(pt){pt>0&&(this.current.lineWidth=pt)}setLineCap(pt){this.current.lineCap=_[pt]}setLineJoin(pt){this.current.lineJoin=b[pt]}setMiterLimit(pt){this.current.miterLimit=pt}setStrokeAlpha(pt){this.current.strokeAlpha=pt}setStrokeRGBColor(pt,Et,ut){this.current.strokeColor=c.Util.makeHexColor(pt,Et,ut)}setFillAlpha(pt){this.current.fillAlpha=pt}setFillRGBColor(pt,Et,ut){this.current.fillColor=c.Util.makeHexColor(pt,Et,ut),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(pt){this.current.strokeColor=this._makeColorN_Pattern(pt)}setFillColorN(pt){this.current.fillColor=this._makeColorN_Pattern(pt)}shadingFill(pt){const{width:Et,height:ut}=this.viewport,gt=c.Util.inverseTransform(this.transformMatrix),[xt,Pt,St,Ct]=c.Util.getAxialAlignedBoundingBox([0,0,Et,ut],gt),Lt=this.svgFactory.createElement("svg:rect");Lt.setAttributeNS(null,"x",xt),Lt.setAttributeNS(null,"y",Pt),Lt.setAttributeNS(null,"width",St-xt),Lt.setAttributeNS(null,"height",Ct-Pt),Lt.setAttributeNS(null,"fill",this._makeShadingPattern(pt)),this.current.fillAlpha<1&&Lt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Lt)}_makeColorN_Pattern(pt){return pt[0]==="TilingPattern"?this._makeTilingPattern(pt):this._makeShadingPattern(pt)}_makeTilingPattern(pt){const Et=pt[1],ut=pt[2],gt=pt[3]||c.IDENTITY_MATRIX,[xt,Pt,St,Ct]=pt[4],Lt=pt[5],er=pt[6],Kt=pt[7],nr=`shading${st++}`,[Jt,qt,kt,Xt]=c.Util.normalizeRect([...c.Util.applyTransform([xt,Pt],gt),...c.Util.applyTransform([St,Ct],gt)]),[sr,At]=c.Util.singularValueDecompose2dScale(gt),ht=Lt*sr,dt=er*At,Tt=this.svgFactory.createElement("svg:pattern");Tt.setAttributeNS(null,"id",nr),Tt.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Tt.setAttributeNS(null,"width",ht),Tt.setAttributeNS(null,"height",dt),Tt.setAttributeNS(null,"x",`${Jt}`),Tt.setAttributeNS(null,"y",`${qt}`);const Mt=this.svg,It=this.transformMatrix,Ut=this.current.fillColor,Zt=this.current.strokeColor,rr=this.svgFactory.create(kt-Jt,Xt-qt);if(this.svg=rr,this.transformMatrix=gt,Kt===2){const _r=c.Util.makeHexColor(...Et);this.current.fillColor=_r,this.current.strokeColor=_r}return this.executeOpTree(this.convertOpList(ut)),this.svg=Mt,this.transformMatrix=It,this.current.fillColor=Ut,this.current.strokeColor=Zt,Tt.append(rr.childNodes[0]),this.defs.append(Tt),`url(#${nr})`}_makeShadingPattern(pt){switch(typeof pt=="string"&&(pt=this.objs.get(pt)),pt[0]){case"RadialAxial":const Et=`shading${st++}`,ut=pt[3];let gt;switch(pt[1]){case"axial":const xt=pt[4],Pt=pt[5];gt=this.svgFactory.createElement("svg:linearGradient"),gt.setAttributeNS(null,"id",Et),gt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gt.setAttributeNS(null,"x1",xt[0]),gt.setAttributeNS(null,"y1",xt[1]),gt.setAttributeNS(null,"x2",Pt[0]),gt.setAttributeNS(null,"y2",Pt[1]);break;case"radial":const St=pt[4],Ct=pt[5],Lt=pt[6],er=pt[7];gt=this.svgFactory.createElement("svg:radialGradient"),gt.setAttributeNS(null,"id",Et),gt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gt.setAttributeNS(null,"cx",Ct[0]),gt.setAttributeNS(null,"cy",Ct[1]),gt.setAttributeNS(null,"r",er),gt.setAttributeNS(null,"fx",St[0]),gt.setAttributeNS(null,"fy",St[1]),gt.setAttributeNS(null,"fr",Lt);break;default:throw new Error(`Unknown RadialAxial type: ${pt[1]}`)}for(const xt of ut){const Pt=this.svgFactory.createElement("svg:stop");Pt.setAttributeNS(null,"offset",xt[0]),Pt.setAttributeNS(null,"stop-color",xt[1]),gt.append(Pt)}return this.defs.append(gt),`url(#${Et})`;case"Mesh":return(0,c.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${pt[0]}`)}}setDash(pt,Et){this.current.dashArray=pt,this.current.dashPhase=Et}constructPath(pt,Et){const ut=this.current;let gt=ut.x,xt=ut.y,Pt=[],St=0;for(const Ct of pt)switch(Ct|0){case c.OPS.rectangle:gt=Et[St++],xt=Et[St++];const Lt=Et[St++],er=Et[St++],Kt=gt+Lt,nr=xt+er;Pt.push("M",lt(gt),lt(xt),"L",lt(Kt),lt(xt),"L",lt(Kt),lt(nr),"L",lt(gt),lt(nr),"Z");break;case c.OPS.moveTo:gt=Et[St++],xt=Et[St++],Pt.push("M",lt(gt),lt(xt));break;case c.OPS.lineTo:gt=Et[St++],xt=Et[St++],Pt.push("L",lt(gt),lt(xt));break;case c.OPS.curveTo:gt=Et[St+4],xt=Et[St+5],Pt.push("C",lt(Et[St]),lt(Et[St+1]),lt(Et[St+2]),lt(Et[St+3]),lt(gt),lt(xt)),St+=6;break;case c.OPS.curveTo2:Pt.push("C",lt(gt),lt(xt),lt(Et[St]),lt(Et[St+1]),lt(Et[St+2]),lt(Et[St+3])),gt=Et[St+2],xt=Et[St+3],St+=4;break;case c.OPS.curveTo3:gt=Et[St+2],xt=Et[St+3],Pt.push("C",lt(Et[St]),lt(Et[St+1]),lt(gt),lt(xt),lt(gt),lt(xt)),St+=4;break;case c.OPS.closePath:Pt.push("Z");break}Pt=Pt.join(" "),ut.path&&pt.length>0&&pt[0]!==c.OPS.rectangle&&pt[0]!==c.OPS.moveTo?Pt=ut.path.getAttributeNS(null,"d")+Pt:(ut.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(ut.path)),ut.path.setAttributeNS(null,"d",Pt),ut.path.setAttributeNS(null,"fill","none"),ut.element=ut.path,ut.setCurrentPoint(gt,xt)}endPath(){const pt=this.current;if(pt.path=null,!this.pendingClip)return;if(!pt.element){this.pendingClip=null;return}const Et=`clippath${at++}`,ut=this.svgFactory.createElement("svg:clipPath");ut.setAttributeNS(null,"id",Et),ut.setAttributeNS(null,"transform",rt(this.transformMatrix));const gt=pt.element.cloneNode(!0);if(this.pendingClip==="evenodd"?gt.setAttributeNS(null,"clip-rule","evenodd"):gt.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,ut.append(gt),this.defs.append(ut),pt.activeClipUrl){pt.clipGroup=null;for(const xt of this.extraStack)xt.clipGroup=null;ut.setAttributeNS(null,"clip-path",pt.activeClipUrl)}pt.activeClipUrl=`url(#${Et})`,this.tgrp=null}clip(pt){this.pendingClip=pt}closePath(){const pt=this.current;if(pt.path){const Et=`${pt.path.getAttributeNS(null,"d")}Z`;pt.path.setAttributeNS(null,"d",Et)}}setLeading(pt){this.current.leading=-pt}setTextRise(pt){this.current.textRise=pt}setTextRenderingMode(pt){this.current.textRenderingMode=pt}setHScale(pt){this.current.textHScale=pt/100}setRenderingIntent(pt){}setFlatness(pt){}setGState(pt){for(const[Et,ut]of pt)switch(Et){case"LW":this.setLineWidth(ut);break;case"LC":this.setLineCap(ut);break;case"LJ":this.setLineJoin(ut);break;case"ML":this.setMiterLimit(ut);break;case"D":this.setDash(ut[0],ut[1]);break;case"RI":this.setRenderingIntent(ut);break;case"FL":this.setFlatness(ut);break;case"Font":this.setFont(ut);break;case"CA":this.setStrokeAlpha(ut);break;case"ca":this.setFillAlpha(ut);break;default:(0,c.warn)(`Unimplemented graphic state operator ${Et}`);break}}fill(){const pt=this.current;pt.element&&(pt.element.setAttributeNS(null,"fill",pt.fillColor),pt.element.setAttributeNS(null,"fill-opacity",pt.fillAlpha),this.endPath())}stroke(){const pt=this.current;pt.element&&(this._setStrokeAttributes(pt.element),pt.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(pt,Et=1){const ut=this.current;let gt=ut.dashArray;Et!==1&&gt.length>0&&(gt=gt.map(function(xt){return Et*xt})),pt.setAttributeNS(null,"stroke",ut.strokeColor),pt.setAttributeNS(null,"stroke-opacity",ut.strokeAlpha),pt.setAttributeNS(null,"stroke-miterlimit",lt(ut.miterLimit)),pt.setAttributeNS(null,"stroke-linecap",ut.lineCap),pt.setAttributeNS(null,"stroke-linejoin",ut.lineJoin),pt.setAttributeNS(null,"stroke-width",lt(Et*ut.lineWidth)+"px"),pt.setAttributeNS(null,"stroke-dasharray",gt.map(lt).join(" ")),pt.setAttributeNS(null,"stroke-dashoffset",lt(Et*ut.dashPhase)+"px")}eoFill(){var pt;(pt=this.current.element)==null||pt.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var pt;(pt=this.current.element)==null||pt.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const pt=this.svgFactory.createElement("svg:rect");pt.setAttributeNS(null,"x","0"),pt.setAttributeNS(null,"y","0"),pt.setAttributeNS(null,"width","1px"),pt.setAttributeNS(null,"height","1px"),pt.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(pt)}paintImageXObject(pt){const Et=this.getObject(pt);if(!Et){(0,c.warn)(`Dependent image with object ID ${pt} is not ready yet`);return}this.paintInlineImageXObject(Et)}paintInlineImageXObject(pt,Et){const ut=pt.width,gt=pt.height,xt=nt(pt,this.forceDataSchema,!!Et),Pt=this.svgFactory.createElement("svg:rect");Pt.setAttributeNS(null,"x","0"),Pt.setAttributeNS(null,"y","0"),Pt.setAttributeNS(null,"width",lt(ut)),Pt.setAttributeNS(null,"height",lt(gt)),this.current.element=Pt,this.clip("nonzero");const St=this.svgFactory.createElement("svg:image");St.setAttributeNS(g,"xlink:href",xt),St.setAttributeNS(null,"x","0"),St.setAttributeNS(null,"y",lt(-gt)),St.setAttributeNS(null,"width",lt(ut)+"px"),St.setAttributeNS(null,"height",lt(gt)+"px"),St.setAttributeNS(null,"transform",`scale(${lt(1/ut)} ${lt(-1/gt)})`),Et?Et.append(St):this._ensureTransformGroup().append(St)}paintImageMaskXObject(pt){const Et=this.getObject(pt.data,pt);if(Et.bitmap){(0,c.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const ut=this.current,gt=Et.width,xt=Et.height,Pt=ut.fillColor;ut.maskId=`mask${ot++}`;const St=this.svgFactory.createElement("svg:mask");St.setAttributeNS(null,"id",ut.maskId);const Ct=this.svgFactory.createElement("svg:rect");Ct.setAttributeNS(null,"x","0"),Ct.setAttributeNS(null,"y","0"),Ct.setAttributeNS(null,"width",lt(gt)),Ct.setAttributeNS(null,"height",lt(xt)),Ct.setAttributeNS(null,"fill",Pt),Ct.setAttributeNS(null,"mask",`url(#${ut.maskId})`),this.defs.append(St),this._ensureTransformGroup().append(Ct),this.paintInlineImageXObject(Et,St)}paintFormXObjectBegin(pt,Et){if(Array.isArray(pt)&&pt.length===6&&this.transform(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]),Et){const ut=Et[2]-Et[0],gt=Et[3]-Et[1],xt=this.svgFactory.createElement("svg:rect");xt.setAttributeNS(null,"x",Et[0]),xt.setAttributeNS(null,"y",Et[1]),xt.setAttributeNS(null,"width",lt(ut)),xt.setAttributeNS(null,"height",lt(gt)),this.current.element=xt,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(pt){const Et=this.svgFactory.create(pt.width,pt.height),ut=this.svgFactory.createElement("svg:defs");Et.append(ut),this.defs=ut;const gt=this.svgFactory.createElement("svg:g");return gt.setAttributeNS(null,"transform",rt(pt.transform)),Et.append(gt),this.svg=gt,Et}_ensureClipGroup(){if(!this.current.clipGroup){const pt=this.svgFactory.createElement("svg:g");pt.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(pt),this.current.clipGroup=pt}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",rt(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}i.SVGGraphics=ct},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class s{static textContent(c){const d=[],h={items:d,styles:Object.create(null)};function g(_){var nt;if(!_)return;let b=null;const _e=_.name;if(_e==="#text")b=_.value;else if(s.shouldBuildText(_e))(nt=_==null?void 0:_.attributes)!=null&&nt.textContent?b=_.attributes.textContent:_.value&&(b=_.value);else return;if(b!==null&&d.push({str:b}),!!_.children)for(const it of _.children)g(it)}return g(c),h}static shouldBuildText(c){return!(c==="textarea"||c==="input"||c==="option"||c==="select")}}i.XfaText=s},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=rt,i.updateTextLayer=at;var a=s(1),c=s(6);const d=1e5,h=30,g=.8,_=new Map;function b(ot,st){let ct;if(st&&a.FeatureTest.isOffscreenCanvasSupported)ct=new OffscreenCanvas(ot,ot).getContext("2d",{alpha:!1});else{const mt=document.createElement("canvas");mt.width=mt.height=ot,ct=mt.getContext("2d",{alpha:!1})}return ct}function _e(ot,st){const ct=_.get(ot);if(ct)return ct;const mt=b(h,st);mt.font=`${h}px ${ot}`;const pt=mt.measureText("");let Et=pt.fontBoundingBoxAscent,ut=Math.abs(pt.fontBoundingBoxDescent);if(Et){const xt=Et/(Et+ut);return _.set(ot,xt),mt.canvas.width=mt.canvas.height=0,xt}mt.strokeStyle="red",mt.clearRect(0,0,h,h),mt.strokeText("g",0,0);let gt=mt.getImageData(0,0,h,h).data;ut=0;for(let xt=gt.length-1-3;xt>=0;xt-=4)if(gt[xt]>0){ut=Math.ceil(xt/4/h);break}mt.clearRect(0,0,h,h),mt.strokeText("A",0,h),gt=mt.getImageData(0,0,h,h).data,Et=0;for(let xt=0,Pt=gt.length;xt<Pt;xt+=4)if(gt[xt]>0){Et=h-Math.floor(xt/4/h);break}if(mt.canvas.width=mt.canvas.height=0,Et){const xt=Et/(Et+ut);return _.set(ot,xt),xt}return _.set(ot,g),g}function nt(ot,st,ct){const mt=document.createElement("span"),pt={angle:0,canvasWidth:0,hasText:st.str!=="",hasEOL:st.hasEOL,fontSize:0};ot._textDivs.push(mt);const Et=a.Util.transform(ot._transform,st.transform);let ut=Math.atan2(Et[1],Et[0]);const gt=ct[st.fontName];gt.vertical&&(ut+=Math.PI/2);const xt=Math.hypot(Et[2],Et[3]),Pt=xt*_e(gt.fontFamily,ot._isOffscreenCanvasSupported);let St,Ct;ut===0?(St=Et[4],Ct=Et[5]-Pt):(St=Et[4]+Pt*Math.sin(ut),Ct=Et[5]-Pt*Math.cos(ut));const Lt="calc(var(--scale-factor)*",er=mt.style;ot._container===ot._rootContainer?(er.left=`${(100*St/ot._pageWidth).toFixed(2)}%`,er.top=`${(100*Ct/ot._pageHeight).toFixed(2)}%`):(er.left=`${Lt}${St.toFixed(2)}px)`,er.top=`${Lt}${Ct.toFixed(2)}px)`),er.fontSize=`${Lt}${xt.toFixed(2)}px)`,er.fontFamily=gt.fontFamily,pt.fontSize=xt,mt.setAttribute("role","presentation"),mt.textContent=st.str,mt.dir=st.dir,ot._fontInspectorEnabled&&(mt.dataset.fontName=st.fontName),ut!==0&&(pt.angle=ut*(180/Math.PI));let Kt=!1;if(st.str.length>1)Kt=!0;else if(st.str!==" "&&st.transform[0]!==st.transform[3]){const nr=Math.abs(st.transform[0]),Jt=Math.abs(st.transform[3]);nr!==Jt&&Math.max(nr,Jt)/Math.min(nr,Jt)>1.5&&(Kt=!0)}Kt&&(pt.canvasWidth=gt.vertical?st.height:st.width),ot._textDivProperties.set(mt,pt),ot._isReadableStream&&ot._layoutText(mt)}function it(ot){const{div:st,scale:ct,properties:mt,ctx:pt,prevFontSize:Et,prevFontFamily:ut}=ot,{style:gt}=st;let xt="";if(mt.canvasWidth!==0&&mt.hasText){const{fontFamily:Pt}=gt,{canvasWidth:St,fontSize:Ct}=mt;(Et!==Ct||ut!==Pt)&&(pt.font=`${Ct*ct}px ${Pt}`,ot.prevFontSize=Ct,ot.prevFontFamily=Pt);const{width:Lt}=pt.measureText(st.textContent);Lt>0&&(xt=`scaleX(${St*ct/Lt})`)}mt.angle!==0&&(xt=`rotate(${mt.angle}deg) ${xt}`),xt.length>0&&(gt.transform=xt)}function et(ot){if(ot._canceled)return;const st=ot._textDivs,ct=ot._capability;if(st.length>d){ct.resolve();return}if(!ot._isReadableStream)for(const pt of st)ot._layoutText(pt);ct.resolve()}class lt{constructor({textContentSource:st,container:ct,viewport:mt,textDivs:pt,textDivProperties:Et,textContentItemsStr:ut,isOffscreenCanvasSupported:gt}){var Lt;this._textContentSource=st,this._isReadableStream=st instanceof ReadableStream,this._container=this._rootContainer=ct,this._textDivs=pt||[],this._textContentItemsStr=ut||[],this._isOffscreenCanvasSupported=gt,this._fontInspectorEnabled=!!((Lt=globalThis.FontInspector)!=null&&Lt.enabled),this._reader=null,this._textDivProperties=Et||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:mt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:b(0,gt)};const{pageWidth:xt,pageHeight:Pt,pageX:St,pageY:Ct}=mt.rawDims;this._transform=[1,0,0,-1,-St,Ct+Pt],this._pageWidth=xt,this._pageHeight=Pt,(0,c.setLayerDimensions)(ct,mt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(st,ct){for(const mt of st){if(mt.str===void 0){if(mt.type==="beginMarkedContentProps"||mt.type==="beginMarkedContent"){const pt=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),mt.id!==null&&this._container.setAttribute("id",`${mt.id}`),pt.append(this._container)}else mt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(mt.str),nt(this,mt,ct)}}_layoutText(st){const ct=this._layoutTextParams.properties=this._textDivProperties.get(st);if(this._layoutTextParams.div=st,it(this._layoutTextParams),ct.hasText&&this._container.append(st),ct.hasEOL){const mt=document.createElement("br");mt.setAttribute("role","presentation"),this._container.append(mt)}}_render(){const st=new a.PromiseCapability;let ct=Object.create(null);if(this._isReadableStream){const mt=()=>{this._reader.read().then(({value:pt,done:Et})=>{if(Et){st.resolve();return}Object.assign(ct,pt.styles),this._processItems(pt.items,ct),mt()},st.reject)};this._reader=this._textContentSource.getReader(),mt()}else if(this._textContentSource){const{items:mt,styles:pt}=this._textContentSource;this._processItems(mt,pt),st.resolve()}else throw new Error('No "textContentSource" parameter specified.');st.promise.then(()=>{ct=null,et(this)},this._capability.reject)}}i.TextLayerRenderTask=lt;function rt(ot){!ot.textContentSource&&(ot.textContent||ot.textContentStream)&&((0,c.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),ot.textContentSource=ot.textContent||ot.textContentStream);const{container:st,viewport:ct}=ot,mt=getComputedStyle(st),pt=mt.getPropertyValue("visibility"),Et=parseFloat(mt.getPropertyValue("--scale-factor"));pt==="visible"&&(!Et||Math.abs(Et-ct.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const ut=new lt(ot);return ut._render(),ut}function at({container:ot,viewport:st,textDivs:ct,textDivProperties:mt,isOffscreenCanvasSupported:pt,mustRotate:Et=!0,mustRescale:ut=!0}){if(Et&&(0,c.setLayerDimensions)(ot,{rotation:st.rotation}),ut){const gt=b(0,pt),Pt={prevFontSize:null,prevFontFamily:null,div:null,scale:st.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:gt};for(const St of ct)Pt.properties=mt.get(St),Pt.div=St,it(Pt)}}},(e,i,s)=>{var _e,nt,it,et,lt,rt,at,ot,st,ct,mt,Hs,gs,Vs,zs;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var a=s(1),c=s(4),d=s(28),h=s(33),g=s(6),_=s(34);const xt=class xt{constructor({uiManager:St,pageIndex:Ct,div:Lt,accessibilityManager:er,annotationLayer:Kt,viewport:nr,l10n:Jt}){cr(this,mt);cr(this,_e);cr(this,nt,!1);cr(this,it,null);cr(this,et,this.pointerup.bind(this));cr(this,lt,this.pointerdown.bind(this));cr(this,rt,new Map);cr(this,at,!1);cr(this,ot,!1);cr(this,st,!1);cr(this,ct);const qt=[d.FreeTextEditor,h.InkEditor,_.StampEditor];if(!xt._initialized){xt._initialized=!0;for(const kt of qt)kt.initialize(Jt)}St.registerEditorTypes(qt),lr(this,ct,St),this.pageIndex=Ct,this.div=Lt,lr(this,_e,er),lr(this,it,Kt),this.viewport=nr,ft(this,ct).addLayer(this)}get isEmpty(){return ft(this,rt).size===0}updateToolbar(St){ft(this,ct).updateToolbar(St)}updateMode(St=ft(this,ct).getMode()){or(this,mt,zs).call(this),St===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),St!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",St===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",St===a.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",St===a.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(St){if(!St&&ft(this,ct).getMode()!==a.AnnotationEditorType.INK)return;if(!St){for(const Lt of ft(this,rt).values())if(Lt.isEmpty()){Lt.setInBackground();return}}or(this,mt,gs).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(St){ft(this,ct).setEditingState(St)}addCommands(St){ft(this,ct).addCommands(St)}enable(){this.div.style.pointerEvents="auto";const St=new Set;for(const Lt of ft(this,rt).values())Lt.enableEditing(),Lt.annotationElementId&&St.add(Lt.annotationElementId);if(!ft(this,it))return;const Ct=ft(this,it).getEditableAnnotations();for(const Lt of Ct){if(Lt.hide(),ft(this,ct).isDeletedAnnotationElement(Lt.data.id)||St.has(Lt.data.id))continue;const er=this.deserialize(Lt);er&&(this.addOrRebuild(er),er.enableEditing())}}disable(){var Ct;lr(this,st,!0),this.div.style.pointerEvents="none";const St=new Set;for(const Lt of ft(this,rt).values()){if(Lt.disableEditing(),!Lt.annotationElementId||Lt.serialize()!==null){St.add(Lt.annotationElementId);continue}(Ct=this.getEditableAnnotation(Lt.annotationElementId))==null||Ct.show(),Lt.remove()}if(ft(this,it)){const Lt=ft(this,it).getEditableAnnotations();for(const er of Lt){const{id:Kt}=er.data;St.has(Kt)||ft(this,ct).isDeletedAnnotationElement(Kt)||er.show()}}or(this,mt,zs).call(this),this.isEmpty&&(this.div.hidden=!0),lr(this,st,!1)}getEditableAnnotation(St){var Ct;return((Ct=ft(this,it))==null?void 0:Ct.getEditableAnnotation(St))||null}setActiveEditor(St){ft(this,ct).getActive()!==St&&ft(this,ct).setActiveEditor(St)}enableClick(){this.div.addEventListener("pointerdown",ft(this,lt)),this.div.addEventListener("pointerup",ft(this,et))}disableClick(){this.div.removeEventListener("pointerdown",ft(this,lt)),this.div.removeEventListener("pointerup",ft(this,et))}attach(St){ft(this,rt).set(St.id,St);const{annotationElementId:Ct}=St;Ct&&ft(this,ct).isDeletedAnnotationElement(Ct)&&ft(this,ct).removeDeletedAnnotationElement(St)}detach(St){var Ct;ft(this,rt).delete(St.id),(Ct=ft(this,_e))==null||Ct.removePointerInTextLayer(St.contentDiv),!ft(this,st)&&St.annotationElementId&&ft(this,ct).addDeletedAnnotationElement(St)}remove(St){this.detach(St),ft(this,ct).removeEditor(St),St.div.contains(document.activeElement)&&setTimeout(()=>{ft(this,ct).focusMainContainer()},0),St.div.remove(),St.isAttachedToDOM=!1,ft(this,ot)||this.addInkEditorIfNeeded(!1)}changeParent(St){var Ct;St.parent!==this&&(St.annotationElementId&&(ft(this,ct).addDeletedAnnotationElement(St.annotationElementId),c.AnnotationEditor.deleteAnnotationElement(St),St.annotationElementId=null),this.attach(St),(Ct=St.parent)==null||Ct.detach(St),St.setParent(this),St.div&&St.isAttachedToDOM&&(St.div.remove(),this.div.append(St.div)))}add(St){if(this.changeParent(St),ft(this,ct).addEditor(St),this.attach(St),!St.isAttachedToDOM){const Ct=St.render();this.div.append(Ct),St.isAttachedToDOM=!0}St.fixAndSetPosition(),St.onceAdded(),ft(this,ct).addToAnnotationStorage(St)}moveEditorInDOM(St){var Lt;if(!St.isAttachedToDOM)return;const{activeElement:Ct}=document;St.div.contains(Ct)&&(St._focusEventsAllowed=!1,setTimeout(()=>{St.div.contains(document.activeElement)?St._focusEventsAllowed=!0:(St.div.addEventListener("focusin",()=>{St._focusEventsAllowed=!0},{once:!0}),Ct.focus())},0)),St._structTreeParentId=(Lt=ft(this,_e))==null?void 0:Lt.moveElementInDOM(this.div,St.div,St.contentDiv,!0)}addOrRebuild(St){St.needsToBeRebuilt()?St.rebuild():this.add(St)}addUndoableEditor(St){const Ct=()=>St._uiManager.rebuild(St),Lt=()=>{St.remove()};this.addCommands({cmd:Ct,undo:Lt,mustExec:!1})}getNextId(){return ft(this,ct).getId()}pasteEditor(St,Ct){ft(this,ct).updateToolbar(St),ft(this,ct).updateMode(St);const{offsetX:Lt,offsetY:er}=or(this,mt,Vs).call(this),Kt=this.getNextId(),nr=or(this,mt,Hs).call(this,{parent:this,id:Kt,x:Lt,y:er,uiManager:ft(this,ct),isCentered:!0,...Ct});nr&&this.add(nr)}deserialize(St){switch(St.annotationType??St.annotationEditorType){case a.AnnotationEditorType.FREETEXT:return d.FreeTextEditor.deserialize(St,this,ft(this,ct));case a.AnnotationEditorType.INK:return h.InkEditor.deserialize(St,this,ft(this,ct));case a.AnnotationEditorType.STAMP:return _.StampEditor.deserialize(St,this,ft(this,ct))}return null}addNewEditor(){or(this,mt,gs).call(this,or(this,mt,Vs).call(this),!0)}setSelected(St){ft(this,ct).setSelected(St)}toggleSelected(St){ft(this,ct).toggleSelected(St)}isSelected(St){return ft(this,ct).isSelected(St)}unselect(St){ft(this,ct).unselect(St)}pointerup(St){const{isMac:Ct}=a.FeatureTest.platform;if(!(St.button!==0||St.ctrlKey&&Ct)&&St.target===this.div&&ft(this,at)){if(lr(this,at,!1),!ft(this,nt)){lr(this,nt,!0);return}if(ft(this,ct).getMode()===a.AnnotationEditorType.STAMP){ft(this,ct).unselectAll();return}or(this,mt,gs).call(this,St,!1)}}pointerdown(St){if(ft(this,at)){lr(this,at,!1);return}const{isMac:Ct}=a.FeatureTest.platform;if(St.button!==0||St.ctrlKey&&Ct||St.target!==this.div)return;lr(this,at,!0);const Lt=ft(this,ct).getActive();lr(this,nt,!Lt||Lt.isEmpty())}findNewParent(St,Ct,Lt){const er=ft(this,ct).findParent(Ct,Lt);return er===null||er===this?!1:(er.changeParent(St),!0)}destroy(){var St,Ct;((St=ft(this,ct).getActive())==null?void 0:St.parent)===this&&(ft(this,ct).commitOrRemove(),ft(this,ct).setActiveEditor(null));for(const Lt of ft(this,rt).values())(Ct=ft(this,_e))==null||Ct.removePointerInTextLayer(Lt.contentDiv),Lt.setParent(null),Lt.isAttachedToDOM=!1,Lt.div.remove();this.div=null,ft(this,rt).clear(),ft(this,ct).removeLayer(this)}render({viewport:St}){this.viewport=St,(0,g.setLayerDimensions)(this.div,St);for(const Ct of ft(this,ct).getEditors(this.pageIndex))this.add(Ct);this.updateMode()}update({viewport:St}){ft(this,ct).commitOrRemove(),this.viewport=St,(0,g.setLayerDimensions)(this.div,{rotation:St.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:St,pageHeight:Ct}=this.viewport.rawDims;return[St,Ct]}};_e=new WeakMap,nt=new WeakMap,it=new WeakMap,et=new WeakMap,lt=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakMap,st=new WeakMap,ct=new WeakMap,mt=new WeakSet,Hs=function(St){switch(ft(this,ct).getMode()){case a.AnnotationEditorType.FREETEXT:return new d.FreeTextEditor(St);case a.AnnotationEditorType.INK:return new h.InkEditor(St);case a.AnnotationEditorType.STAMP:return new _.StampEditor(St)}return null},gs=function(St,Ct){const Lt=this.getNextId(),er=or(this,mt,Hs).call(this,{parent:this,id:Lt,x:St.offsetX,y:St.offsetY,uiManager:ft(this,ct),isCentered:Ct});return er&&this.add(er),er},Vs=function(){const{x:St,y:Ct,width:Lt,height:er}=this.div.getBoundingClientRect(),Kt=Math.max(0,St),nr=Math.max(0,Ct),Jt=Math.min(window.innerWidth,St+Lt),qt=Math.min(window.innerHeight,Ct+er),kt=(Kt+Jt)/2-St,Xt=(nr+qt)/2-Ct,[sr,At]=this.viewport.rotation%180===0?[kt,Xt]:[Xt,kt];return{offsetX:sr,offsetY:At}},zs=function(){lr(this,ot,!0);for(const St of ft(this,rt).values())St.isEmpty()&&St.remove();lr(this,ot,!1)},an(xt,"_initialized",!1);let b=xt;i.AnnotationEditorLayer=b},(e,i,s)=>{var _,b,_e,nt,it,et,lt,rt,at,ot,yo,Eo,So,ss,Xs,Ao,Gs;Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var a=s(1),c=s(5),d=s(4),h=s(29);const xt=class xt extends d.AnnotationEditor{constructor(Ct){super({...Ct,name:"freeTextEditor"});cr(this,ot);cr(this,_,this.editorDivBlur.bind(this));cr(this,b,this.editorDivFocus.bind(this));cr(this,_e,this.editorDivInput.bind(this));cr(this,nt,this.editorDivKeydown.bind(this));cr(this,it);cr(this,et,"");cr(this,lt,`${this.id}-editor`);cr(this,rt);cr(this,at,null);lr(this,it,Ct.color||xt._defaultColor||d.AnnotationEditor._defaultLineColor),lr(this,rt,Ct.fontSize||xt._defaultFontSize)}static get _keyboardManager(){const Ct=xt.prototype,Lt=nr=>nr.isEmpty(),er=c.AnnotationEditorUIManager.TRANSLATE_SMALL,Kt=c.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new c.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Ct.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Ct.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Ct._translateEmpty,{args:[-er,0],checker:Lt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Ct._translateEmpty,{args:[-Kt,0],checker:Lt}],[["ArrowRight","mac+ArrowRight"],Ct._translateEmpty,{args:[er,0],checker:Lt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Ct._translateEmpty,{args:[Kt,0],checker:Lt}],[["ArrowUp","mac+ArrowUp"],Ct._translateEmpty,{args:[0,-er],checker:Lt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Ct._translateEmpty,{args:[0,-Kt],checker:Lt}],[["ArrowDown","mac+ArrowDown"],Ct._translateEmpty,{args:[0,er],checker:Lt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Ct._translateEmpty,{args:[0,Kt],checker:Lt}]]))}static initialize(Ct){d.AnnotationEditor.initialize(Ct,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Lt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Lt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Ct,Lt){switch(Ct){case a.AnnotationEditorParamsType.FREETEXT_SIZE:xt._defaultFontSize=Lt;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:xt._defaultColor=Lt;break}}updateParams(Ct,Lt){switch(Ct){case a.AnnotationEditorParamsType.FREETEXT_SIZE:or(this,ot,yo).call(this,Lt);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:or(this,ot,Eo).call(this,Lt);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,xt._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,xt._defaultColor||d.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,ft(this,rt)],[a.AnnotationEditorParamsType.FREETEXT_COLOR,ft(this,it)]]}_translateEmpty(Ct,Lt){this._uiManager.translateSelectedEditors(Ct,Lt,!0)}getInitialTranslation(){const Ct=this.parentScale;return[-xt._internalPadding*Ct,-(xt._internalPadding+ft(this,rt))*Ct]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",ft(this,nt)),this.editorDiv.addEventListener("focus",ft(this,b)),this.editorDiv.addEventListener("blur",ft(this,_)),this.editorDiv.addEventListener("input",ft(this,_e)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",ft(this,lt)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",ft(this,nt)),this.editorDiv.removeEventListener("focus",ft(this,b)),this.editorDiv.removeEventListener("blur",ft(this,_)),this.editorDiv.removeEventListener("input",ft(this,_e)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Ct){this._focusEventsAllowed&&(super.focusin(Ct),Ct.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Ct;if(this.width){or(this,ot,Gs).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Ct=this._initialOptions)!=null&&Ct.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Ct=ft(this,et),Lt=lr(this,et,or(this,ot,So).call(this).trimEnd());if(Ct===Lt)return;const er=Kt=>{if(lr(this,et,Kt),!Kt){this.remove();return}or(this,ot,Xs).call(this),this._uiManager.rebuild(this),or(this,ot,ss).call(this)};this.addCommands({cmd:()=>{er(Lt)},undo:()=>{er(Ct)},mustExec:!1}),or(this,ot,ss).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Ct){this.enterInEditMode()}keydown(Ct){Ct.target===this.div&&Ct.key==="Enter"&&(this.enterInEditMode(),Ct.preventDefault())}editorDivKeydown(Ct){xt._keyboardManager.exec(this,Ct)}editorDivFocus(Ct){this.isEditing=!0}editorDivBlur(Ct){this.isEditing=!1}editorDivInput(Ct){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Ct,Lt;this.width&&(Ct=this.x,Lt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",ft(this,lt)),this.enableEditing(),d.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Kt=>{var nr;return(nr=this.editorDiv)==null?void 0:nr.setAttribute("aria-label",Kt)}),d.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Kt=>{var nr;return(nr=this.editorDiv)==null?void 0:nr.setAttribute("default-content",Kt)}),this.editorDiv.contentEditable=!0;const{style:er}=this.editorDiv;if(er.fontSize=`calc(${ft(this,rt)}px * var(--scale-factor))`,er.color=ft(this,it),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,c.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Kt,nr]=this.parentDimensions;if(this.annotationElementId){const{position:Jt}=ft(this,at);let[qt,kt]=this.getInitialTranslation();[qt,kt]=this.pageTranslationToScreen(qt,kt);const[Xt,sr]=this.pageDimensions,[At,ht]=this.pageTranslation;let dt,Tt;switch(this.rotation){case 0:dt=Ct+(Jt[0]-At)/Xt,Tt=Lt+this.height-(Jt[1]-ht)/sr;break;case 90:dt=Ct+(Jt[0]-At)/Xt,Tt=Lt-(Jt[1]-ht)/sr,[qt,kt]=[kt,-qt];break;case 180:dt=Ct-this.width+(Jt[0]-At)/Xt,Tt=Lt-(Jt[1]-ht)/sr,[qt,kt]=[-qt,-kt];break;case 270:dt=Ct+(Jt[0]-At-this.height*sr)/Xt,Tt=Lt+(Jt[1]-ht-this.width*Xt)/sr,[qt,kt]=[-kt,qt];break}this.setAt(dt*Kt,Tt*nr,qt,kt)}else this.setAt(Ct*Kt,Lt*nr,this.width*Kt,this.height*nr);or(this,ot,Xs).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Ct,Lt,er){let Kt=null;if(Ct instanceof h.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Jt,fontColor:qt},rect:kt,rotation:Xt,id:sr},textContent:At,textPosition:ht,parent:{page:{pageNumber:dt}}}=Ct;if(!At||At.length===0)return null;Kt=Ct={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(qt),fontSize:Jt,value:At.join(`
`),position:ht,pageIndex:dt-1,rect:kt,rotation:Xt,id:sr,deleted:!1}}const nr=super.deserialize(Ct,Lt,er);return lr(nr,rt,Ct.fontSize),lr(nr,it,a.Util.makeHexColor(...Ct.color)),lr(nr,et,Ct.value),nr.annotationElementId=Ct.id||null,lr(nr,at,Kt),nr}serialize(Ct=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Lt=xt._internalPadding*this.parentScale,er=this.getRect(Lt,Lt),Kt=d.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:ft(this,it)),nr={annotationType:a.AnnotationEditorType.FREETEXT,color:Kt,fontSize:ft(this,rt),value:ft(this,et),pageIndex:this.pageIndex,rect:er,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Ct?nr:this.annotationElementId&&!or(this,ot,Ao).call(this,nr)?null:(nr.id=this.annotationElementId,nr)}};_=new WeakMap,b=new WeakMap,_e=new WeakMap,nt=new WeakMap,it=new WeakMap,et=new WeakMap,lt=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakSet,yo=function(Ct){const Lt=Kt=>{this.editorDiv.style.fontSize=`calc(${Kt}px * var(--scale-factor))`,this.translate(0,-(Kt-ft(this,rt))*this.parentScale),lr(this,rt,Kt),or(this,ot,ss).call(this)},er=ft(this,rt);this.addCommands({cmd:()=>{Lt(Ct)},undo:()=>{Lt(er)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Eo=function(Ct){const Lt=ft(this,it);this.addCommands({cmd:()=>{lr(this,it,this.editorDiv.style.color=Ct)},undo:()=>{lr(this,it,this.editorDiv.style.color=Lt)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},So=function(){const Ct=this.editorDiv.getElementsByTagName("div");if(Ct.length===0)return this.editorDiv.innerText;const Lt=[];for(const er of Ct)Lt.push(er.innerText.replace(/\r\n?|\n/,""));return Lt.join(`
`)},ss=function(){const[Ct,Lt]=this.parentDimensions;let er;if(this.isAttachedToDOM)er=this.div.getBoundingClientRect();else{const{currentLayer:Kt,div:nr}=this,Jt=nr.style.display;nr.style.display="hidden",Kt.div.append(this.div),er=nr.getBoundingClientRect(),nr.remove(),nr.style.display=Jt}this.rotation%180===this.parentRotation%180?(this.width=er.width/Ct,this.height=er.height/Lt):(this.width=er.height/Ct,this.height=er.width/Lt),this.fixAndSetPosition()},Xs=function(){if(this.editorDiv.replaceChildren(),!!ft(this,et))for(const Ct of ft(this,et).split(`
`)){const Lt=document.createElement("div");Lt.append(Ct?document.createTextNode(Ct):document.createElement("br")),this.editorDiv.append(Lt)}},Ao=function(Ct){const{value:Lt,fontSize:er,color:Kt,rect:nr,pageIndex:Jt}=ft(this,at);return Ct.value!==Lt||Ct.fontSize!==er||Ct.rect.some((qt,kt)=>Math.abs(qt-nr[kt])>=1)||Ct.color.some((qt,kt)=>qt!==Kt[kt])||Ct.pageIndex!==Jt},Gs=function(Ct=!1){if(!this.annotationElementId)return;if(or(this,ot,ss).call(this),!Ct&&(this.width===0||this.height===0)){setTimeout(()=>or(this,ot,Gs).call(this,!0),0);return}const Lt=xt._internalPadding*this.parentScale;ft(this,at).rect=this.getRect(Lt,Lt)},an(xt,"_freeTextDefaultContent",""),an(xt,"_internalPadding",0),an(xt,"_defaultColor",null),an(xt,"_defaultFontSize",10),an(xt,"_type","freetext");let g=xt;i.FreeTextEditor=g},(e,i,s)=>{var Tt,It,On,To,rr,_r,pr,Ar,Sr,Fr,ur,ir,Bt,Qt,fr,hr,Tr,Mr,kr,dr,Nr,Dr,bo,_s,Ks,Ys,Kr,tn,nn,Or,mr,vr,Hr,qs,Zr,tr,Rr,Br,Co,Qs;Object.defineProperty(i,"__esModule",{value:!0}),i.StampAnnotationElement=i.InkAnnotationElement=i.FreeTextAnnotationElement=i.AnnotationLayer=void 0;var a=s(1),c=s(6),d=s(3),h=s(30),g=s(31),_=s(32);const b=1e3,_e=9,nt=new WeakSet;function it(jr){return{width:jr[2]-jr[0],height:jr[3]-jr[1]}}class et{static create(Vt){switch(Vt.data.annotationType){case a.AnnotationType.LINK:return new rt(Vt);case a.AnnotationType.TEXT:return new at(Vt);case a.AnnotationType.WIDGET:switch(Vt.data.fieldType){case"Tx":return new st(Vt);case"Btn":return Vt.data.radioButton?new pt(Vt):Vt.data.checkBox?new mt(Vt):new Et(Vt);case"Ch":return new ut(Vt);case"Sig":return new ct(Vt)}return new ot(Vt);case a.AnnotationType.POPUP:return new gt(Vt);case a.AnnotationType.FREETEXT:return new Pt(Vt);case a.AnnotationType.LINE:return new St(Vt);case a.AnnotationType.SQUARE:return new Ct(Vt);case a.AnnotationType.CIRCLE:return new Lt(Vt);case a.AnnotationType.POLYLINE:return new er(Vt);case a.AnnotationType.CARET:return new nr(Vt);case a.AnnotationType.INK:return new Jt(Vt);case a.AnnotationType.POLYGON:return new Kt(Vt);case a.AnnotationType.HIGHLIGHT:return new qt(Vt);case a.AnnotationType.UNDERLINE:return new kt(Vt);case a.AnnotationType.SQUIGGLY:return new Xt(Vt);case a.AnnotationType.STRIKEOUT:return new sr(Vt);case a.AnnotationType.STAMP:return new At(Vt);case a.AnnotationType.FILEATTACHMENT:return new ht(Vt);default:return new lt(Vt)}}}const Mt=class Mt{constructor(Vt,{isRenderable:$t=!1,ignoreBorder:ar=!1,createQuadrilaterals:xr=!1}={}){cr(this,Tt,!1);this.isRenderable=$t,this.data=Vt.data,this.layer=Vt.layer,this.linkService=Vt.linkService,this.downloadManager=Vt.downloadManager,this.imageResourcesPath=Vt.imageResourcesPath,this.renderForms=Vt.renderForms,this.svgFactory=Vt.svgFactory,this.annotationStorage=Vt.annotationStorage,this.enableScripting=Vt.enableScripting,this.hasJSActions=Vt.hasJSActions,this._fieldObjects=Vt.fieldObjects,this.parent=Vt.parent,$t&&(this.container=this._createContainer(ar)),xr&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Vt,contentsObj:$t,richText:ar}){return!!(Vt!=null&&Vt.str||$t!=null&&$t.str||ar!=null&&ar.str)}get hasPopupData(){return Mt._hasPopupData(this.data)}_createContainer(Vt){const{data:$t,parent:{page:ar,viewport:xr}}=this,Er=document.createElement("section");Er.setAttribute("data-annotation-id",$t.id),this instanceof ot||(Er.tabIndex=b),Er.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Er.setAttribute("aria-haspopup","dialog"),$t.noRotate&&Er.classList.add("norotate");const{pageWidth:Pr,pageHeight:Lr,pageX:Gr,pageY:Xr}=xr.rawDims;if(!$t.rect||this instanceof gt){const{rotation:Ht}=$t;return!$t.hasOwnCanvas&&Ht!==0&&this.setRotation(Ht,Er),Er}const{width:Rt,height:zt}=it($t.rect),Dt=a.Util.normalizeRect([$t.rect[0],ar.view[3]-$t.rect[1]+ar.view[1],$t.rect[2],ar.view[3]-$t.rect[3]+ar.view[1]]);if(!Vt&&$t.borderStyle.width>0){Er.style.borderWidth=`${$t.borderStyle.width}px`;const Ht=$t.borderStyle.horizontalCornerRadius,Gt=$t.borderStyle.verticalCornerRadius;if(Ht>0||Gt>0){const Cr=`calc(${Ht}px * var(--scale-factor)) / calc(${Gt}px * var(--scale-factor))`;Er.style.borderRadius=Cr}else if(this instanceof pt){const Cr=`calc(${Rt}px * var(--scale-factor)) / calc(${zt}px * var(--scale-factor))`;Er.style.borderRadius=Cr}switch($t.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:Er.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:Er.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:Er.style.borderBottomStyle="solid";break}const gr=$t.borderColor||null;gr?(lr(this,Tt,!0),Er.style.borderColor=a.Util.makeHexColor(gr[0]|0,gr[1]|0,gr[2]|0)):Er.style.borderWidth=0}Er.style.left=`${100*(Dt[0]-Gr)/Pr}%`,Er.style.top=`${100*(Dt[1]-Xr)/Lr}%`;const{rotation:Nt}=$t;return $t.hasOwnCanvas||Nt===0?(Er.style.width=`${100*Rt/Pr}%`,Er.style.height=`${100*zt/Lr}%`):this.setRotation(Nt,Er),Er}setRotation(Vt,$t=this.container){if(!this.data.rect)return;const{pageWidth:ar,pageHeight:xr}=this.parent.viewport.rawDims,{width:Er,height:Pr}=it(this.data.rect);let Lr,Gr;Vt%180===0?(Lr=100*Er/ar,Gr=100*Pr/xr):(Lr=100*Pr/ar,Gr=100*Er/xr),$t.style.width=`${Lr}%`,$t.style.height=`${Gr}%`,$t.setAttribute("data-main-rotation",(360-Vt)%360)}get _commonActions(){const Vt=($t,ar,xr)=>{const Er=xr.detail[$t],Pr=Er[0],Lr=Er.slice(1);xr.target.style[ar]=h.ColorConverters[`${Pr}_HTML`](Lr),this.annotationStorage.setValue(this.data.id,{[ar]:h.ColorConverters[`${Pr}_rgb`](Lr)})};return(0,a.shadow)(this,"_commonActions",{display:$t=>{const{display:ar}=$t.detail,xr=ar%2===1;this.container.style.visibility=xr?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:xr,noPrint:ar===1||ar===2})},print:$t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!$t.detail.print})},hidden:$t=>{const{hidden:ar}=$t.detail;this.container.style.visibility=ar?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:ar,noView:ar})},focus:$t=>{setTimeout(()=>$t.target.focus({preventScroll:!1}),0)},userName:$t=>{$t.target.title=$t.detail.userName},readonly:$t=>{$t.target.disabled=$t.detail.readonly},required:$t=>{this._setRequired($t.target,$t.detail.required)},bgColor:$t=>{Vt("bgColor","backgroundColor",$t)},fillColor:$t=>{Vt("fillColor","backgroundColor",$t)},fgColor:$t=>{Vt("fgColor","color",$t)},textColor:$t=>{Vt("textColor","color",$t)},borderColor:$t=>{Vt("borderColor","borderColor",$t)},strokeColor:$t=>{Vt("strokeColor","borderColor",$t)},rotation:$t=>{const ar=$t.detail.rotation;this.setRotation(ar),this.annotationStorage.setValue(this.data.id,{rotation:ar})}})}_dispatchEventFromSandbox(Vt,$t){const ar=this._commonActions;for(const xr of Object.keys($t.detail)){const Er=Vt[xr]||ar[xr];Er==null||Er($t)}}_setDefaultPropertiesFromJS(Vt){if(!this.enableScripting)return;const $t=this.annotationStorage.getRawValue(this.data.id);if(!$t)return;const ar=this._commonActions;for(const[xr,Er]of Object.entries($t)){const Pr=ar[xr];if(Pr){const Lr={detail:{[xr]:Er},target:Vt};Pr(Lr),delete $t[xr]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Vt}=this.data;if(!Vt)return;const[$t,ar,xr,Er]=this.data.rect;if(Vt.length===1){const[,{x:Gt,y:gr},{x:Cr,y:yr}]=Vt[0];if(xr===Gt&&Er===gr&&$t===Cr&&ar===yr)return}const{style:Pr}=this.container;let Lr;if(ft(this,Tt)){const{borderColor:Gt,borderWidth:gr}=Pr;Pr.borderWidth=0,Lr=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Gt}" stroke-width="${gr}">`],this.container.classList.add("hasBorder")}const Gr=xr-$t,Xr=Er-ar,{svgFactory:Rt}=this,zt=Rt.createElement("svg");zt.classList.add("quadrilateralsContainer"),zt.setAttribute("width",0),zt.setAttribute("height",0);const Dt=Rt.createElement("defs");zt.append(Dt);const Nt=Rt.createElement("clipPath"),Ht=`clippath_${this.data.id}`;Nt.setAttribute("id",Ht),Nt.setAttribute("clipPathUnits","objectBoundingBox"),Dt.append(Nt);for(const[,{x:Gt,y:gr},{x:Cr,y:yr}]of Vt){const wr=Rt.createElement("rect"),br=(Cr-$t)/Gr,Ur=(Er-gr)/Xr,$r=(Gt-Cr)/Gr,qr=(gr-yr)/Xr;wr.setAttribute("x",br),wr.setAttribute("y",Ur),wr.setAttribute("width",$r),wr.setAttribute("height",qr),Nt.append(wr),Lr==null||Lr.push(`<rect vector-effect="non-scaling-stroke" x="${br}" y="${Ur}" width="${$r}" height="${qr}"/>`)}ft(this,Tt)&&(Lr.push("</g></svg>')"),Pr.backgroundImage=Lr.join("")),this.container.append(zt),this.container.style.clipPath=`url(#${Ht})`}_createPopup(){const{container:Vt,data:$t}=this;Vt.setAttribute("aria-haspopup","dialog");const ar=new gt({data:{color:$t.color,titleObj:$t.titleObj,modificationDate:$t.modificationDate,contentsObj:$t.contentsObj,richText:$t.richText,parentRect:$t.rect,borderStyle:0,id:`popup_${$t.id}`,rotation:$t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(ar.render())}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Vt,$t=null){const ar=[];if(this._fieldObjects){const xr=this._fieldObjects[Vt];if(xr)for(const{page:Er,id:Pr,exportValues:Lr}of xr){if(Er===-1||Pr===$t)continue;const Gr=typeof Lr=="string"?Lr:null,Xr=document.querySelector(`[data-element-id="${Pr}"]`);if(Xr&&!nt.has(Xr)){(0,a.warn)(`_getElementsByName - element not allowed: ${Pr}`);continue}ar.push({id:Pr,exportValue:Gr,domElement:Xr})}return ar}for(const xr of document.getElementsByName(Vt)){const{exportValue:Er}=xr,Pr=xr.getAttribute("data-element-id");Pr!==$t&&nt.has(xr)&&ar.push({id:Pr,exportValue:Er,domElement:xr})}return ar}show(){var Vt;this.container&&(this.container.hidden=!1),(Vt=this.popup)==null||Vt.maybeShow()}hide(){var Vt;this.container&&(this.container.hidden=!0),(Vt=this.popup)==null||Vt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Vt=this.getElementsToTriggerPopup();if(Array.isArray(Vt))for(const $t of Vt)$t.classList.add("highlightArea");else Vt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:Vt,data:{id:$t}}=this;this.container.addEventListener("dblclick",()=>{var ar;(ar=this.linkService.eventBus)==null||ar.dispatch("switchannotationeditormode",{source:this,mode:Vt,editId:$t})})}};Tt=new WeakMap;let lt=Mt;class rt extends lt{constructor($t,ar=null){super($t,{isRenderable:!0,ignoreBorder:!!(ar!=null&&ar.ignoreBorder),createQuadrilaterals:!0});cr(this,It);this.isTooltipOnly=$t.data.isTooltipOnly}render(){const{data:$t,linkService:ar}=this,xr=document.createElement("a");xr.setAttribute("data-element-id",$t.id);let Er=!1;return $t.url?(ar.addLinkAttributes(xr,$t.url,$t.newWindow),Er=!0):$t.action?(this._bindNamedAction(xr,$t.action),Er=!0):$t.attachment?(this._bindAttachment(xr,$t.attachment),Er=!0):$t.setOCGState?(or(this,It,To).call(this,xr,$t.setOCGState),Er=!0):$t.dest?(this._bindLink(xr,$t.dest),Er=!0):($t.actions&&($t.actions.Action||$t.actions["Mouse Up"]||$t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(xr,$t),Er=!0),$t.resetForm?(this._bindResetFormAction(xr,$t.resetForm),Er=!0):this.isTooltipOnly&&!Er&&(this._bindLink(xr,""),Er=!0)),this.container.classList.add("linkAnnotation"),Er&&this.container.append(xr),this.container}_bindLink($t,ar){$t.href=this.linkService.getDestinationHash(ar),$t.onclick=()=>(ar&&this.linkService.goToDestination(ar),!1),(ar||ar==="")&&or(this,It,On).call(this)}_bindNamedAction($t,ar){$t.href=this.linkService.getAnchorUrl(""),$t.onclick=()=>(this.linkService.executeNamedAction(ar),!1),or(this,It,On).call(this)}_bindAttachment($t,ar){$t.href=this.linkService.getAnchorUrl(""),$t.onclick=()=>{var xr;return(xr=this.downloadManager)==null||xr.openOrDownloadData(this.container,ar.content,ar.filename),!1},or(this,It,On).call(this)}_bindJSAction($t,ar){$t.href=this.linkService.getAnchorUrl("");const xr=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Er of Object.keys(ar.actions)){const Pr=xr.get(Er);Pr&&($t[Pr]=()=>{var Lr;return(Lr=this.linkService.eventBus)==null||Lr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ar.id,name:Er}}),!1})}$t.onclick||($t.onclick=()=>!1),or(this,It,On).call(this)}_bindResetFormAction($t,ar){const xr=$t.onclick;if(xr||($t.href=this.linkService.getAnchorUrl("")),or(this,It,On).call(this),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),xr||($t.onclick=()=>!1);return}$t.onclick=()=>{var zt;xr==null||xr();const{fields:Er,refs:Pr,include:Lr}=ar,Gr=[];if(Er.length!==0||Pr.length!==0){const Dt=new Set(Pr);for(const Nt of Er){const Ht=this._fieldObjects[Nt]||[];for(const{id:Gt}of Ht)Dt.add(Gt)}for(const Nt of Object.values(this._fieldObjects))for(const Ht of Nt)Dt.has(Ht.id)===Lr&&Gr.push(Ht)}else for(const Dt of Object.values(this._fieldObjects))Gr.push(...Dt);const Xr=this.annotationStorage,Rt=[];for(const Dt of Gr){const{id:Nt}=Dt;switch(Rt.push(Nt),Dt.type){case"text":{const Gt=Dt.defaultValue||"";Xr.setValue(Nt,{value:Gt});break}case"checkbox":case"radiobutton":{const Gt=Dt.defaultValue===Dt.exportValues;Xr.setValue(Nt,{value:Gt});break}case"combobox":case"listbox":{const Gt=Dt.defaultValue||"";Xr.setValue(Nt,{value:Gt});break}default:continue}const Ht=document.querySelector(`[data-element-id="${Nt}"]`);if(Ht){if(!nt.has(Ht)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${Nt}`);continue}}else continue;Ht.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((zt=this.linkService.eventBus)==null||zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Rt,name:"ResetForm"}})),!1}}}It=new WeakSet,On=function(){this.container.setAttribute("data-internal-link","")},To=function($t,ar){$t.href=this.linkService.getAnchorUrl(""),$t.onclick=()=>(this.linkService.executeSetOCGState(ar),!1),or(this,It,On).call(this)};class at extends lt{constructor(Vt){super(Vt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Vt=document.createElement("img");return Vt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Vt.alt="[{{type}} Annotation]",Vt.dataset.l10nId="text_annotation_type",Vt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Vt),this.container}}class ot extends lt{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(Vt){var $t;this.data.hasOwnCanvas&&((($t=Vt.previousSibling)==null?void 0:$t.nodeName)==="CANVAS"&&(Vt.previousSibling.hidden=!0),Vt.hidden=!1)}_getKeyModifier(Vt){const{isWin:$t,isMac:ar}=a.FeatureTest.platform;return $t&&Vt.ctrlKey||ar&&Vt.metaKey}_setEventListener(Vt,$t,ar,xr,Er){ar.includes("mouse")?Vt.addEventListener(ar,Pr=>{var Lr;(Lr=this.linkService.eventBus)==null||Lr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:xr,value:Er(Pr),shift:Pr.shiftKey,modifier:this._getKeyModifier(Pr)}})}):Vt.addEventListener(ar,Pr=>{var Lr;if(ar==="blur"){if(!$t.focused||!Pr.relatedTarget)return;$t.focused=!1}else if(ar==="focus"){if($t.focused)return;$t.focused=!0}Er&&((Lr=this.linkService.eventBus)==null||Lr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:xr,value:Er(Pr)}}))})}_setEventListeners(Vt,$t,ar,xr){var Er,Pr,Lr;for(const[Gr,Xr]of ar)(Xr==="Action"||(Er=this.data.actions)!=null&&Er[Xr])&&((Xr==="Focus"||Xr==="Blur")&&($t||($t={focused:!1})),this._setEventListener(Vt,$t,Gr,Xr,xr),Xr==="Focus"&&!((Pr=this.data.actions)!=null&&Pr.Blur)?this._setEventListener(Vt,$t,"blur","Blur",null):Xr==="Blur"&&!((Lr=this.data.actions)!=null&&Lr.Focus)&&this._setEventListener(Vt,$t,"focus","Focus",null))}_setBackgroundColor(Vt){const $t=this.data.backgroundColor||null;Vt.style.backgroundColor=$t===null?"transparent":a.Util.makeHexColor($t[0],$t[1],$t[2])}_setTextStyle(Vt){const $t=["left","center","right"],{fontColor:ar}=this.data.defaultAppearanceData,xr=this.data.defaultAppearanceData.fontSize||_e,Er=Vt.style;let Pr;const Lr=2,Gr=Xr=>Math.round(10*Xr)/10;if(this.data.multiLine){const Xr=Math.abs(this.data.rect[3]-this.data.rect[1]-Lr),Rt=Math.round(Xr/(a.LINE_FACTOR*xr))||1,zt=Xr/Rt;Pr=Math.min(xr,Gr(zt/a.LINE_FACTOR))}else{const Xr=Math.abs(this.data.rect[3]-this.data.rect[1]-Lr);Pr=Math.min(xr,Gr(Xr/a.LINE_FACTOR))}Er.fontSize=`calc(${Pr}px * var(--scale-factor))`,Er.color=a.Util.makeHexColor(ar[0],ar[1],ar[2]),this.data.textAlignment!==null&&(Er.textAlign=$t[this.data.textAlignment])}_setRequired(Vt,$t){$t?Vt.setAttribute("required",!0):Vt.removeAttribute("required"),Vt.setAttribute("aria-required",$t)}}class st extends ot{constructor(Vt){const $t=Vt.renderForms||!Vt.data.hasAppearance&&!!Vt.data.fieldValue;super(Vt,{isRenderable:$t})}setPropertyOnSiblings(Vt,$t,ar,xr){const Er=this.annotationStorage;for(const Pr of this._getElementsByName(Vt.name,Vt.id))Pr.domElement&&(Pr.domElement[$t]=ar),Er.setValue(Pr.id,{[xr]:ar})}render(){var xr,Er;const Vt=this.annotationStorage,$t=this.data.id;this.container.classList.add("textWidgetAnnotation");let ar=null;if(this.renderForms){const Pr=Vt.getValue($t,{value:this.data.fieldValue});let Lr=Pr.value||"";const Gr=Vt.getValue($t,{charLimit:this.data.maxLen}).charLimit;Gr&&Lr.length>Gr&&(Lr=Lr.slice(0,Gr));let Xr=Pr.formattedValue||((xr=this.data.textContent)==null?void 0:xr.join(`
`))||null;Xr&&this.data.comb&&(Xr=Xr.replaceAll(/\s+/g,""));const Rt={userValue:Lr,formattedValue:Xr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(ar=document.createElement("textarea"),ar.textContent=Xr??Lr,this.data.doNotScroll&&(ar.style.overflowY="hidden")):(ar=document.createElement("input"),ar.type="text",ar.setAttribute("value",Xr??Lr),this.data.doNotScroll&&(ar.style.overflowX="hidden")),this.data.hasOwnCanvas&&(ar.hidden=!0),nt.add(ar),ar.setAttribute("data-element-id",$t),ar.disabled=this.data.readOnly,ar.name=this.data.fieldName,ar.tabIndex=b,this._setRequired(ar,this.data.required),Gr&&(ar.maxLength=Gr),ar.addEventListener("input",Dt=>{Vt.setValue($t,{value:Dt.target.value}),this.setPropertyOnSiblings(ar,"value",Dt.target.value,"value"),Rt.formattedValue=null}),ar.addEventListener("resetform",Dt=>{const Nt=this.data.defaultFieldValue??"";ar.value=Rt.userValue=Nt,Rt.formattedValue=null});let zt=Dt=>{const{formattedValue:Nt}=Rt;Nt!=null&&(Dt.target.value=Nt),Dt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ar.addEventListener("focus",Nt=>{if(Rt.focused)return;const{target:Ht}=Nt;Rt.userValue&&(Ht.value=Rt.userValue),Rt.lastCommittedValue=Ht.value,Rt.commitKey=1,Rt.focused=!0}),ar.addEventListener("updatefromsandbox",Nt=>{this.showElementAndHideCanvas(Nt.target);const Ht={value(Gt){Rt.userValue=Gt.detail.value??"",Vt.setValue($t,{value:Rt.userValue.toString()}),Gt.target.value=Rt.userValue},formattedValue(Gt){const{formattedValue:gr}=Gt.detail;Rt.formattedValue=gr,gr!=null&&Gt.target!==document.activeElement&&(Gt.target.value=gr),Vt.setValue($t,{formattedValue:gr})},selRange(Gt){Gt.target.setSelectionRange(...Gt.detail.selRange)},charLimit:Gt=>{var wr;const{charLimit:gr}=Gt.detail,{target:Cr}=Gt;if(gr===0){Cr.removeAttribute("maxLength");return}Cr.setAttribute("maxLength",gr);let yr=Rt.userValue;!yr||yr.length<=gr||(yr=yr.slice(0,gr),Cr.value=Rt.userValue=yr,Vt.setValue($t,{value:yr}),(wr=this.linkService.eventBus)==null||wr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:$t,name:"Keystroke",value:yr,willCommit:!0,commitKey:1,selStart:Cr.selectionStart,selEnd:Cr.selectionEnd}}))}};this._dispatchEventFromSandbox(Ht,Nt)}),ar.addEventListener("keydown",Nt=>{var gr;Rt.commitKey=1;let Ht=-1;if(Nt.key==="Escape"?Ht=0:Nt.key==="Enter"&&!this.data.multiLine?Ht=2:Nt.key==="Tab"&&(Rt.commitKey=3),Ht===-1)return;const{value:Gt}=Nt.target;Rt.lastCommittedValue!==Gt&&(Rt.lastCommittedValue=Gt,Rt.userValue=Gt,(gr=this.linkService.eventBus)==null||gr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:$t,name:"Keystroke",value:Gt,willCommit:!0,commitKey:Ht,selStart:Nt.target.selectionStart,selEnd:Nt.target.selectionEnd}}))});const Dt=zt;zt=null,ar.addEventListener("blur",Nt=>{var Gt;if(!Rt.focused||!Nt.relatedTarget)return;Rt.focused=!1;const{value:Ht}=Nt.target;Rt.userValue=Ht,Rt.lastCommittedValue!==Ht&&((Gt=this.linkService.eventBus)==null||Gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:$t,name:"Keystroke",value:Ht,willCommit:!0,commitKey:Rt.commitKey,selStart:Nt.target.selectionStart,selEnd:Nt.target.selectionEnd}})),Dt(Nt)}),(Er=this.data.actions)!=null&&Er.Keystroke&&ar.addEventListener("beforeinput",Nt=>{var Ur;Rt.lastCommittedValue=null;const{data:Ht,target:Gt}=Nt,{value:gr,selectionStart:Cr,selectionEnd:yr}=Gt;let wr=Cr,br=yr;switch(Nt.inputType){case"deleteWordBackward":{const $r=gr.substring(0,Cr).match(/\w*[^\w]*$/);$r&&(wr-=$r[0].length);break}case"deleteWordForward":{const $r=gr.substring(Cr).match(/^[^\w]*\w*/);$r&&(br+=$r[0].length);break}case"deleteContentBackward":Cr===yr&&(wr-=1);break;case"deleteContentForward":Cr===yr&&(br+=1);break}Nt.preventDefault(),(Ur=this.linkService.eventBus)==null||Ur.dispatch("dispatcheventinsandbox",{source:this,detail:{id:$t,name:"Keystroke",value:gr,change:Ht||"",willCommit:!1,selStart:wr,selEnd:br}})}),this._setEventListeners(ar,Rt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Nt=>Nt.target.value)}if(zt&&ar.addEventListener("blur",zt),this.data.comb){const Nt=(this.data.rect[2]-this.data.rect[0])/Gr;ar.classList.add("comb"),ar.style.letterSpacing=`calc(${Nt}px * var(--scale-factor) - 1ch)`}}else ar=document.createElement("div"),ar.textContent=this.data.fieldValue,ar.style.verticalAlign="middle",ar.style.display="table-cell";return this._setTextStyle(ar),this._setBackgroundColor(ar),this._setDefaultPropertiesFromJS(ar),this.container.append(ar),this.container}}class ct extends ot{constructor(Vt){super(Vt,{isRenderable:!!Vt.data.hasOwnCanvas})}}class mt extends ot{constructor(Vt){super(Vt,{isRenderable:Vt.renderForms})}render(){const Vt=this.annotationStorage,$t=this.data,ar=$t.id;let xr=Vt.getValue(ar,{value:$t.exportValue===$t.fieldValue}).value;typeof xr=="string"&&(xr=xr!=="Off",Vt.setValue(ar,{value:xr})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Er=document.createElement("input");return nt.add(Er),Er.setAttribute("data-element-id",ar),Er.disabled=$t.readOnly,this._setRequired(Er,this.data.required),Er.type="checkbox",Er.name=$t.fieldName,xr&&Er.setAttribute("checked",!0),Er.setAttribute("exportValue",$t.exportValue),Er.tabIndex=b,Er.addEventListener("change",Pr=>{const{name:Lr,checked:Gr}=Pr.target;for(const Xr of this._getElementsByName(Lr,ar)){const Rt=Gr&&Xr.exportValue===$t.exportValue;Xr.domElement&&(Xr.domElement.checked=Rt),Vt.setValue(Xr.id,{value:Rt})}Vt.setValue(ar,{value:Gr})}),Er.addEventListener("resetform",Pr=>{const Lr=$t.defaultFieldValue||"Off";Pr.target.checked=Lr===$t.exportValue}),this.enableScripting&&this.hasJSActions&&(Er.addEventListener("updatefromsandbox",Pr=>{const Lr={value(Gr){Gr.target.checked=Gr.detail.value!=="Off",Vt.setValue(ar,{value:Gr.target.checked})}};this._dispatchEventFromSandbox(Lr,Pr)}),this._setEventListeners(Er,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Pr=>Pr.target.checked)),this._setBackgroundColor(Er),this._setDefaultPropertiesFromJS(Er),this.container.append(Er),this.container}}class pt extends ot{constructor(Vt){super(Vt,{isRenderable:Vt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Vt=this.annotationStorage,$t=this.data,ar=$t.id;let xr=Vt.getValue(ar,{value:$t.fieldValue===$t.buttonValue}).value;typeof xr=="string"&&(xr=xr!==$t.buttonValue,Vt.setValue(ar,{value:xr}));const Er=document.createElement("input");if(nt.add(Er),Er.setAttribute("data-element-id",ar),Er.disabled=$t.readOnly,this._setRequired(Er,this.data.required),Er.type="radio",Er.name=$t.fieldName,xr&&Er.setAttribute("checked",!0),Er.tabIndex=b,Er.addEventListener("change",Pr=>{const{name:Lr,checked:Gr}=Pr.target;for(const Xr of this._getElementsByName(Lr,ar))Vt.setValue(Xr.id,{value:!1});Vt.setValue(ar,{value:Gr})}),Er.addEventListener("resetform",Pr=>{const Lr=$t.defaultFieldValue;Pr.target.checked=Lr!=null&&Lr===$t.buttonValue}),this.enableScripting&&this.hasJSActions){const Pr=$t.buttonValue;Er.addEventListener("updatefromsandbox",Lr=>{const Gr={value:Xr=>{const Rt=Pr===Xr.detail.value;for(const zt of this._getElementsByName(Xr.target.name)){const Dt=Rt&&zt.id===ar;zt.domElement&&(zt.domElement.checked=Dt),Vt.setValue(zt.id,{value:Dt})}}};this._dispatchEventFromSandbox(Gr,Lr)}),this._setEventListeners(Er,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Lr=>Lr.target.checked)}return this._setBackgroundColor(Er),this._setDefaultPropertiesFromJS(Er),this.container.append(Er),this.container}}class Et extends rt{constructor(Vt){super(Vt,{ignoreBorder:Vt.data.hasAppearance})}render(){const Vt=super.render();Vt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(Vt.title=this.data.alternativeText);const $t=Vt.lastChild;return this.enableScripting&&this.hasJSActions&&$t&&(this._setDefaultPropertiesFromJS($t),$t.addEventListener("updatefromsandbox",ar=>{this._dispatchEventFromSandbox({},ar)})),Vt}}class ut extends ot{constructor(Vt){super(Vt,{isRenderable:Vt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Vt=this.annotationStorage,$t=this.data.id,ar=Vt.getValue($t,{value:this.data.fieldValue}),xr=document.createElement("select");nt.add(xr),xr.setAttribute("data-element-id",$t),xr.disabled=this.data.readOnly,this._setRequired(xr,this.data.required),xr.name=this.data.fieldName,xr.tabIndex=b;let Er=this.data.combo&&this.data.options.length>0;this.data.combo||(xr.size=this.data.options.length,this.data.multiSelect&&(xr.multiple=!0)),xr.addEventListener("resetform",Rt=>{const zt=this.data.defaultFieldValue;for(const Dt of xr.options)Dt.selected=Dt.value===zt});for(const Rt of this.data.options){const zt=document.createElement("option");zt.textContent=Rt.displayValue,zt.value=Rt.exportValue,ar.value.includes(Rt.exportValue)&&(zt.setAttribute("selected",!0),Er=!1),xr.append(zt)}let Pr=null;if(Er){const Rt=document.createElement("option");Rt.value=" ",Rt.setAttribute("hidden",!0),Rt.setAttribute("selected",!0),xr.prepend(Rt),Pr=()=>{Rt.remove(),xr.removeEventListener("input",Pr),Pr=null},xr.addEventListener("input",Pr)}const Lr=Rt=>{const zt=Rt?"value":"textContent",{options:Dt,multiple:Nt}=xr;return Nt?Array.prototype.filter.call(Dt,Ht=>Ht.selected).map(Ht=>Ht[zt]):Dt.selectedIndex===-1?null:Dt[Dt.selectedIndex][zt]};let Gr=Lr(!1);const Xr=Rt=>{const zt=Rt.target.options;return Array.prototype.map.call(zt,Dt=>({displayValue:Dt.textContent,exportValue:Dt.value}))};return this.enableScripting&&this.hasJSActions?(xr.addEventListener("updatefromsandbox",Rt=>{const zt={value(Dt){Pr==null||Pr();const Nt=Dt.detail.value,Ht=new Set(Array.isArray(Nt)?Nt:[Nt]);for(const Gt of xr.options)Gt.selected=Ht.has(Gt.value);Vt.setValue($t,{value:Lr(!0)}),Gr=Lr(!1)},multipleSelection(Dt){xr.multiple=!0},remove(Dt){const Nt=xr.options,Ht=Dt.detail.remove;Nt[Ht].selected=!1,xr.remove(Ht),Nt.length>0&&Array.prototype.findIndex.call(Nt,gr=>gr.selected)===-1&&(Nt[0].selected=!0),Vt.setValue($t,{value:Lr(!0),items:Xr(Dt)}),Gr=Lr(!1)},clear(Dt){for(;xr.length!==0;)xr.remove(0);Vt.setValue($t,{value:null,items:[]}),Gr=Lr(!1)},insert(Dt){const{index:Nt,displayValue:Ht,exportValue:Gt}=Dt.detail.insert,gr=xr.children[Nt],Cr=document.createElement("option");Cr.textContent=Ht,Cr.value=Gt,gr?gr.before(Cr):xr.append(Cr),Vt.setValue($t,{value:Lr(!0),items:Xr(Dt)}),Gr=Lr(!1)},items(Dt){const{items:Nt}=Dt.detail;for(;xr.length!==0;)xr.remove(0);for(const Ht of Nt){const{displayValue:Gt,exportValue:gr}=Ht,Cr=document.createElement("option");Cr.textContent=Gt,Cr.value=gr,xr.append(Cr)}xr.options.length>0&&(xr.options[0].selected=!0),Vt.setValue($t,{value:Lr(!0),items:Xr(Dt)}),Gr=Lr(!1)},indices(Dt){const Nt=new Set(Dt.detail.indices);for(const Ht of Dt.target.options)Ht.selected=Nt.has(Ht.index);Vt.setValue($t,{value:Lr(!0)}),Gr=Lr(!1)},editable(Dt){Dt.target.disabled=!Dt.detail.editable}};this._dispatchEventFromSandbox(zt,Rt)}),xr.addEventListener("input",Rt=>{var Dt;const zt=Lr(!0);Vt.setValue($t,{value:zt}),Rt.preventDefault(),(Dt=this.linkService.eventBus)==null||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:$t,name:"Keystroke",value:Gr,changeEx:zt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(xr,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Rt=>Rt.target.value)):xr.addEventListener("input",function(Rt){Vt.setValue($t,{value:Lr(!0)})}),this.data.combo&&this._setTextStyle(xr),this._setBackgroundColor(xr),this._setDefaultPropertiesFromJS(xr),this.container.append(xr),this.container}}class gt extends lt{constructor(Vt){const{data:$t,elements:ar}=Vt;super(Vt,{isRenderable:lt._hasPopupData($t)}),this.elements=ar}render(){this.container.classList.add("popupAnnotation");const Vt=new xt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),$t=[];for(const ar of this.elements)ar.popup=Vt,$t.push(ar.data.id),ar.addHighlightArea();return this.container.setAttribute("aria-controls",$t.map(ar=>`${a.AnnotationPrefix}${ar}`).join(",")),this.container}}class xt{constructor({container:Vt,color:$t,elements:ar,titleObj:xr,modificationDate:Er,contentsObj:Pr,richText:Lr,parent:Gr,rect:Xr,parentRect:Rt,open:zt}){cr(this,Dr);cr(this,rr,null);cr(this,_r,or(this,Dr,bo).bind(this));cr(this,pr,or(this,Dr,Ys).bind(this));cr(this,Ar,or(this,Dr,Ks).bind(this));cr(this,Sr,or(this,Dr,_s).bind(this));cr(this,Fr,null);cr(this,ur,null);cr(this,ir,null);cr(this,Bt,null);cr(this,Qt,null);cr(this,fr,null);cr(this,hr,!1);cr(this,Tr,null);cr(this,Mr,null);cr(this,kr,null);cr(this,dr,null);cr(this,Nr,!1);var Nt;lr(this,ur,Vt),lr(this,dr,xr),lr(this,ir,Pr),lr(this,kr,Lr),lr(this,Qt,Gr),lr(this,Fr,$t),lr(this,Mr,Xr),lr(this,fr,Rt),lr(this,Bt,ar);const Dt=c.PDFDateString.toDateObject(Er);Dt&&lr(this,rr,Gr.l10n.get("annotation_date_string",{date:Dt.toLocaleDateString(),time:Dt.toLocaleTimeString()})),this.trigger=ar.flatMap(Ht=>Ht.getElementsToTriggerPopup());for(const Ht of this.trigger)Ht.addEventListener("click",ft(this,Sr)),Ht.addEventListener("mouseenter",ft(this,Ar)),Ht.addEventListener("mouseleave",ft(this,pr)),Ht.classList.add("popupTriggerArea");for(const Ht of ar)(Nt=Ht.container)==null||Nt.addEventListener("keydown",ft(this,_r));ft(this,ur).hidden=!0,zt&&or(this,Dr,_s).call(this)}render(){if(ft(this,Tr))return;const{page:{view:Vt},viewport:{rawDims:{pageWidth:$t,pageHeight:ar,pageX:xr,pageY:Er}}}=ft(this,Qt),Pr=lr(this,Tr,document.createElement("div"));if(Pr.className="popup",ft(this,Fr)){const wr=Pr.style.outlineColor=a.Util.makeHexColor(...ft(this,Fr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Pr.style.backgroundColor=`color-mix(in srgb, ${wr} 30%, white)`:Pr.style.backgroundColor=a.Util.makeHexColor(...ft(this,Fr).map(Ur=>Math.floor(.7*(255-Ur)+Ur)))}const Lr=document.createElement("span");Lr.className="header";const Gr=document.createElement("h1");if(Lr.append(Gr),{dir:Gr.dir,str:Gr.textContent}=ft(this,dr),Pr.append(Lr),ft(this,rr)){const wr=document.createElement("span");wr.classList.add("popupDate"),ft(this,rr).then(br=>{wr.textContent=br}),Lr.append(wr)}const Xr=ft(this,ir),Rt=ft(this,kr);if(Rt!=null&&Rt.str&&(!(Xr!=null&&Xr.str)||Xr.str===Rt.str))_.XfaLayer.render({xfaHtml:Rt.html,intent:"richText",div:Pr}),Pr.lastChild.classList.add("richText","popupContent");else{const wr=this._formatContents(Xr);Pr.append(wr)}let zt=!!ft(this,fr),Dt=zt?ft(this,fr):ft(this,Mr);for(const wr of ft(this,Bt))if(!Dt||a.Util.intersect(wr.data.rect,Dt)!==null){Dt=wr.data.rect,zt=!0;break}const Nt=a.Util.normalizeRect([Dt[0],Vt[3]-Dt[1]+Vt[1],Dt[2],Vt[3]-Dt[3]+Vt[1]]),Gt=zt?Dt[2]-Dt[0]+5:0,gr=Nt[0]+Gt,Cr=Nt[1],{style:yr}=ft(this,ur);yr.left=`${100*(gr-xr)/$t}%`,yr.top=`${100*(Cr-Er)/ar}%`,ft(this,ur).append(Pr)}_formatContents({str:Vt,dir:$t}){const ar=document.createElement("p");ar.classList.add("popupContent"),ar.dir=$t;const xr=Vt.split(/(?:\r\n?|\n)/);for(let Er=0,Pr=xr.length;Er<Pr;++Er){const Lr=xr[Er];ar.append(document.createTextNode(Lr)),Er<Pr-1&&ar.append(document.createElement("br"))}return ar}forceHide(){lr(this,Nr,this.isVisible),ft(this,Nr)&&(ft(this,ur).hidden=!0)}maybeShow(){ft(this,Nr)&&(lr(this,Nr,!1),ft(this,ur).hidden=!1)}get isVisible(){return ft(this,ur).hidden===!1}}rr=new WeakMap,_r=new WeakMap,pr=new WeakMap,Ar=new WeakMap,Sr=new WeakMap,Fr=new WeakMap,ur=new WeakMap,ir=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,fr=new WeakMap,hr=new WeakMap,Tr=new WeakMap,Mr=new WeakMap,kr=new WeakMap,dr=new WeakMap,Nr=new WeakMap,Dr=new WeakSet,bo=function(Vt){Vt.altKey||Vt.shiftKey||Vt.ctrlKey||Vt.metaKey||(Vt.key==="Enter"||Vt.key==="Escape"&&ft(this,hr))&&or(this,Dr,_s).call(this)},_s=function(){lr(this,hr,!ft(this,hr)),ft(this,hr)?(or(this,Dr,Ks).call(this),ft(this,ur).addEventListener("click",ft(this,Sr)),ft(this,ur).addEventListener("keydown",ft(this,_r))):(or(this,Dr,Ys).call(this),ft(this,ur).removeEventListener("click",ft(this,Sr)),ft(this,ur).removeEventListener("keydown",ft(this,_r)))},Ks=function(){ft(this,Tr)||this.render(),this.isVisible?ft(this,hr)&&ft(this,ur).classList.add("focused"):(ft(this,ur).hidden=!1,ft(this,ur).style.zIndex=parseInt(ft(this,ur).style.zIndex)+1e3)},Ys=function(){ft(this,ur).classList.remove("focused"),!(ft(this,hr)||!this.isVisible)&&(ft(this,ur).hidden=!0,ft(this,ur).style.zIndex=parseInt(ft(this,ur).style.zIndex)-1e3)};class Pt extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Vt.data.textContent,this.textPosition=Vt.data.textPosition,this.annotationEditorType=a.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Vt=document.createElement("div");Vt.classList.add("annotationTextContent"),Vt.setAttribute("role","comment");for(const $t of this.textContent){const ar=document.createElement("span");ar.textContent=$t,Vt.append(ar)}this.container.append(Vt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}i.FreeTextAnnotationElement=Pt;class St extends lt{constructor($t){super($t,{isRenderable:!0,ignoreBorder:!0});cr(this,Kr,null)}render(){this.container.classList.add("lineAnnotation");const $t=this.data,{width:ar,height:xr}=it($t.rect),Er=this.svgFactory.create(ar,xr,!0),Pr=lr(this,Kr,this.svgFactory.createElement("svg:line"));return Pr.setAttribute("x1",$t.rect[2]-$t.lineCoordinates[0]),Pr.setAttribute("y1",$t.rect[3]-$t.lineCoordinates[1]),Pr.setAttribute("x2",$t.rect[2]-$t.lineCoordinates[2]),Pr.setAttribute("y2",$t.rect[3]-$t.lineCoordinates[3]),Pr.setAttribute("stroke-width",$t.borderStyle.width||1),Pr.setAttribute("stroke","transparent"),Pr.setAttribute("fill","transparent"),Er.append(Pr),this.container.append(Er),!$t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ft(this,Kr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kr=new WeakMap;class Ct extends lt{constructor($t){super($t,{isRenderable:!0,ignoreBorder:!0});cr(this,tn,null)}render(){this.container.classList.add("squareAnnotation");const $t=this.data,{width:ar,height:xr}=it($t.rect),Er=this.svgFactory.create(ar,xr,!0),Pr=$t.borderStyle.width,Lr=lr(this,tn,this.svgFactory.createElement("svg:rect"));return Lr.setAttribute("x",Pr/2),Lr.setAttribute("y",Pr/2),Lr.setAttribute("width",ar-Pr),Lr.setAttribute("height",xr-Pr),Lr.setAttribute("stroke-width",Pr||1),Lr.setAttribute("stroke","transparent"),Lr.setAttribute("fill","transparent"),Er.append(Lr),this.container.append(Er),!$t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ft(this,tn)}addHighlightArea(){this.container.classList.add("highlightArea")}}tn=new WeakMap;class Lt extends lt{constructor($t){super($t,{isRenderable:!0,ignoreBorder:!0});cr(this,nn,null)}render(){this.container.classList.add("circleAnnotation");const $t=this.data,{width:ar,height:xr}=it($t.rect),Er=this.svgFactory.create(ar,xr,!0),Pr=$t.borderStyle.width,Lr=lr(this,nn,this.svgFactory.createElement("svg:ellipse"));return Lr.setAttribute("cx",ar/2),Lr.setAttribute("cy",xr/2),Lr.setAttribute("rx",ar/2-Pr/2),Lr.setAttribute("ry",xr/2-Pr/2),Lr.setAttribute("stroke-width",Pr||1),Lr.setAttribute("stroke","transparent"),Lr.setAttribute("fill","transparent"),Er.append(Lr),this.container.append(Er),!$t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ft(this,nn)}addHighlightArea(){this.container.classList.add("highlightArea")}}nn=new WeakMap;class er extends lt{constructor($t){super($t,{isRenderable:!0,ignoreBorder:!0});cr(this,Or,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const $t=this.data,{width:ar,height:xr}=it($t.rect),Er=this.svgFactory.create(ar,xr,!0);let Pr=[];for(const Gr of $t.vertices){const Xr=Gr.x-$t.rect[0],Rt=$t.rect[3]-Gr.y;Pr.push(Xr+","+Rt)}Pr=Pr.join(" ");const Lr=lr(this,Or,this.svgFactory.createElement(this.svgElementName));return Lr.setAttribute("points",Pr),Lr.setAttribute("stroke-width",$t.borderStyle.width||1),Lr.setAttribute("stroke","transparent"),Lr.setAttribute("fill","transparent"),Er.append(Lr),this.container.append(Er),!$t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ft(this,Or)}addHighlightArea(){this.container.classList.add("highlightArea")}}Or=new WeakMap;class Kt extends er{constructor(Vt){super(Vt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class nr extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Jt extends lt{constructor($t){super($t,{isRenderable:!0,ignoreBorder:!0});cr(this,mr,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=a.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const $t=this.data,{width:ar,height:xr}=it($t.rect),Er=this.svgFactory.create(ar,xr,!0);for(const Pr of $t.inkLists){let Lr=[];for(const Xr of Pr){const Rt=Xr.x-$t.rect[0],zt=$t.rect[3]-Xr.y;Lr.push(`${Rt},${zt}`)}Lr=Lr.join(" ");const Gr=this.svgFactory.createElement(this.svgElementName);ft(this,mr).push(Gr),Gr.setAttribute("points",Lr),Gr.setAttribute("stroke-width",$t.borderStyle.width||1),Gr.setAttribute("stroke","transparent"),Gr.setAttribute("fill","transparent"),!$t.popupRef&&this.hasPopupData&&this._createPopup(),Er.append(Gr)}return this.container.append(Er),this.container}getElementsToTriggerPopup(){return ft(this,mr)}addHighlightArea(){this.container.classList.add("highlightArea")}}mr=new WeakMap,i.InkAnnotationElement=Jt;class qt extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class kt extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Xt extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class sr extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class At extends lt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}i.StampAnnotationElement=At;class ht extends lt{constructor($t){var Er;super($t,{isRenderable:!0});cr(this,Hr);cr(this,vr,null);const{filename:ar,content:xr}=this.data.file;this.filename=(0,c.getFilenameFromUrl)(ar,!0),this.content=xr,(Er=this.linkService.eventBus)==null||Er.dispatch("fileattachmentannotation",{source:this,filename:ar,content:xr})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:$t,data:ar}=this;let xr;ar.hasAppearance||ar.fillAlpha===0?xr=document.createElement("div"):(xr=document.createElement("img"),xr.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(ar.name)?"paperclip":"pushpin"}.svg`,ar.fillAlpha&&ar.fillAlpha<1&&(xr.style=`filter: opacity(${Math.round(ar.fillAlpha*100)}%);`)),xr.addEventListener("dblclick",or(this,Hr,qs).bind(this)),lr(this,vr,xr);const{isMac:Er}=a.FeatureTest.platform;return $t.addEventListener("keydown",Pr=>{Pr.key==="Enter"&&(Er?Pr.metaKey:Pr.ctrlKey)&&or(this,Hr,qs).call(this)}),!ar.popupRef&&this.hasPopupData?this._createPopup():xr.classList.add("popupTriggerArea"),$t.append(xr),$t}getElementsToTriggerPopup(){return ft(this,vr)}addHighlightArea(){this.container.classList.add("highlightArea")}}vr=new WeakMap,Hr=new WeakSet,qs=function(){var $t;($t=this.downloadManager)==null||$t.openOrDownloadData(this.container,this.content,this.filename)};class dt{constructor({div:Vt,accessibilityManager:$t,annotationCanvasMap:ar,l10n:xr,page:Er,viewport:Pr}){cr(this,Br);cr(this,Zr,null);cr(this,tr,null);cr(this,Rr,new Map);this.div=Vt,lr(this,Zr,$t),lr(this,tr,ar),this.l10n=xr,this.page=Er,this.viewport=Pr,this.zIndex=0,this.l10n||(this.l10n=g.NullL10n)}async render(Vt){const{annotations:$t}=Vt,ar=this.div;(0,c.setLayerDimensions)(ar,this.viewport);const xr=new Map,Er={data:null,layer:ar,linkService:Vt.linkService,downloadManager:Vt.downloadManager,imageResourcesPath:Vt.imageResourcesPath||"",renderForms:Vt.renderForms!==!1,svgFactory:new c.DOMSVGFactory,annotationStorage:Vt.annotationStorage||new d.AnnotationStorage,enableScripting:Vt.enableScripting===!0,hasJSActions:Vt.hasJSActions,fieldObjects:Vt.fieldObjects,parent:this,elements:null};for(const Pr of $t){if(Pr.noHTML)continue;const Lr=Pr.annotationType===a.AnnotationType.POPUP;if(Lr){const Rt=xr.get(Pr.id);if(!Rt)continue;Er.elements=Rt}else{const{width:Rt,height:zt}=it(Pr.rect);if(Rt<=0||zt<=0)continue}Er.data=Pr;const Gr=et.create(Er);if(!Gr.isRenderable)continue;if(!Lr&&Pr.popupRef){const Rt=xr.get(Pr.popupRef);Rt?Rt.push(Gr):xr.set(Pr.popupRef,[Gr])}Gr.annotationEditorType>0&&ft(this,Rr).set(Gr.data.id,Gr);const Xr=Gr.render();Pr.hidden&&(Xr.style.visibility="hidden"),or(this,Br,Co).call(this,Xr,Pr.id)}or(this,Br,Qs).call(this),await this.l10n.translate(ar)}update({viewport:Vt}){const $t=this.div;this.viewport=Vt,(0,c.setLayerDimensions)($t,{rotation:Vt.rotation}),or(this,Br,Qs).call(this),$t.hidden=!1}getEditableAnnotations(){return Array.from(ft(this,Rr).values())}getEditableAnnotation(Vt){return ft(this,Rr).get(Vt)}}Zr=new WeakMap,tr=new WeakMap,Rr=new WeakMap,Br=new WeakSet,Co=function(Vt,$t){var xr;const ar=Vt.firstChild||Vt;ar.id=`${a.AnnotationPrefix}${$t}`,this.div.append(Vt),(xr=ft(this,Zr))==null||xr.moveElementInDOM(this.div,Vt,ar,!1)},Qs=function(){if(!ft(this,tr))return;const Vt=this.div;for(const[$t,ar]of ft(this,tr)){const xr=Vt.querySelector(`[data-annotation-id="${$t}"]`);if(!xr)continue;const{firstChild:Er}=xr;Er?Er.nodeName==="CANVAS"?Er.replaceWith(ar):Er.before(ar):xr.append(ar)}ft(this,tr).clear()},i.AnnotationLayer=dt},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function s(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}function a(d){return Math.max(0,Math.min(255,255*d))}class c{static CMYK_G([h,g,_,b]){return["G",1-Math.min(1,.3*h+.59*_+.11*g+b)]}static G_CMYK([h]){return["CMYK",0,0,0,1-h]}static G_RGB([h]){return["RGB",h,h,h]}static G_rgb([h]){return h=a(h),[h,h,h]}static G_HTML([h]){const g=s(h);return`#${g}${g}${g}`}static RGB_G([h,g,_]){return["G",.3*h+.59*g+.11*_]}static RGB_rgb(h){return h.map(a)}static RGB_HTML(h){return`#${h.map(s).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([h,g,_,b]){return["RGB",1-Math.min(1,h+b),1-Math.min(1,_+b),1-Math.min(1,g+b)]}static CMYK_rgb([h,g,_,b]){return[a(1-Math.min(1,h+b)),a(1-Math.min(1,_+b)),a(1-Math.min(1,g+b))]}static CMYK_HTML(h){const g=this.CMYK_RGB(h).slice(1);return this.RGB_HTML(g)}static RGB_CMYK([h,g,_]){const b=1-h,_e=1-g,nt=1-_,it=Math.min(b,_e,nt);return["CMYK",b,_e,nt,it]}}i.ColorConverters=c},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NullL10n=void 0,i.getL10nFallback=a;const s={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};s.print_progress_percent="{{progress}}%";function a(h,g){switch(h){case"find_match_count":h=`find_match_count[${g.total===1?"one":"other"}]`;break;case"find_match_count_limit":h=`find_match_count_limit[${g.limit===1?"one":"other"}]`;break}return s[h]||""}function c(h,g){return g?h.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(_,b)=>b in g?g[b]:"{{"+b+"}}"):h}const d={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(h,g=null,_=a(h,g)){return c(_,g)},async translate(h){}};i.NullL10n=d},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var a=s(25);class c{static setupStorage(h,g,_,b,_e){const nt=b.getValue(g,{value:null});switch(_.name){case"textarea":if(nt.value!==null&&(h.textContent=nt.value),_e==="print")break;h.addEventListener("input",it=>{b.setValue(g,{value:it.target.value})});break;case"input":if(_.attributes.type==="radio"||_.attributes.type==="checkbox"){if(nt.value===_.attributes.xfaOn?h.setAttribute("checked",!0):nt.value===_.attributes.xfaOff&&h.removeAttribute("checked"),_e==="print")break;h.addEventListener("change",it=>{b.setValue(g,{value:it.target.checked?it.target.getAttribute("xfaOn"):it.target.getAttribute("xfaOff")})})}else{if(nt.value!==null&&h.setAttribute("value",nt.value),_e==="print")break;h.addEventListener("input",it=>{b.setValue(g,{value:it.target.value})})}break;case"select":if(nt.value!==null){h.setAttribute("value",nt.value);for(const it of _.children)it.attributes.value===nt.value?it.attributes.selected=!0:it.attributes.hasOwnProperty("selected")&&delete it.attributes.selected}h.addEventListener("input",it=>{const et=it.target.options,lt=et.selectedIndex===-1?"":et[et.selectedIndex].value;b.setValue(g,{value:lt})});break}}static setAttributes({html:h,element:g,storage:_=null,intent:b,linkService:_e}){const{attributes:nt}=g,it=h instanceof HTMLAnchorElement;nt.type==="radio"&&(nt.name=`${nt.name}-${b}`);for(const[et,lt]of Object.entries(nt))if(lt!=null)switch(et){case"class":lt.length&&h.setAttribute(et,lt.join(" "));break;case"dataId":break;case"id":h.setAttribute("data-element-id",lt);break;case"style":Object.assign(h.style,lt);break;case"textContent":h.textContent=lt;break;default:(!it||et!=="href"&&et!=="newWindow")&&h.setAttribute(et,lt)}it&&_e.addLinkAttributes(h,nt.href,nt.newWindow),_&&nt.dataId&&this.setupStorage(h,nt.dataId,g,_)}static render(h){var rt;const g=h.annotationStorage,_=h.linkService,b=h.xfaHtml,_e=h.intent||"display",nt=document.createElement(b.name);b.attributes&&this.setAttributes({html:nt,element:b,intent:_e,linkService:_});const it=[[b,-1,nt]],et=h.div;if(et.append(nt),h.viewport){const at=`matrix(${h.viewport.transform.join(",")})`;et.style.transform=at}_e!=="richText"&&et.setAttribute("class","xfaLayer xfaFont");const lt=[];for(;it.length>0;){const[at,ot,st]=it.at(-1);if(ot+1===at.children.length){it.pop();continue}const ct=at.children[++it.at(-1)[1]];if(ct===null)continue;const{name:mt}=ct;if(mt==="#text"){const Et=document.createTextNode(ct.value);lt.push(Et),st.append(Et);continue}const pt=(rt=ct==null?void 0:ct.attributes)!=null&&rt.xmlns?document.createElementNS(ct.attributes.xmlns,mt):document.createElement(mt);if(st.append(pt),ct.attributes&&this.setAttributes({html:pt,element:ct,storage:g,intent:_e,linkService:_}),ct.children&&ct.children.length>0)it.push([ct,-1,pt]);else if(ct.value){const Et=document.createTextNode(ct.value);a.XfaText.shouldBuildText(mt)&&lt.push(Et),pt.append(Et)}}for(const at of et.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))at.setAttribute("readOnly",!0);return{textDivs:lt}}static update(h){const g=`matrix(${h.viewport.transform.join(",")})`;h.div.style.transform=g,h.div.hidden=!1}}i.XfaLayer=c},(e,i,s)=>{var b,_e,nt,it,et,lt,rt,at,ot,st,ct,mt,pt,Et,ut,Ro,Po,ko,Fo,Js,Mo,Zs,Oo,Lo,Do,Io,No,Sn,na,vs,xs,Hn,ga,ws,It,Bo,_a,jo,Uo,xa,ys,Vn;Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0;var a=s(1),c=s(4),d=s(29),h=s(6),g=s(5);const Fr=class Fr extends c.AnnotationEditor{constructor(Bt){super({...Bt,name:"inkEditor"});cr(this,ut);cr(this,b,0);cr(this,_e,0);cr(this,nt,this.canvasPointermove.bind(this));cr(this,it,this.canvasPointerleave.bind(this));cr(this,et,this.canvasPointerup.bind(this));cr(this,lt,this.canvasPointerdown.bind(this));cr(this,rt,new Path2D);cr(this,at,!1);cr(this,ot,!1);cr(this,st,!1);cr(this,ct,null);cr(this,mt,0);cr(this,pt,0);cr(this,Et,null);this.color=Bt.color||null,this.thickness=Bt.thickness||null,this.opacity=Bt.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Bt){c.AnnotationEditor.initialize(Bt,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Bt,Qt){switch(Bt){case a.AnnotationEditorParamsType.INK_THICKNESS:Fr._defaultThickness=Qt;break;case a.AnnotationEditorParamsType.INK_COLOR:Fr._defaultColor=Qt;break;case a.AnnotationEditorParamsType.INK_OPACITY:Fr._defaultOpacity=Qt/100;break}}updateParams(Bt,Qt){switch(Bt){case a.AnnotationEditorParamsType.INK_THICKNESS:or(this,ut,Ro).call(this,Qt);break;case a.AnnotationEditorParamsType.INK_COLOR:or(this,ut,Po).call(this,Qt);break;case a.AnnotationEditorParamsType.INK_OPACITY:or(this,ut,ko).call(this,Qt);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,Fr._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,Fr._defaultColor||c.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(Fr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Fr._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||Fr._defaultColor||c.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Fr._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(or(this,ut,vs).call(this),or(this,ut,xs).call(this)),this.isAttachedToDOM||(this.parent.add(this),or(this,ut,Hn).call(this)),or(this,ut,Vn).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,ft(this,ct).disconnect(),lr(this,ct,null),super.remove())}setParent(Bt){!this.parent&&Bt?this._uiManager.removeShouldRescale(this):this.parent&&Bt===null&&this._uiManager.addShouldRescale(this),super.setParent(Bt)}onScaleChanging(){const[Bt,Qt]=this.parentDimensions,fr=this.width*Bt,hr=this.height*Qt;this.setDimensions(fr,hr)}enableEditMode(){ft(this,at)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",ft(this,lt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",ft(this,lt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){ft(this,at)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lr(this,at,!0),this.div.classList.add("disabled"),or(this,ut,Vn).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Bt){this._focusEventsAllowed&&(super.focusin(Bt),this.enableEditMode())}canvasPointerdown(Bt){Bt.button!==0||!this.isInEditMode()||ft(this,at)||(this.setInForeground(),Bt.preventDefault(),Bt.type!=="mouse"&&this.div.focus(),or(this,ut,Mo).call(this,Bt.offsetX,Bt.offsetY))}canvasPointermove(Bt){Bt.preventDefault(),or(this,ut,Zs).call(this,Bt.offsetX,Bt.offsetY)}canvasPointerup(Bt){Bt.preventDefault(),or(this,ut,na).call(this,Bt)}canvasPointerleave(Bt){or(this,ut,na).call(this,Bt)}get isResizable(){return!this.isEmpty()&&ft(this,at)}render(){if(this.div)return this.div;let Bt,Qt;this.width&&(Bt=this.x,Qt=this.y),super.render(),c.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(kr=>{var dr;return(dr=this.div)==null?void 0:dr.setAttribute("aria-label",kr)});const[fr,hr,Tr,Mr]=or(this,ut,Fo).call(this);if(this.setAt(fr,hr,0,0),this.setDims(Tr,Mr),or(this,ut,vs).call(this),this.width){const[kr,dr]=this.parentDimensions;this.setAspectRatio(this.width*kr,this.height*dr),this.setAt(Bt*kr,Qt*dr,this.width*kr,this.height*dr),lr(this,st,!0),or(this,ut,Hn).call(this),this.setDims(this.width*kr,this.height*dr),or(this,ut,Sn).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return or(this,ut,xs).call(this),this.div}setDimensions(Bt,Qt){const fr=Math.round(Bt),hr=Math.round(Qt);if(ft(this,mt)===fr&&ft(this,pt)===hr)return;lr(this,mt,fr),lr(this,pt,hr),this.canvas.style.visibility="hidden";const[Tr,Mr]=this.parentDimensions;this.width=Bt/Tr,this.height=Qt/Mr,this.fixAndSetPosition(),ft(this,at)&&or(this,ut,ga).call(this,Bt,Qt),or(this,ut,Hn).call(this),or(this,ut,Sn).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Bt,Qt,fr){var Kr,tn,nn;if(Bt instanceof d.InkAnnotationElement)return null;const hr=super.deserialize(Bt,Qt,fr);hr.thickness=Bt.thickness,hr.color=a.Util.makeHexColor(...Bt.color),hr.opacity=Bt.opacity;const[Tr,Mr]=hr.pageDimensions,kr=hr.width*Tr,dr=hr.height*Mr,Nr=hr.parentScale,Dr=Bt.thickness/2;lr(hr,at,!0),lr(hr,mt,Math.round(kr)),lr(hr,pt,Math.round(dr));const{paths:Jr,rect:Qr,rotation:en}=Bt;for(let{bezier:Or}of Jr){Or=or(Kr=Fr,It,jo).call(Kr,Or,Qr,en);const mr=[];hr.paths.push(mr);let vr=Nr*(Or[0]-Dr),Hr=Nr*(Or[1]-Dr);for(let Zr=2,tr=Or.length;Zr<tr;Zr+=6){const Rr=Nr*(Or[Zr]-Dr),Br=Nr*(Or[Zr+1]-Dr),zr=Nr*(Or[Zr+2]-Dr),Ir=Nr*(Or[Zr+3]-Dr),jr=Nr*(Or[Zr+4]-Dr),Vt=Nr*(Or[Zr+5]-Dr);mr.push([[vr,Hr],[Rr,Br],[zr,Ir],[jr,Vt]]),vr=jr,Hr=Vt}const rn=or(this,It,Bo).call(this,mr);hr.bezierPath2D.push(rn)}const Vr=or(tn=hr,ut,xa).call(tn);return lr(hr,_e,Math.max(c.AnnotationEditor.MIN_SIZE,Vr[2]-Vr[0])),lr(hr,b,Math.max(c.AnnotationEditor.MIN_SIZE,Vr[3]-Vr[1])),or(nn=hr,ut,ga).call(nn,kr,dr),hr}serialize(){if(this.isEmpty())return null;const Bt=this.getRect(0,0),Qt=c.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:Qt,thickness:this.thickness,opacity:this.opacity,paths:or(this,ut,Uo).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Bt),pageIndex:this.pageIndex,rect:Bt,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};b=new WeakMap,_e=new WeakMap,nt=new WeakMap,it=new WeakMap,et=new WeakMap,lt=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakMap,st=new WeakMap,ct=new WeakMap,mt=new WeakMap,pt=new WeakMap,Et=new WeakMap,ut=new WeakSet,Ro=function(Bt){const Qt=this.thickness;this.addCommands({cmd:()=>{this.thickness=Bt,or(this,ut,Vn).call(this)},undo:()=>{this.thickness=Qt,or(this,ut,Vn).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Po=function(Bt){const Qt=this.color;this.addCommands({cmd:()=>{this.color=Bt,or(this,ut,Sn).call(this)},undo:()=>{this.color=Qt,or(this,ut,Sn).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ko=function(Bt){Bt/=100;const Qt=this.opacity;this.addCommands({cmd:()=>{this.opacity=Bt,or(this,ut,Sn).call(this)},undo:()=>{this.opacity=Qt,or(this,ut,Sn).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Fo=function(){const{parentRotation:Bt,parentDimensions:[Qt,fr]}=this;switch(Bt){case 90:return[0,fr,fr,Qt];case 180:return[Qt,fr,Qt,fr];case 270:return[Qt,0,fr,Qt];default:return[0,0,Qt,fr]}},Js=function(){const{ctx:Bt,color:Qt,opacity:fr,thickness:hr,parentScale:Tr,scaleFactor:Mr}=this;Bt.lineWidth=hr*Tr/Mr,Bt.lineCap="round",Bt.lineJoin="round",Bt.miterLimit=10,Bt.strokeStyle=`${Qt}${(0,g.opacityToHex)(fr)}`},Mo=function(Bt,Qt){this.canvas.addEventListener("contextmenu",h.noContextMenu),this.canvas.addEventListener("pointerleave",ft(this,it)),this.canvas.addEventListener("pointermove",ft(this,nt)),this.canvas.addEventListener("pointerup",ft(this,et)),this.canvas.removeEventListener("pointerdown",ft(this,lt)),this.isEditing=!0,ft(this,st)||(lr(this,st,!0),or(this,ut,Hn).call(this),this.thickness||(this.thickness=Fr._defaultThickness),this.color||(this.color=Fr._defaultColor||c.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Fr._defaultOpacity)),this.currentPath.push([Bt,Qt]),lr(this,ot,!1),or(this,ut,Js).call(this),lr(this,Et,()=>{or(this,ut,Do).call(this),ft(this,Et)&&window.requestAnimationFrame(ft(this,Et))}),window.requestAnimationFrame(ft(this,Et))},Zs=function(Bt,Qt){const[fr,hr]=this.currentPath.at(-1);if(this.currentPath.length>1&&Bt===fr&&Qt===hr)return;const Tr=this.currentPath;let Mr=ft(this,rt);if(Tr.push([Bt,Qt]),lr(this,ot,!0),Tr.length<=2){Mr.moveTo(...Tr[0]),Mr.lineTo(Bt,Qt);return}Tr.length===3&&(lr(this,rt,Mr=new Path2D),Mr.moveTo(...Tr[0])),or(this,ut,Io).call(this,Mr,...Tr.at(-3),...Tr.at(-2),Bt,Qt)},Oo=function(){if(this.currentPath.length===0)return;const Bt=this.currentPath.at(-1);ft(this,rt).lineTo(...Bt)},Lo=function(Bt,Qt){lr(this,Et,null),Bt=Math.min(Math.max(Bt,0),this.canvas.width),Qt=Math.min(Math.max(Qt,0),this.canvas.height),or(this,ut,Zs).call(this,Bt,Qt),or(this,ut,Oo).call(this);let fr;if(this.currentPath.length!==1)fr=or(this,ut,No).call(this);else{const dr=[Bt,Qt];fr=[[dr,dr.slice(),dr.slice(),dr]]}const hr=ft(this,rt),Tr=this.currentPath;this.currentPath=[],lr(this,rt,new Path2D);const Mr=()=>{this.allRawPaths.push(Tr),this.paths.push(fr),this.bezierPath2D.push(hr),this.rebuild()},kr=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(or(this,ut,vs).call(this),or(this,ut,xs).call(this)),or(this,ut,Vn).call(this))};this.addCommands({cmd:Mr,undo:kr,mustExec:!0})},Do=function(){if(!ft(this,ot))return;lr(this,ot,!1);const Bt=Math.ceil(this.thickness*this.parentScale),Qt=this.currentPath.slice(-3),fr=Qt.map(Mr=>Mr[0]),hr=Qt.map(Mr=>Mr[1]);Math.min(...fr)-Bt,Math.max(...fr)+Bt,Math.min(...hr)-Bt,Math.max(...hr)+Bt;const{ctx:Tr}=this;Tr.save(),Tr.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Mr of this.bezierPath2D)Tr.stroke(Mr);Tr.stroke(ft(this,rt)),Tr.restore()},Io=function(Bt,Qt,fr,hr,Tr,Mr,kr){const dr=(Qt+hr)/2,Nr=(fr+Tr)/2,Dr=(hr+Mr)/2,Jr=(Tr+kr)/2;Bt.bezierCurveTo(dr+2*(hr-dr)/3,Nr+2*(Tr-Nr)/3,Dr+2*(hr-Dr)/3,Jr+2*(Tr-Jr)/3,Dr,Jr)},No=function(){const Bt=this.currentPath;if(Bt.length<=2)return[[Bt[0],Bt[0],Bt.at(-1),Bt.at(-1)]];const Qt=[];let fr,[hr,Tr]=Bt[0];for(fr=1;fr<Bt.length-2;fr++){const[Qr,en]=Bt[fr],[Vr,Kr]=Bt[fr+1],tn=(Qr+Vr)/2,nn=(en+Kr)/2,Or=[hr+2*(Qr-hr)/3,Tr+2*(en-Tr)/3],mr=[tn+2*(Qr-tn)/3,nn+2*(en-nn)/3];Qt.push([[hr,Tr],Or,mr,[tn,nn]]),[hr,Tr]=[tn,nn]}const[Mr,kr]=Bt[fr],[dr,Nr]=Bt[fr+1],Dr=[hr+2*(Mr-hr)/3,Tr+2*(kr-Tr)/3],Jr=[dr+2*(Mr-dr)/3,Nr+2*(kr-Nr)/3];return Qt.push([[hr,Tr],Dr,Jr,[dr,Nr]]),Qt},Sn=function(){if(this.isEmpty()){or(this,ut,ws).call(this);return}or(this,ut,Js).call(this);const{canvas:Bt,ctx:Qt}=this;Qt.setTransform(1,0,0,1,0,0),Qt.clearRect(0,0,Bt.width,Bt.height),or(this,ut,ws).call(this);for(const fr of this.bezierPath2D)Qt.stroke(fr)},na=function(Bt){this.canvas.removeEventListener("pointerleave",ft(this,it)),this.canvas.removeEventListener("pointermove",ft(this,nt)),this.canvas.removeEventListener("pointerup",ft(this,et)),this.canvas.addEventListener("pointerdown",ft(this,lt)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",h.noContextMenu)},10),or(this,ut,Lo).call(this,Bt.offsetX,Bt.offsetY),this.addToAnnotationStorage(),this.setInBackground()},vs=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",c.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Bt=>{var Qt;return(Qt=this.canvas)==null?void 0:Qt.setAttribute("aria-label",Bt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},xs=function(){lr(this,ct,new ResizeObserver(Bt=>{const Qt=Bt[0].contentRect;Qt.width&&Qt.height&&this.setDimensions(Qt.width,Qt.height)})),ft(this,ct).observe(this.div)},Hn=function(){if(!ft(this,st))return;const[Bt,Qt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Bt),this.canvas.height=Math.ceil(this.height*Qt),or(this,ut,ws).call(this)},ga=function(Bt,Qt){const fr=or(this,ut,ys).call(this),hr=(Bt-fr)/ft(this,_e),Tr=(Qt-fr)/ft(this,b);this.scaleFactor=Math.min(hr,Tr)},ws=function(){const Bt=or(this,ut,ys).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Bt,this.translationY*this.scaleFactor+Bt)},It=new WeakSet,Bo=function(Bt){const Qt=new Path2D;for(let fr=0,hr=Bt.length;fr<hr;fr++){const[Tr,Mr,kr,dr]=Bt[fr];fr===0&&Qt.moveTo(...Tr),Qt.bezierCurveTo(Mr[0],Mr[1],kr[0],kr[1],dr[0],dr[1])}return Qt},_a=function(Bt,Qt,fr){const[hr,Tr,Mr,kr]=Qt;switch(fr){case 0:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2)Bt[dr]+=hr,Bt[dr+1]=kr-Bt[dr+1];break;case 90:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2){const Dr=Bt[dr];Bt[dr]=Bt[dr+1]+hr,Bt[dr+1]=Dr+Tr}break;case 180:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2)Bt[dr]=Mr-Bt[dr],Bt[dr+1]+=Tr;break;case 270:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2){const Dr=Bt[dr];Bt[dr]=Mr-Bt[dr+1],Bt[dr+1]=kr-Dr}break;default:throw new Error("Invalid rotation")}return Bt},jo=function(Bt,Qt,fr){const[hr,Tr,Mr,kr]=Qt;switch(fr){case 0:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2)Bt[dr]-=hr,Bt[dr+1]=kr-Bt[dr+1];break;case 90:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2){const Dr=Bt[dr];Bt[dr]=Bt[dr+1]-Tr,Bt[dr+1]=Dr-hr}break;case 180:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2)Bt[dr]=Mr-Bt[dr],Bt[dr+1]-=Tr;break;case 270:for(let dr=0,Nr=Bt.length;dr<Nr;dr+=2){const Dr=Bt[dr];Bt[dr]=kr-Bt[dr+1],Bt[dr+1]=Mr-Dr}break;default:throw new Error("Invalid rotation")}return Bt},Uo=function(Bt,Qt,fr,hr){var Nr,Dr;const Tr=[],Mr=this.thickness/2,kr=Bt*Qt+Mr,dr=Bt*fr+Mr;for(const Jr of this.paths){const Qr=[],en=[];for(let Vr=0,Kr=Jr.length;Vr<Kr;Vr++){const[tn,nn,Or,mr]=Jr[Vr],vr=Bt*tn[0]+kr,Hr=Bt*tn[1]+dr,rn=Bt*nn[0]+kr,Zr=Bt*nn[1]+dr,tr=Bt*Or[0]+kr,Rr=Bt*Or[1]+dr,Br=Bt*mr[0]+kr,zr=Bt*mr[1]+dr;Vr===0&&(Qr.push(vr,Hr),en.push(vr,Hr)),Qr.push(rn,Zr,tr,Rr,Br,zr),en.push(rn,Zr),Vr===Kr-1&&en.push(Br,zr)}Tr.push({bezier:or(Nr=Fr,It,_a).call(Nr,Qr,hr,this.rotation),points:or(Dr=Fr,It,_a).call(Dr,en,hr,this.rotation)})}return Tr},xa=function(){let Bt=1/0,Qt=-1/0,fr=1/0,hr=-1/0;for(const Tr of this.paths)for(const[Mr,kr,dr,Nr]of Tr){const Dr=a.Util.bezierBoundingBox(...Mr,...kr,...dr,...Nr);Bt=Math.min(Bt,Dr[0]),fr=Math.min(fr,Dr[1]),Qt=Math.max(Qt,Dr[2]),hr=Math.max(hr,Dr[3])}return[Bt,fr,Qt,hr]},ys=function(){return ft(this,at)?Math.ceil(this.thickness*this.parentScale):0},Vn=function(Bt=!1){if(this.isEmpty())return;if(!ft(this,at)){or(this,ut,Sn).call(this);return}const Qt=or(this,ut,xa).call(this),fr=or(this,ut,ys).call(this);lr(this,_e,Math.max(c.AnnotationEditor.MIN_SIZE,Qt[2]-Qt[0])),lr(this,b,Math.max(c.AnnotationEditor.MIN_SIZE,Qt[3]-Qt[1]));const hr=Math.ceil(fr+ft(this,_e)*this.scaleFactor),Tr=Math.ceil(fr+ft(this,b)*this.scaleFactor),[Mr,kr]=this.parentDimensions;this.width=hr/Mr,this.height=Tr/kr,this.setAspectRatio(hr,Tr);const dr=this.translationX,Nr=this.translationY;this.translationX=-Qt[0],this.translationY=-Qt[1],or(this,ut,Hn).call(this),or(this,ut,Sn).call(this),lr(this,mt,hr),lr(this,pt,Tr),this.setDims(hr,Tr);const Dr=Bt?fr/this.scaleFactor/2:0;this.translate(dr-this.translationX-Dr,Nr-this.translationY-Dr)},cr(Fr,It),an(Fr,"_defaultColor",null),an(Fr,"_defaultOpacity",1),an(Fr,"_defaultThickness",1),an(Fr,"_type","ink");let _=Fr;i.InkEditor=_},(e,i,s)=>{var _,b,_e,nt,it,et,lt,rt,at,ot,st,as,os,Es,ba,$o,Wo,$a,Ss,Ho;Object.defineProperty(i,"__esModule",{value:!0}),i.StampEditor=void 0;var a=s(1),c=s(4),d=s(6),h=s(29);const Ct=class Ct extends c.AnnotationEditor{constructor(Kt){super({...Kt,name:"stampEditor"});cr(this,st);cr(this,_,null);cr(this,b,null);cr(this,_e,null);cr(this,nt,null);cr(this,it,null);cr(this,et,null);cr(this,lt,null);cr(this,rt,null);cr(this,at,!1);cr(this,ot,!1);lr(this,nt,Kt.bitmapUrl),lr(this,it,Kt.bitmapFile)}static initialize(Kt){c.AnnotationEditor.initialize(Kt)}static get supportedTypes(){const Kt=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,a.shadow)(this,"supportedTypes",Kt.map(nr=>`image/${nr}`))}static get supportedTypesStr(){return(0,a.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Kt){return this.supportedTypes.includes(Kt)}static paste(Kt,nr){nr.pasteEditor(a.AnnotationEditorType.STAMP,{bitmapFile:Kt.getAsFile()})}remove(){var Kt,nr;ft(this,b)&&(lr(this,_,null),this._uiManager.imageManager.deleteId(ft(this,b)),(Kt=ft(this,et))==null||Kt.remove(),lr(this,et,null),(nr=ft(this,lt))==null||nr.disconnect(),lr(this,lt,null)),super.remove()}rebuild(){if(!this.parent){ft(this,b)&&or(this,st,Es).call(this);return}super.rebuild(),this.div!==null&&(ft(this,b)&&or(this,st,Es).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(ft(this,_e)||ft(this,_)||ft(this,nt)||ft(this,it))}get isResizable(){return!0}render(){if(this.div)return this.div;let Kt,nr;if(this.width&&(Kt=this.x,nr=this.y),super.render(),this.div.hidden=!0,ft(this,_)?or(this,st,ba).call(this):or(this,st,Es).call(this),this.width){const[Jt,qt]=this.parentDimensions;this.setAt(Kt*Jt,nr*qt,this.width*Jt,this.height*qt)}return this.div}static deserialize(Kt,nr,Jt){if(Kt instanceof h.StampAnnotationElement)return null;const qt=super.deserialize(Kt,nr,Jt),{rect:kt,bitmapUrl:Xt,bitmapId:sr,isSvg:At,accessibilityData:ht}=Kt;sr&&Jt.imageManager.isValidId(sr)?lr(qt,b,sr):lr(qt,nt,Xt),lr(qt,at,At);const[dt,Tt]=qt.pageDimensions;return qt.width=(kt[2]-kt[0])/dt,qt.height=(kt[3]-kt[1])/Tt,ht&&(qt.altTextData=ht),qt}serialize(Kt=!1,nr=null){if(this.isEmpty())return null;const Jt={annotationType:a.AnnotationEditorType.STAMP,bitmapId:ft(this,b),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:ft(this,at),structTreeParentId:this._structTreeParentId};if(Kt)return Jt.bitmapUrl=or(this,st,Ss).call(this,!0),Jt.accessibilityData=this.altTextData,Jt;const{decorative:qt,altText:kt}=this.altTextData;if(!qt&&kt&&(Jt.accessibilityData={type:"Figure",alt:kt}),nr===null)return Jt;nr.stamps||(nr.stamps=new Map);const Xt=ft(this,at)?(Jt.rect[2]-Jt.rect[0])*(Jt.rect[3]-Jt.rect[1]):null;if(!nr.stamps.has(ft(this,b)))nr.stamps.set(ft(this,b),{area:Xt,serialized:Jt}),Jt.bitmap=or(this,st,Ss).call(this,!1);else if(ft(this,at)){const sr=nr.stamps.get(ft(this,b));Xt>sr.area&&(sr.area=Xt,sr.serialized.bitmap.close(),sr.serialized.bitmap=or(this,st,Ss).call(this,!1))}return Jt}};_=new WeakMap,b=new WeakMap,_e=new WeakMap,nt=new WeakMap,it=new WeakMap,et=new WeakMap,lt=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakMap,st=new WeakSet,as=function(Kt,nr=!1){if(!Kt){this.remove();return}lr(this,_,Kt.bitmap),nr||(lr(this,b,Kt.id),lr(this,at,Kt.isSvg)),or(this,st,ba).call(this)},os=function(){lr(this,_e,null),this._uiManager.enableWaiting(!1),ft(this,et)&&this.div.focus()},Es=function(){if(ft(this,b)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(ft(this,b)).then(nr=>or(this,st,as).call(this,nr,!0)).finally(()=>or(this,st,os).call(this));return}if(ft(this,nt)){const nr=ft(this,nt);lr(this,nt,null),this._uiManager.enableWaiting(!0),lr(this,_e,this._uiManager.imageManager.getFromUrl(nr).then(Jt=>or(this,st,as).call(this,Jt)).finally(()=>or(this,st,os).call(this)));return}if(ft(this,it)){const nr=ft(this,it);lr(this,it,null),this._uiManager.enableWaiting(!0),lr(this,_e,this._uiManager.imageManager.getFromFile(nr).then(Jt=>or(this,st,as).call(this,Jt)).finally(()=>or(this,st,os).call(this)));return}const Kt=document.createElement("input");Kt.type="file",Kt.accept=Ct.supportedTypesStr,lr(this,_e,new Promise(nr=>{Kt.addEventListener("change",async()=>{if(!Kt.files||Kt.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Jt=await this._uiManager.imageManager.getFromFile(Kt.files[0]);or(this,st,as).call(this,Jt)}nr()}),Kt.addEventListener("cancel",()=>{this.remove(),nr()})}).finally(()=>or(this,st,os).call(this))),Kt.click()},ba=function(){const{div:Kt}=this;let{width:nr,height:Jt}=ft(this,_);const[qt,kt]=this.pageDimensions,Xt=.75;if(this.width)nr=this.width*qt,Jt=this.height*kt;else if(nr>Xt*qt||Jt>Xt*kt){const dt=Math.min(Xt*qt/nr,Xt*kt/Jt);nr*=dt,Jt*=dt}const[sr,At]=this.parentDimensions;this.setDims(nr*sr/qt,Jt*At/kt),this._uiManager.enableWaiting(!1);const ht=lr(this,et,document.createElement("canvas"));Kt.append(ht),Kt.hidden=!1,or(this,st,$a).call(this,nr,Jt),or(this,st,Ho).call(this),ft(this,ot)||(this.parent.addUndoableEditor(this),lr(this,ot,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},$o=function(Kt,nr){var Xt;const[Jt,qt]=this.parentDimensions;this.width=Kt/Jt,this.height=nr/qt,this.setDims(Kt,nr),(Xt=this._initialOptions)!=null&&Xt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,ft(this,rt)!==null&&clearTimeout(ft(this,rt)),lr(this,rt,setTimeout(()=>{lr(this,rt,null),or(this,st,$a).call(this,Kt,nr)},200))},Wo=function(Kt,nr){const{width:Jt,height:qt}=ft(this,_);let kt=Jt,Xt=qt,sr=ft(this,_);for(;kt>2*Kt||Xt>2*nr;){const At=kt,ht=Xt;kt>2*Kt&&(kt=kt>=16384?Math.floor(kt/2)-1:Math.ceil(kt/2)),Xt>2*nr&&(Xt=Xt>=16384?Math.floor(Xt/2)-1:Math.ceil(Xt/2));const dt=new OffscreenCanvas(kt,Xt);dt.getContext("2d").drawImage(sr,0,0,At,ht,0,0,kt,Xt),sr=dt.transferToImageBitmap()}return sr},$a=function(Kt,nr){Kt=Math.ceil(Kt),nr=Math.ceil(nr);const Jt=ft(this,et);if(!Jt||Jt.width===Kt&&Jt.height===nr)return;Jt.width=Kt,Jt.height=nr;const qt=ft(this,at)?ft(this,_):or(this,st,Wo).call(this,Kt,nr),kt=Jt.getContext("2d");kt.filter=this._uiManager.hcmFilter,kt.drawImage(qt,0,0,qt.width,qt.height,0,0,Kt,nr)},Ss=function(Kt){if(Kt){if(ft(this,at)){const qt=this._uiManager.imageManager.getSvgUrl(ft(this,b));if(qt)return qt}const nr=document.createElement("canvas");return{width:nr.width,height:nr.height}=ft(this,_),nr.getContext("2d").drawImage(ft(this,_),0,0),nr.toDataURL()}if(ft(this,at)){const[nr,Jt]=this.pageDimensions,qt=Math.round(this.width*nr*d.PixelsPerInch.PDF_TO_CSS_UNITS),kt=Math.round(this.height*Jt*d.PixelsPerInch.PDF_TO_CSS_UNITS),Xt=new OffscreenCanvas(qt,kt);return Xt.getContext("2d").drawImage(ft(this,_),0,0,ft(this,_).width,ft(this,_).height,0,0,qt,kt),Xt.transferToImageBitmap()}return structuredClone(ft(this,_))},Ho=function(){lr(this,lt,new ResizeObserver(Kt=>{const nr=Kt[0].contentRect;nr.width&&nr.height&&or(this,st,$o).call(this,nr.width,nr.height)})),ft(this,lt).observe(this.div)},an(Ct,"_type","stamp");let g=Ct;i.StampEditor=g}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var i=__webpack_module_cache__[e];if(i!==void 0)return i.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__w_pdfjs_require__),s.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return d.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return h.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return g.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return a.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return _.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return i.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return i.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return s.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return b.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return s.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return s.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return a.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return i.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return c.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return c.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.version}});var i=__w_pdfjs_require__(1),s=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),c=__w_pdfjs_require__(26),d=__w_pdfjs_require__(27),h=__w_pdfjs_require__(5),g=__w_pdfjs_require__(29),_=__w_pdfjs_require__(14),b=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";const extractCTeData=async e=>{const i=await e.arrayBuffer(),s=await pdfExports.getDocument({data:i}).promise;let a="";for(let c=1;c<=s.numPages;c++){const g=(await(await s.getPage(c)).getTextContent()).items.map(_=>_.str).join(" ");a+=g+`
`}return a=a.replace(/\s+/g," ").trim(),parseText(a)},parseText=e=>{const i={dataEmissao:"",numeroCTe:"",serie:"",chaveAcesso:"",transportadora:"",cnpjTransportadora:"",remetente:"",cnpjRemetente:"",cidadeOrigem:"",ufOrigem:"",destinatario:"",cnpjDestinatario:"",cidadeDestino:"",ufDestino:"",produto:"",peso:"",quantidadeVolumes:"",valorTotalCarga:"",valorFrete:"",valorICMS:"",nfe:"",placaVeiculo:""},s=e.match(/(\d{2}\/\d{2}\/\d{4})\s*[-]\s*\d{2}:\d{2}/);if(s)i.dataEmissao=s[1];else{const st=e.match(/(\d{2}\/\d{2}\/\d{4})/);st&&(i.dataEmissao=st[1])}const a=e.match(/N[o]?\s*DOCUMENTO\s+CT-?E\s+S[E]RIE[:\s]*(\d+)\s+(\d+)/i);if(a)i.numeroCTe=a[1],i.serie=a[2];else{const st=e.match(/N[U]MERO\s*[:\s]*(\d+)/i);if(st)i.numeroCTe=st[1];else{const mt=e.match(/CT-?e\s*n[o]?\s*[:\s]*(\d+)/i);mt&&(i.numeroCTe=mt[1])}const ct=e.match(/S[E]RIE[:\s]*(\d+)/i);ct&&(i.serie=ct[1])}const c=e.match(/(\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4}\s*\d{4})/);c&&(i.chaveAcesso=c[1].replace(/\s/g,""));const d=e.match(/EMITENTE[^A-Z-]*([A-Z-][A-Z-\s]+(?:LTDA|LTDA\.|S\.?A\.?|EIRELI|ME|EPP|TRANSPORTES?))/i);if(d){i.transportadora=d[1].trim();const st=e.substring(d.index).match(/CNPJ[:\s]*(\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2})/);st&&(i.cnpjTransportadora=st[1].replace(/[.\/\-]/g,""))}else{const st=e.match(/([A-Z-][A-Z-\s]+(?:TRANSPORTES?|LOG[I]STICA)[A-Z-\s]*(?:LTDA|LTDA\.|S\.?A\.?))/i);if(st){i.transportadora=st[1].trim();const ct=e.substring(st.index).match(/CNPJ[:\s]*(\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2})/);ct&&(i.cnpjTransportadora=ct[1].replace(/[.\/\-]/g,""))}}if(!i.cnpjTransportadora){const st=e.match(/CNPJ[:\s]*(\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2})/i);st&&(i.cnpjTransportadora=st[1].replace(/[.\/\-]/g,""))}const h=e.match(/REMETENTE[^A-Z-]*([A-Z-][A-Z-\s]+(?:LTDA|S\.?A\.?|EIRELI|IND[U]STRIA|COM[E]RCIO))/i);h&&(i.remetente=h[1].trim());const g=e.match(/REMETENTE[^0-9]*?CNPJ[:\s]*(\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2})/is);g&&(i.cnpjRemetente=g[1].replace(/[.\/-]/g,""));const _=e.match(/([A-Z-][A-Z-\s]+?)\s*-\s*([A-Z]{2})\s+([A-Z-][A-Z-\s]+?)\s*-\s*([A-Z]{2})/);if(_)i.cidadeOrigem=_[1].trim(),i.ufOrigem=_[2],i.cidadeDestino=_[3].trim(),i.ufDestino=_[4];else{const st=e.match(/MUNIC[I]PIO[:\s]*([A-Z-][A-Z-\s]+?)(?:\s*[-]\s*|\s+)([A-Z]{2})\s/i);st&&(i.cidadeOrigem=st[1].trim(),i.ufOrigem=st[2]);const ct=e.match(/DESTINO[:\s]*([A-Z-][A-Z-\s]+?)(?:\s*[-]\s*|\s+)([A-Z]{2})/i);ct&&(i.cidadeDestino=ct[1].trim(),i.ufDestino=ct[2])}const b=e.match(/DESTINAT[A]RIO[^A-Z-]*([A-Z-][A-Z-\s]+(?:LTDA|S\.?A\.?|EIRELI))/i);b&&(i.destinatario=b[1].trim());const _e=e.match(/DESTINAT[A]RIO[^0-9]*?CNPJ[:\s]*(\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2})/is);_e&&(i.cnpjDestinatario=_e[1].replace(/[.\/-]/g,""));const nt=e.match(/PRODUTO\s+PREDOMINANTE[:\s]*([A-Z-][A-Z-\s\-\d,\.]+?)(?=\s+(?:PESO|QNT|QUANTIDADE|VALOR|COMPONENTES))/i);if(nt)i.produto=nt[1].trim();else{const st=e.match(/PRODUTO\s+PREDOMINANTE[:\s]*([A-Z-][A-Z-\s\-\d,\.]{5,50})/i);st&&(i.produto=st[1].trim())}const it=e.match(/PESO\s*(?:BRUTO|TOTAL)?[:\s]*(\d{1,3}(?:[.,]\d{3})*[.,]\d+|\d+)\s*(?:KG)?/i);if(it){let st=it[1];st.includes(".")&&st.includes(",")?st=st.replace(/\./g,"").replace(",","."):st.includes(",")&&(st=st.replace(",",".")),i.peso=st}else{const st=e.match(/QNT\.?\s*(\d{1,3}(?:[.,]\d{3})*[.,]\d+|\d+)/i);if(st){let ct=st[1];ct.includes(".")&&ct.includes(",")?ct=ct.replace(/\./g,"").replace(",","."):ct.includes(",")&&(ct=ct.replace(",",".")),i.peso=ct}}const et=e.match(/QUANTIDADE\s+(?:DE\s+)?VOLUMES[:\s]*(\d+)[.,]?(\d+)?/i);et&&(i.quantidadeVolumes=et[1]);const lt=e.match(/VALOR\s+TOTAL\s+(?:DA\s+)?CARGA[:\s]*R?\$?\s*(\d+[.\d]*,\d{2})/i);lt&&(i.valorTotalCarga=lt[1].replace(/\./g,"").replace(",","."));const rt=e.match(/VALOR\s+TOTAL\s+(?:DA\s+)?PRESTA[C][A]O[:\s]*R?\$?\s*(\d+[.\d]*,\d{2})/i);rt&&(i.valorFrete=rt[1].replace(/\./g,"").replace(",","."));const at=e.match(/VALOR\s+(?:DO\s+)?ICMS[:\s]*R?\$?\s*(\d+[.\d]*,\d{2})/i);at&&(i.valorICMS=at[1].replace(/\./g,"").replace(",","."));const ot=e.match(/NF-?e?[:\s]*(\d{3})\s*\/\s*(\d+)/i);if(ot)i.nfe=`${ot[1]}/${ot[2]}`;else{const st=e.match(/S[E]RIE\s*\/\s*N[o]?\s*DOCUMENTO[^0-9]*(\d{3})\s*\/\s*(\d+)/i);if(st)i.nfe=`${st[1]}/${st[2]}`;else{const ct=e.match(/NOTA\s+FISCAL[:\s]*(\d+)/i);ct&&(i.nfe=ct[1])}}return i},countExtractedFields=e=>Object.entries(e).filter(([i,s])=>i!=="placaVeiculo"&&s!=="").length,getMissingFields=e=>{const i={dataEmissao:"Data de Emisso",numeroCTe:"Nmero do CT-e",serie:"Srie",chaveAcesso:"Chave de Acesso",transportadora:"Transportadora",cnpjTransportadora:"CNPJ Transportadora",remetente:"Remetente",cnpjRemetente:"CNPJ Remetente",cidadeOrigem:"Cidade de Origem",ufOrigem:"UF de Origem",destinatario:"Destinatrio",cnpjDestinatario:"CNPJ Destinatrio",cidadeDestino:"Cidade de Destino",ufDestino:"UF de Destino",produto:"Produto",peso:"Peso",quantidadeVolumes:"Volumes",valorTotalCarga:"Valor da Carga",valorFrete:"Valor do Frete",valorICMS:"Valor ICMS",nfe:"NF-e"};return Object.entries(e).filter(([s,a])=>s!=="placaVeiculo"&&a==="").map(([s])=>i[s]||s)};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}var _getchar=function e(i){return String.fromCharCode(i)},_getansi=function e(i){return String.fromCharCode(i)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var i="",s=0,a=0,c=0,d=0,h=0,g=0,_=0,b=0;b<e.length;)s=e.charCodeAt(b++),d=s>>2,a=e.charCodeAt(b++),h=(s&3)<<4|a>>4,c=e.charCodeAt(b++),g=(a&15)<<2|c>>6,_=c&63,isNaN(a)?g=_=64:isNaN(c)&&(_=64),i+=Base64_map.charAt(d)+Base64_map.charAt(h)+Base64_map.charAt(g)+Base64_map.charAt(_);return i}function Base64_decode(e){var i="",s=0,a=0,c=0,d=0,h=0,g=0,_=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var b=0;b<e.length;)d=Base64_map.indexOf(e.charAt(b++)),h=Base64_map.indexOf(e.charAt(b++)),s=d<<2|h>>4,i+=String.fromCharCode(s),g=Base64_map.indexOf(e.charAt(b++)),a=(h&15)<<4|g>>2,g!==64&&(i+=String.fromCharCode(a)),_=Base64_map.indexOf(e.charAt(b++)),c=(g&3)<<6|_,_!==64&&(i+=String.fromCharCode(c));return i}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(i,s){return s?new Buffer(i,s):new Buffer(i)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function e(i){return has_buf?Buffer_from(i,"binary"):i.split("").map(function(s){return s.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var i=new ArrayBuffer(e.length),s=new Uint8Array(i),a=0;a!=e.length;++a)s[a]=e.charCodeAt(a)&255;return i}function a2s(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var i=[],s=0;s<e.length;++s)i[s]=String.fromCharCode(e[s]);return i.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(i){return Buffer.isBuffer(i)?i:Buffer_from(i)}))}:function(e){if(typeof Uint8Array<"u"){var i=0,s=0;for(i=0;i<e.length;++i)s+=e[i].length;var a=new Uint8Array(s),c=0;for(i=0,s=0;i<e.length;s+=c,++i)if(c=e[i].length,e[i]instanceof Uint8Array)a.set(e[i],s);else{if(typeof e[i]=="string")throw"wtf";a.set(new Uint8Array(e[i]),s)}return a}return[].concat.apply([],e.map(function(d){return Array.isArray(d)?d:[].slice.call(d)}))};function utf8decode(e){for(var i=[],s=0,a=e.length+250,c=new_raw_buf(e.length+255),d=0;d<e.length;++d){var h=e.charCodeAt(d);if(h<128)c[s++]=h;else if(h<2048)c[s++]=192|h>>6&31,c[s++]=128|h&63;else if(h>=55296&&h<57344){h=(h&1023)+64;var g=e.charCodeAt(++d)&1023;c[s++]=240|h>>8&7,c[s++]=128|h>>2&63,c[s++]=128|g>>6&15|(h&3)<<4,c[s++]=128|g&63}else c[s++]=224|h>>12&15,c[s++]=128|h>>6&63,c[s++]=128|h&63;s>a&&(i.push(c.slice(0,s)),s=0,c=new_raw_buf(65535),a=65530)}return i.push(c.slice(0,s)),bconcat(i)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var i="",s=e.length-1;s>=0;)i+=e.charAt(s--);return i}function pad0(e,i){var s=""+e;return s.length>=i?s:fill("0",i-s.length)+s}function pad_(e,i){var s=""+e;return s.length>=i?s:fill(" ",i-s.length)+s}function rpad_(e,i){var s=""+e;return s.length>=i?s:s+fill(" ",i-s.length)}function pad0r1(e,i){var s=""+Math.round(e);return s.length>=i?s:fill("0",i-s.length)+s}function pad0r2(e,i){var s=""+e;return s.length>=i?s:fill("0",i-s.length)+s}var p2_32=Math.pow(2,32);function pad0r(e,i){if(e>p2_32||e<-p2_32)return pad0r1(e,i);var s=Math.round(e);return pad0r2(s,i)}function SSF_isgeneral(e,i){return i=i||0,e.length>=7+i&&(e.charCodeAt(i)|32)===103&&(e.charCodeAt(i+1)|32)===101&&(e.charCodeAt(i+2)|32)===110&&(e.charCodeAt(i+3)|32)===101&&(e.charCodeAt(i+4)|32)===114&&(e.charCodeAt(i+5)|32)===97&&(e.charCodeAt(i+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,i,s){for(var a=e<0?-1:1,c=e*a,d=0,h=1,g=0,_=1,b=0,_e=0,nt=Math.floor(c);b<i&&(nt=Math.floor(c),g=nt*h+d,_e=nt*b+_,!(c-nt<5e-8));)c=1/(c-nt),d=h,h=g,_=b,b=_e;if(_e>i&&(b>i?(_e=_,g=d):(_e=b,g=h)),!s)return[0,a*g,_e];var it=Math.floor(a*g/_e);return[it,a*g-it*_e,_e]}function SSF_parse_date_code(e,i,s){if(e>2958465||e<0)return null;var a=e|0,c=Math.floor(86400*(e-a)),d=0,h=[],g={D:a,T:c,u:86400*(e-a)-c,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(g.u)<1e-6&&(g.u=0),i&&i.date1904&&(a+=1462),g.u>.9999&&(g.u=0,++c==86400&&(g.T=c=0,++a,++g.D)),a===60)h=s?[1317,10,29]:[1900,2,29],d=3;else if(a===0)h=s?[1317,8,29]:[1900,1,0],d=6;else{a>60&&--a;var _=new Date(1900,0,1);_.setDate(_.getDate()+a-1),h=[_.getFullYear(),_.getMonth()+1,_.getDate()],d=_.getDay(),a<60&&(d=(d+6)%7),s&&(d=SSF_fix_hijri(_,h))}return g.y=h[0],g.m=h[1],g.d=h[2],g.S=c%60,c=Math.floor(c/60),g.M=c%60,c=Math.floor(c/60),g.H=c,g.q=d,g}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,i){var s=e.getTime();return i?s-=1461*24*60*60*1e3:e>=SSFbase1904&&(s+=24*60*60*1e3),(s-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var i=e<0?12:11,s=SSF_strip_decimal(e.toFixed(12));return s.length<=i||(s=e.toPrecision(10),s.length<=i)?s:e.toExponential(5)}function SSF_large_exp(e){var i=SSF_strip_decimal(e.toFixed(11));return i.length>(e<0?12:11)||i==="0"||i==="-0"?e.toPrecision(6):i}function SSF_general_num(e){var i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),s;return i>=-4&&i<=-1?s=e.toPrecision(10+i):Math.abs(i)<=9?s=SSF_small_exp(e):i===10?s=e.toFixed(10).substr(0,12):s=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(s.toUpperCase()))}function SSF_general(e,i){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,i){i[0]-=581;var s=e.getDay();return e<60&&(s=(s+6)%7),s}function SSF_write_date(e,i,s,a){var c="",d=0,h=0,g=s.y,_,b=0;switch(e){case 98:g=s.y+543;case 121:switch(i.length){case 1:case 2:_=g%100,b=2;break;default:_=g%1e4,b=4;break}break;case 109:switch(i.length){case 1:case 2:_=s.m,b=i.length;break;case 3:return months[s.m-1][1];case 5:return months[s.m-1][0];default:return months[s.m-1][2]}break;case 100:switch(i.length){case 1:case 2:_=s.d,b=i.length;break;case 3:return days[s.q][0];default:return days[s.q][1]}break;case 104:switch(i.length){case 1:case 2:_=1+(s.H+11)%12,b=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:_=s.H,b=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:_=s.M,b=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return s.u===0&&(i=="s"||i=="ss")?pad0(s.S,i.length):(a>=2?h=a===3?1e3:100:h=a===1?10:1,d=Math.round(h*(s.S+s.u)),d>=60*h&&(d=0),i==="s"?d===0?"0":""+d/h:(c=pad0(d,2+a),i==="ss"?c.substr(0,2):"."+c.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":_=s.D*24+s.H;break;case"[m]":case"[mm]":_=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":_=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+i}b=i.length===3?1:2;break;case 101:_=g,b=1;break}var _e=b>0?pad0(_,b):"";return _e}function commaify(e){var i=3;if(e.length<=i)return e;for(var s=e.length%i,a=e.substr(0,s);s!=e.length;s+=i)a+=(a.length>0?",":"")+e.substr(s,i);return a}var pct1=/%/g;function write_num_pct(e,i,s){var a=i.replace(pct1,""),c=i.length-a.length;return write_num(e,a,s*Math.pow(10,2*c))+fill("%",c)}function write_num_cm(e,i,s){for(var a=i.length-1;i.charCodeAt(a-1)===44;)--a;return write_num(e,i.substr(0,a),s/Math.pow(10,3*(i.length-a)))}function write_num_exp(e,i){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+write_num_exp(e,-i);var c=e.indexOf(".");c===-1&&(c=e.indexOf("E"));var d=Math.floor(Math.log(i)*Math.LOG10E)%c;if(d<0&&(d+=c),s=(i/Math.pow(10,d)).toPrecision(a+1+(c+d)%c),s.indexOf("e")===-1){var h=Math.floor(Math.log(i)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(h-s.length+d):s+="E+"+(h-d);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,c)+"."+s.substr(2+c),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(g,_,b,_e){return _+b+_e.substr(0,(c+d)%c)+"."+_e.substr(d)+"E"})}else s=i.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,i,s){var a=parseInt(e[4],10),c=Math.round(i*a),d=Math.floor(c/a),h=c-d*a,g=a;return s+(d===0?"":""+d)+" "+(h===0?fill(" ",e[1].length+1+e[4].length):pad_(h,e[1].length)+e[2]+"/"+e[3]+pad0(g,e[4].length))}function write_num_f2(e,i,s){return s+(i===0?"":""+i)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var i="",s,a=0;a!=e.length;++a)switch(s=e.charCodeAt(a)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(s)}return i}function rnd(e,i){var s=Math.pow(10,i);return""+Math.round(e*s)/s}function dec(e,i){var s=e-Math.floor(e),a=Math.pow(10,i);return i<(""+Math.round(s*a)).length?0:Math.round(s*a)}function carry(e,i){return i<(""+Math.round((e-Math.floor(e))*Math.pow(10,i))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,i,s){if(e.charCodeAt(0)===40&&!i.match(closeparen)){var a=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?write_num_flt("n",a,s):"("+write_num_flt("n",a,-s)+")"}if(i.charCodeAt(i.length-1)===44)return write_num_cm(e,i,s);if(i.indexOf("%")!==-1)return write_num_pct(e,i,s);if(i.indexOf("E")!==-1)return write_num_exp(i,s);if(i.charCodeAt(0)===36)return"$"+write_num_flt(e,i.substr(i.charAt(1)==" "?2:1),s);var c,d,h,g,_=Math.abs(s),b=s<0?"-":"";if(i.match(/^00+$/))return b+pad0r(_,i.length);if(i.match(/^[#?]+$/))return c=pad0r(s,0),c==="0"&&(c=""),c.length>i.length?c:hashq(i.substr(0,i.length-c.length))+c;if(d=i.match(frac1))return write_num_f1(d,_,b);if(i.match(/^#+0+$/))return b+pad0r(_,i.length-i.indexOf("0"));if(d=i.match(dec1))return c=rnd(s,d[1].length).replace(/^([^\.]+)$/,"$1."+hashq(d[1])).replace(/\.$/,"."+hashq(d[1])).replace(/\.(\d*)$/,function(lt,rt){return"."+rt+fill("0",hashq(d[1]).length-rt.length)}),i.indexOf("0.")!==-1?c:c.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),d=i.match(/^(0*)\.(#*)$/))return b+rnd(_,d[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=i.match(/^#{1,3},##0(\.?)$/))return b+commaify(pad0r(_,0));if(d=i.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+write_num_flt(e,i,-s):commaify(""+(Math.floor(s)+carry(s,d[1].length)))+"."+pad0(dec(s,d[1].length),d[1].length);if(d=i.match(/^#,#*,#0/))return write_num_flt(e,i.replace(/^#,#*,/,""),s);if(d=i.match(/^([0#]+)(\\?-([0#]+))+$/))return c=_strrev(write_num_flt(e,i.replace(/[\\-]/g,""),s)),h=0,_strrev(_strrev(i.replace(/\\/g,"")).replace(/[0#]/g,function(lt){return h<c.length?c.charAt(h++):lt==="0"?"0":""}));if(i.match(phone))return c=write_num_flt(e,"##########",s),"("+c.substr(0,3)+") "+c.substr(3,3)+"-"+c.substr(6);var _e="";if(d=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(d[4].length,7),g=SSF_frac(_,Math.pow(10,h)-1,!1),c=""+b,_e=write_num("n",d[1],g[1]),_e.charAt(_e.length-1)==" "&&(_e=_e.substr(0,_e.length-1)+"0"),c+=_e+d[2]+"/"+d[3],_e=rpad_(g[2],h),_e.length<d[4].length&&(_e=hashq(d[4].substr(d[4].length-_e.length))+_e),c+=_e,c;if(d=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(d[1].length,d[4].length),7),g=SSF_frac(_,Math.pow(10,h)-1,!0),b+(g[0]||(g[1]?"":"0"))+" "+(g[1]?pad_(g[1],h)+d[2]+"/"+d[3]+rpad_(g[2],h):fill(" ",2*h+1+d[2].length+d[3].length));if(d=i.match(/^[#0?]+$/))return c=pad0r(s,0),i.length<=c.length?c:hashq(i.substr(0,i.length-c.length))+c;if(d=i.match(/^([#0?]+)\.([#0]+)$/)){c=""+s.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),h=c.indexOf(".");var nt=i.indexOf(".")-h,it=i.length-c.length-nt;return hashq(i.substr(0,nt)+c+i.substr(i.length-it))}if(d=i.match(/^00,000\.([#0]*0)$/))return h=dec(s,d[1].length),s<0?"-"+write_num_flt(e,i,-s):commaify(flr(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(lt){return"00,"+(lt.length<3?pad0(0,3-lt.length):"")+lt})+"."+pad0(h,d[1].length);switch(i){case"###,##0.00":return write_num_flt(e,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var et=commaify(pad0r(_,0));return et!=="0"?b+et:"";case"###,###.00":return write_num_flt(e,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+i+"|")}function write_num_cm2(e,i,s){for(var a=i.length-1;i.charCodeAt(a-1)===44;)--a;return write_num(e,i.substr(0,a),s/Math.pow(10,3*(i.length-a)))}function write_num_pct2(e,i,s){var a=i.replace(pct1,""),c=i.length-a.length;return write_num(e,a,s*Math.pow(10,2*c))+fill("%",c)}function write_num_exp2(e,i){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+write_num_exp2(e,-i);var c=e.indexOf(".");c===-1&&(c=e.indexOf("E"));var d=Math.floor(Math.log(i)*Math.LOG10E)%c;if(d<0&&(d+=c),s=(i/Math.pow(10,d)).toPrecision(a+1+(c+d)%c),!s.match(/[Ee]/)){var h=Math.floor(Math.log(i)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(h-s.length+d):s+="E+"+(h-d),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(g,_,b,_e){return _+b+_e.substr(0,(c+d)%c)+"."+_e.substr(d)+"E"})}else s=i.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function write_num_int(e,i,s){if(e.charCodeAt(0)===40&&!i.match(closeparen)){var a=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?write_num_int("n",a,s):"("+write_num_int("n",a,-s)+")"}if(i.charCodeAt(i.length-1)===44)return write_num_cm2(e,i,s);if(i.indexOf("%")!==-1)return write_num_pct2(e,i,s);if(i.indexOf("E")!==-1)return write_num_exp2(i,s);if(i.charCodeAt(0)===36)return"$"+write_num_int(e,i.substr(i.charAt(1)==" "?2:1),s);var c,d,h,g,_=Math.abs(s),b=s<0?"-":"";if(i.match(/^00+$/))return b+pad0(_,i.length);if(i.match(/^[#?]+$/))return c=""+s,s===0&&(c=""),c.length>i.length?c:hashq(i.substr(0,i.length-c.length))+c;if(d=i.match(frac1))return write_num_f2(d,_,b);if(i.match(/^#+0+$/))return b+pad0(_,i.length-i.indexOf("0"));if(d=i.match(dec1))return c=(""+s).replace(/^([^\.]+)$/,"$1."+hashq(d[1])).replace(/\.$/,"."+hashq(d[1])),c=c.replace(/\.(\d*)$/,function(lt,rt){return"."+rt+fill("0",hashq(d[1]).length-rt.length)}),i.indexOf("0.")!==-1?c:c.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),d=i.match(/^(0*)\.(#*)$/))return b+(""+_).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=i.match(/^#{1,3},##0(\.?)$/))return b+commaify(""+_);if(d=i.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+write_num_int(e,i,-s):commaify(""+s)+"."+fill("0",d[1].length);if(d=i.match(/^#,#*,#0/))return write_num_int(e,i.replace(/^#,#*,/,""),s);if(d=i.match(/^([0#]+)(\\?-([0#]+))+$/))return c=_strrev(write_num_int(e,i.replace(/[\\-]/g,""),s)),h=0,_strrev(_strrev(i.replace(/\\/g,"")).replace(/[0#]/g,function(lt){return h<c.length?c.charAt(h++):lt==="0"?"0":""}));if(i.match(phone))return c=write_num_int(e,"##########",s),"("+c.substr(0,3)+") "+c.substr(3,3)+"-"+c.substr(6);var _e="";if(d=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(d[4].length,7),g=SSF_frac(_,Math.pow(10,h)-1,!1),c=""+b,_e=write_num("n",d[1],g[1]),_e.charAt(_e.length-1)==" "&&(_e=_e.substr(0,_e.length-1)+"0"),c+=_e+d[2]+"/"+d[3],_e=rpad_(g[2],h),_e.length<d[4].length&&(_e=hashq(d[4].substr(d[4].length-_e.length))+_e),c+=_e,c;if(d=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(d[1].length,d[4].length),7),g=SSF_frac(_,Math.pow(10,h)-1,!0),b+(g[0]||(g[1]?"":"0"))+" "+(g[1]?pad_(g[1],h)+d[2]+"/"+d[3]+rpad_(g[2],h):fill(" ",2*h+1+d[2].length+d[3].length));if(d=i.match(/^[#0?]+$/))return c=""+s,i.length<=c.length?c:hashq(i.substr(0,i.length-c.length))+c;if(d=i.match(/^([#0]+)\.([#0]+)$/)){c=""+s.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),h=c.indexOf(".");var nt=i.indexOf(".")-h,it=i.length-c.length-nt;return hashq(i.substr(0,nt)+c+i.substr(i.length-it))}if(d=i.match(/^00,000\.([#0]*0)$/))return s<0?"-"+write_num_int(e,i,-s):commaify(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(lt){return"00,"+(lt.length<3?pad0(0,3-lt.length):"")+lt})+"."+pad0(0,d[1].length);switch(i){case"###,###":case"##,###":case"#,###":var et=commaify(""+_);return et!=="0"?b+et:"";default:if(i.match(/\.[0#?]*$/))return write_num_int(e,i.slice(0,i.lastIndexOf(".")),s)+hashq(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}function write_num(e,i,s){return(s|0)===s?write_num_int(e,i,s):write_num_flt(e,i,s)}function SSF_split_fmt(e){for(var i=[],s=!1,a=0,c=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:s=!s;break;case 95:case 42:case 92:++a;break;case 59:i[i.length]=e.substr(c,a-c),c=a+1}if(i[i.length]=e.substr(c),s===!0)throw new Error("Format |"+e+"| unterminated string ");return i}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var i=0,s="",a="";i<e.length;)switch(s=e.charAt(i)){case"G":SSF_isgeneral(e,i)&&(i+=6),i++;break;case'"':for(;e.charCodeAt(++i)!==34&&i<e.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(i,3).toUpperCase()==="A/P"||e.substr(i,5).toUpperCase()==="AM/PM"||e.substr(i,5).toUpperCase()==="/")return!0;++i;break;case"[":for(a=s;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;i<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++i))>-1||s=="\\"&&e.charAt(i+1)=="-"&&"0#".indexOf(e.charAt(i+2))>-1););break;case"?":for(;e.charAt(++i)===s;);break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}function eval_fmt(e,i,s,a){for(var c=[],d="",h=0,g="",_="t",b,_e,nt,it="H";h<e.length;)switch(g=e.charAt(h)){case"G":if(!SSF_isgeneral(e,h))throw new Error("unrecognized character "+g+" in "+e);c[c.length]={t:"G",v:"General"},h+=7;break;case'"':for(d="";(nt=e.charCodeAt(++h))!==34&&h<e.length;)d+=String.fromCharCode(nt);c[c.length]={t:"t",v:d},++h;break;case"\\":var et=e.charAt(++h),lt=et==="("||et===")"?et:"t";c[c.length]={t:lt,v:et},++h;break;case"_":c[c.length]={t:"t",v:" "},h+=2;break;case"@":c[c.length]={t:"T",v:i},++h;break;case"B":case"b":if(e.charAt(h+1)==="1"||e.charAt(h+1)==="2"){if(b==null&&(b=SSF_parse_date_code(i,s,e.charAt(h+1)==="2"),b==null))return"";c[c.length]={t:"X",v:e.substr(h,2)},_=g,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":g=g.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||b==null&&(b=SSF_parse_date_code(i,s),b==null))return"";for(d=g;++h<e.length&&e.charAt(h).toLowerCase()===g;)d+=g;g==="m"&&_.toLowerCase()==="h"&&(g="M"),g==="h"&&(g=it),c[c.length]={t:g,v:d},_=g;break;case"A":case"a":case"":var rt={t:g,v:g};if(b==null&&(b=SSF_parse_date_code(i,s)),e.substr(h,3).toUpperCase()==="A/P"?(b!=null&&(rt.v=b.H>=12?"P":"A"),rt.t="T",it="h",h+=3):e.substr(h,5).toUpperCase()==="AM/PM"?(b!=null&&(rt.v=b.H>=12?"PM":"AM"),rt.t="T",h+=5,it="h"):e.substr(h,5).toUpperCase()==="/"?(b!=null&&(rt.v=b.H>=12?"":""),rt.t="T",h+=5,it="h"):(rt.t="t",++h),b==null&&rt.t==="T")return"";c[c.length]=rt,_=g;break;case"[":for(d=g;e.charAt(h++)!=="]"&&h<e.length;)d+=e.charAt(h);if(d.slice(-1)!=="]")throw'unterminated "[" block: |'+d+"|";if(d.match(SSF_abstime)){if(b==null&&(b=SSF_parse_date_code(i,s),b==null))return"";c[c.length]={t:"Z",v:d.toLowerCase()},_=d.charAt(1)}else d.indexOf("$")>-1&&(d=(d.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(c[c.length]={t:"t",v:d}));break;case".":if(b!=null){for(d=g;++h<e.length&&(g=e.charAt(h))==="0";)d+=g;c[c.length]={t:"s",v:d};break}case"0":case"#":for(d=g;++h<e.length&&"0#?.,E+-%".indexOf(g=e.charAt(h))>-1;)d+=g;c[c.length]={t:"n",v:d};break;case"?":for(d=g;e.charAt(++h)===g;)d+=g;c[c.length]={t:g,v:d},_=g;break;case"*":++h,(e.charAt(h)==" "||e.charAt(h)=="*")&&++h;break;case"(":case")":c[c.length]={t:a===1?"t":g,v:g},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(d=g;h<e.length&&"0123456789".indexOf(e.charAt(++h))>-1;)d+=e.charAt(h);c[c.length]={t:"D",v:d};break;case" ":c[c.length]={t:g,v:g},++h;break;case"$":c[c.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(g)===-1)throw new Error("unrecognized character "+g+" in "+e);c[c.length]={t:"t",v:g},++h;break}var at=0,ot=0,st;for(h=c.length-1,_="t";h>=0;--h)switch(c[h].t){case"h":case"H":c[h].t=it,_="h",at<1&&(at=1);break;case"s":(st=c[h].v.match(/\.0+$/))&&(ot=Math.max(ot,st[0].length-1)),at<3&&(at=3);case"d":case"y":case"M":case"e":_=c[h].t;break;case"m":_==="s"&&(c[h].t="M",at<2&&(at=2));break;case"X":break;case"Z":at<1&&c[h].v.match(/[Hh]/)&&(at=1),at<2&&c[h].v.match(/[Mm]/)&&(at=2),at<3&&c[h].v.match(/[Ss]/)&&(at=3)}switch(at){case 0:break;case 1:b.u>=.5&&(b.u=0,++b.S),b.S>=60&&(b.S=0,++b.M),b.M>=60&&(b.M=0,++b.H);break;case 2:b.u>=.5&&(b.u=0,++b.S),b.S>=60&&(b.S=0,++b.M);break}var ct="",mt;for(h=0;h<c.length;++h)switch(c[h].t){case"t":case"T":case" ":case"D":break;case"X":c[h].v="",c[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[h].v=SSF_write_date(c[h].t.charCodeAt(0),c[h].v,b,ot),c[h].t="t";break;case"n":case"?":for(mt=h+1;c[mt]!=null&&((g=c[mt].t)==="?"||g==="D"||(g===" "||g==="t")&&c[mt+1]!=null&&(c[mt+1].t==="?"||c[mt+1].t==="t"&&c[mt+1].v==="/")||c[h].t==="("&&(g===" "||g==="n"||g===")")||g==="t"&&(c[mt].v==="/"||c[mt].v===" "&&c[mt+1]!=null&&c[mt+1].t=="?"));)c[h].v+=c[mt].v,c[mt]={v:"",t:";"},++mt;ct+=c[h].v,h=mt-1;break;case"G":c[h].t="t",c[h].v=SSF_general(i,s);break}var pt="",Et,ut;if(ct.length>0){ct.charCodeAt(0)==40?(Et=i<0&&ct.charCodeAt(0)===45?-i:i,ut=write_num("n",ct,Et)):(Et=i<0&&a>1?-i:i,ut=write_num("n",ct,Et),Et<0&&c[0]&&c[0].t=="t"&&(ut=ut.substr(1),c[0].v="-"+c[0].v)),mt=ut.length-1;var gt=c.length;for(h=0;h<c.length;++h)if(c[h]!=null&&c[h].t!="t"&&c[h].v.indexOf(".")>-1){gt=h;break}var xt=c.length;if(gt===c.length&&ut.indexOf("E")===-1){for(h=c.length-1;h>=0;--h)c[h]==null||"n?".indexOf(c[h].t)===-1||(mt>=c[h].v.length-1?(mt-=c[h].v.length,c[h].v=ut.substr(mt+1,c[h].v.length)):mt<0?c[h].v="":(c[h].v=ut.substr(0,mt+1),mt=-1),c[h].t="t",xt=h);mt>=0&&xt<c.length&&(c[xt].v=ut.substr(0,mt+1)+c[xt].v)}else if(gt!==c.length&&ut.indexOf("E")===-1){for(mt=ut.indexOf(".")-1,h=gt;h>=0;--h)if(!(c[h]==null||"n?".indexOf(c[h].t)===-1)){for(_e=c[h].v.indexOf(".")>-1&&h===gt?c[h].v.indexOf(".")-1:c[h].v.length-1,pt=c[h].v.substr(_e+1);_e>=0;--_e)mt>=0&&(c[h].v.charAt(_e)==="0"||c[h].v.charAt(_e)==="#")&&(pt=ut.charAt(mt--)+pt);c[h].v=pt,c[h].t="t",xt=h}for(mt>=0&&xt<c.length&&(c[xt].v=ut.substr(0,mt+1)+c[xt].v),mt=ut.indexOf(".")+1,h=gt;h<c.length;++h)if(!(c[h]==null||"n?(".indexOf(c[h].t)===-1&&h!==gt)){for(_e=c[h].v.indexOf(".")>-1&&h===gt?c[h].v.indexOf(".")+1:0,pt=c[h].v.substr(0,_e);_e<c[h].v.length;++_e)mt<ut.length&&(pt+=ut.charAt(mt++));c[h].v=pt,c[h].t="t",xt=h}}}for(h=0;h<c.length;++h)c[h]!=null&&"n?".indexOf(c[h].t)>-1&&(Et=a>1&&i<0&&h>0&&c[h-1].v==="-"?-i:i,c[h].v=write_num(c[h].t,c[h].v,Et),c[h].t="t");var Pt="";for(h=0;h!==c.length;++h)c[h]!=null&&(Pt+=c[h].v);return Pt}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,i){if(i==null)return!1;var s=parseFloat(i[2]);switch(i[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0;break}return!1}function choose_fmt(e,i){var s=SSF_split_fmt(e),a=s.length,c=s[a-1].indexOf("@");if(a<4&&c>-1&&--a,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof i!="number")return[4,s.length===4||c>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=c>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=c>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=c>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var d=i>0?s[0]:i<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[a,d];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var h=s[0].match(cfregex2),g=s[1].match(cfregex2);return chkcond(i,h)?[a,s[0]]:chkcond(i,g)?[a,s[1]]:[a,s[h!=null&&g!=null?2:1]]}return[a,d]}function SSF_format(e,i,s){s==null&&(s={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&s.dateNF?a=s.dateNF:a=e;break;case"number":e==14&&s.dateNF?a=s.dateNF:a=(s.table!=null?s.table:table_fmt)[e],a==null&&(a=s.table&&s.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),a==null&&(a=SSF_default_str[e]||"General");break}if(SSF_isgeneral(a,0))return SSF_general(i,s);i instanceof Date&&(i=datenum_local(i,s.date1904));var c=choose_fmt(a,i);if(SSF_isgeneral(c[1]))return SSF_general(i,s);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return eval_fmt(c[1],i,s,c[0])}function SSF_load(e,i){if(typeof i!="number"){i=+i||-1;for(var s=0;s<392;++s){if(table_fmt[s]==null){i<0&&(i=s);continue}if(table_fmt[s]==e){i=s;break}}i<0&&(i=391)}return table_fmt[i]=e,i}function SSF_load_table(e){for(var i=0;i!=392;++i)e[i]!==void 0&&SSF_load(e[i],i)}function make_ssf(){table_fmt=SSF_init_table()}var dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var i=typeof e=="number"?table_fmt[e]:e;return i=i.replace(dateNFregex,"(\\d+)"),new RegExp("^"+i+"$")}function dateNF_fix(e,i,s){var a=-1,c=-1,d=-1,h=-1,g=-1,_=-1;(i.match(dateNFregex)||[]).forEach(function(nt,it){var et=parseInt(s[it+1],10);switch(nt.toLowerCase().charAt(0)){case"y":a=et;break;case"d":d=et;break;case"h":h=et;break;case"s":_=et;break;case"m":h>=0?g=et:c=et;break}}),_>=0&&g==-1&&c>=0&&(g=c,c=-1);var b=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(c>=1?c:1)).slice(-2)+"-"+("00"+(d>=1?d:1)).slice(-2);b.length==7&&(b="0"+b),b.length==8&&(b="20"+b);var _e=("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2)+":"+("00"+(_>=0?_:0)).slice(-2);return h==-1&&g==-1&&_==-1?b:a==-1&&c==-1&&d==-1?_e:b+"T"+_e}var CRC32=function(){var e={};e.version="1.2.0";function i(){for(var ut=0,gt=new Array(256),xt=0;xt!=256;++xt)ut=xt,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,ut=ut&1?-306674912^ut>>>1:ut>>>1,gt[xt]=ut;return typeof Int32Array<"u"?new Int32Array(gt):gt}var s=i();function a(ut){var gt=0,xt=0,Pt=0,St=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Pt=0;Pt!=256;++Pt)St[Pt]=ut[Pt];for(Pt=0;Pt!=256;++Pt)for(xt=ut[Pt],gt=256+Pt;gt<4096;gt+=256)xt=St[gt]=xt>>>8^ut[xt&255];var Ct=[];for(Pt=1;Pt!=16;++Pt)Ct[Pt-1]=typeof Int32Array<"u"?St.subarray(Pt*256,Pt*256+256):St.slice(Pt*256,Pt*256+256);return Ct}var c=a(s),d=c[0],h=c[1],g=c[2],_=c[3],b=c[4],_e=c[5],nt=c[6],it=c[7],et=c[8],lt=c[9],rt=c[10],at=c[11],ot=c[12],st=c[13],ct=c[14];function mt(ut,gt){for(var xt=gt^-1,Pt=0,St=ut.length;Pt<St;)xt=xt>>>8^s[(xt^ut.charCodeAt(Pt++))&255];return~xt}function pt(ut,gt){for(var xt=gt^-1,Pt=ut.length-15,St=0;St<Pt;)xt=ct[ut[St++]^xt&255]^st[ut[St++]^xt>>8&255]^ot[ut[St++]^xt>>16&255]^at[ut[St++]^xt>>>24]^rt[ut[St++]]^lt[ut[St++]]^et[ut[St++]]^it[ut[St++]]^nt[ut[St++]]^_e[ut[St++]]^b[ut[St++]]^_[ut[St++]]^g[ut[St++]]^h[ut[St++]]^d[ut[St++]]^s[ut[St++]];for(Pt+=15;St<Pt;)xt=xt>>>8^s[(xt^ut[St++])&255];return~xt}function Et(ut,gt){for(var xt=gt^-1,Pt=0,St=ut.length,Ct=0,Lt=0;Pt<St;)Ct=ut.charCodeAt(Pt++),Ct<128?xt=xt>>>8^s[(xt^Ct)&255]:Ct<2048?(xt=xt>>>8^s[(xt^(192|Ct>>6&31))&255],xt=xt>>>8^s[(xt^(128|Ct&63))&255]):Ct>=55296&&Ct<57344?(Ct=(Ct&1023)+64,Lt=ut.charCodeAt(Pt++)&1023,xt=xt>>>8^s[(xt^(240|Ct>>8&7))&255],xt=xt>>>8^s[(xt^(128|Ct>>2&63))&255],xt=xt>>>8^s[(xt^(128|Lt>>6&15|(Ct&3)<<4))&255],xt=xt>>>8^s[(xt^(128|Lt&63))&255]):(xt=xt>>>8^s[(xt^(224|Ct>>12&15))&255],xt=xt>>>8^s[(xt^(128|Ct>>6&63))&255],xt=xt>>>8^s[(xt^(128|Ct&63))&255]);return~xt}return e.table=s,e.bstr=mt,e.buf=pt,e.str=Et,e}(),CFB=function e(){var i={};i.version="1.2.1";function s(Rt,zt){for(var Dt=Rt.split("/"),Nt=zt.split("/"),Ht=0,Gt=0,gr=Math.min(Dt.length,Nt.length);Ht<gr;++Ht){if(Gt=Dt[Ht].length-Nt[Ht].length)return Gt;if(Dt[Ht]!=Nt[Ht])return Dt[Ht]<Nt[Ht]?-1:1}return Dt.length-Nt.length}function a(Rt){if(Rt.charAt(Rt.length-1)=="/")return Rt.slice(0,-1).indexOf("/")===-1?Rt:a(Rt.slice(0,-1));var zt=Rt.lastIndexOf("/");return zt===-1?Rt:Rt.slice(0,zt+1)}function c(Rt){if(Rt.charAt(Rt.length-1)=="/")return c(Rt.slice(0,-1));var zt=Rt.lastIndexOf("/");return zt===-1?Rt:Rt.slice(zt+1)}function d(Rt,zt){typeof zt=="string"&&(zt=new Date(zt));var Dt=zt.getHours();Dt=Dt<<6|zt.getMinutes(),Dt=Dt<<5|zt.getSeconds()>>>1,Rt.write_shift(2,Dt);var Nt=zt.getFullYear()-1980;Nt=Nt<<4|zt.getMonth()+1,Nt=Nt<<5|zt.getDate(),Rt.write_shift(2,Nt)}function h(Rt){var zt=Rt.read_shift(2)&65535,Dt=Rt.read_shift(2)&65535,Nt=new Date,Ht=Dt&31;Dt>>>=5;var Gt=Dt&15;Dt>>>=4,Nt.setMilliseconds(0),Nt.setFullYear(Dt+1980),Nt.setMonth(Gt-1),Nt.setDate(Ht);var gr=zt&31;zt>>>=5;var Cr=zt&63;return zt>>>=6,Nt.setHours(zt),Nt.setMinutes(Cr),Nt.setSeconds(gr<<1),Nt}function g(Rt){prep_blob(Rt,0);for(var zt={},Dt=0;Rt.l<=Rt.length-4;){var Nt=Rt.read_shift(2),Ht=Rt.read_shift(2),Gt=Rt.l+Ht,gr={};switch(Nt){case 21589:Dt=Rt.read_shift(1),Dt&1&&(gr.mtime=Rt.read_shift(4)),Ht>5&&(Dt&2&&(gr.atime=Rt.read_shift(4)),Dt&4&&(gr.ctime=Rt.read_shift(4))),gr.mtime&&(gr.mt=new Date(gr.mtime*1e3));break}Rt.l=Gt,zt[Nt]=gr}return zt}var _;function b(){return _||(_={})}function _e(Rt,zt){if(Rt[0]==80&&Rt[1]==75)return Zr(Rt,zt);if((Rt[0]|32)==109&&(Rt[1]|32)==105)return ar(Rt,zt);if(Rt.length<512)throw new Error("CFB file size "+Rt.length+" < 512");var Dt=3,Nt=512,Ht=0,Gt=0,gr=0,Cr=0,yr=0,wr=[],br=Rt.slice(0,512);prep_blob(br,0);var Ur=nt(br);switch(Dt=Ur[0],Dt){case 3:Nt=512;break;case 4:Nt=4096;break;case 0:if(Ur[1]==0)return Zr(Rt,zt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Dt)}Nt!==512&&(br=Rt.slice(0,Nt),prep_blob(br,28));var $r=Rt.slice(0,Nt);it(br,Dt);var qr=br.read_shift(4,"i");if(Dt===3&&qr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qr);br.l+=4,gr=br.read_shift(4,"i"),br.l+=4,br.chk("00100000","Mini Stream Cutoff Size: "),Cr=br.read_shift(4,"i"),Ht=br.read_shift(4,"i"),yr=br.read_shift(4,"i"),Gt=br.read_shift(4,"i");for(var Wr=-1,Yr=0;Yr<109&&(Wr=br.read_shift(4,"i"),!(Wr<0));++Yr)wr[Yr]=Wr;var sn=et(Rt,Nt);at(yr,Gt,sn,Nt,wr);var on=st(sn,gr,wr,Nt);on[gr].name="!Directory",Ht>0&&Cr!==Lt&&(on[Cr].name="!MiniFAT"),on[wr[0]].name="!FAT",on.fat_addrs=wr,on.ssz=Nt;var ln={},fn=[],Zn=[],_i=[];ct(gr,on,sn,fn,Ht,ln,Zn,Cr),lt(Zn,_i,fn),fn.shift();var es={FileIndex:Zn,FullPaths:_i};return zt&&zt.raw&&(es.raw={header:$r,sectors:sn}),es}function nt(Rt){if(Rt[Rt.l]==80&&Rt[Rt.l+1]==75)return[0,0];Rt.chk(er,"Header Signature: "),Rt.l+=16;var zt=Rt.read_shift(2,"u");return[Rt.read_shift(2,"u"),zt]}function it(Rt,zt){var Dt=9;switch(Rt.l+=2,Dt=Rt.read_shift(2)){case 9:if(zt!=3)throw new Error("Sector Shift: Expected 9 saw "+Dt);break;case 12:if(zt!=4)throw new Error("Sector Shift: Expected 12 saw "+Dt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Dt)}Rt.chk("0600","Mini Sector Shift: "),Rt.chk("000000000000","Reserved: ")}function et(Rt,zt){for(var Dt=Math.ceil(Rt.length/zt)-1,Nt=[],Ht=1;Ht<Dt;++Ht)Nt[Ht-1]=Rt.slice(Ht*zt,(Ht+1)*zt);return Nt[Dt-1]=Rt.slice(Dt*zt),Nt}function lt(Rt,zt,Dt){for(var Nt=0,Ht=0,Gt=0,gr=0,Cr=0,yr=Dt.length,wr=[],br=[];Nt<yr;++Nt)wr[Nt]=br[Nt]=Nt,zt[Nt]=Dt[Nt];for(;Cr<br.length;++Cr)Nt=br[Cr],Ht=Rt[Nt].L,Gt=Rt[Nt].R,gr=Rt[Nt].C,wr[Nt]===Nt&&(Ht!==-1&&wr[Ht]!==Ht&&(wr[Nt]=wr[Ht]),Gt!==-1&&wr[Gt]!==Gt&&(wr[Nt]=wr[Gt])),gr!==-1&&(wr[gr]=Nt),Ht!==-1&&Nt!=wr[Nt]&&(wr[Ht]=wr[Nt],br.lastIndexOf(Ht)<Cr&&br.push(Ht)),Gt!==-1&&Nt!=wr[Nt]&&(wr[Gt]=wr[Nt],br.lastIndexOf(Gt)<Cr&&br.push(Gt));for(Nt=1;Nt<yr;++Nt)wr[Nt]===Nt&&(Gt!==-1&&wr[Gt]!==Gt?wr[Nt]=wr[Gt]:Ht!==-1&&wr[Ht]!==Ht&&(wr[Nt]=wr[Ht]));for(Nt=1;Nt<yr;++Nt)if(Rt[Nt].type!==0){if(Cr=Nt,Cr!=wr[Cr])do Cr=wr[Cr],zt[Nt]=zt[Cr]+"/"+zt[Nt];while(Cr!==0&&wr[Cr]!==-1&&Cr!=wr[Cr]);wr[Nt]=-1}for(zt[0]+="/",Nt=1;Nt<yr;++Nt)Rt[Nt].type!==2&&(zt[Nt]+="/")}function rt(Rt,zt,Dt){for(var Nt=Rt.start,Ht=Rt.size,Gt=[],gr=Nt;Dt&&Ht>0&&gr>=0;)Gt.push(zt.slice(gr*Ct,gr*Ct+Ct)),Ht-=Ct,gr=__readInt32LE(Dt,gr*4);return Gt.length===0?new_buf(0):bconcat(Gt).slice(0,Rt.size)}function at(Rt,zt,Dt,Nt,Ht){var Gt=Lt;if(Rt===Lt){if(zt!==0)throw new Error("DIFAT chain shorter than expected")}else if(Rt!==-1){var gr=Dt[Rt],Cr=(Nt>>>2)-1;if(!gr)return;for(var yr=0;yr<Cr&&(Gt=__readInt32LE(gr,yr*4))!==Lt;++yr)Ht.push(Gt);at(__readInt32LE(gr,Nt-4),zt-1,Dt,Nt,Ht)}}function ot(Rt,zt,Dt,Nt,Ht){var Gt=[],gr=[];Ht||(Ht=[]);var Cr=Nt-1,yr=0,wr=0;for(yr=zt;yr>=0;){Ht[yr]=!0,Gt[Gt.length]=yr,gr.push(Rt[yr]);var br=Dt[Math.floor(yr*4/Nt)];if(wr=yr*4&Cr,Nt<4+wr)throw new Error("FAT boundary crossed: "+yr+" 4 "+Nt);if(!Rt[br])break;yr=__readInt32LE(Rt[br],wr)}return{nodes:Gt,data:__toBuffer([gr])}}function st(Rt,zt,Dt,Nt){var Ht=Rt.length,Gt=[],gr=[],Cr=[],yr=[],wr=Nt-1,br=0,Ur=0,$r=0,qr=0;for(br=0;br<Ht;++br)if(Cr=[],$r=br+zt,$r>=Ht&&($r-=Ht),!gr[$r]){yr=[];var Wr=[];for(Ur=$r;Ur>=0;){Wr[Ur]=!0,gr[Ur]=!0,Cr[Cr.length]=Ur,yr.push(Rt[Ur]);var Yr=Dt[Math.floor(Ur*4/Nt)];if(qr=Ur*4&wr,Nt<4+qr)throw new Error("FAT boundary crossed: "+Ur+" 4 "+Nt);if(!Rt[Yr]||(Ur=__readInt32LE(Rt[Yr],qr),Wr[Ur]))break}Gt[$r]={nodes:Cr,data:__toBuffer([yr])}}return Gt}function ct(Rt,zt,Dt,Nt,Ht,Gt,gr,Cr){for(var yr=0,wr=Nt.length?2:0,br=zt[Rt].data,Ur=0,$r=0,qr;Ur<br.length;Ur+=128){var Wr=br.slice(Ur,Ur+128);prep_blob(Wr,64),$r=Wr.read_shift(2),qr=__utf16le(Wr,0,$r-wr),Nt.push(qr);var Yr={name:qr,type:Wr.read_shift(1),color:Wr.read_shift(1),L:Wr.read_shift(4,"i"),R:Wr.read_shift(4,"i"),C:Wr.read_shift(4,"i"),clsid:Wr.read_shift(16),state:Wr.read_shift(4,"i"),start:0,size:0},sn=Wr.read_shift(2)+Wr.read_shift(2)+Wr.read_shift(2)+Wr.read_shift(2);sn!==0&&(Yr.ct=mt(Wr,Wr.l-8));var on=Wr.read_shift(2)+Wr.read_shift(2)+Wr.read_shift(2)+Wr.read_shift(2);on!==0&&(Yr.mt=mt(Wr,Wr.l-8)),Yr.start=Wr.read_shift(4,"i"),Yr.size=Wr.read_shift(4,"i"),Yr.size<0&&Yr.start<0&&(Yr.size=Yr.type=0,Yr.start=Lt,Yr.name=""),Yr.type===5?(yr=Yr.start,Ht>0&&yr!==Lt&&(zt[yr].name="!StreamData")):Yr.size>=4096?(Yr.storage="fat",zt[Yr.start]===void 0&&(zt[Yr.start]=ot(Dt,Yr.start,zt.fat_addrs,zt.ssz)),zt[Yr.start].name=Yr.name,Yr.content=zt[Yr.start].data.slice(0,Yr.size)):(Yr.storage="minifat",Yr.size<0?Yr.size=0:yr!==Lt&&Yr.start!==Lt&&zt[yr]&&(Yr.content=rt(Yr,zt[yr].data,(zt[Cr]||{}).data))),Yr.content&&prep_blob(Yr.content,0),Gt[qr]=Yr,gr.push(Yr)}}function mt(Rt,zt){return new Date((__readUInt32LE(Rt,zt+4)/1e7*Math.pow(2,32)+__readUInt32LE(Rt,zt)/1e7-11644473600)*1e3)}function pt(Rt,zt){return b(),_e(_.readFileSync(Rt),zt)}function Et(Rt,zt){var Dt=zt&&zt.type;switch(Dt||has_buf&&Buffer.isBuffer(Rt)&&(Dt="buffer"),Dt||"base64"){case"file":return pt(Rt,zt);case"base64":return _e(s2a(Base64_decode(Rt)),zt);case"binary":return _e(s2a(Rt),zt)}return _e(Rt,zt)}function ut(Rt,zt){var Dt=zt||{},Nt=Dt.root||"Root Entry";if(Rt.FullPaths||(Rt.FullPaths=[]),Rt.FileIndex||(Rt.FileIndex=[]),Rt.FullPaths.length!==Rt.FileIndex.length)throw new Error("inconsistent CFB structure");Rt.FullPaths.length===0&&(Rt.FullPaths[0]=Nt+"/",Rt.FileIndex[0]={name:Nt,type:5}),Dt.CLSID&&(Rt.FileIndex[0].clsid=Dt.CLSID),gt(Rt)}function gt(Rt){var zt="Sh33tJ5";if(!CFB.find(Rt,"/"+zt)){var Dt=new_buf(4);Dt[0]=55,Dt[1]=Dt[3]=50,Dt[2]=54,Rt.FileIndex.push({name:zt,type:2,content:Dt,size:4,L:69,R:69,C:69}),Rt.FullPaths.push(Rt.FullPaths[0]+zt),xt(Rt)}}function xt(Rt,zt){ut(Rt);for(var Dt=!1,Nt=!1,Ht=Rt.FullPaths.length-1;Ht>=0;--Ht){var Gt=Rt.FileIndex[Ht];switch(Gt.type){case 0:Nt?Dt=!0:(Rt.FileIndex.pop(),Rt.FullPaths.pop());break;case 1:case 2:case 5:Nt=!0,isNaN(Gt.R*Gt.L*Gt.C)&&(Dt=!0),Gt.R>-1&&Gt.L>-1&&Gt.R==Gt.L&&(Dt=!0);break;default:Dt=!0;break}}if(!(!Dt&&!zt)){var gr=new Date(1987,1,19),Cr=0,yr=Object.create?Object.create(null):{},wr=[];for(Ht=0;Ht<Rt.FullPaths.length;++Ht)yr[Rt.FullPaths[Ht]]=!0,Rt.FileIndex[Ht].type!==0&&wr.push([Rt.FullPaths[Ht],Rt.FileIndex[Ht]]);for(Ht=0;Ht<wr.length;++Ht){var br=a(wr[Ht][0]);Nt=yr[br],Nt||(wr.push([br,{name:c(br).replace("/",""),type:1,clsid:nr,ct:gr,mt:gr,content:null}]),yr[br]=!0)}for(wr.sort(function(qr,Wr){return s(qr[0],Wr[0])}),Rt.FullPaths=[],Rt.FileIndex=[],Ht=0;Ht<wr.length;++Ht)Rt.FullPaths[Ht]=wr[Ht][0],Rt.FileIndex[Ht]=wr[Ht][1];for(Ht=0;Ht<wr.length;++Ht){var Ur=Rt.FileIndex[Ht],$r=Rt.FullPaths[Ht];if(Ur.name=c($r).replace("/",""),Ur.L=Ur.R=Ur.C=-(Ur.color=1),Ur.size=Ur.content?Ur.content.length:0,Ur.start=0,Ur.clsid=Ur.clsid||nr,Ht===0)Ur.C=wr.length>1?1:-1,Ur.size=0,Ur.type=5;else if($r.slice(-1)=="/"){for(Cr=Ht+1;Cr<wr.length&&a(Rt.FullPaths[Cr])!=$r;++Cr);for(Ur.C=Cr>=wr.length?-1:Cr,Cr=Ht+1;Cr<wr.length&&a(Rt.FullPaths[Cr])!=a($r);++Cr);Ur.R=Cr>=wr.length?-1:Cr,Ur.type=1}else a(Rt.FullPaths[Ht+1]||"")==a($r)&&(Ur.R=Ht+1),Ur.type=2}}}function Pt(Rt,zt){var Dt=zt||{};if(Dt.fileType=="mad")return xr(Rt,Dt);switch(xt(Rt),Dt.fileType){case"zip":return Rr(Rt,Dt)}var Nt=function(qr){for(var Wr=0,Yr=0,sn=0;sn<qr.FileIndex.length;++sn){var on=qr.FileIndex[sn];if(on.content){var ln=on.content.length;ln>0&&(ln<4096?Wr+=ln+63>>6:Yr+=ln+511>>9)}}for(var fn=qr.FullPaths.length+3>>2,Zn=Wr+7>>3,_i=Wr+127>>7,es=Zn+Yr+fn+_i,Mn=es+127>>7,As=Mn<=109?0:Math.ceil((Mn-109)/127);es+Mn+As+127>>7>Mn;)As=++Mn<=109?0:Math.ceil((Mn-109)/127);var yn=[1,As,Mn,_i,fn,Yr,Wr,0];return qr.FileIndex[0].size=Wr<<6,yn[7]=(qr.FileIndex[0].start=yn[0]+yn[1]+yn[2]+yn[3]+yn[4]+yn[5])+(yn[6]+7>>3),yn}(Rt),Ht=new_buf(Nt[7]<<9),Gt=0,gr=0;{for(Gt=0;Gt<8;++Gt)Ht.write_shift(1,Kt[Gt]);for(Gt=0;Gt<8;++Gt)Ht.write_shift(2,0);for(Ht.write_shift(2,62),Ht.write_shift(2,3),Ht.write_shift(2,65534),Ht.write_shift(2,9),Ht.write_shift(2,6),Gt=0;Gt<3;++Gt)Ht.write_shift(2,0);for(Ht.write_shift(4,0),Ht.write_shift(4,Nt[2]),Ht.write_shift(4,Nt[0]+Nt[1]+Nt[2]+Nt[3]-1),Ht.write_shift(4,0),Ht.write_shift(4,4096),Ht.write_shift(4,Nt[3]?Nt[0]+Nt[1]+Nt[2]-1:Lt),Ht.write_shift(4,Nt[3]),Ht.write_shift(-4,Nt[1]?Nt[0]-1:Lt),Ht.write_shift(4,Nt[1]),Gt=0;Gt<109;++Gt)Ht.write_shift(-4,Gt<Nt[2]?Nt[1]+Gt:-1)}if(Nt[1])for(gr=0;gr<Nt[1];++gr){for(;Gt<236+gr*127;++Gt)Ht.write_shift(-4,Gt<Nt[2]?Nt[1]+Gt:-1);Ht.write_shift(-4,gr===Nt[1]-1?Lt:gr+1)}var Cr=function(qr){for(gr+=qr;Gt<gr-1;++Gt)Ht.write_shift(-4,Gt+1);qr&&(++Gt,Ht.write_shift(-4,Lt))};for(gr=Gt=0,gr+=Nt[1];Gt<gr;++Gt)Ht.write_shift(-4,Jt.DIFSECT);for(gr+=Nt[2];Gt<gr;++Gt)Ht.write_shift(-4,Jt.FATSECT);Cr(Nt[3]),Cr(Nt[4]);for(var yr=0,wr=0,br=Rt.FileIndex[0];yr<Rt.FileIndex.length;++yr)br=Rt.FileIndex[yr],br.content&&(wr=br.content.length,!(wr<4096)&&(br.start=gr,Cr(wr+511>>9)));for(Cr(Nt[6]+7>>3);Ht.l&511;)Ht.write_shift(-4,Jt.ENDOFCHAIN);for(gr=Gt=0,yr=0;yr<Rt.FileIndex.length;++yr)br=Rt.FileIndex[yr],br.content&&(wr=br.content.length,!(!wr||wr>=4096)&&(br.start=gr,Cr(wr+63>>6)));for(;Ht.l&511;)Ht.write_shift(-4,Jt.ENDOFCHAIN);for(Gt=0;Gt<Nt[4]<<2;++Gt){var Ur=Rt.FullPaths[Gt];if(!Ur||Ur.length===0){for(yr=0;yr<17;++yr)Ht.write_shift(4,0);for(yr=0;yr<3;++yr)Ht.write_shift(4,-1);for(yr=0;yr<12;++yr)Ht.write_shift(4,0);continue}br=Rt.FileIndex[Gt],Gt===0&&(br.start=br.size?br.start-1:Lt);var $r=Gt===0&&Dt.root||br.name;if(wr=2*($r.length+1),Ht.write_shift(64,$r,"utf16le"),Ht.write_shift(2,wr),Ht.write_shift(1,br.type),Ht.write_shift(1,br.color),Ht.write_shift(-4,br.L),Ht.write_shift(-4,br.R),Ht.write_shift(-4,br.C),br.clsid)Ht.write_shift(16,br.clsid,"hex");else for(yr=0;yr<4;++yr)Ht.write_shift(4,0);Ht.write_shift(4,br.state||0),Ht.write_shift(4,0),Ht.write_shift(4,0),Ht.write_shift(4,0),Ht.write_shift(4,0),Ht.write_shift(4,br.start),Ht.write_shift(4,br.size),Ht.write_shift(4,0)}for(Gt=1;Gt<Rt.FileIndex.length;++Gt)if(br=Rt.FileIndex[Gt],br.size>=4096)if(Ht.l=br.start+1<<9,has_buf&&Buffer.isBuffer(br.content))br.content.copy(Ht,Ht.l,0,br.size),Ht.l+=br.size+511&-512;else{for(yr=0;yr<br.size;++yr)Ht.write_shift(1,br.content[yr]);for(;yr&511;++yr)Ht.write_shift(1,0)}for(Gt=1;Gt<Rt.FileIndex.length;++Gt)if(br=Rt.FileIndex[Gt],br.size>0&&br.size<4096)if(has_buf&&Buffer.isBuffer(br.content))br.content.copy(Ht,Ht.l,0,br.size),Ht.l+=br.size+63&-64;else{for(yr=0;yr<br.size;++yr)Ht.write_shift(1,br.content[yr]);for(;yr&63;++yr)Ht.write_shift(1,0)}if(has_buf)Ht.l=Ht.length;else for(;Ht.l<Ht.length;)Ht.write_shift(1,0);return Ht}function St(Rt,zt){var Dt=Rt.FullPaths.map(function(yr){return yr.toUpperCase()}),Nt=Dt.map(function(yr){var wr=yr.split("/");return wr[wr.length-(yr.slice(-1)=="/"?2:1)]}),Ht=!1;zt.charCodeAt(0)===47?(Ht=!0,zt=Dt[0].slice(0,-1)+zt):Ht=zt.indexOf("/")!==-1;var Gt=zt.toUpperCase(),gr=Ht===!0?Dt.indexOf(Gt):Nt.indexOf(Gt);if(gr!==-1)return Rt.FileIndex[gr];var Cr=!Gt.match(chr1);for(Gt=Gt.replace(chr0,""),Cr&&(Gt=Gt.replace(chr1,"!")),gr=0;gr<Dt.length;++gr)if((Cr?Dt[gr].replace(chr1,"!"):Dt[gr]).replace(chr0,"")==Gt||(Cr?Nt[gr].replace(chr1,"!"):Nt[gr]).replace(chr0,"")==Gt)return Rt.FileIndex[gr];return null}var Ct=64,Lt=-2,er="d0cf11e0a1b11ae1",Kt=[208,207,17,224,161,177,26,225],nr="00000000000000000000000000000000",Jt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Lt,FREESECT:-1,HEADER_SIGNATURE:er,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:nr,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function qt(Rt,zt,Dt){b();var Nt=Pt(Rt,Dt);_.writeFileSync(zt,Nt)}function kt(Rt){for(var zt=new Array(Rt.length),Dt=0;Dt<Rt.length;++Dt)zt[Dt]=String.fromCharCode(Rt[Dt]);return zt.join("")}function Xt(Rt,zt){var Dt=Pt(Rt,zt);switch(zt&&zt.type||"buffer"){case"file":return b(),_.writeFileSync(zt.filename,Dt),Dt;case"binary":return typeof Dt=="string"?Dt:kt(Dt);case"base64":return Base64_encode(typeof Dt=="string"?Dt:kt(Dt));case"buffer":if(has_buf)return Buffer.isBuffer(Dt)?Dt:Buffer_from(Dt);case"array":return typeof Dt=="string"?s2a(Dt):Dt}return Dt}var sr;function At(Rt){try{var zt=Rt.InflateRaw,Dt=new zt;if(Dt._processChunk(new Uint8Array([3,0]),Dt._finishFlushFlag),Dt.bytesRead)sr=Rt;else throw new Error("zlib does not expose bytesRead")}catch(Nt){console.error("cannot use native zlib: "+(Nt.message||Nt))}}function ht(Rt,zt){if(!sr)return Hr(Rt,zt);var Dt=sr.InflateRaw,Nt=new Dt,Ht=Nt._processChunk(Rt.slice(Rt.l),Nt._finishFlushFlag);return Rt.l+=Nt.bytesRead,Ht}function dt(Rt){return sr?sr.deflateRawSync(Rt):en(Rt)}var Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Mt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],It=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ut(Rt){var zt=(Rt<<1|Rt<<11)&139536|(Rt<<5|Rt<<15)&558144;return(zt>>16|zt>>8|zt)&255}for(var Zt=typeof Uint8Array<"u",rr=Zt?new Uint8Array(256):[],_r=0;_r<256;++_r)rr[_r]=Ut(_r);function pr(Rt,zt){var Dt=rr[Rt&255];return zt<=8?Dt>>>8-zt:(Dt=Dt<<8|rr[Rt>>8&255],zt<=16?Dt>>>16-zt:(Dt=Dt<<8|rr[Rt>>16&255],Dt>>>24-zt))}function Ar(Rt,zt){var Dt=zt&7,Nt=zt>>>3;return(Rt[Nt]|(Dt<=6?0:Rt[Nt+1]<<8))>>>Dt&3}function Sr(Rt,zt){var Dt=zt&7,Nt=zt>>>3;return(Rt[Nt]|(Dt<=5?0:Rt[Nt+1]<<8))>>>Dt&7}function Fr(Rt,zt){var Dt=zt&7,Nt=zt>>>3;return(Rt[Nt]|(Dt<=4?0:Rt[Nt+1]<<8))>>>Dt&15}function ur(Rt,zt){var Dt=zt&7,Nt=zt>>>3;return(Rt[Nt]|(Dt<=3?0:Rt[Nt+1]<<8))>>>Dt&31}function ir(Rt,zt){var Dt=zt&7,Nt=zt>>>3;return(Rt[Nt]|(Dt<=1?0:Rt[Nt+1]<<8))>>>Dt&127}function Bt(Rt,zt,Dt){var Nt=zt&7,Ht=zt>>>3,Gt=(1<<Dt)-1,gr=Rt[Ht]>>>Nt;return Dt<8-Nt||(gr|=Rt[Ht+1]<<8-Nt,Dt<16-Nt)||(gr|=Rt[Ht+2]<<16-Nt,Dt<24-Nt)||(gr|=Rt[Ht+3]<<24-Nt),gr&Gt}function Qt(Rt,zt,Dt){var Nt=zt&7,Ht=zt>>>3;return Nt<=5?Rt[Ht]|=(Dt&7)<<Nt:(Rt[Ht]|=Dt<<Nt&255,Rt[Ht+1]=(Dt&7)>>8-Nt),zt+3}function fr(Rt,zt,Dt){var Nt=zt&7,Ht=zt>>>3;return Dt=(Dt&1)<<Nt,Rt[Ht]|=Dt,zt+1}function hr(Rt,zt,Dt){var Nt=zt&7,Ht=zt>>>3;return Dt<<=Nt,Rt[Ht]|=Dt&255,Dt>>>=8,Rt[Ht+1]=Dt,zt+8}function Tr(Rt,zt,Dt){var Nt=zt&7,Ht=zt>>>3;return Dt<<=Nt,Rt[Ht]|=Dt&255,Dt>>>=8,Rt[Ht+1]=Dt&255,Rt[Ht+2]=Dt>>>8,zt+16}function Mr(Rt,zt){var Dt=Rt.length,Nt=2*Dt>zt?2*Dt:zt+5,Ht=0;if(Dt>=zt)return Rt;if(has_buf){var Gt=new_unsafe_buf(Nt);if(Rt.copy)Rt.copy(Gt);else for(;Ht<Rt.length;++Ht)Gt[Ht]=Rt[Ht];return Gt}else if(Zt){var gr=new Uint8Array(Nt);if(gr.set)gr.set(Rt);else for(;Ht<Dt;++Ht)gr[Ht]=Rt[Ht];return gr}return Rt.length=Nt,Rt}function kr(Rt){for(var zt=new Array(Rt),Dt=0;Dt<Rt;++Dt)zt[Dt]=0;return zt}function dr(Rt,zt,Dt){var Nt=1,Ht=0,Gt=0,gr=0,Cr=0,yr=Rt.length,wr=Zt?new Uint16Array(32):kr(32);for(Gt=0;Gt<32;++Gt)wr[Gt]=0;for(Gt=yr;Gt<Dt;++Gt)Rt[Gt]=0;yr=Rt.length;var br=Zt?new Uint16Array(yr):kr(yr);for(Gt=0;Gt<yr;++Gt)wr[Ht=Rt[Gt]]++,Nt<Ht&&(Nt=Ht),br[Gt]=0;for(wr[0]=0,Gt=1;Gt<=Nt;++Gt)wr[Gt+16]=Cr=Cr+wr[Gt-1]<<1;for(Gt=0;Gt<yr;++Gt)Cr=Rt[Gt],Cr!=0&&(br[Gt]=wr[Cr+16]++);var Ur=0;for(Gt=0;Gt<yr;++Gt)if(Ur=Rt[Gt],Ur!=0)for(Cr=pr(br[Gt],Nt)>>Nt-Ur,gr=(1<<Nt+4-Ur)-1;gr>=0;--gr)zt[Cr|gr<<Ur]=Ur&15|Gt<<4;return Nt}var Nr=Zt?new Uint16Array(512):kr(512),Dr=Zt?new Uint16Array(32):kr(32);if(!Zt){for(var Jr=0;Jr<512;++Jr)Nr[Jr]=0;for(Jr=0;Jr<32;++Jr)Dr[Jr]=0}(function(){for(var Rt=[],zt=0;zt<32;zt++)Rt.push(5);dr(Rt,Dr,32);var Dt=[];for(zt=0;zt<=143;zt++)Dt.push(8);for(;zt<=255;zt++)Dt.push(9);for(;zt<=279;zt++)Dt.push(7);for(;zt<=287;zt++)Dt.push(8);dr(Dt,Nr,288)})();var Qr=function(){for(var zt=Zt?new Uint8Array(32768):[],Dt=0,Nt=0;Dt<It.length-1;++Dt)for(;Nt<It[Dt+1];++Nt)zt[Nt]=Dt;for(;Nt<32768;++Nt)zt[Nt]=29;var Ht=Zt?new Uint8Array(259):[];for(Dt=0,Nt=0;Dt<Mt.length-1;++Dt)for(;Nt<Mt[Dt+1];++Nt)Ht[Nt]=Dt;function Gt(Cr,yr){for(var wr=0;wr<Cr.length;){var br=Math.min(65535,Cr.length-wr),Ur=wr+br==Cr.length;for(yr.write_shift(1,+Ur),yr.write_shift(2,br),yr.write_shift(2,~br&65535);br-- >0;)yr[yr.l++]=Cr[wr++]}return yr.l}function gr(Cr,yr){for(var wr=0,br=0,Ur=Zt?new Uint16Array(32768):[];br<Cr.length;){var $r=Math.min(65535,Cr.length-br);if($r<10){for(wr=Qt(yr,wr,+(br+$r==Cr.length)),wr&7&&(wr+=8-(wr&7)),yr.l=wr/8|0,yr.write_shift(2,$r),yr.write_shift(2,~$r&65535);$r-- >0;)yr[yr.l++]=Cr[br++];wr=yr.l*8;continue}wr=Qt(yr,wr,+(br+$r==Cr.length)+2);for(var qr=0;$r-- >0;){var Wr=Cr[br];qr=(qr<<5^Wr)&32767;var Yr=-1,sn=0;if((Yr=Ur[qr])&&(Yr|=br&-32768,Yr>br&&(Yr-=32768),Yr<br))for(;Cr[Yr+sn]==Cr[br+sn]&&sn<250;)++sn;if(sn>2){Wr=Ht[sn],Wr<=22?wr=hr(yr,wr,rr[Wr+1]>>1)-1:(hr(yr,wr,3),wr+=5,hr(yr,wr,rr[Wr-23]>>5),wr+=3);var on=Wr<8?0:Wr-4>>2;on>0&&(Tr(yr,wr,sn-Mt[Wr]),wr+=on),Wr=zt[br-Yr],wr=hr(yr,wr,rr[Wr]>>3),wr-=3;var ln=Wr<4?0:Wr-2>>1;ln>0&&(Tr(yr,wr,br-Yr-It[Wr]),wr+=ln);for(var fn=0;fn<sn;++fn)Ur[qr]=br&32767,qr=(qr<<5^Cr[br])&32767,++br;$r-=sn-1}else Wr<=143?Wr=Wr+48:wr=fr(yr,wr,1),wr=hr(yr,wr,rr[Wr]),Ur[qr]=br&32767,++br}wr=hr(yr,wr,0)-1}return yr.l=(wr+7)/8|0,yr.l}return function(yr,wr){return yr.length<8?Gt(yr,wr):gr(yr,wr)}}();function en(Rt){var zt=new_buf(50+Math.floor(Rt.length*1.1)),Dt=Qr(Rt,zt);return zt.slice(0,Dt)}var Vr=Zt?new Uint16Array(32768):kr(32768),Kr=Zt?new Uint16Array(32768):kr(32768),tn=Zt?new Uint16Array(128):kr(128),nn=1,Or=1;function mr(Rt,zt){var Dt=ur(Rt,zt)+257;zt+=5;var Nt=ur(Rt,zt)+1;zt+=5;var Ht=Fr(Rt,zt)+4;zt+=4;for(var Gt=0,gr=Zt?new Uint8Array(19):kr(19),Cr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],yr=1,wr=Zt?new Uint8Array(8):kr(8),br=Zt?new Uint8Array(8):kr(8),Ur=gr.length,$r=0;$r<Ht;++$r)gr[Tt[$r]]=Gt=Sr(Rt,zt),yr<Gt&&(yr=Gt),wr[Gt]++,zt+=3;var qr=0;for(wr[0]=0,$r=1;$r<=yr;++$r)br[$r]=qr=qr+wr[$r-1]<<1;for($r=0;$r<Ur;++$r)(qr=gr[$r])!=0&&(Cr[$r]=br[qr]++);var Wr=0;for($r=0;$r<Ur;++$r)if(Wr=gr[$r],Wr!=0){qr=rr[Cr[$r]]>>8-Wr;for(var Yr=(1<<7-Wr)-1;Yr>=0;--Yr)tn[qr|Yr<<Wr]=Wr&7|$r<<3}var sn=[];for(yr=1;sn.length<Dt+Nt;)switch(qr=tn[ir(Rt,zt)],zt+=qr&7,qr>>>=3){case 16:for(Gt=3+Ar(Rt,zt),zt+=2,qr=sn[sn.length-1];Gt-- >0;)sn.push(qr);break;case 17:for(Gt=3+Sr(Rt,zt),zt+=3;Gt-- >0;)sn.push(0);break;case 18:for(Gt=11+ir(Rt,zt),zt+=7;Gt-- >0;)sn.push(0);break;default:sn.push(qr),yr<qr&&(yr=qr);break}var on=sn.slice(0,Dt),ln=sn.slice(Dt);for($r=Dt;$r<286;++$r)on[$r]=0;for($r=Nt;$r<30;++$r)ln[$r]=0;return nn=dr(on,Vr,286),Or=dr(ln,Kr,30),zt}function vr(Rt,zt){if(Rt[0]==3&&!(Rt[1]&3))return[new_raw_buf(zt),2];for(var Dt=0,Nt=0,Ht=new_unsafe_buf(zt||1<<18),Gt=0,gr=Ht.length>>>0,Cr=0,yr=0;!(Nt&1);){if(Nt=Sr(Rt,Dt),Dt+=3,Nt>>>1)Nt>>1==1?(Cr=9,yr=5):(Dt=mr(Rt,Dt),Cr=nn,yr=Or);else{Dt&7&&(Dt+=8-(Dt&7));var wr=Rt[Dt>>>3]|Rt[(Dt>>>3)+1]<<8;if(Dt+=32,wr>0)for(!zt&&gr<Gt+wr&&(Ht=Mr(Ht,Gt+wr),gr=Ht.length);wr-- >0;)Ht[Gt++]=Rt[Dt>>>3],Dt+=8;continue}for(;;){!zt&&gr<Gt+32767&&(Ht=Mr(Ht,Gt+32767),gr=Ht.length);var br=Bt(Rt,Dt,Cr),Ur=Nt>>>1==1?Nr[br]:Vr[br];if(Dt+=Ur&15,Ur>>>=4,!(Ur>>>8&255))Ht[Gt++]=Ur;else{if(Ur==256)break;Ur-=257;var $r=Ur<8?0:Ur-4>>2;$r>5&&($r=0);var qr=Gt+Mt[Ur];$r>0&&(qr+=Bt(Rt,Dt,$r),Dt+=$r),br=Bt(Rt,Dt,yr),Ur=Nt>>>1==1?Dr[br]:Kr[br],Dt+=Ur&15,Ur>>>=4;var Wr=Ur<4?0:Ur-2>>1,Yr=It[Ur];for(Wr>0&&(Yr+=Bt(Rt,Dt,Wr),Dt+=Wr),!zt&&gr<qr&&(Ht=Mr(Ht,qr+100),gr=Ht.length);Gt<qr;)Ht[Gt]=Ht[Gt-Yr],++Gt}}}return zt?[Ht,Dt+7>>>3]:[Ht.slice(0,Gt),Dt+7>>>3]}function Hr(Rt,zt){var Dt=Rt.slice(Rt.l||0),Nt=vr(Dt,zt);return Rt.l+=Nt[1],Nt[0]}function rn(Rt,zt){if(Rt)typeof console<"u"&&console.error(zt);else throw new Error(zt)}function Zr(Rt,zt){var Dt=Rt;prep_blob(Dt,0);var Nt=[],Ht=[],Gt={FileIndex:Nt,FullPaths:Ht};ut(Gt,{root:zt.root});for(var gr=Dt.length-4;(Dt[gr]!=80||Dt[gr+1]!=75||Dt[gr+2]!=5||Dt[gr+3]!=6)&&gr>=0;)--gr;Dt.l=gr+4,Dt.l+=4;var Cr=Dt.read_shift(2);Dt.l+=6;var yr=Dt.read_shift(4);for(Dt.l=yr,gr=0;gr<Cr;++gr){Dt.l+=20;var wr=Dt.read_shift(4),br=Dt.read_shift(4),Ur=Dt.read_shift(2),$r=Dt.read_shift(2),qr=Dt.read_shift(2);Dt.l+=8;var Wr=Dt.read_shift(4),Yr=g(Dt.slice(Dt.l+Ur,Dt.l+Ur+$r));Dt.l+=Ur+$r+qr;var sn=Dt.l;Dt.l=Wr+4,tr(Dt,wr,br,Gt,Yr),Dt.l=sn}return Gt}function tr(Rt,zt,Dt,Nt,Ht){Rt.l+=2;var Gt=Rt.read_shift(2),gr=Rt.read_shift(2),Cr=h(Rt);if(Gt&8257)throw new Error("Unsupported ZIP encryption");for(var yr=Rt.read_shift(4),wr=Rt.read_shift(4),br=Rt.read_shift(4),Ur=Rt.read_shift(2),$r=Rt.read_shift(2),qr="",Wr=0;Wr<Ur;++Wr)qr+=String.fromCharCode(Rt[Rt.l++]);if($r){var Yr=g(Rt.slice(Rt.l,Rt.l+$r));(Yr[21589]||{}).mt&&(Cr=Yr[21589].mt),((Ht||{})[21589]||{}).mt&&(Cr=Ht[21589].mt)}Rt.l+=$r;var sn=Rt.slice(Rt.l,Rt.l+wr);switch(gr){case 8:sn=ht(Rt,br);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+gr)}var on=!1;Gt&8&&(yr=Rt.read_shift(4),yr==134695760&&(yr=Rt.read_shift(4),on=!0),wr=Rt.read_shift(4),br=Rt.read_shift(4)),wr!=zt&&rn(on,"Bad compressed size: "+zt+" != "+wr),br!=Dt&&rn(on,"Bad uncompressed size: "+Dt+" != "+br),Pr(Nt,qr,sn,{unsafe:!0,mt:Cr})}function Rr(Rt,zt){var Dt=zt||{},Nt=[],Ht=[],Gt=new_buf(1),gr=Dt.compression?8:0,Cr=0,yr=0,wr=0,br=0,Ur=0,$r=Rt.FullPaths[0],qr=$r,Wr=Rt.FileIndex[0],Yr=[],sn=0;for(yr=1;yr<Rt.FullPaths.length;++yr)if(qr=Rt.FullPaths[yr].slice($r.length),Wr=Rt.FileIndex[yr],!(!Wr.size||!Wr.content||qr=="Sh33tJ5")){var on=br,ln=new_buf(qr.length);for(wr=0;wr<qr.length;++wr)ln.write_shift(1,qr.charCodeAt(wr)&127);ln=ln.slice(0,ln.l),Yr[Ur]=CRC32.buf(Wr.content,0);var fn=Wr.content;gr==8&&(fn=dt(fn)),Gt=new_buf(30),Gt.write_shift(4,67324752),Gt.write_shift(2,20),Gt.write_shift(2,Cr),Gt.write_shift(2,gr),Wr.mt?d(Gt,Wr.mt):Gt.write_shift(4,0),Gt.write_shift(-4,Yr[Ur]),Gt.write_shift(4,fn.length),Gt.write_shift(4,Wr.content.length),Gt.write_shift(2,ln.length),Gt.write_shift(2,0),br+=Gt.length,Nt.push(Gt),br+=ln.length,Nt.push(ln),br+=fn.length,Nt.push(fn),Gt=new_buf(46),Gt.write_shift(4,33639248),Gt.write_shift(2,0),Gt.write_shift(2,20),Gt.write_shift(2,Cr),Gt.write_shift(2,gr),Gt.write_shift(4,0),Gt.write_shift(-4,Yr[Ur]),Gt.write_shift(4,fn.length),Gt.write_shift(4,Wr.content.length),Gt.write_shift(2,ln.length),Gt.write_shift(2,0),Gt.write_shift(2,0),Gt.write_shift(2,0),Gt.write_shift(2,0),Gt.write_shift(4,0),Gt.write_shift(4,on),sn+=Gt.l,Ht.push(Gt),sn+=ln.length,Ht.push(ln),++Ur}return Gt=new_buf(22),Gt.write_shift(4,101010256),Gt.write_shift(2,0),Gt.write_shift(2,0),Gt.write_shift(2,Ur),Gt.write_shift(2,Ur),Gt.write_shift(4,sn),Gt.write_shift(4,br),Gt.write_shift(2,0),bconcat([bconcat(Nt),bconcat(Ht),Gt])}var Br={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zr(Rt,zt){if(Rt.ctype)return Rt.ctype;var Dt=Rt.name||"",Nt=Dt.match(/\.([^\.]+)$/);return Nt&&Br[Nt[1]]||zt&&(Nt=(Dt=zt).match(/[\.\\]([^\.\\])+$/),Nt&&Br[Nt[1]])?Br[Nt[1]]:"application/octet-stream"}function Ir(Rt){for(var zt=Base64_encode(Rt),Dt=[],Nt=0;Nt<zt.length;Nt+=76)Dt.push(zt.slice(Nt,Nt+76));return Dt.join(`\r
`)+`\r
`}function jr(Rt){var zt=Rt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(wr){var br=wr.charCodeAt(0).toString(16).toUpperCase();return"="+(br.length==1?"0"+br:br)});zt=zt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),zt.charAt(0)==`
`&&(zt="=0D"+zt.slice(1)),zt=zt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Dt=[],Nt=zt.split(`\r
`),Ht=0;Ht<Nt.length;++Ht){var Gt=Nt[Ht];if(Gt.length==0){Dt.push("");continue}for(var gr=0;gr<Gt.length;){var Cr=76,yr=Gt.slice(gr,gr+Cr);yr.charAt(Cr-1)=="="?Cr--:yr.charAt(Cr-2)=="="?Cr-=2:yr.charAt(Cr-3)=="="&&(Cr-=3),yr=Gt.slice(gr,gr+Cr),gr+=Cr,gr<Gt.length&&(yr+="="),Dt.push(yr)}}return Dt.join(`\r
`)}function Vt(Rt){for(var zt=[],Dt=0;Dt<Rt.length;++Dt){for(var Nt=Rt[Dt];Dt<=Rt.length&&Nt.charAt(Nt.length-1)=="=";)Nt=Nt.slice(0,Nt.length-1)+Rt[++Dt];zt.push(Nt)}for(var Ht=0;Ht<zt.length;++Ht)zt[Ht]=zt[Ht].replace(/[=][0-9A-Fa-f]{2}/g,function(Gt){return String.fromCharCode(parseInt(Gt.slice(1),16))});return s2a(zt.join(`\r
`))}function $t(Rt,zt,Dt){for(var Nt="",Ht="",Gt="",gr,Cr=0;Cr<10;++Cr){var yr=zt[Cr];if(!yr||yr.match(/^\s*$/))break;var wr=yr.match(/^(.*?):\s*([^\s].*)$/);if(wr)switch(wr[1].toLowerCase()){case"content-location":Nt=wr[2].trim();break;case"content-type":Gt=wr[2].trim();break;case"content-transfer-encoding":Ht=wr[2].trim();break}}switch(++Cr,Ht.toLowerCase()){case"base64":gr=s2a(Base64_decode(zt.slice(Cr).join("")));break;case"quoted-printable":gr=Vt(zt.slice(Cr));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ht)}var br=Pr(Rt,Nt.slice(Dt.length),gr,{unsafe:!0});Gt&&(br.ctype=Gt)}function ar(Rt,zt){if(kt(Rt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Dt=zt&&zt.root||"",Nt=(has_buf&&Buffer.isBuffer(Rt)?Rt.toString("binary"):kt(Rt)).split(`\r
`),Ht=0,Gt="";for(Ht=0;Ht<Nt.length;++Ht)if(Gt=Nt[Ht],!!/^Content-Location:/i.test(Gt)&&(Gt=Gt.slice(Gt.indexOf("file")),Dt||(Dt=Gt.slice(0,Gt.lastIndexOf("/")+1)),Gt.slice(0,Dt.length)!=Dt))for(;Dt.length>0&&(Dt=Dt.slice(0,Dt.length-1),Dt=Dt.slice(0,Dt.lastIndexOf("/")+1),Gt.slice(0,Dt.length)!=Dt););var gr=(Nt[1]||"").match(/boundary="(.*?)"/);if(!gr)throw new Error("MAD cannot find boundary");var Cr="--"+(gr[1]||""),yr=[],wr=[],br={FileIndex:yr,FullPaths:wr};ut(br);var Ur,$r=0;for(Ht=0;Ht<Nt.length;++Ht){var qr=Nt[Ht];qr!==Cr&&qr!==Cr+"--"||($r++&&$t(br,Nt.slice(Ur,Ht),Dt),Ur=Ht)}return br}function xr(Rt,zt){var Dt=zt||{},Nt=Dt.boundary||"SheetJS";Nt="------="+Nt;for(var Ht=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Nt.slice(2)+'"',"","",""],Gt=Rt.FullPaths[0],gr=Gt,Cr=Rt.FileIndex[0],yr=1;yr<Rt.FullPaths.length;++yr)if(gr=Rt.FullPaths[yr].slice(Gt.length),Cr=Rt.FileIndex[yr],!(!Cr.size||!Cr.content||gr=="Sh33tJ5")){gr=gr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(sn){return"_x"+sn.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(sn){return"_u"+sn.charCodeAt(0).toString(16)+"_"});for(var wr=Cr.content,br=has_buf&&Buffer.isBuffer(wr)?wr.toString("binary"):kt(wr),Ur=0,$r=Math.min(1024,br.length),qr=0,Wr=0;Wr<=$r;++Wr)(qr=br.charCodeAt(Wr))>=32&&qr<128&&++Ur;var Yr=Ur>=$r*4/5;Ht.push(Nt),Ht.push("Content-Location: "+(Dt.root||"file:///C:/SheetJS/")+gr),Ht.push("Content-Transfer-Encoding: "+(Yr?"quoted-printable":"base64")),Ht.push("Content-Type: "+zr(Cr,gr)),Ht.push(""),Ht.push(Yr?jr(br):Ir(br))}return Ht.push(Nt+`--\r
`),Ht.join(`\r
`)}function Er(Rt){var zt={};return ut(zt,Rt),zt}function Pr(Rt,zt,Dt,Nt){var Ht=Nt&&Nt.unsafe;Ht||ut(Rt);var Gt=!Ht&&CFB.find(Rt,zt);if(!Gt){var gr=Rt.FullPaths[0];zt.slice(0,gr.length)==gr?gr=zt:(gr.slice(-1)!="/"&&(gr+="/"),gr=(gr+zt).replace("//","/")),Gt={name:c(zt),type:2},Rt.FileIndex.push(Gt),Rt.FullPaths.push(gr),Ht||CFB.utils.cfb_gc(Rt)}return Gt.content=Dt,Gt.size=Dt?Dt.length:0,Nt&&(Nt.CLSID&&(Gt.clsid=Nt.CLSID),Nt.mt&&(Gt.mt=Nt.mt),Nt.ct&&(Gt.ct=Nt.ct)),Gt}function Lr(Rt,zt){ut(Rt);var Dt=CFB.find(Rt,zt);if(Dt){for(var Nt=0;Nt<Rt.FileIndex.length;++Nt)if(Rt.FileIndex[Nt]==Dt)return Rt.FileIndex.splice(Nt,1),Rt.FullPaths.splice(Nt,1),!0}return!1}function Gr(Rt,zt,Dt){ut(Rt);var Nt=CFB.find(Rt,zt);if(Nt){for(var Ht=0;Ht<Rt.FileIndex.length;++Ht)if(Rt.FileIndex[Ht]==Nt)return Rt.FileIndex[Ht].name=c(Dt),Rt.FullPaths[Ht]=Dt,!0}return!1}function Xr(Rt){xt(Rt,!0)}return i.find=St,i.read=Et,i.parse=_e,i.write=Xt,i.writeFile=qt,i.utils={cfb_new:Er,cfb_add:Pr,cfb_del:Lr,cfb_mov:Gr,cfb_gc:Xr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:At,_deflateRaw:en,_inflateRaw:Hr,consts:Jt},i}();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,i,s){if(typeof Deno<"u"){if(s&&typeof i=="string")switch(s){case"utf8":i=new TextEncoder(s).encode(i);break;case"binary":i=s2ab(i);break;default:throw new Error("Unsupported encoding "+s)}return Deno.writeFileSync(e,i)}var a=s=="utf8"?utf8write(i):i;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var c=new Blob([blobify(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(c,e);if(typeof saveAs<"u")return saveAs(c,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var d=URL.createObjectURL(c);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(d)},6e4),chrome.downloads.download({url:d,filename:e,saveAs:!0});var h=document.createElement("a");if(h.download!=null)return h.download=e,h.href=d,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(d)},6e4),d}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var g=File(e);return g.open("w"),g.encoding="binary",Array.isArray(i)&&(i=a2s(i)),g.write(i),g.close(),i}catch(_){if(!_.message||!_.message.match(/onstruct/))throw _}throw new Error("cannot save file "+e)}function keys(e){for(var i=Object.keys(e),s=[],a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e,i[a])&&s.push(i[a]);return s}function evert_key(e,i){for(var s=[],a=keys(e),c=0;c!==a.length;++c)s[e[a[c]][i]]==null&&(s[e[a[c]][i]]=a[c]);return s}function evert(e){for(var i=[],s=keys(e),a=0;a!==s.length;++a)i[e[s[a]]]=s[a];return i}function evert_num(e){for(var i=[],s=keys(e),a=0;a!==s.length;++a)i[e[s[a]]]=parseInt(s[a],10);return i}function evert_arr(e){for(var i=[],s=keys(e),a=0;a!==s.length;++a)i[e[s[a]]]==null&&(i[e[s[a]]]=[]),i[e[s[a]]].push(s[a]);return i}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,i){var s=e.getTime(),a=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(s-a)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var i=new Date;return i.setTime(e*24*60*60*1e3+dnthresh),i.getTimezoneOffset()!==refoffset&&i.setTime(i.getTime()+(i.getTimezoneOffset()-refoffset)*6e4),i}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,i){var s=new Date(e);if(good_pd)return i>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):i<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(s.getFullYear())){var a=s.getFullYear();return e.indexOf(""+a)>-1||s.setFullYear(s.getFullYear()+100),s}var c=e.match(/\d+/g)||["2017","2","19","0","0","0"],d=new Date(+c[0],+c[1]-1,+c[2],+c[3]||0,+c[4]||0,+c[5]||0);return e.indexOf("Z")>-1&&(d=new Date(d.getTime()-d.getTimezoneOffset()*60*1e3)),d}function cc2str(e,i){if(has_buf&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var s={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(d){return s[d]||d})}catch{}for(var a=[],c=0;c!=e.length;++c)a.push(String.fromCharCode(e[c]));return a.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=dup(e[s]));return i}function fill(e,i){for(var s="";s.length<i;)s+=e;return s}function fuzzynum(e){var i=Number(e);if(!isNaN(i))return isFinite(i)?i:NaN;if(!/\d/.test(e))return i;var s=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(i=Number(a))||(a=a.replace(/[(](.*)[)]/,function(c,d){return s=-s,d}),!isNaN(i=Number(a)))?i/s:i}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var i=new Date(e),s=new Date(NaN),a=i.getYear(),c=i.getMonth(),d=i.getDate();if(isNaN(d))return s;var h=e.toLowerCase();if(h.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(h=h.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),h.length>3&&lower_months.indexOf(h)==-1)return s}else if(h.match(/[a-z]/))return s;return a<0||a>8099?s:(c>0||d>1)&&a!=101?i:e.match(/[^-0-9:,\/\\]/)?s:i}function zip_add_file(e,i,s){if(e.FullPaths){if(typeof s=="string"){var a;return has_buf?a=Buffer_from(s):a=utf8decode(s),CFB.utils.cfb_add(e,i,a)}CFB.utils.cfb_add(e,i,s)}else e.file(i,s)}function zip_new(){return CFB.utils.cfb_new()}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var i=e+"";return i.replace(decregex,function(s){return rencoding[s]}).replace(charegex,function(s){return"_x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var i=e+"";return i.replace(decregex,function(s){return rencoding[s]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var i=e+"";return i.replace(decregex,function(s){return rencoding[s]}).replace(htmlcharegex,function(s){return"&#x"+s.charCodeAt(0).toString(16).toUpperCase()+";"})}function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var i="",s=0,a=0,c=0,d=0,h=0,g=0;s<e.length;){if(a=e.charCodeAt(s++),a<128){i+=String.fromCharCode(a);continue}if(c=e.charCodeAt(s++),a>191&&a<224){h=(a&31)<<6,h|=c&63,i+=String.fromCharCode(h);continue}if(d=e.charCodeAt(s++),a<240){i+=String.fromCharCode((a&15)<<12|(c&63)<<6|d&63);continue}h=e.charCodeAt(s++),g=((a&7)<<18|(c&63)<<12|(d&63)<<6|h&63)-65536,i+=String.fromCharCode(55296+(g>>>10&1023)),i+=String.fromCharCode(56320+(g&1023))}return i}function utf8readb(e){var i=new_raw_buf(2*e.length),s,a,c=1,d=0,h=0,g;for(a=0;a<e.length;a+=c)c=1,(g=e.charCodeAt(a))<128?s=g:g<224?(s=(g&31)*64+(e.charCodeAt(a+1)&63),c=2):g<240?(s=(g&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),c=3):(c=4,s=(g&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),s-=65536,h=55296+(s>>>10&1023),s=56320+(s&1023)),h!==0&&(i[d++]=h&255,i[d++]=h>>>8,h=0),i[d++]=s%256,i[d++]=s>>>8;return i.slice(0,d).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var i=[],s=0,a=0,c=0;s<e.length;)switch(a=e.charCodeAt(s++),!0){case a<128:i.push(String.fromCharCode(a));break;case a<2048:i.push(String.fromCharCode(192+(a>>6))),i.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,c=e.charCodeAt(s++)-56320+(a<<10),i.push(String.fromCharCode(240+(c>>18&7))),i.push(String.fromCharCode(144+(c>>12&63))),i.push(String.fromCharCode(128+(c>>6&63))),i.push(String.fromCharCode(128+(c&63)));break;default:i.push(String.fromCharCode(224+(a>>12))),i.push(String.fromCharCode(128+(a>>6&63))),i.push(String.fromCharCode(128+(a&63)))}return i.join("")},htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(i){return[new RegExp("&"+i[0]+";","ig"),i[1]]});return function(s){for(var a=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),c=0;c<e.length;++c)a=a.replace(e[c][0],e[c][1]);return a}}(),wtregex=/(^\s|\s$|\n)/;function writetag(e,i){return"<"+e+(i.match(wtregex)?' xml:space="preserve"':"")+">"+i+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(i){return" "+i+'="'+e[i]+'"'}).join("")}function writextag(e,i,s){return"<"+e+(s!=null?wxt_helper(s):"")+(i!=null?(i.match(wtregex)?' xml:space="preserve"':"")+">"+i+"</"+e:"/")+">"}function write_w3cdtf(e,i){try{return e.toISOString().replace(/\.\d*/,"")}catch(s){if(i)throw s}return""}function write_vt(e,i){switch(typeof e){case"string":var s=writextag("vt:lpwstr",escapexml(e));return s=s.replace(/&quot;/g,"_x0022_"),s;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}var XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,i){for(var s=1-2*(e[i+7]>>>7),a=((e[i+7]&127)<<4)+(e[i+6]>>>4&15),c=e[i+6]&15,d=5;d>=0;--d)c=c*256+e[i+d];return a==2047?c==0?s*(1/0):NaN:(a==0?a=-1022:(a-=1023,c+=Math.pow(2,52)),s*Math.pow(2,a-52)*c)}function write_double_le(e,i,s){var a=(i<0||1/i==-1/0?1:0)<<7,c=0,d=0,h=a?-i:i;isFinite(h)?h==0?c=d=0:(c=Math.floor(Math.log(h)/Math.LN2),d=h*Math.pow(2,52-c),c<=-1023&&(!isFinite(d)||d<Math.pow(2,52))?c=-1022:(d-=Math.pow(2,52),c+=1023)):(c=2047,d=isNaN(i)?26985:0);for(var g=0;g<=5;++g,d/=256)e[s+g]=d&255;e[s+6]=(c&15)<<4|d&15,e[s+7]=c>>4|a}var ___toBuffer=function(e){for(var i=[],s=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var c=0,d=e[0][a].length;c<d;c+=s)i.push.apply(i,e[0][a].slice(c,c+s));return i},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(i){return Buffer.isBuffer(i)?i:Buffer_from(i)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,i,s){for(var a=[],c=i;c<s;c+=2)a.push(String.fromCharCode(__readUInt16LE(e,c)));return a.join("").replace(chr0,"")},__utf16le=has_buf?function(e,i,s){return Buffer.isBuffer(e)?e.toString("utf16le",i,s).replace(chr0,""):___utf16le(e,i,s)}:___utf16le,___hexlify=function(e,i,s){for(var a=[],c=i;c<i+s;++c)a.push(("0"+e[c].toString(16)).slice(-2));return a.join("")},__hexlify=has_buf?function(e,i,s){return Buffer.isBuffer(e)?e.toString("hex",i,i+s):___hexlify(e,i,s)}:___hexlify,___utf8=function(e,i,s){for(var a=[],c=i;c<s;c++)a.push(String.fromCharCode(__readUInt8(e,c)));return a.join("")},__utf8=has_buf?function e(i,s,a){return Buffer.isBuffer(i)?i.toString("utf8",s,a):___utf8(i,s,a)}:___utf8,___lpstr=function(e,i){var s=__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s-1):""},__lpstr=___lpstr,___cpstr=function(e,i){var s=__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s-1):""},__cpstr=___cpstr,___lpwstr=function(e,i){var s=2*__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s-1):""},__lpwstr=___lpwstr,___lpp4=function e(i,s){var a=__readUInt32LE(i,s);return a>0?__utf16le(i,s+4,s+4+a):""},__lpp4=___lpp4,___8lpp4=function(e,i){var s=__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s):""},__8lpp4=___8lpp4,___double=function(e,i){return read_double_le(e,i)},__double=___double,is_buf=function e(i){return Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array};has_buf&&(__lpstr=function(i,s){if(!Buffer.isBuffer(i))return ___lpstr(i,s);var a=i.readUInt32LE(s);return a>0?i.toString("utf8",s+4,s+4+a-1):""},__cpstr=function(i,s){if(!Buffer.isBuffer(i))return ___cpstr(i,s);var a=i.readUInt32LE(s);return a>0?i.toString("utf8",s+4,s+4+a-1):""},__lpwstr=function(i,s){if(!Buffer.isBuffer(i))return ___lpwstr(i,s);var a=2*i.readUInt32LE(s);return i.toString("utf16le",s+4,s+4+a-1)},__lpp4=function(i,s){if(!Buffer.isBuffer(i))return ___lpp4(i,s);var a=i.readUInt32LE(s);return i.toString("utf16le",s+4,s+4+a)},__8lpp4=function(i,s){if(!Buffer.isBuffer(i))return ___8lpp4(i,s);var a=i.readUInt32LE(s);return i.toString("utf8",s+4,s+4+a)},__double=function(i,s){return Buffer.isBuffer(i)?i.readDoubleLE(s):___double(i,s)},is_buf=function(i){return Buffer.isBuffer(i)||Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array});var __readUInt8=function(e,i){return e[i]},__readUInt16LE=function(e,i){return e[i+1]*256+e[i]},__readInt16LE=function(e,i){var s=e[i+1]*256+e[i];return s<32768?s:(65535-s+1)*-1},__readUInt32LE=function(e,i){return e[i+3]*(1<<24)+(e[i+2]<<16)+(e[i+1]<<8)+e[i]},__readInt32LE=function(e,i){return e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]},__readInt32BE=function(e,i){return e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]};function ReadShift(e,i){var s="",a,c,d=[],h,g,_,b;switch(i){case"dbcs":if(b=this.l,has_buf&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*e).toString("utf16le");else for(_=0;_<e;++_)s+=String.fromCharCode(__readUInt16LE(this,b)),b+=2;e*=2;break;case"utf8":s=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,s=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":s=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":s=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":s=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),s=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),s=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,s="";(h=__readUInt8(this,this.l+e++))!==0;)d.push(_getchar(h));s=d.join("");break;case"_wstr":for(e=0,s="";(h=__readUInt16LE(this,this.l+e))!==0;)d.push(_getchar(h)),e+=2;e+=2,s=d.join("");break;case"dbcs-cont":for(s="",b=this.l,_=0;_<e;++_){if(this.lens&&this.lens.indexOf(b)!==-1)return h=__readUInt8(this,b),this.l=b+1,g=ReadShift.call(this,e-_,h?"dbcs-cont":"sbcs-cont"),d.join("")+g;d.push(_getchar(__readUInt16LE(this,b))),b+=2}s=d.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(s="",b=this.l,_=0;_!=e;++_){if(this.lens&&this.lens.indexOf(b)!==-1)return h=__readUInt8(this,b),this.l=b+1,g=ReadShift.call(this,e-_,h?"dbcs-cont":"sbcs-cont"),d.join("")+g;d.push(_getchar(__readUInt8(this,b))),b+=1}s=d.join("");break;default:switch(e){case 1:return a=__readUInt8(this,this.l),this.l++,a;case 2:return a=(i==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,a;case 4:case-4:return i==="i"||!(this[this.l+3]&128)?(a=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,a):(c=__readUInt32LE(this,this.l),this.l+=4,c);case 8:case-8:if(i==="f")return e==8?c=__double(this,this.l):c=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,c;e=8;case 16:s=__hexlify(this,this.l,e);break}}return this.l+=e,s}var __writeUInt32LE=function(e,i,s){e[s]=i&255,e[s+1]=i>>>8&255,e[s+2]=i>>>16&255,e[s+3]=i>>>24&255},__writeInt32LE=function(e,i,s){e[s]=i&255,e[s+1]=i>>8&255,e[s+2]=i>>16&255,e[s+3]=i>>24&255},__writeUInt16LE=function(e,i,s){e[s]=i&255,e[s+1]=i>>>8&255};function WriteShift(e,i,s){var a=0,c=0;if(s==="dbcs"){for(c=0;c!=i.length;++c)__writeUInt16LE(this,i.charCodeAt(c),this.l+2*c);a=2*i.length}else if(s==="sbcs"){for(i=i.replace(/[^\x00-\x7F]/g,"_"),c=0;c!=i.length;++c)this[this.l+c]=i.charCodeAt(c)&255;a=i.length}else if(s==="hex"){for(;c<e;++c)this[this.l++]=parseInt(i.slice(2*c,2*c+2),16)||0;return this}else if(s==="utf16le"){var d=Math.min(this.l+e,this.length);for(c=0;c<Math.min(i.length,e);++c){var h=i.charCodeAt(c);this[this.l++]=h&255,this[this.l++]=h>>8}for(;this.l<d;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=i&255;break;case 2:a=2,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255;break;case 3:a=3,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255,i>>>=8,this[this.l+2]=i&255;break;case 4:a=4,__writeUInt32LE(this,i,this.l);break;case 8:if(a=8,s==="f"){write_double_le(this,i,this.l);break}case 16:break;case-4:a=4,__writeInt32LE(this,i,this.l);break}return this.l+=a,this}function CheckField(e,i){var s=__hexlify(this,this.l,e.length>>1);if(s!==e)throw new Error(i+"Expected "+e+" saw "+s);this.l+=e.length>>1}function prep_blob(e,i){e.l=i,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,i){e.l+=i}function new_buf(e){var i=new_raw_buf(e);return prep_blob(i,0),i}function buf_array(){var e=[],i=has_buf?256:2048,s=function(b){var _e=new_buf(b);return prep_blob(_e,0),_e},a=s(i),c=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},d=function(b){return a&&b<a.length-a.l?a:(c(),a=s(Math.max(b+1,i)))},h=function(){return c(),bconcat(e)},g=function(b){c(),a=b,a.l==null&&(a.l=a.length),d(i)};return{next:d,push:g,end:h,_bufs:e}}function write_record(e,i,s,a){var c=+i,d;if(!isNaN(c)){a||(a=XLSBRecordEnum[c].p||(s||[]).length||0),d=1+(c>=128?1:0)+1,a>=128&&++d,a>=16384&&++d,a>=2097152&&++d;var h=e.next(d);c<=127?h.write_shift(1,c):(h.write_shift(1,(c&127)+128),h.write_shift(1,c>>7));for(var g=0;g!=4;++g)if(a>=128)h.write_shift(1,(a&127)+128),a>>=7;else{h.write_shift(1,a);break}a>0&&is_buf(s)&&e.push(s)}}function shift_cell_xls(e,i,s){var a=dup(e);if(i.s?(a.cRel&&(a.c+=i.s.c),a.rRel&&(a.r+=i.s.r)):(a.cRel&&(a.c+=i.c),a.rRel&&(a.r+=i.r)),!s||s.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function shift_range_xls(e,i,s){var a=dup(e);return a.s=shift_cell_xls(a.s,i.s,s),a.e=shift_cell_xls(a.e,i.s,s),a}function encode_cell_xls(e,i){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=i>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=i>8?1048576:i>5?65536:16384;var s=encode_cell(e);return!e.cRel&&e.cRel!=null&&(s=fix_col(s)),!e.rRel&&e.rRel!=null&&(s=fix_row(s)),s}function encode_range_xls(e,i){return e.s.r==0&&!e.s.rRel&&e.e.r==(i.biff>=12?1048575:i.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(i.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,i.biff)+":"+encode_cell_xls(e.e,i.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var i=unfix_col(e),s=0,a=0;a!==i.length;++a)s=26*s+i.charCodeAt(a)-64;return s-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var i="";for(++e;e;e=Math.floor((e-1)/26))i=String.fromCharCode((e-1)%26+65)+i;return i}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var i=0,s=0,a=0;a<e.length;++a){var c=e.charCodeAt(a);c>=48&&c<=57?i=10*i+(c-48):c>=65&&c<=90&&(s=26*s+(c-64))}return{c:s-1,r:i-1}}function encode_cell(e){for(var i=e.c+1,s="";i;i=(i-1)/26|0)s=String.fromCharCode((i-1)%26+65)+s;return s+(e.r+1)}function decode_range(e){var i=e.indexOf(":");return i==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,i)),e:decode_cell(e.slice(i+1))}}function encode_range(e,i){return typeof i>"u"||typeof i=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof i!="string"&&(i=encode_cell(i)),e==i?e:e+":"+i)}function safe_decode_range(e){var i={s:{c:0,r:0},e:{c:0,r:0}},s=0,a=0,c=0,d=e.length;for(s=0;a<d&&!((c=e.charCodeAt(a)-64)<1||c>26);++a)s=26*s+c;for(i.s.c=--s,s=0;a<d&&!((c=e.charCodeAt(a)-48)<0||c>9);++a)s=10*s+c;if(i.s.r=--s,a===d||c!=10)return i.e.c=i.s.c,i.e.r=i.s.r,i;for(++a,s=0;a!=d&&!((c=e.charCodeAt(a)-64)<1||c>26);++a)s=26*s+c;for(i.e.c=--s,s=0;a!=d&&!((c=e.charCodeAt(a)-48)<0||c>9);++a)s=10*s+c;return i.e.r=--s,i}function safe_format_cell(e,i){var s=e.t=="d"&&i instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,s?datenum(i):i)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(s?14:0),s?datenum(i):i)}catch{return""+i}}function format_cell(e,i,s){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&s&&s.dateNF&&(e.z=s.dateNF),e.t=="e"?BErr[e.v]||e.v:i==null?safe_format_cell(e,e.v):safe_format_cell(e,i))}function sheet_to_workbook(e,i){var s=i&&i.sheet?i.sheet:"Sheet1",a={};return a[s]=e,{SheetNames:[s],Sheets:a}}function sheet_add_aoa(e,i,s){var a=s||{},c=e?Array.isArray(e):a.dense,d=e||(c?[]:{}),h=0,g=0;if(d&&a.origin!=null){if(typeof a.origin=="number")h=a.origin;else{var _=typeof a.origin=="string"?decode_cell(a.origin):a.origin;h=_.r,g=_.c}d["!ref"]||(d["!ref"]="A1:A1")}var b={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(d["!ref"]){var _e=safe_decode_range(d["!ref"]);b.s.c=_e.s.c,b.s.r=_e.s.r,b.e.c=Math.max(b.e.c,_e.e.c),b.e.r=Math.max(b.e.r,_e.e.r),h==-1&&(b.e.r=h=_e.e.r+1)}for(var nt=0;nt!=i.length;++nt)if(i[nt]){if(!Array.isArray(i[nt]))throw new Error("aoa_to_sheet expects an array of arrays");for(var it=0;it!=i[nt].length;++it)if(!(typeof i[nt][it]>"u")){var et={v:i[nt][it]},lt=h+nt,rt=g+it;if(b.s.r>lt&&(b.s.r=lt),b.s.c>rt&&(b.s.c=rt),b.e.r<lt&&(b.e.r=lt),b.e.c<rt&&(b.e.c=rt),i[nt][it]&&typeof i[nt][it]=="object"&&!Array.isArray(i[nt][it])&&!(i[nt][it]instanceof Date))et=i[nt][it];else if(Array.isArray(et.v)&&(et.f=i[nt][it][1],et.v=et.v[0]),et.v===null)if(et.f)et.t="n";else if(a.nullError)et.t="e",et.v=0;else if(a.sheetStubs)et.t="z";else continue;else typeof et.v=="number"?et.t="n":typeof et.v=="boolean"?et.t="b":et.v instanceof Date?(et.z=a.dateNF||table_fmt[14],a.cellDates?(et.t="d",et.w=SSF_format(et.z,datenum(et.v))):(et.t="n",et.v=datenum(et.v),et.w=SSF_format(et.z,et.v))):et.t="s";if(c)d[lt]||(d[lt]=[]),d[lt][rt]&&d[lt][rt].z&&(et.z=d[lt][rt].z),d[lt][rt]=et;else{var at=encode_cell({c:rt,r:lt});d[at]&&d[at].z&&(et.z=d[at].z),d[at]=et}}}return b.s.c<1e7&&(d["!ref"]=encode_range(b)),d}function aoa_to_sheet(e,i){return sheet_add_aoa(null,e,i)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,i){return i||(i=new_buf(4)),i.write_shift(4,e),i}function parse_XLWideString(e){var i=e.read_shift(4);return i===0?"":e.read_shift(i,"dbcs")}function write_XLWideString(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(4+2*e.length)),i.write_shift(4,e.length),e.length>0&&i.write_shift(0,e,"dbcs"),s?i.slice(0,i.l):i}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,i){return i||(i=new_buf(4)),i.write_shift(2,0),i.write_shift(2,0),i}function parse_RichStr(e,i){var s=e.l,a=e.read_shift(1),c=parse_XLWideString(e),d=[],h={t:c,h:c};if(a&1){for(var g=e.read_shift(4),_=0;_!=g;++_)d.push(parse_StrRun(e));h.r=d}else h.r=[{ich:0,ifnt:0}];return e.l=s+i,h}function write_RichStr(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(15+4*e.t.length)),i.write_shift(1,0),write_XLWideString(e.t,i),s?i.slice(0,i.l):i}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(23+4*e.t.length)),i.write_shift(1,1),write_XLWideString(e.t,i),i.write_shift(4,1),write_StrRun({ich:0,ifnt:0},i),s?i.slice(0,i.l):i}function parse_XLSBCell(e){var i=e.read_shift(4),s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:i,iStyleRef:s}}function write_XLSBCell(e,i){return i==null&&(i=new_buf(8)),i.write_shift(-4,e.c),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}function parse_XLSBShortCell(e){var i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:i}}function write_XLSBShortCell(e,i){return i==null&&(i=new_buf(4)),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var i=e.read_shift(4);return i===0||i===4294967295?"":e.read_shift(i,"dbcs")}function write_XLNullableWideString(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(127)),i.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&i.write_shift(0,e,"dbcs"),s?i.slice(0,i.l):i}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var i=e.slice(e.l,e.l+4),s=i[0]&1,a=i[0]&2;e.l+=4;var c=a===0?__double([0,0,0,0,i[0]&252,i[1],i[2],i[3]],0):__readInt32LE(i,0)>>2;return s?c/100:c}function write_RkNumber(e,i){i==null&&(i=new_buf(4));var s=0,a=0,c=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:c==(c|0)&&c>=-(1<<29)&&c<1<<29&&(a=1,s=1),a)i.write_shift(-4,((s?c:e)<<2)+(s+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var i={s:{},e:{}};return i.s.r=e.read_shift(4),i.e.r=e.read_shift(4),i.s.c=e.read_shift(4),i.e.c=e.read_shift(4),i}function write_RfX(e,i){return i||(i=new_buf(16)),i.write_shift(4,e.s.r),i.write_shift(4,e.e.r),i.write_shift(4,e.s.c),i.write_shift(4,e.e.c),i}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,i){return(i||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var i={},s=e.read_shift(1),a=s>>>1,c=e.read_shift(1),d=e.read_shift(2,"i"),h=e.read_shift(1),g=e.read_shift(1),_=e.read_shift(1);switch(e.l++,a){case 0:i.auto=1;break;case 1:i.index=c;var b=XLSIcv[c];b&&(i.rgb=rgb2Hex(b));break;case 2:i.rgb=rgb2Hex([h,g,_]);break;case 3:i.theme=c;break}return d!=0&&(i.tint=d>0?d/32767:d/32768),i}function write_BrtColor(e,i){if(i||(i=new_buf(8)),!e||e.auto)return i.write_shift(4,0),i.write_shift(4,0),i;e.index!=null?(i.write_shift(1,2),i.write_shift(1,e.index)):e.theme!=null?(i.write_shift(1,6),i.write_shift(1,e.theme)):(i.write_shift(1,5),i.write_shift(1,0));var s=e.tint||0;if(s>0?s*=32767:s<0&&(s*=32768),i.write_shift(2,s),!e.rgb||e.theme!=null)i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),i.write_shift(1,parseInt(a.slice(0,2),16)),i.write_shift(1,parseInt(a.slice(2,4),16)),i.write_shift(1,parseInt(a.slice(4,6),16)),i.write_shift(1,255)}return i}function parse_FontFlags(e){var i=e.read_shift(1);e.l++;var s={fBold:i&1,fItalic:i&2,fUnderline:i&4,fStrikeout:i&8,fOutline:i&16,fShadow:i&32,fCondense:i&64,fExtend:i&128};return s}function write_FontFlags(e,i){i||(i=new_buf(2));var s=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return i.write_shift(1,s),i.write_shift(1,0),i}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}};function rgbify(e){return e.map(function(i){return[i>>16&255,i>>8&255,i&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function write_ct(e,i){var s=evert_arr(ct2type),a=[],c;a[a.length]=XML_HEADER,a[a.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(_){return writextag("Default",null,{Extension:_[0],ContentType:_[1]})}));var d=function(_){e[_]&&e[_].length>0&&(c=e[_][0],a[a.length]=writextag("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:CT_LIST[_][i.bookType]||CT_LIST[_].xlsx}))},h=function(_){(e[_]||[]).forEach(function(b){a[a.length]=writextag("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:CT_LIST[_][i.bookType]||CT_LIST[_].xlsx})})},g=function(_){(e[_]||[]).forEach(function(b){a[a.length]=writextag("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:s[_][0]})})};return d("workbooks"),h("sheets"),h("charts"),g("themes"),["strs","styles"].forEach(d),["coreprops","extprops","custprops"].forEach(g),g("vba"),g("comments"),g("threadedcomments"),g("drawings"),h("metadata"),g("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var i=e.lastIndexOf("/");return e.slice(0,i+1)+"_rels/"+e.slice(i+1)+".rels"}function write_rels(e){var i=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(s){i[i.length]=writextag("Relationship",null,e["!id"][s])}),i.length>2&&(i[i.length]="</Relationships>",i[1]=i[1].replace("/>",">")),i.join("")}function add_rels(e,i,s,a,c,d){if(c||(c={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),i<0)for(i=e["!idx"];e["!id"]["rId"+i];++i);if(e["!idx"]=i+1,c.Id="rId"+i,c.Type=a,c.Target=s,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(c.Type)>-1&&(c.TargetMode="External"),e["!id"][c.Id])throw new Error("Cannot rewrite rId "+i);return e["!id"][c.Id]=c,e[("/"+c.Target).replace("//","/")]=c,i}function write_manifest(e){var i=[XML_HEADER];i.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),i.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var s=0;s<e.length;++s)i.push('  <manifest:file-entry manifest:full-path="'+e[s][0]+'" manifest:media-type="'+e[s][1]+`"/>
`);return i.push("</manifest:manifest>"),i.join("")}function write_rdf_type(e,i,s){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(s||"odf")+"#"+i+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,i){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var i=[XML_HEADER];i.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var s=0;s!=e.length;++s)i.push(write_rdf_type(e[s][0],e[s][1])),i.push(write_rdf_has("",e[s][0]));return i.push(write_rdf_type("","Document","pkg")),i.push("</rdf:RDF>"),i.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cp_doit(e,i,s,a,c){c[e]!=null||i==null||i===""||(c[e]=i,i=escapexml(i),a[a.length]=s?writextag(e,i,s):writetag(e,i))}function write_core_props(e,i){var s=i||{},a=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],c={};if(!e&&!s.Props)return a.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},a,c),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},a,c));for(var d=0;d!=CORE_PROPS.length;++d){var h=CORE_PROPS[d],g=s.Props&&s.Props[h[1]]!=null?s.Props[h[1]]:e?e[h[1]]:null;g===!0?g="1":g===!1?g="0":typeof g=="number"&&(g=String(g)),g!=null&&cp_doit(h[0],g,null,a,c)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function write_ext_props(e){var i=[],s=writextag;return e||(e={}),e.Application="SheetJS",i[i.length]=XML_HEADER,i[i.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(a){if(e[a[1]]!==void 0){var c;switch(a[2]){case"string":c=escapexml(String(e[a[1]]));break;case"bool":c=e[a[1]]?"true":"false";break}c!==void 0&&(i[i.length]=s(a[0],c))}}),i[i.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),i[i.length]=s("TitlesOfParts",s("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+escapexml(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}function write_cust_props(e){var i=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return i.join("");var s=1;return keys(e).forEach(function(c){++s,i[i.length]=writextag("property",write_vt(e[c]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:s,name:escapexml(c)})}),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xlml_write_docprops(e,i){var s=[];return keys(XLMLDocPropsMap).map(function(a){for(var c=0;c<CORE_PROPS.length;++c)if(CORE_PROPS[c][1]==a)return CORE_PROPS[c];for(c=0;c<EXT_PROPS.length;++c)if(EXT_PROPS[c][1]==a)return EXT_PROPS[c];throw a}).forEach(function(a){if(e[a[1]]!=null){var c=i&&i.Props&&i.Props[a[1]]!=null?i.Props[a[1]]:e[a[1]];switch(a[2]){case"date":c=new Date(c).toISOString().replace(/\.\d*Z/,"Z");break}typeof c=="number"?c=String(c):c===!0||c===!1?c=c?"1":"0":c instanceof Date&&(c=new Date(c).toISOString().replace(/\.\d*Z/,"")),s.push(writetag(XLMLDocPropsMap[a[1]]||a[1],c))}}),writextag("DocumentProperties",s.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,i){var s=["Worksheets","SheetNames"],a="CustomDocumentProperties",c=[];return e&&keys(e).forEach(function(d){if(Object.prototype.hasOwnProperty.call(e,d)){for(var h=0;h<CORE_PROPS.length;++h)if(d==CORE_PROPS[h][1])return;for(h=0;h<EXT_PROPS.length;++h)if(d==EXT_PROPS[h][1])return;for(h=0;h<s.length;++h)if(d==s[h])return;var g=e[d],_="string";typeof g=="number"?(_="float",g=String(g)):g===!0||g===!1?(_="boolean",g=g?"1":"0"):g=String(g),c.push(writextag(escapexmltag(d),g,{"dt:dt":_}))}}),i&&keys(i).forEach(function(d){if(Object.prototype.hasOwnProperty.call(i,d)&&!(e&&Object.prototype.hasOwnProperty.call(e,d))){var h=i[d],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h instanceof Date?(g="dateTime.tz",h=h.toISOString()):h=String(h),c.push(writextag(escapexmltag(d),h,{"dt:dt":g}))}}),"<"+a+' xmlns="'+XLMLNS.o+'">'+c.join("")+"</"+a+">"}function write_FILETIME(e){var i=typeof e=="string"?new Date(Date.parse(e)):e,s=i.getTime()/1e3+11644473600,a=s%Math.pow(2,32),c=(s-a)/Math.pow(2,32);a*=1e7,c*=1e7;var d=a/Math.pow(2,32)|0;d>0&&(a=a%Math.pow(2,32),c+=d);var h=new_buf(8);return h.write_shift(4,a),h.write_shift(4,c),h}function write_TypedPropertyValue(e,i){var s=new_buf(4),a=new_buf(4);switch(s.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,i);break;case 5:a=new_buf(8),a.write_shift(8,i,"f");break;case 11:a.write_shift(4,i?1:0);break;case 64:a=write_FILETIME(i);break;case 31:case 80:for(a=new_buf(4+2*(i.length+1)+(i.length%2?0:2)),a.write_shift(4,i.length+1),a.write_shift(0,i,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}return bconcat([s,a])}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,i,s){var a=new_buf(8),c=[],d=[],h=8,g=0,_=new_buf(8),b=new_buf(8);if(_.write_shift(4,2),_.write_shift(4,1200),b.write_shift(4,1),d.push(_),c.push(b),h+=8+_.length,!i){b=new_buf(8),b.write_shift(4,0),c.unshift(b);var _e=[new_buf(4)];for(_e[0].write_shift(4,e.length),g=0;g<e.length;++g){var nt=e[g][0];for(_=new_buf(8+2*(nt.length+1)+(nt.length%2?0:2)),_.write_shift(4,g+2),_.write_shift(4,nt.length+1),_.write_shift(0,nt,"dbcs");_.l!=_.length;)_.write_shift(1,0);_e.push(_)}_=bconcat(_e),d.unshift(_),h+=8+_.length}for(g=0;g<e.length;++g)if(!(i&&!i[e[g][0]])&&!(XLSPSSkip.indexOf(e[g][0])>-1||PseudoPropsPairs.indexOf(e[g][0])>-1)&&e[g][1]!=null){var it=e[g][1],et=0;if(i){et=+i[e[g][0]];var lt=s[et];if(lt.p=="version"&&typeof it=="string"){var rt=it.split(".");it=(+rt[0]<<16)+(+rt[1]||0)}_=write_TypedPropertyValue(lt.t,it)}else{var at=guess_property_type(it);at==-1&&(at=31,it=String(it)),_=write_TypedPropertyValue(at,it)}d.push(_),b=new_buf(8),b.write_shift(4,i?et:2+g),c.push(b),h+=8+_.length}var ot=8*(d.length+1);for(g=0;g<d.length;++g)c[g].write_shift(4,ot),ot+=d[g].length;return a.write_shift(4,h),a.write_shift(4,d.length),bconcat([a].concat(c).concat(d))}function write_PropertySetStream(e,i,s,a,c,d){var h=new_buf(c?68:48),g=[h];h.write_shift(2,65534),h.write_shift(2,0),h.write_shift(4,842412599),h.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),h.write_shift(4,c?2:1),h.write_shift(16,i,"hex"),h.write_shift(4,c?68:48);var _=write_PropertySet(e,s,a);if(g.push(_),c){var b=write_PropertySet(c,null,null);h.write_shift(16,d,"hex"),h.write_shift(4,68+_.length),g.push(b)}return bconcat(g)}function writezeroes(e,i){i||(i=new_buf(e));for(var s=0;s<e;++s)i.write_shift(1,0);return i}function parsebool(e,i){return e.read_shift(i)===1}function writebool(e,i){return i||(i=new_buf(2)),i.write_shift(2,+!!e),i}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,i){return i||(i=new_buf(2)),i.write_shift(2,e),i}function write_Bes(e,i,s){return s||(s=new_buf(2)),s.write_shift(1,i=="e"?+e:+!!e),s.write_shift(1,i=="e"?1:0),s}function parse_ShortXLUnicodeString(e,i,s){var a=e.read_shift(s&&s.biff>=12?2:1),c="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var d=e.read_shift(1);d&&(c="dbcs-cont")}else s.biff==12&&(c="wstr");s.biff>=2&&s.biff<=5&&(c="cpstr");var h=a?e.read_shift(a,c):"";return h}function write_XLUnicodeRichExtendedString(e){var i=e.t||"",s=new_buf(3);s.write_shift(2,i.length),s.write_shift(1,1);var a=new_buf(2*i.length);a.write_shift(2*i.length,i,"utf16le");var c=[s,a];return bconcat(c)}function parse_XLUnicodeStringNoCch(e,i,s){var a;if(s){if(s.biff>=2&&s.biff<=5)return e.read_shift(i,"cpstr");if(s.biff>=12)return e.read_shift(i,"dbcs-cont")}var c=e.read_shift(1);return c===0?a=e.read_shift(i,"sbcs-cont"):a=e.read_shift(i,"dbcs-cont"),a}function parse_XLUnicodeString(e,i,s){var a=e.read_shift(s&&s.biff==2?1:2);return a===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,a,s)}function parse_XLUnicodeString2(e,i,s){if(s.biff>5)return parse_XLUnicodeString(e,i,s);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,s.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,i,s){return s||(s=new_buf(3+2*e.length)),s.write_shift(2,e.length),s.write_shift(1,1),s.write_shift(31,e,"utf16le"),s}function write_HyperlinkString(e,i){i||(i=new_buf(6+e.length*2)),i.write_shift(4,1+e.length);for(var s=0;s<e.length;++s)i.write_shift(2,e.charCodeAt(s));return i.write_shift(2,0),i}function write_Hyperlink(e){var i=new_buf(512),s=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var c=a.indexOf("#"),d=c>-1?31:23;switch(a.charAt(0)){case"#":d=28;break;case".":d&=-3;break}i.write_shift(4,2),i.write_shift(4,d);var h=[8,6815827,6619237,4849780,83];for(s=0;s<h.length;++s)i.write_shift(4,h[s]);if(d==28)a=a.slice(1),write_HyperlinkString(a,i);else if(d&2){for(h="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<h.length;++s)i.write_shift(1,parseInt(h[s],16));var g=c>-1?a.slice(0,c):a;for(i.write_shift(4,2*(g.length+1)),s=0;s<g.length;++s)i.write_shift(2,g.charCodeAt(s));i.write_shift(2,0),d&8&&write_HyperlinkString(c>-1?a.slice(c+1):"",i)}else{for(h="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),s=0;s<h.length;++s)i.write_shift(1,parseInt(h[s],16));for(var _=0;a.slice(_*3,_*3+3)=="../"||a.slice(_*3,_*3+3)=="..\\";)++_;for(i.write_shift(2,_),i.write_shift(4,a.length-3*_+1),s=0;s<a.length-3*_;++s)i.write_shift(1,a.charCodeAt(s+3*_)&255);for(i.write_shift(1,0),i.write_shift(2,65535),i.write_shift(2,57005),s=0;s<6;++s)i.write_shift(4,0)}return i.slice(0,i.l)}function write_XLSCell(e,i,s,a){return a||(a=new_buf(6)),a.write_shift(2,e),a.write_shift(2,i),a.write_shift(2,s||0),a}function parse_XTI(e,i,s){var a=s.biff>8?4:2,c=e.read_shift(a),d=e.read_shift(a,"i"),h=e.read_shift(a,"i");return[c,d,h]}function parse_Ref8U(e){var i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2);return{s:{c:a,r:i},e:{c,r:s}}}function write_Ref8U(e,i){return i||(i=new_buf(8)),i.write_shift(2,e.s.r),i.write_shift(2,e.e.r),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c),i}function write_BOF(e,i,s){var a=1536,c=16;switch(s.bookType){case"biff8":break;case"biff5":a=1280,c=8;break;case"biff4":a=4,c=6;break;case"biff3":a=3,c=6;break;case"biff2":a=2,c=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var d=new_buf(c);return d.write_shift(2,a),d.write_shift(2,i),c>4&&d.write_shift(2,29282),c>6&&d.write_shift(2,1997),c>8&&(d.write_shift(2,49161),d.write_shift(2,1),d.write_shift(2,1798),d.write_shift(2,0)),d}function write_WriteAccess(e,i){var s=!i||i.biff==8,a=new_buf(s?112:54);for(a.write_shift(i.biff==8?2:1,7),s&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(s?0:536870912));a.l<a.length;)a.write_shift(1,s?0:32);return a}function write_BoundSheet8(e,i){var s=!i||i.biff>=8?2:1,a=new_buf(8+s*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),i.biff>=8&&a.write_shift(1,1),a.write_shift(s*e.name.length,e.name,i.biff<8?"sbcs":"utf16le");var c=a.slice(0,a.l);return c.l=a.l,c}function write_SST(e,i){var s=new_buf(8);s.write_shift(4,e.Count),s.write_shift(4,e.Unique);for(var a=[],c=0;c<e.length;++c)a[c]=write_XLUnicodeRichExtendedString(e[c]);var d=bconcat([s].concat(a));return d.parts=[s.length].concat(a.map(function(h){return h.length})),d}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function write_Window2(e){var i=new_buf(18),s=1718;return e&&e.RTL&&(s|=64),i.write_shift(2,s),i.write_shift(4,0),i.write_shift(4,64),i.write_shift(4,0),i.write_shift(4,0),i}function write_Font(e,i){var s=e.name||"Arial",a=i&&i.biff==5,c=a?15+s.length:16+2*s.length,d=new_buf(c);return d.write_shift(2,(e.sz||12)*20),d.write_shift(4,0),d.write_shift(2,400),d.write_shift(4,0),d.write_shift(2,0),d.write_shift(1,s.length),a||d.write_shift(1,1),d.write_shift((a?1:2)*s.length,s,a?"sbcs":"utf16le"),d}function write_LabelSst(e,i,s,a){var c=new_buf(10);return write_XLSCell(e,i,a,c),c.write_shift(4,s),c}function write_Label(e,i,s,a,c){var d=!c||c.biff==8,h=new_buf(8+ +d+(1+d)*s.length);return write_XLSCell(e,i,a,h),h.write_shift(2,s.length),d&&h.write_shift(1,1),h.write_shift((1+d)*s.length,s,d?"utf16le":"sbcs"),h}function write_Format(e,i,s,a){var c=s&&s.biff==5;a||(a=new_buf(c?3+i.length:5+2*i.length)),a.write_shift(2,e),a.write_shift(c?1:2,i.length),c||a.write_shift(1,1),a.write_shift((c?1:2)*i.length,i,c?"sbcs":"utf16le");var d=a.length>a.l?a.slice(0,a.l):a;return d.l==null&&(d.l=d.length),d}function write_Dimensions(e,i){var s=i.biff==8||!i.biff?4:2,a=new_buf(2*s+6);return a.write_shift(s,e.s.r),a.write_shift(s,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function write_XF(e,i,s,a){var c=s&&s.biff==5;a||(a=new_buf(c?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,i<<4));var d=0;return e.numFmtId>0&&c&&(d|=1024),a.write_shift(4,d),a.write_shift(4,0),c||a.write_shift(4,0),a.write_shift(2,0),a}function write_Guts(e){var i=new_buf(8);return i.write_shift(4,0),i.write_shift(2,0),i.write_shift(2,0),i}function write_BoolErr(e,i,s,a,c,d){var h=new_buf(8);return write_XLSCell(e,i,a,h),write_Bes(s,d,h),h}function write_Number(e,i,s,a){var c=new_buf(14);return write_XLSCell(e,i,a,c),write_Xnum(s,c),c}function parse_ExternSheet(e,i,s){if(s.biff<8)return parse_BIFF5ExternSheet(e,i,s);for(var a=[],c=e.l+i,d=e.read_shift(s.biff>8?4:2);d--!==0;)a.push(parse_XTI(e,s.biff>8?12:6,s));if(e.l!=c)throw new Error("Bad ExternSheet: "+e.l+" != "+c);return a}function parse_BIFF5ExternSheet(e,i,s){e[e.l+1]==3&&e[e.l]++;var a=parse_ShortXLUnicodeString(e,i,s);return a.charCodeAt(0)==3?a.slice(1):a}function write_MergeCells(e){var i=new_buf(2+e.length*8);i.write_shift(2,e.length);for(var s=0;s<e.length;++s)write_Ref8U(e[s],i);return i}function write_HLink(e){var i=new_buf(24),s=decode_cell(e[0]);i.write_shift(2,s.r),i.write_shift(2,s.r),i.write_shift(2,s.c),i.write_shift(2,s.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),c=0;c<16;++c)i.write_shift(1,parseInt(a[c],16));return bconcat([i,write_Hyperlink(e[1])])}function write_HLinkTooltip(e){var i=e[1].Tooltip,s=new_buf(10+2*(i.length+1));s.write_shift(2,2048);var a=decode_cell(e[0]);s.write_shift(2,a.r),s.write_shift(2,a.r),s.write_shift(2,a.c),s.write_shift(2,a.c);for(var c=0;c<i.length;++c)s.write_shift(2,i.charCodeAt(c));return s.write_shift(2,0),s}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ColInfo(e,i,s){if(!s.cellStyles)return parsenoop(e,i);var a=s&&s.biff>=12?4:2,c=e.read_shift(a),d=e.read_shift(a),h=e.read_shift(a),g=e.read_shift(a),_=e.read_shift(2);a==2&&(e.l+=2);var b={s:c,e:d,w:h,ixfe:g,flags:_};return(s.biff>=5||!s.biff)&&(b.level=_>>8&7),b}function write_ColInfo(e,i){var s=new_buf(12);s.write_shift(2,i),s.write_shift(2,i),s.write_shift(2,e.width*256),s.write_shift(2,0);var a=0;return e.hidden&&(a|=1),s.write_shift(1,a),a=e.level||0,s.write_shift(1,a),s.write_shift(2,0),s}function write_RRTabId(e){for(var i=new_buf(2*e),s=0;s<e;++s)i.write_shift(2,s+1);return i}function write_BIFF2NUM(e,i,s){var a=new_buf(15);return write_BIFF2Cell(a,e,i),a.write_shift(8,s,"f"),a}function write_BIFF2INT(e,i,s){var a=new_buf(9);return write_BIFF2Cell(a,e,i),a.write_shift(2,s),a}var DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},i=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(g,_){var b=[],_e=new_raw_buf(1);switch(_.type){case"base64":_e=s2a(Base64_decode(g));break;case"binary":_e=s2a(g);break;case"buffer":case"array":_e=g;break}prep_blob(_e,0);var nt=_e.read_shift(1),it=!!(nt&136),et=!1,lt=!1;switch(nt){case 2:break;case 3:break;case 48:et=!0,it=!0;break;case 49:et=!0,it=!0;break;case 131:break;case 139:break;case 140:lt=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+nt.toString(16))}var rt=0,at=521;nt==2&&(rt=_e.read_shift(2)),_e.l+=3,nt!=2&&(rt=_e.read_shift(4)),rt>1048576&&(rt=1e6),nt!=2&&(at=_e.read_shift(2));var ot=_e.read_shift(2),st=_.codepage||1252;nt!=2&&(_e.l+=16,_e.read_shift(1),_e[_e.l]!==0&&(st=e[_e[_e.l]]),_e.l+=1,_e.l+=2),lt&&(_e.l+=36);for(var ct=[],mt={},pt=Math.min(_e.length,nt==2?521:at-10-(et?264:0)),Et=lt?32:11;_e.l<pt&&_e[_e.l]!=13;)switch(mt={},mt.name=$cptable.utils.decode(st,_e.slice(_e.l,_e.l+Et)).replace(/[\u0000\r\n].*$/g,""),_e.l+=Et,mt.type=String.fromCharCode(_e.read_shift(1)),nt!=2&&!lt&&(mt.offset=_e.read_shift(4)),mt.len=_e.read_shift(1),nt==2&&(mt.offset=_e.read_shift(2)),mt.dec=_e.read_shift(1),mt.name.length&&ct.push(mt),nt!=2&&(_e.l+=lt?13:14),mt.type){case"B":(!et||mt.len!=8)&&_.WTF&&console.log("Skipping "+mt.name+":"+mt.type);break;case"G":case"P":_.WTF&&console.log("Skipping "+mt.name+":"+mt.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+mt.type)}if(_e[_e.l]!==13&&(_e.l=at-1),_e.read_shift(1)!==13)throw new Error("DBF Terminator not found "+_e.l+" "+_e[_e.l]);_e.l=at;var ut=0,gt=0;for(b[0]=[],gt=0;gt!=ct.length;++gt)b[0][gt]=ct[gt].name;for(;rt-- >0;){if(_e[_e.l]===42){_e.l+=ot;continue}for(++_e.l,b[++ut]=[],gt=0,gt=0;gt!=ct.length;++gt){var xt=_e.slice(_e.l,_e.l+ct[gt].len);_e.l+=ct[gt].len,prep_blob(xt,0);var Pt=$cptable.utils.decode(st,xt);switch(ct[gt].type){case"C":Pt.trim().length&&(b[ut][gt]=Pt.replace(/\s+$/,""));break;case"D":Pt.length===8?b[ut][gt]=new Date(+Pt.slice(0,4),+Pt.slice(4,6)-1,+Pt.slice(6,8)):b[ut][gt]=Pt;break;case"F":b[ut][gt]=parseFloat(Pt.trim());break;case"+":case"I":b[ut][gt]=lt?xt.read_shift(-4,"i")^2147483648:xt.read_shift(4,"i");break;case"L":switch(Pt.trim().toUpperCase()){case"Y":case"T":b[ut][gt]=!0;break;case"N":case"F":b[ut][gt]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Pt+"|")}break;case"M":if(!it)throw new Error("DBF Unexpected MEMO for type "+nt.toString(16));b[ut][gt]="##MEMO##"+(lt?parseInt(Pt.trim(),10):xt.read_shift(4));break;case"N":Pt=Pt.replace(/\u0000/g,"").trim(),Pt&&Pt!="."&&(b[ut][gt]=+Pt||0);break;case"@":b[ut][gt]=new Date(xt.read_shift(-8,"f")-621356832e5);break;case"T":b[ut][gt]=new Date((xt.read_shift(4)-2440588)*864e5+xt.read_shift(4));break;case"Y":b[ut][gt]=xt.read_shift(4,"i")/1e4+xt.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":b[ut][gt]=-xt.read_shift(-8,"f");break;case"B":if(et&&ct[gt].len==8){b[ut][gt]=xt.read_shift(8,"f");break}case"G":case"P":xt.l+=ct[gt].len;break;case"0":if(ct[gt].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+ct[gt].type)}}}if(nt!=2&&_e.l<_e.length&&_e[_e.l++]!=26)throw new Error("DBF EOF Marker missing "+(_e.l-1)+" of "+_e.length+" "+_e[_e.l-1].toString(16));return _&&_.sheetRows&&(b=b.slice(0,_.sheetRows)),_.DBF=ct,b}function a(g,_){var b=_||{};b.dateNF||(b.dateNF="yyyymmdd");var _e=aoa_to_sheet(s(g,b),b);return _e["!cols"]=b.DBF.map(function(nt){return{wch:nt.len,DBF:nt}}),delete b.DBF,_e}function c(g,_){try{return sheet_to_workbook(a(g,_),_)}catch(b){if(_&&_.WTF)throw b}return{SheetNames:[],Sheets:{}}}var d={B:8,C:250,L:1,D:8,"?":0,"":0};function h(g,_){var b=_||{};if(+b.codepage>=0&&set_cp(+b.codepage),b.type=="string")throw new Error("Cannot write DBF to JS string");var _e=buf_array(),nt=sheet_to_json(g,{header:1,raw:!0,cellDates:!0}),it=nt[0],et=nt.slice(1),lt=g["!cols"]||[],rt=0,at=0,ot=0,st=1;for(rt=0;rt<it.length;++rt){if(((lt[rt]||{}).DBF||{}).name){it[rt]=lt[rt].DBF.name,++ot;continue}if(it[rt]!=null){if(++ot,typeof it[rt]=="number"&&(it[rt]=it[rt].toString(10)),typeof it[rt]!="string")throw new Error("DBF Invalid column name "+it[rt]+" |"+typeof it[rt]+"|");if(it.indexOf(it[rt])!==rt){for(at=0;at<1024;++at)if(it.indexOf(it[rt]+"_"+at)==-1){it[rt]+="_"+at;break}}}}var ct=safe_decode_range(g["!ref"]),mt=[],pt=[],Et=[];for(rt=0;rt<=ct.e.c-ct.s.c;++rt){var ut="",gt="",xt=0,Pt=[];for(at=0;at<et.length;++at)et[at][rt]!=null&&Pt.push(et[at][rt]);if(Pt.length==0||it[rt]==null){mt[rt]="?";continue}for(at=0;at<Pt.length;++at){switch(typeof Pt[at]){case"number":gt="B";break;case"string":gt="C";break;case"boolean":gt="L";break;case"object":gt=Pt[at]instanceof Date?"D":"C";break;default:gt="C"}xt=Math.max(xt,String(Pt[at]).length),ut=ut&&ut!=gt?"C":gt}xt>250&&(xt=250),gt=((lt[rt]||{}).DBF||{}).type,gt=="C"&&lt[rt].DBF.len>xt&&(xt=lt[rt].DBF.len),ut=="B"&&gt=="N"&&(ut="N",Et[rt]=lt[rt].DBF.dec,xt=lt[rt].DBF.len),pt[rt]=ut=="C"||gt=="N"?xt:d[ut]||0,st+=pt[rt],mt[rt]=ut}var St=_e.next(32);for(St.write_shift(4,318902576),St.write_shift(4,et.length),St.write_shift(2,296+32*ot),St.write_shift(2,st),rt=0;rt<4;++rt)St.write_shift(4,0);for(St.write_shift(4,0|(+i[current_ansi]||3)<<8),rt=0,at=0;rt<it.length;++rt)if(it[rt]!=null){var Ct=_e.next(32),Lt=(it[rt].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Ct.write_shift(1,Lt,"sbcs"),Ct.write_shift(1,mt[rt]=="?"?"C":mt[rt],"sbcs"),Ct.write_shift(4,at),Ct.write_shift(1,pt[rt]||d[mt[rt]]||0),Ct.write_shift(1,Et[rt]||0),Ct.write_shift(1,2),Ct.write_shift(4,0),Ct.write_shift(1,0),Ct.write_shift(4,0),Ct.write_shift(4,0),at+=pt[rt]||d[mt[rt]]||0}var er=_e.next(264);for(er.write_shift(4,13),rt=0;rt<65;++rt)er.write_shift(4,0);for(rt=0;rt<et.length;++rt){var Kt=_e.next(st);for(Kt.write_shift(1,0),at=0;at<it.length;++at)if(it[at]!=null)switch(mt[at]){case"L":Kt.write_shift(1,et[rt][at]==null?63:et[rt][at]?84:70);break;case"B":Kt.write_shift(8,et[rt][at]||0,"f");break;case"N":var nr="0";for(typeof et[rt][at]=="number"&&(nr=et[rt][at].toFixed(Et[at]||0)),ot=0;ot<pt[at]-nr.length;++ot)Kt.write_shift(1,32);Kt.write_shift(1,nr,"sbcs");break;case"D":et[rt][at]?(Kt.write_shift(4,("0000"+et[rt][at].getFullYear()).slice(-4),"sbcs"),Kt.write_shift(2,("00"+(et[rt][at].getMonth()+1)).slice(-2),"sbcs"),Kt.write_shift(2,("00"+et[rt][at].getDate()).slice(-2),"sbcs")):Kt.write_shift(8,"00000000","sbcs");break;case"C":var Jt=String(et[rt][at]!=null?et[rt][at]:"").slice(0,pt[at]);for(Kt.write_shift(1,Jt,"sbcs"),ot=0;ot<pt[at]-Jt.length;++ot)Kt.write_shift(1,32);break}}return _e.next(1).write_shift(1,26),_e.end()}return{to_workbook:c,to_sheet:a,from_sheet:h}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},i=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(it,et){var lt=e[et];return typeof lt=="number"?_getansi(lt):lt},a=function(it,et,lt){var rt=et.charCodeAt(0)-32<<4|lt.charCodeAt(0)-48;return rt==59?it:_getansi(rt)};e["|"]=254;function c(it,et){switch(et.type){case"base64":return d(Base64_decode(it),et);case"binary":return d(it,et);case"buffer":return d(has_buf&&Buffer.isBuffer(it)?it.toString("binary"):a2s(it),et);case"array":return d(cc2str(it),et)}throw new Error("Unrecognized type "+et.type)}function d(it,et){var lt=it.split(/[\n\r]+/),rt=-1,at=-1,ot=0,st=0,ct=[],mt=[],pt=null,Et={},ut=[],gt=[],xt=[],Pt=0,St;for(+et.codepage>=0&&set_cp(+et.codepage);ot!==lt.length;++ot){Pt=0;var Ct=lt[ot].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(i,s),Lt=Ct.replace(/;;/g,"\0").split(";").map(function(Tt){return Tt.replace(/\u0000/g,";")}),er=Lt[0],Kt;if(Ct.length>0)switch(er){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Lt[1].charAt(0)=="P"&&mt.push(Ct.slice(3).replace(/;;/g,";"));break;case"C":var nr=!1,Jt=!1,qt=!1,kt=!1,Xt=-1,sr=-1;for(st=1;st<Lt.length;++st)switch(Lt[st].charAt(0)){case"A":break;case"X":at=parseInt(Lt[st].slice(1))-1,Jt=!0;break;case"Y":for(rt=parseInt(Lt[st].slice(1))-1,Jt||(at=0),St=ct.length;St<=rt;++St)ct[St]=[];break;case"K":Kt=Lt[st].slice(1),Kt.charAt(0)==='"'?Kt=Kt.slice(1,Kt.length-1):Kt==="TRUE"?Kt=!0:Kt==="FALSE"?Kt=!1:isNaN(fuzzynum(Kt))?isNaN(fuzzydate(Kt).getDate())||(Kt=parseDate(Kt)):(Kt=fuzzynum(Kt),pt!==null&&fmt_is_date(pt)&&(Kt=numdate(Kt))),nr=!0;break;case"E":kt=!0;var At=rc_to_a1(Lt[st].slice(1),{r:rt,c:at});ct[rt][at]=[ct[rt][at],At];break;case"S":qt=!0,ct[rt][at]=[ct[rt][at],"S5S"];break;case"G":break;case"R":Xt=parseInt(Lt[st].slice(1))-1;break;case"C":sr=parseInt(Lt[st].slice(1))-1;break;default:if(et&&et.WTF)throw new Error("SYLK bad record "+Ct)}if(nr&&(ct[rt][at]&&ct[rt][at].length==2?ct[rt][at][0]=Kt:ct[rt][at]=Kt,pt=null),qt){if(kt)throw new Error("SYLK shared formula cannot have own formula");var ht=Xt>-1&&ct[Xt][sr];if(!ht||!ht[1])throw new Error("SYLK shared formula cannot find base");ct[rt][at][1]=shift_formula_str(ht[1],{r:rt-Xt,c:at-sr})}break;case"F":var dt=0;for(st=1;st<Lt.length;++st)switch(Lt[st].charAt(0)){case"X":at=parseInt(Lt[st].slice(1))-1,++dt;break;case"Y":for(rt=parseInt(Lt[st].slice(1))-1,St=ct.length;St<=rt;++St)ct[St]=[];break;case"M":Pt=parseInt(Lt[st].slice(1))/20;break;case"F":break;case"G":break;case"P":pt=mt[parseInt(Lt[st].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(xt=Lt[st].slice(1).split(" "),St=parseInt(xt[0],10);St<=parseInt(xt[1],10);++St)Pt=parseInt(xt[2],10),gt[St-1]=Pt===0?{hidden:!0}:{wch:Pt},process_col(gt[St-1]);break;case"C":at=parseInt(Lt[st].slice(1))-1,gt[at]||(gt[at]={});break;case"R":rt=parseInt(Lt[st].slice(1))-1,ut[rt]||(ut[rt]={}),Pt>0?(ut[rt].hpt=Pt,ut[rt].hpx=pt2px(Pt)):Pt===0&&(ut[rt].hidden=!0);break;default:if(et&&et.WTF)throw new Error("SYLK bad record "+Ct)}dt<1&&(pt=null);break;default:if(et&&et.WTF)throw new Error("SYLK bad record "+Ct)}}return ut.length>0&&(Et["!rows"]=ut),gt.length>0&&(Et["!cols"]=gt),et&&et.sheetRows&&(ct=ct.slice(0,et.sheetRows)),[ct,Et]}function h(it,et){var lt=c(it,et),rt=lt[0],at=lt[1],ot=aoa_to_sheet(rt,et);return keys(at).forEach(function(st){ot[st]=at[st]}),ot}function g(it,et){return sheet_to_workbook(h(it,et),et)}function _(it,et,lt,rt){var at="C;Y"+(lt+1)+";X"+(rt+1)+";K";switch(it.t){case"n":at+=it.v||0,it.f&&!it.F&&(at+=";E"+a1_to_rc(it.f,{r:lt,c:rt}));break;case"b":at+=it.v?"TRUE":"FALSE";break;case"e":at+=it.w||it.v;break;case"d":at+='"'+(it.w||it.v)+'"';break;case"s":at+='"'+it.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return at}function b(it,et){et.forEach(function(lt,rt){var at="F;W"+(rt+1)+" "+(rt+1)+" ";lt.hidden?at+="0":(typeof lt.width=="number"&&!lt.wpx&&(lt.wpx=width2px(lt.width)),typeof lt.wpx=="number"&&!lt.wch&&(lt.wch=px2char(lt.wpx)),typeof lt.wch=="number"&&(at+=Math.round(lt.wch))),at.charAt(at.length-1)!=" "&&it.push(at)})}function _e(it,et){et.forEach(function(lt,rt){var at="F;";lt.hidden?at+="M0;":lt.hpt?at+="M"+20*lt.hpt+";":lt.hpx&&(at+="M"+20*px2pt(lt.hpx)+";"),at.length>2&&it.push(at+"R"+(rt+1))})}function nt(it,et){var lt=["ID;PWXL;N;E"],rt=[],at=safe_decode_range(it["!ref"]),ot,st=Array.isArray(it),ct=`\r
`;lt.push("P;PGeneral"),lt.push("F;P0;DG0G8;M255"),it["!cols"]&&b(lt,it["!cols"]),it["!rows"]&&_e(lt,it["!rows"]),lt.push("B;Y"+(at.e.r-at.s.r+1)+";X"+(at.e.c-at.s.c+1)+";D"+[at.s.c,at.s.r,at.e.c,at.e.r].join(" "));for(var mt=at.s.r;mt<=at.e.r;++mt)for(var pt=at.s.c;pt<=at.e.c;++pt){var Et=encode_cell({r:mt,c:pt});ot=st?(it[mt]||[])[pt]:it[Et],!(!ot||ot.v==null&&(!ot.f||ot.F))&&rt.push(_(ot,it,mt,pt))}return lt.join(ct)+ct+rt.join(ct)+ct+"E"+ct}return{to_workbook:g,to_sheet:h,from_sheet:nt}}(),DIF=function(){function e(d,h){switch(h.type){case"base64":return i(Base64_decode(d),h);case"binary":return i(d,h);case"buffer":return i(has_buf&&Buffer.isBuffer(d)?d.toString("binary"):a2s(d),h);case"array":return i(cc2str(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){for(var g=d.split(`
`),_=-1,b=-1,_e=0,nt=[];_e!==g.length;++_e){if(g[_e].trim()==="BOT"){nt[++_]=[],b=0;continue}if(!(_<0)){var it=g[_e].trim().split(","),et=it[0],lt=it[1];++_e;for(var rt=g[_e]||"";(rt.match(/["]/g)||[]).length&1&&_e<g.length-1;)rt+=`
`+g[++_e];switch(rt=rt.trim(),+et){case-1:if(rt==="BOT"){nt[++_]=[],b=0;continue}else if(rt!=="EOD")throw new Error("Unrecognized DIF special command "+rt);break;case 0:rt==="TRUE"?nt[_][b]=!0:rt==="FALSE"?nt[_][b]=!1:isNaN(fuzzynum(lt))?isNaN(fuzzydate(lt).getDate())?nt[_][b]=lt:nt[_][b]=parseDate(lt):nt[_][b]=fuzzynum(lt),++b;break;case 1:rt=rt.slice(1,rt.length-1),rt=rt.replace(/""/g,'"'),rt&&rt.match(/^=".*"$/)&&(rt=rt.slice(2,-1)),nt[_][b++]=rt!==""?rt:null;break}if(rt==="EOD")break}}return h&&h.sheetRows&&(nt=nt.slice(0,h.sheetRows)),nt}function s(d,h){return aoa_to_sheet(e(d,h),h)}function a(d,h){return sheet_to_workbook(s(d,h),h)}var c=function(){var d=function(_,b,_e,nt,it){_.push(b),_.push(_e+","+nt),_.push('"'+it.replace(/"/g,'""')+'"')},h=function(_,b,_e,nt){_.push(b+","+_e),_.push(b==1?'"'+nt.replace(/"/g,'""')+'"':nt)};return function(_){var b=[],_e=safe_decode_range(_["!ref"]),nt,it=Array.isArray(_);d(b,"TABLE",0,1,"sheetjs"),d(b,"VECTORS",0,_e.e.r-_e.s.r+1,""),d(b,"TUPLES",0,_e.e.c-_e.s.c+1,""),d(b,"DATA",0,0,"");for(var et=_e.s.r;et<=_e.e.r;++et){h(b,-1,0,"BOT");for(var lt=_e.s.c;lt<=_e.e.c;++lt){var rt=encode_cell({r:et,c:lt});if(nt=it?(_[et]||[])[lt]:_[rt],!nt){h(b,1,0,"");continue}switch(nt.t){case"n":var at=nt.w;!at&&nt.v!=null&&(at=nt.v),at==null?nt.f&&!nt.F?h(b,1,0,"="+nt.f):h(b,1,0,""):h(b,0,at,"V");break;case"b":h(b,0,nt.v?1:0,nt.v?"TRUE":"FALSE");break;case"s":h(b,1,0,isNaN(nt.v)?nt.v:'="'+nt.v+'"');break;case"d":nt.w||(nt.w=SSF_format(nt.z||table_fmt[14],datenum(parseDate(nt.v)))),h(b,0,nt.w,"V");break;default:h(b,1,0,"")}}}h(b,-1,0,"EOD");var ot=`\r
`,st=b.join(ot);return st}}();return{to_workbook:a,to_sheet:s,from_sheet:c}}(),ETH=function(){function e(nt){return nt.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function i(nt){return nt.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(nt,it){for(var et=nt.split(`
`),lt=-1,rt=-1,at=0,ot=[];at!==et.length;++at){var st=et[at].trim().split(":");if(st[0]==="cell"){var ct=decode_cell(st[1]);if(ot.length<=ct.r)for(lt=ot.length;lt<=ct.r;++lt)ot[lt]||(ot[lt]=[]);switch(lt=ct.r,rt=ct.c,st[2]){case"t":ot[lt][rt]=e(st[3]);break;case"v":ot[lt][rt]=+st[3];break;case"vtf":var mt=st[st.length-1];case"vtc":switch(st[3]){case"nl":ot[lt][rt]=!!+st[4];break;default:ot[lt][rt]=+st[4];break}st[2]=="vtf"&&(ot[lt][rt]=[ot[lt][rt],mt])}}}return it&&it.sheetRows&&(ot=ot.slice(0,it.sheetRows)),ot}function a(nt,it){return aoa_to_sheet(s(nt,it),it)}function c(nt,it){return sheet_to_workbook(a(nt,it),it)}var d=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),h=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,g=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),_="--SocialCalcSpreadsheetControlSave--";function b(nt){if(!nt||!nt["!ref"])return"";for(var it=[],et=[],lt,rt="",at=decode_range(nt["!ref"]),ot=Array.isArray(nt),st=at.s.r;st<=at.e.r;++st)for(var ct=at.s.c;ct<=at.e.c;++ct)if(rt=encode_cell({r:st,c:ct}),lt=ot?(nt[st]||[])[ct]:nt[rt],!(!lt||lt.v==null||lt.t==="z")){switch(et=["cell",rt,"t"],lt.t){case"s":case"str":et.push(i(lt.v));break;case"n":lt.f?(et[2]="vtf",et[3]="n",et[4]=lt.v,et[5]=i(lt.f)):(et[2]="v",et[3]=lt.v);break;case"b":et[2]="vt"+(lt.f?"f":"c"),et[3]="nl",et[4]=lt.v?"1":"0",et[5]=i(lt.f||(lt.v?"TRUE":"FALSE"));break;case"d":var mt=datenum(parseDate(lt.v));et[2]="vtc",et[3]="nd",et[4]=""+mt,et[5]=lt.w||SSF_format(lt.z||table_fmt[14],mt);break;case"e":continue}it.push(et.join(":"))}return it.push("sheet:c:"+(at.e.c-at.s.c+1)+":r:"+(at.e.r-at.s.r+1)+":tvf:1"),it.push("valueformat:1:text-wiki"),it.join(`
`)}function _e(nt){return[d,h,g,h,b(nt),_].join(`
`)}return{to_workbook:c,to_sheet:a,from_sheet:_e}}(),PRN=function(){function e(_e,nt,it,et,lt){lt.raw?nt[it][et]=_e:_e===""||(_e==="TRUE"?nt[it][et]=!0:_e==="FALSE"?nt[it][et]=!1:isNaN(fuzzynum(_e))?isNaN(fuzzydate(_e).getDate())?nt[it][et]=_e:nt[it][et]=parseDate(_e):nt[it][et]=fuzzynum(_e))}function i(_e,nt){var it=nt||{},et=[];if(!_e||_e.length===0)return et;for(var lt=_e.split(/[\r\n]/),rt=lt.length-1;rt>=0&&lt[rt].length===0;)--rt;for(var at=10,ot=0,st=0;st<=rt;++st)ot=lt[st].indexOf(" "),ot==-1?ot=lt[st].length:ot++,at=Math.max(at,ot);for(st=0;st<=rt;++st){et[st]=[];var ct=0;for(e(lt[st].slice(0,at).trim(),et,st,ct,it),ct=1;ct<=(lt[st].length-at)/10+1;++ct)e(lt[st].slice(at+(ct-1)*10,at+ct*10).trim(),et,st,ct,it)}return it.sheetRows&&(et=et.slice(0,it.sheetRows)),et}var s={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function c(_e){for(var nt={},it=!1,et=0,lt=0;et<_e.length;++et)(lt=_e.charCodeAt(et))==34?it=!it:!it&&lt in s&&(nt[lt]=(nt[lt]||0)+1);lt=[];for(et in nt)Object.prototype.hasOwnProperty.call(nt,et)&&lt.push([nt[et],et]);if(!lt.length){nt=a;for(et in nt)Object.prototype.hasOwnProperty.call(nt,et)&&lt.push([nt[et],et])}return lt.sort(function(rt,at){return rt[0]-at[0]||a[rt[1]]-a[at[1]]}),s[lt.pop()[1]]||44}function d(_e,nt){var it=nt||{},et="",lt=it.dense?[]:{},rt={s:{c:0,r:0},e:{c:0,r:0}};_e.slice(0,4)=="sep="?_e.charCodeAt(5)==13&&_e.charCodeAt(6)==10?(et=_e.charAt(4),_e=_e.slice(7)):_e.charCodeAt(5)==13||_e.charCodeAt(5)==10?(et=_e.charAt(4),_e=_e.slice(6)):et=c(_e.slice(0,1024)):it&&it.FS?et=it.FS:et=c(_e.slice(0,1024));var at=0,ot=0,st=0,ct=0,mt=0,pt=et.charCodeAt(0),Et=!1,ut=0,gt=_e.charCodeAt(0);_e=_e.replace(/\r\n/mg,`
`);var xt=it.dateNF!=null?dateNF_regex(it.dateNF):null;function Pt(){var St=_e.slice(ct,mt),Ct={};if(St.charAt(0)=='"'&&St.charAt(St.length-1)=='"'&&(St=St.slice(1,-1).replace(/""/g,'"')),St.length===0)Ct.t="z";else if(it.raw)Ct.t="s",Ct.v=St;else if(St.trim().length===0)Ct.t="s",Ct.v=St;else if(St.charCodeAt(0)==61)St.charCodeAt(1)==34&&St.charCodeAt(St.length-1)==34?(Ct.t="s",Ct.v=St.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(St)?(Ct.t="n",Ct.f=St.slice(1)):(Ct.t="s",Ct.v=St);else if(St=="TRUE")Ct.t="b",Ct.v=!0;else if(St=="FALSE")Ct.t="b",Ct.v=!1;else if(!isNaN(st=fuzzynum(St)))Ct.t="n",it.cellText!==!1&&(Ct.w=St),Ct.v=st;else if(!isNaN(fuzzydate(St).getDate())||xt&&St.match(xt)){Ct.z=it.dateNF||table_fmt[14];var Lt=0;xt&&St.match(xt)&&(St=dateNF_fix(St,it.dateNF,St.match(xt)||[]),Lt=1),it.cellDates?(Ct.t="d",Ct.v=parseDate(St,Lt)):(Ct.t="n",Ct.v=datenum(parseDate(St,Lt))),it.cellText!==!1&&(Ct.w=SSF_format(Ct.z,Ct.v instanceof Date?datenum(Ct.v):Ct.v)),it.cellNF||delete Ct.z}else Ct.t="s",Ct.v=St;if(Ct.t=="z"||(it.dense?(lt[at]||(lt[at]=[]),lt[at][ot]=Ct):lt[encode_cell({c:ot,r:at})]=Ct),ct=mt+1,gt=_e.charCodeAt(ct),rt.e.c<ot&&(rt.e.c=ot),rt.e.r<at&&(rt.e.r=at),ut==pt)++ot;else if(ot=0,++at,it.sheetRows&&it.sheetRows<=at)return!0}e:for(;mt<_e.length;++mt)switch(ut=_e.charCodeAt(mt)){case 34:gt===34&&(Et=!Et);break;case pt:case 10:case 13:if(!Et&&Pt())break e;break}return mt-ct>0&&Pt(),lt["!ref"]=encode_range(rt),lt}function h(_e,nt){return!(nt&&nt.PRN)||nt.FS||_e.slice(0,4)=="sep="||_e.indexOf("	")>=0||_e.indexOf(",")>=0||_e.indexOf(";")>=0?d(_e,nt):aoa_to_sheet(i(_e,nt),nt)}function g(_e,nt){var it="",et=nt.type=="string"?[0,0,0,0]:firstbyte(_e,nt);switch(nt.type){case"base64":it=Base64_decode(_e);break;case"binary":it=_e;break;case"buffer":nt.codepage==65001?it=_e.toString("utf8"):nt.codepage&&typeof $cptable<"u"?it=$cptable.utils.decode(nt.codepage,_e):it=has_buf&&Buffer.isBuffer(_e)?_e.toString("binary"):a2s(_e);break;case"array":it=cc2str(_e);break;case"string":it=_e;break;default:throw new Error("Unrecognized type "+nt.type)}return et[0]==239&&et[1]==187&&et[2]==191?it=utf8read(it.slice(3)):nt.type!="string"&&nt.type!="buffer"&&nt.codepage==65001?it=utf8read(it):nt.type=="binary"&&typeof $cptable<"u"&&nt.codepage&&(it=$cptable.utils.decode(nt.codepage,$cptable.utils.encode(28591,it))),it.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(nt.type=="string"?it:utf8read(it),nt):h(it,nt)}function _(_e,nt){return sheet_to_workbook(g(_e,nt),nt)}function b(_e){for(var nt=[],it=safe_decode_range(_e["!ref"]),et,lt=Array.isArray(_e),rt=it.s.r;rt<=it.e.r;++rt){for(var at=[],ot=it.s.c;ot<=it.e.c;++ot){var st=encode_cell({r:rt,c:ot});if(et=lt?(_e[rt]||[])[ot]:_e[st],!et||et.v==null){at.push("          ");continue}for(var ct=(et.w||(format_cell(et),et.w)||"").slice(0,10);ct.length<10;)ct+=" ";at.push(ct+(ot===0?" ":""))}nt.push(at.join(""))}return nt.join(`
`)}return{to_workbook:_,to_sheet:g,from_sheet:b}}(),WK_=function(){function e(At,ht,dt){if(At){prep_blob(At,At.l||0);for(var Tt=dt.Enum||Xt;At.l<At.length;){var Mt=At.read_shift(2),It=Tt[Mt]||Tt[65535],Ut=At.read_shift(2),Zt=At.l+Ut,rr=It.f&&It.f(At,Ut,dt);if(At.l=Zt,ht(rr,It,Mt))return}}}function i(At,ht){switch(ht.type){case"base64":return s(s2a(Base64_decode(At)),ht);case"binary":return s(s2a(At),ht);case"buffer":case"array":return s(At,ht)}throw"Unsupported type "+ht.type}function s(At,ht){if(!At)return At;var dt=ht||{},Tt=dt.dense?[]:{},Mt="Sheet1",It="",Ut=0,Zt={},rr=[],_r=[],pr={s:{r:0,c:0},e:{r:0,c:0}},Ar=dt.sheetRows||0;if(At[2]==0&&(At[3]==8||At[3]==9)&&At.length>=16&&At[14]==5&&At[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(At[2]==2)dt.Enum=Xt,e(At,function(ir,Bt,Qt){switch(Qt){case 0:dt.vers=ir,ir>=4096&&(dt.qpro=!0);break;case 6:pr=ir;break;case 204:ir&&(It=ir);break;case 222:It=ir;break;case 15:case 51:dt.qpro||(ir[1].v=ir[1].v.slice(1));case 13:case 14:case 16:Qt==14&&(ir[2]&112)==112&&(ir[2]&15)>1&&(ir[2]&15)<15&&(ir[1].z=dt.dateNF||table_fmt[14],dt.cellDates&&(ir[1].t="d",ir[1].v=numdate(ir[1].v))),dt.qpro&&ir[3]>Ut&&(Tt["!ref"]=encode_range(pr),Zt[Mt]=Tt,rr.push(Mt),Tt=dt.dense?[]:{},pr={s:{r:0,c:0},e:{r:0,c:0}},Ut=ir[3],Mt=It||"Sheet"+(Ut+1),It="");var fr=dt.dense?(Tt[ir[0].r]||[])[ir[0].c]:Tt[encode_cell(ir[0])];if(fr){fr.t=ir[1].t,fr.v=ir[1].v,ir[1].z!=null&&(fr.z=ir[1].z),ir[1].f!=null&&(fr.f=ir[1].f);break}dt.dense?(Tt[ir[0].r]||(Tt[ir[0].r]=[]),Tt[ir[0].r][ir[0].c]=ir[1]):Tt[encode_cell(ir[0])]=ir[1];break}},dt);else if(At[2]==26||At[2]==14)dt.Enum=sr,At[2]==14&&(dt.qpro=!0,At.l=0),e(At,function(ir,Bt,Qt){switch(Qt){case 204:Mt=ir;break;case 22:ir[1].v=ir[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ir[3]>Ut&&(Tt["!ref"]=encode_range(pr),Zt[Mt]=Tt,rr.push(Mt),Tt=dt.dense?[]:{},pr={s:{r:0,c:0},e:{r:0,c:0}},Ut=ir[3],Mt="Sheet"+(Ut+1)),Ar>0&&ir[0].r>=Ar)break;dt.dense?(Tt[ir[0].r]||(Tt[ir[0].r]=[]),Tt[ir[0].r][ir[0].c]=ir[1]):Tt[encode_cell(ir[0])]=ir[1],pr.e.c<ir[0].c&&(pr.e.c=ir[0].c),pr.e.r<ir[0].r&&(pr.e.r=ir[0].r);break;case 27:ir[14e3]&&(_r[ir[14e3][0]]=ir[14e3][1]);break;case 1537:_r[ir[0]]=ir[1],ir[0]==Ut&&(Mt=ir[1]);break}},dt);else throw new Error("Unrecognized LOTUS BOF "+At[2]);if(Tt["!ref"]=encode_range(pr),Zt[It||Mt]=Tt,rr.push(It||Mt),!_r.length)return{SheetNames:rr,Sheets:Zt};for(var Sr={},Fr=[],ur=0;ur<_r.length;++ur)Zt[rr[ur]]?(Fr.push(_r[ur]||rr[ur]),Sr[_r[ur]]=Zt[_r[ur]]||Zt[rr[ur]]):(Fr.push(_r[ur]),Sr[_r[ur]]={"!ref":"A1"});return{SheetNames:Fr,Sheets:Sr}}function a(At,ht){var dt=ht||{};if(+dt.codepage>=0&&set_cp(+dt.codepage),dt.type=="string")throw new Error("Cannot write WK1 to JS string");var Tt=buf_array(),Mt=safe_decode_range(At["!ref"]),It=Array.isArray(At),Ut=[];write_biff_rec(Tt,0,d(1030)),write_biff_rec(Tt,6,_(Mt));for(var Zt=Math.min(Mt.e.r,8191),rr=Mt.s.r;rr<=Zt;++rr)for(var _r=encode_row(rr),pr=Mt.s.c;pr<=Mt.e.c;++pr){rr===Mt.s.r&&(Ut[pr]=encode_col(pr));var Ar=Ut[pr]+_r,Sr=It?(At[rr]||[])[pr]:At[Ar];if(!(!Sr||Sr.t=="z"))if(Sr.t=="n")(Sr.v|0)==Sr.v&&Sr.v>=-32768&&Sr.v<=32767?write_biff_rec(Tt,13,et(rr,pr,Sr.v)):write_biff_rec(Tt,14,rt(rr,pr,Sr.v));else{var Fr=format_cell(Sr);write_biff_rec(Tt,15,nt(rr,pr,Fr.slice(0,239)))}}return write_biff_rec(Tt,1),Tt.end()}function c(At,ht){var dt=ht||{};if(+dt.codepage>=0&&set_cp(+dt.codepage),dt.type=="string")throw new Error("Cannot write WK3 to JS string");var Tt=buf_array();write_biff_rec(Tt,0,h(At));for(var Mt=0,It=0;Mt<At.SheetNames.length;++Mt)(At.Sheets[At.SheetNames[Mt]]||{})["!ref"]&&write_biff_rec(Tt,27,kt(At.SheetNames[Mt],It++));var Ut=0;for(Mt=0;Mt<At.SheetNames.length;++Mt){var Zt=At.Sheets[At.SheetNames[Mt]];if(!(!Zt||!Zt["!ref"])){for(var rr=safe_decode_range(Zt["!ref"]),_r=Array.isArray(Zt),pr=[],Ar=Math.min(rr.e.r,8191),Sr=rr.s.r;Sr<=Ar;++Sr)for(var Fr=encode_row(Sr),ur=rr.s.c;ur<=rr.e.c;++ur){Sr===rr.s.r&&(pr[ur]=encode_col(ur));var ir=pr[ur]+Fr,Bt=_r?(Zt[Sr]||[])[ur]:Zt[ir];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")write_biff_rec(Tt,23,Pt(Sr,ur,Ut,Bt.v));else{var Qt=format_cell(Bt);write_biff_rec(Tt,22,ut(Sr,ur,Ut,Qt.slice(0,239)))}}++Ut}}return write_biff_rec(Tt,1),Tt.end()}function d(At){var ht=new_buf(2);return ht.write_shift(2,At),ht}function h(At){var ht=new_buf(26);ht.write_shift(2,4096),ht.write_shift(2,4),ht.write_shift(4,0);for(var dt=0,Tt=0,Mt=0,It=0;It<At.SheetNames.length;++It){var Ut=At.SheetNames[It],Zt=At.Sheets[Ut];if(!(!Zt||!Zt["!ref"])){++Mt;var rr=decode_range(Zt["!ref"]);dt<rr.e.r&&(dt=rr.e.r),Tt<rr.e.c&&(Tt=rr.e.c)}}return dt>8191&&(dt=8191),ht.write_shift(2,dt),ht.write_shift(1,Mt),ht.write_shift(1,Tt),ht.write_shift(2,0),ht.write_shift(2,0),ht.write_shift(1,1),ht.write_shift(1,2),ht.write_shift(4,0),ht.write_shift(4,0),ht}function g(At,ht,dt){var Tt={s:{c:0,r:0},e:{c:0,r:0}};return ht==8&&dt.qpro?(Tt.s.c=At.read_shift(1),At.l++,Tt.s.r=At.read_shift(2),Tt.e.c=At.read_shift(1),At.l++,Tt.e.r=At.read_shift(2),Tt):(Tt.s.c=At.read_shift(2),Tt.s.r=At.read_shift(2),ht==12&&dt.qpro&&(At.l+=2),Tt.e.c=At.read_shift(2),Tt.e.r=At.read_shift(2),ht==12&&dt.qpro&&(At.l+=2),Tt.s.c==65535&&(Tt.s.c=Tt.e.c=Tt.s.r=Tt.e.r=0),Tt)}function _(At){var ht=new_buf(8);return ht.write_shift(2,At.s.c),ht.write_shift(2,At.s.r),ht.write_shift(2,At.e.c),ht.write_shift(2,At.e.r),ht}function b(At,ht,dt){var Tt=[{c:0,r:0},{t:"n",v:0},0,0];return dt.qpro&&dt.vers!=20768?(Tt[0].c=At.read_shift(1),Tt[3]=At.read_shift(1),Tt[0].r=At.read_shift(2),At.l+=2):(Tt[2]=At.read_shift(1),Tt[0].c=At.read_shift(2),Tt[0].r=At.read_shift(2)),Tt}function _e(At,ht,dt){var Tt=At.l+ht,Mt=b(At,ht,dt);if(Mt[1].t="s",dt.vers==20768){At.l++;var It=At.read_shift(1);return Mt[1].v=At.read_shift(It,"utf8"),Mt}return dt.qpro&&At.l++,Mt[1].v=At.read_shift(Tt-At.l,"cstr"),Mt}function nt(At,ht,dt){var Tt=new_buf(7+dt.length);Tt.write_shift(1,255),Tt.write_shift(2,ht),Tt.write_shift(2,At),Tt.write_shift(1,39);for(var Mt=0;Mt<Tt.length;++Mt){var It=dt.charCodeAt(Mt);Tt.write_shift(1,It>=128?95:It)}return Tt.write_shift(1,0),Tt}function it(At,ht,dt){var Tt=b(At,ht,dt);return Tt[1].v=At.read_shift(2,"i"),Tt}function et(At,ht,dt){var Tt=new_buf(7);return Tt.write_shift(1,255),Tt.write_shift(2,ht),Tt.write_shift(2,At),Tt.write_shift(2,dt,"i"),Tt}function lt(At,ht,dt){var Tt=b(At,ht,dt);return Tt[1].v=At.read_shift(8,"f"),Tt}function rt(At,ht,dt){var Tt=new_buf(13);return Tt.write_shift(1,255),Tt.write_shift(2,ht),Tt.write_shift(2,At),Tt.write_shift(8,dt,"f"),Tt}function at(At,ht,dt){var Tt=At.l+ht,Mt=b(At,ht,dt);if(Mt[1].v=At.read_shift(8,"f"),dt.qpro)At.l=Tt;else{var It=At.read_shift(2);mt(At.slice(At.l,At.l+It),Mt),At.l+=It}return Mt}function ot(At,ht,dt){var Tt=ht&32768;return ht&=-32769,ht=(Tt?At:0)+(ht>=8192?ht-16384:ht),(Tt?"":"$")+(dt?encode_col(ht):encode_row(ht))}var st={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},ct=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function mt(At,ht){prep_blob(At,0);for(var dt=[],Tt=0,Mt="",It="",Ut="",Zt="";At.l<At.length;){var rr=At[At.l++];switch(rr){case 0:dt.push(At.read_shift(8,"f"));break;case 1:It=ot(ht[0].c,At.read_shift(2),!0),Mt=ot(ht[0].r,At.read_shift(2),!1),dt.push(It+Mt);break;case 2:{var _r=ot(ht[0].c,At.read_shift(2),!0),pr=ot(ht[0].r,At.read_shift(2),!1);It=ot(ht[0].c,At.read_shift(2),!0),Mt=ot(ht[0].r,At.read_shift(2),!1),dt.push(_r+pr+":"+It+Mt)}break;case 3:if(At.l<At.length){console.error("WK1 premature formula end");return}break;case 4:dt.push("("+dt.pop()+")");break;case 5:dt.push(At.read_shift(2));break;case 6:{for(var Ar="";rr=At[At.l++];)Ar+=String.fromCharCode(rr);dt.push('"'+Ar.replace(/"/g,'""')+'"')}break;case 8:dt.push("-"+dt.pop());break;case 23:dt.push("+"+dt.pop());break;case 22:dt.push("NOT("+dt.pop()+")");break;case 20:case 21:Zt=dt.pop(),Ut=dt.pop(),dt.push(["AND","OR"][rr-20]+"("+Ut+","+Zt+")");break;default:if(rr<32&&ct[rr])Zt=dt.pop(),Ut=dt.pop(),dt.push(Ut+ct[rr]+Zt);else if(st[rr]){if(Tt=st[rr][1],Tt==69&&(Tt=At[At.l++]),Tt>dt.length){console.error("WK1 bad formula parse 0x"+rr.toString(16)+":|"+dt.join("|")+"|");return}var Sr=dt.slice(-Tt);dt.length-=Tt,dt.push(st[rr][0]+"("+Sr.join(",")+")")}else return rr<=7?console.error("WK1 invalid opcode "+rr.toString(16)):rr<=24?console.error("WK1 unsupported op "+rr.toString(16)):rr<=30?console.error("WK1 invalid opcode "+rr.toString(16)):rr<=115?console.error("WK1 unsupported function opcode "+rr.toString(16)):console.error("WK1 unrecognized opcode "+rr.toString(16))}}dt.length==1?ht[1].f=""+dt[0]:console.error("WK1 bad formula parse |"+dt.join("|")+"|")}function pt(At){var ht=[{c:0,r:0},{t:"n",v:0},0];return ht[0].r=At.read_shift(2),ht[3]=At[At.l++],ht[0].c=At[At.l++],ht}function Et(At,ht){var dt=pt(At);return dt[1].t="s",dt[1].v=At.read_shift(ht-4,"cstr"),dt}function ut(At,ht,dt,Tt){var Mt=new_buf(6+Tt.length);Mt.write_shift(2,At),Mt.write_shift(1,dt),Mt.write_shift(1,ht),Mt.write_shift(1,39);for(var It=0;It<Tt.length;++It){var Ut=Tt.charCodeAt(It);Mt.write_shift(1,Ut>=128?95:Ut)}return Mt.write_shift(1,0),Mt}function gt(At,ht){var dt=pt(At);dt[1].v=At.read_shift(2);var Tt=dt[1].v>>1;if(dt[1].v&1)switch(Tt&7){case 0:Tt=(Tt>>3)*5e3;break;case 1:Tt=(Tt>>3)*500;break;case 2:Tt=(Tt>>3)/20;break;case 3:Tt=(Tt>>3)/200;break;case 4:Tt=(Tt>>3)/2e3;break;case 5:Tt=(Tt>>3)/2e4;break;case 6:Tt=(Tt>>3)/16;break;case 7:Tt=(Tt>>3)/64;break}return dt[1].v=Tt,dt}function xt(At,ht){var dt=pt(At),Tt=At.read_shift(4),Mt=At.read_shift(4),It=At.read_shift(2);if(It==65535)return Tt===0&&Mt===3221225472?(dt[1].t="e",dt[1].v=15):Tt===0&&Mt===3489660928?(dt[1].t="e",dt[1].v=42):dt[1].v=0,dt;var Ut=It&32768;return It=(It&32767)-16446,dt[1].v=(1-Ut*2)*(Mt*Math.pow(2,It+32)+Tt*Math.pow(2,It)),dt}function Pt(At,ht,dt,Tt){var Mt=new_buf(14);if(Mt.write_shift(2,At),Mt.write_shift(1,dt),Mt.write_shift(1,ht),Tt==0)return Mt.write_shift(4,0),Mt.write_shift(4,0),Mt.write_shift(2,65535),Mt;var It=0,Ut=0,Zt=0,rr=0;return Tt<0&&(It=1,Tt=-Tt),Ut=Math.log2(Tt)|0,Tt/=Math.pow(2,Ut-31),rr=Tt>>>0,rr&2147483648||(Tt/=2,++Ut,rr=Tt>>>0),Tt-=rr,rr|=2147483648,rr>>>=0,Tt*=Math.pow(2,32),Zt=Tt>>>0,Mt.write_shift(4,Zt),Mt.write_shift(4,rr),Ut+=16383+(It?32768:0),Mt.write_shift(2,Ut),Mt}function St(At,ht){var dt=xt(At);return At.l+=ht-14,dt}function Ct(At,ht){var dt=pt(At),Tt=At.read_shift(4);return dt[1].v=Tt>>6,dt}function Lt(At,ht){var dt=pt(At),Tt=At.read_shift(8,"f");return dt[1].v=Tt,dt}function er(At,ht){var dt=Lt(At);return At.l+=ht-10,dt}function Kt(At,ht){return At[At.l+ht-1]==0?At.read_shift(ht,"cstr"):""}function nr(At,ht){var dt=At[At.l++];dt>ht-1&&(dt=ht-1);for(var Tt="";Tt.length<dt;)Tt+=String.fromCharCode(At[At.l++]);return Tt}function Jt(At,ht,dt){if(!(!dt.qpro||ht<21)){var Tt=At.read_shift(1);At.l+=17,At.l+=1,At.l+=2;var Mt=At.read_shift(ht-21,"cstr");return[Tt,Mt]}}function qt(At,ht){for(var dt={},Tt=At.l+ht;At.l<Tt;){var Mt=At.read_shift(2);if(Mt==14e3){for(dt[Mt]=[0,""],dt[Mt][0]=At.read_shift(2);At[At.l];)dt[Mt][1]+=String.fromCharCode(At[At.l]),At.l++;At.l++}}return dt}function kt(At,ht){var dt=new_buf(5+At.length);dt.write_shift(2,14e3),dt.write_shift(2,ht);for(var Tt=0;Tt<At.length;++Tt){var Mt=At.charCodeAt(Tt);dt[dt.l++]=Mt>127?95:Mt}return dt[dt.l++]=0,dt}var Xt={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:g},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:it},14:{n:"NUMBER",f:lt},15:{n:"LABEL",f:_e},16:{n:"FORMULA",f:at},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:_e},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Kt},222:{n:"SHEETNAMELP",f:nr},65535:{n:""}},sr={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Et},23:{n:"NUMBER17",f:xt},24:{n:"NUMBER18",f:gt},25:{n:"FORMULA19",f:St},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:qt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Ct},38:{n:"??"},39:{n:"NUMBER27",f:Lt},40:{n:"FORMULA28",f:er},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Kt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Jt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:c,to_workbook:i}}(),straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,i){if(!i.bookSST)return"";var s=[XML_HEADER];s[s.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var c=e[a],d="<si>";c.r?d+=c.r:(d+="<t",c.t||(c.t=""),c.t.match(straywsregex)&&(d+=' xml:space="preserve"'),d+=">"+escapexml(c.t)+"</t>"),d+="</si>",s[s.length]=d}return s.length>2&&(s[s.length]="</sst>",s[1]=s[1].replace("/>",">")),s.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function write_BrtBeginSst(e,i){return i||(i=new_buf(8)),i.write_shift(4,e.Count),i.write_shift(4,e.Unique),i}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var i=buf_array();write_record(i,159,write_BrtBeginSst(e));for(var s=0;s<e.length;++s)write_record(i,19,write_BrtSSTItem(e[s]));return write_record(i,160),i.end()}function _JS2ANSI(e){for(var i=[],s=e.split(""),a=0;a<s.length;++a)i[a]=s[a].charCodeAt(0);return i}function crypto_CreatePasswordVerifier_Method1(e){var i=0,s,a=_JS2ANSI(e),c=a.length+1,d,h,g,_,b;for(s=new_raw_buf(c),s[0]=a.length,d=1;d!=c;++d)s[d]=a[d-1];for(d=c-1;d>=0;--d)h=s[d],g=i&16384?1:0,_=i<<1&32767,b=g|_,i=b^h;return i^52811}var RTF=function(){function e(c,d){switch(d.type){case"base64":return i(Base64_decode(c),d);case"binary":return i(c,d);case"buffer":return i(has_buf&&Buffer.isBuffer(c)?c.toString("binary"):a2s(c),d);case"array":return i(cc2str(c),d)}throw new Error("Unrecognized type "+d.type)}function i(c,d){var h=d||{},g=h.dense?[]:{},_=c.match(/\\trowd.*?\\row\b/g);if(!_.length)throw new Error("RTF missing table");var b={s:{c:0,r:0},e:{c:0,r:_.length-1}};return _.forEach(function(_e,nt){Array.isArray(g)&&(g[nt]=[]);for(var it=/\\\w+\b/g,et=0,lt,rt=-1;lt=it.exec(_e);){switch(lt[0]){case"\\cell":var at=_e.slice(et,it.lastIndex-lt[0].length);if(at[0]==" "&&(at=at.slice(1)),++rt,at.length){var ot={v:at,t:"s"};Array.isArray(g)?g[nt][rt]=ot:g[encode_cell({r:nt,c:rt})]=ot}break}et=it.lastIndex}rt>b.e.c&&(b.e.c=rt)}),g["!ref"]=encode_range(b),g}function s(c,d){return sheet_to_workbook(e(c,d),d)}function a(c){for(var d=["{\\rtf1\\ansi"],h=safe_decode_range(c["!ref"]),g,_=Array.isArray(c),b=h.s.r;b<=h.e.r;++b){d.push("\\trowd\\trautofit1");for(var _e=h.s.c;_e<=h.e.c;++_e)d.push("\\cellx"+(_e+1));for(d.push("\\pard\\intbl"),_e=h.s.c;_e<=h.e.c;++_e){var nt=encode_cell({r:b,c:_e});g=_?(c[b]||[])[_e]:c[nt],!(!g||g.v==null&&(!g.f||g.F))&&(d.push(" "+(g.w||(format_cell(g),g.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}return{to_workbook:s,to_sheet:e,from_sheet:a}}();function rgb2Hex(e){for(var i=0,s=1;i!=3;++i)s=s*256+(e[i]>255?255:e[i]<0?0:e[i]);return s.toString(16).toUpperCase().slice(1)}var DEF_MDW=6,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}function write_numFmts(e){var i=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)e[a]!=null&&(i[i.length]=writextag("numFmt",null,{numFmtId:a,formatCode:escapexml(e[a])}))}),i.length===1?"":(i[i.length]="</numFmts>",i[0]=writextag("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join(""))}function write_cellXfs(e){var i=[];return i[i.length]=writextag("cellXfs",null),e.forEach(function(s){i[i.length]=writextag("xf",null,s)}),i[i.length]="</cellXfs>",i.length===2?"":(i[0]=writextag("cellXfs",null,{count:i.length-2}).replace("/>",">"),i.join(""))}function write_sty_xml(e,i){var s=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],a;return e.SSF&&(a=write_numFmts(e.SSF))!=null&&(s[s.length]=a),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=write_cellXfs(i.cellXfs))&&(s[s.length]=a),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',s.length>2&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function parse_BrtFmt(e,i){var s=e.read_shift(2),a=parse_XLWideString(e);return[s,a]}function write_BrtFmt(e,i,s){s||(s=new_buf(6+4*i.length)),s.write_shift(2,e),write_XLWideString(i,s);var a=s.length>s.l?s.slice(0,s.l):s;return s.l==null&&(s.l=s.length),a}function parse_BrtFont(e,i,s){var a={};a.sz=e.read_shift(2)/20;var c=parse_FontFlags(e);c.fItalic&&(a.italic=1),c.fCondense&&(a.condense=1),c.fExtend&&(a.extend=1),c.fShadow&&(a.shadow=1),c.fOutline&&(a.outline=1),c.fStrikeout&&(a.strike=1);var d=e.read_shift(2);switch(d===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var h=e.read_shift(1);h!=0&&(a.underline=h);var g=e.read_shift(1);g>0&&(a.family=g);var _=e.read_shift(1);switch(_>0&&(a.charset=_),e.l++,a.color=parse_BrtColor(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=parse_XLWideString(e),a}function write_BrtFont(e,i){i||(i=new_buf(25+4*32)),i.write_shift(2,e.sz*20),write_FontFlags(e,i),i.write_shift(2,e.bold?700:400);var s=0;e.vertAlign=="superscript"?s=1:e.vertAlign=="subscript"&&(s=2),i.write_shift(2,s),i.write_shift(1,e.underline||0),i.write_shift(1,e.family||0),i.write_shift(1,e.charset||0),i.write_shift(1,0),write_BrtColor(e.color,i);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),i.write_shift(1,a),write_XLWideString(e.name,i),i.length>i.l?i.slice(0,i.l):i}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,i){i||(i=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var s=rev_XLSBFillPTNames[e.patternType];s==null&&(s=40),i.write_shift(4,s);var a=0;if(s!=40)for(write_BrtColor({auto:1},i),write_BrtColor({auto:1},i);a<12;++a)i.write_shift(4,0);else{for(;a<4;++a)i.write_shift(4,0);for(;a<12;++a)i.write_shift(4,0)}return i.length>i.l?i.slice(0,i.l):i}function parse_BrtXF(e,i){var s=e.l+i,a=e.read_shift(2),c=e.read_shift(2);return e.l=s,{ixfe:a,numFmtId:c}}function write_BrtXF(e,i,s){s||(s=new_buf(16)),s.write_shift(2,i||0),s.write_shift(2,e.numFmtId||0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);var a=0;return s.write_shift(1,a),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s}function write_Blxf(e,i){return i||(i=new_buf(10)),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(4,0),i}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,i){return i||(i=new_buf(51)),i.write_shift(1,0),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),i.length>i.l?i.slice(0,i.l):i}function write_BrtStyle(e,i){return i||(i=new_buf(12+4*10)),i.write_shift(4,e.xfId),i.write_shift(2,1),i.write_shift(1,+e.builtinId),i.write_shift(1,0),write_XLNullableWideString(e.name||"",i),i.length>i.l?i.slice(0,i.l):i}function write_BrtBeginTableStyles(e,i,s){var a=new_buf(2052);return a.write_shift(4,e),write_XLNullableWideString(i,a),write_XLNullableWideString(s,a),a.length>a.l?a.slice(0,a.l):a}function write_FMTS_bin(e,i){if(i){var s=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var c=a[0];c<=a[1];++c)i[c]!=null&&++s}),s!=0&&(write_record(e,615,write_UInt32LE(s)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var c=a[0];c<=a[1];++c)i[c]!=null&&write_record(e,44,write_BrtFmt(c,i[c]))}),write_record(e,616))}}function write_FONTS_bin(e){var i=1;write_record(e,611,write_UInt32LE(i)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),write_record(e,612)}function write_FILLS_bin(e){var i=2;write_record(e,603,write_UInt32LE(i)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var i=1;write_record(e,613,write_UInt32LE(i)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var i=1;write_record(e,626,write_UInt32LE(i)),write_record(e,47,write_BrtXF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,i){write_record(e,617,write_UInt32LE(i.length)),i.forEach(function(s){write_record(e,47,write_BrtXF(s,0))}),write_record(e,618)}function write_STYLES_bin(e){var i=1;write_record(e,619,write_UInt32LE(i)),write_record(e,48,write_BrtStyle({xfId:0,builtinId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var i=0;write_record(e,505,write_UInt32LE(i)),write_record(e,506)}function write_TABLESTYLES_bin(e){var i=0;write_record(e,508,write_BrtBeginTableStyles(i,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,i){var s=buf_array();return write_record(s,278),write_FMTS_bin(s,e.SSF),write_FONTS_bin(s),write_FILLS_bin(s),write_BORDERS_bin(s),write_CELLSTYLEXFS_bin(s),write_CELLXFS_bin(s,i.cellXfs),write_STYLES_bin(s),write_DXFS_bin(s),write_TABLESTYLES_bin(s),write_record(s,279),s.end()}function write_theme(e,i){if(i&&i.themeXLSX)return i.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var s=[XML_HEADER];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function parse_BrtMdtinfo(e,i){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var i=new_buf(12+2*e.name.length);return i.write_shift(4,e.flags),i.write_shift(4,e.version),write_XLWideString(e.name,i),i.slice(0,i.l)}function parse_BrtMdb(e){for(var i=[],s=e.read_shift(4);s-- >0;)i.push([e.read_shift(4),e.read_shift(4)]);return i}function write_BrtMdb(e){var i=new_buf(4+8*e.length);i.write_shift(4,e.length);for(var s=0;s<e.length;++s)i.write_shift(4,e[s][0]),i.write_shift(4,e[s][1]);return i}function write_BrtBeginEsfmd(e,i){var s=new_buf(8+2*i.length);return s.write_shift(4,e),write_XLWideString(i,s),s.slice(0,s.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,i){var s=new_buf(8);return s.write_shift(4,e),s.write_shift(4,1),s}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_BrtCalcChainItem$(e){var i={};i.i=e.read_shift(4);var s={};s.r=e.read_shift(4),s.c=e.read_shift(4),i.r=encode_cell(s);var a=e.read_shift(1);return a&2&&(i.l="1"),a&8&&(i.a="1"),i}var _shapeid=1024;function write_comments_vml(e,i){for(var s=[21600,21600],a=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),c=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:s.join(","),path:a})];_shapeid<e*1e3;)_shapeid+=1e3;return i.forEach(function(d){var h=decode_cell(d[0]),g={color2:"#BEFF82",type:"gradient"};g.type=="gradient"&&(g.angle="-180");var _=g.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,b=writextag("v:fill",_,g),_e={on:"t",obscured:"t"};++_shapeid,c=c.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(d[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",b,writextag("v:shadow",null,_e),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[h.c+1,0,h.r+1,0,h.c+3,20,h.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(h.r)),writetag("x:Column",String(h.c)),d[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),c.push("</xml>"),c.join("")}function write_comments_xml(e){var i=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],s=[];return i.push("<authors>"),e.forEach(function(a){a[1].forEach(function(c){var d=escapexml(c.a);s.indexOf(d)==-1&&(s.push(d),i.push("<author>"+d+"</author>")),c.T&&c.ID&&s.indexOf("tc="+c.ID)==-1&&(s.push("tc="+c.ID),i.push("<author>tc="+c.ID+"</author>"))})}),s.length==0&&(s.push("SheetJ5"),i.push("<author>SheetJ5</author>")),i.push("</authors>"),i.push("<commentList>"),e.forEach(function(a){var c=0,d=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?c=s.indexOf("tc="+a[1][0].ID):a[1].forEach(function(_){_.a&&(c=s.indexOf(escapexml(_.a))),d.push(_.t||"")}),i.push('<comment ref="'+a[0]+'" authorId="'+c+'"><text>'),d.length<=1)i.push(writetag("t",escapexml(d[0]||"")));else{for(var h=`Comment:
    `+d[0]+`
`,g=1;g<d.length;++g)h+=`Reply:
    `+d[g]+`
`;i.push(writetag("t",escapexml(h)))}i.push("</text></comment>")}),i.push("</commentList>"),i.length>2&&(i[i.length]="</comments>",i[1]=i[1].replace("/>",">")),i.join("")}function write_tcmnt_xml(e,i,s){var a=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(c){var d="";(c[1]||[]).forEach(function(h,g){if(!h.T){delete h.ID;return}h.a&&i.indexOf(h.a)==-1&&i.push(h.a);var _={ref:c[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"};g==0?d=_.id:_.parentId=d,h.ID=_.id,h.a&&(_.personId="{54EE7950-7262-4200-6969-"+("000000000000"+i.indexOf(h.a)).slice(-12)+"}"),a.push(writextag("threadedComment",writetag("text",h.t||""),_))})}),a.push("</ThreadedComments>"),a.join("")}function write_people_xml(e){var i=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(s,a){i.push(writextag("person",null,{displayName:s,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:s,providerId:"None"}))}),i.push("</personList>"),i.join("")}function parse_BrtBeginComment(e){var i={};i.iauthor=e.read_shift(4);var s=parse_UncheckedRfX(e);return i.rfx=s.s,i.ref=encode_cell(s.s),e.l+=16,i}function write_BrtBeginComment(e,i){return i==null&&(i=new_buf(36)),i.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],i),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function write_comments_bin(e){var i=buf_array(),s=[];return write_record(i,628),write_record(i,630),e.forEach(function(a){a[1].forEach(function(c){s.indexOf(c.a)>-1||(s.push(c.a.slice(0,54)),write_record(i,632,write_BrtCommentAuthor(c.a)))})}),write_record(i,631),write_record(i,633),e.forEach(function(a){a[1].forEach(function(c){c.iauthor=s.indexOf(c.a);var d={s:decode_cell(a[0]),e:decode_cell(a[0])};write_record(i,635,write_BrtBeginComment([d,c])),c.t&&c.t.length>0&&write_record(i,637,write_BrtCommentText(c)),write_record(i,636),delete c.iauthor})}),write_record(i,634),write_record(i,629),i.end()}function fill_vba_xls(e,i){i.FullPaths.forEach(function(s,a){if(a!=0){var c=s.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");c.slice(-1)!=="/"&&CFB.utils.cfb_add(e,c,i.FileIndex[a].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"],rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,i={r:0,c:0};function s(a,c,d,h){var g=!1,_=!1;d.length==0?_=!0:d.charAt(0)=="["&&(_=!0,d=d.slice(1,-1)),h.length==0?g=!0:h.charAt(0)=="["&&(g=!0,h=h.slice(1,-1));var b=d.length>0?parseInt(d,10)|0:0,_e=h.length>0?parseInt(h,10)|0:0;return g?_e+=i.c:--_e,_?b+=i.r:--b,c+(g?"":"$")+encode_col(_e)+(_?"":"$")+encode_row(b)}return function(c,d){return i=d,c.replace(e,s)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(i,s){return i.replace(crefregex,function(a,c,d,h,g,_){var b=decode_col(h)-(d?0:s.c),_e=decode_row(_)-(g?0:s.r),nt=_e==0?"":g?_e+1:"["+_e+"]",it=b==0?"":d?b+1:"["+b+"]";return c+"R"+nt+"C"+it})}}();function shift_formula_str(e,i){return e.replace(crefregex,function(s,a,c,d,h,g){return a+(c=="$"?c+d:encode_col(decode_col(d)+i.c))+(h=="$"?h+g:encode_row(decode_row(g)+i.r))})}function fuzzyfmla(e){return e.length!=1}function parseread1(e){e.l+=1}function parse_ColRelU(e,i){var s=e.read_shift(2);return[s&16383,s>>14&1,s>>15&1]}function parse_RgceArea(e,i,s){var a=2;if(s){if(s.biff>=2&&s.biff<=5)return parse_RgceArea_BIFF2(e);s.biff==12&&(a=4)}var c=e.read_shift(a),d=e.read_shift(a),h=parse_ColRelU(e),g=parse_ColRelU(e);return{s:{r:c,c:h[0],cRel:h[1],rRel:h[2]},e:{r:d,c:g[0],cRel:g[1],rRel:g[2]}}}function parse_RgceArea_BIFF2(e){var i=parse_ColRelU(e),s=parse_ColRelU(e),a=e.read_shift(1),c=e.read_shift(1);return{s:{r:i[0],c:a,cRel:i[1],rRel:i[2]},e:{r:s[0],c,cRel:s[1],rRel:s[2]}}}function parse_RgceAreaRel(e,i,s){if(s.biff<8)return parse_RgceArea_BIFF2(e);var a=e.read_shift(s.biff==12?4:2),c=e.read_shift(s.biff==12?4:2),d=parse_ColRelU(e),h=parse_ColRelU(e);return{s:{r:a,c:d[0],cRel:d[1],rRel:d[2]},e:{r:c,c:h[0],cRel:h[1],rRel:h[2]}}}function parse_RgceLoc(e,i,s){if(s&&s.biff>=2&&s.biff<=5)return parse_RgceLoc_BIFF2(e);var a=e.read_shift(s&&s.biff==12?4:2),c=parse_ColRelU(e);return{r:a,c:c[0],cRel:c[1],rRel:c[2]}}function parse_RgceLoc_BIFF2(e){var i=parse_ColRelU(e),s=e.read_shift(1);return{r:i[0],c:s,cRel:i[1],rRel:i[2]}}function parse_RgceElfLoc(e){var i=e.read_shift(2),s=e.read_shift(2);return{r:i,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function parse_RgceLocRel(e,i,s){var a=s&&s.biff?s.biff:8;if(a>=2&&a<=5)return parse_RgceLocRel_BIFF2(e);var c=e.read_shift(a>=12?4:2),d=e.read_shift(2),h=(d&16384)>>14,g=(d&32768)>>15;if(d&=16383,g==1)for(;c>524287;)c-=1048576;if(h==1)for(;d>8191;)d=d-16384;return{r:c,c:d,cRel:h,rRel:g}}function parse_RgceLocRel_BIFF2(e){var i=e.read_shift(2),s=e.read_shift(1),a=(i&32768)>>15,c=(i&16384)>>14;return i&=16383,a==1&&i>=8192&&(i=i-16384),c==1&&s>=128&&(s=s-256),{r:i,c:s,cRel:c,rRel:a}}function parse_PtgArea(e,i,s){var a=(e[e.l++]&96)>>5,c=parse_RgceArea(e,s.biff>=2&&s.biff<=5?6:8,s);return[a,c]}function parse_PtgArea3d(e,i,s){var a=(e[e.l++]&96)>>5,c=e.read_shift(2,"i"),d=8;if(s)switch(s.biff){case 5:e.l+=12,d=6;break;case 12:d=12;break}var h=parse_RgceArea(e,d,s);return[a,c,h]}function parse_PtgAreaErr(e,i,s){var a=(e[e.l++]&96)>>5;return e.l+=s&&s.biff>8?12:s.biff<8?6:8,[a]}function parse_PtgAreaErr3d(e,i,s){var a=(e[e.l++]&96)>>5,c=e.read_shift(2),d=8;if(s)switch(s.biff){case 5:e.l+=12,d=6;break;case 12:d=12;break}return e.l+=d,[a,c]}function parse_PtgAreaN(e,i,s){var a=(e[e.l++]&96)>>5,c=parse_RgceAreaRel(e,i-1,s);return[a,c]}function parse_PtgArray(e,i,s){var a=(e[e.l++]&96)>>5;return e.l+=s.biff==2?6:s.biff==12?14:7,[a]}function parse_PtgAttrBaxcel(e){var i=e[e.l+1]&1,s=1;return e.l+=4,[i,s]}function parse_PtgAttrChoose(e,i,s){e.l+=2;for(var a=e.read_shift(s&&s.biff==2?1:2),c=[],d=0;d<=a;++d)c.push(e.read_shift(s&&s.biff==2?1:2));return c}function parse_PtgAttrGoto(e,i,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function parse_PtgAttrIf(e,i,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function parse_PtgAttrIfError(e){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(2)]}function parse_PtgAttrSemi(e,i,s){var a=e[e.l+1]&255?1:0;return e.l+=s&&s.biff==2?3:4,[a]}function parse_PtgAttrSpaceType(e){var i=e.read_shift(1),s=e.read_shift(1);return[i,s]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var c=parse_RgceLoc(e,0,s);return[a,c]}function parse_PtgRefN(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var c=parse_RgceLocRel(e,0,s);return[a,c]}function parse_PtgRef3d(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var c=e.read_shift(2);s&&s.biff==5&&(e.l+=12);var d=parse_RgceLoc(e,0,s);return[a,c,d]}function parse_PtgFunc(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var c=e.read_shift(s&&s.biff<=3?1:2);return[FtabArgc[c],Ftab[c],a]}function parse_PtgFuncVar(e,i,s){var a=e[e.l++],c=e.read_shift(1),d=s&&s.biff<=3?[a==88?-1:0,e.read_shift(1)]:parsetab(e);return[c,(d[0]===0?Ftab:Cetab)[d[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,i,s){e.l+=s&&s.biff==2?3:4}function parse_PtgExp(e,i,s){if(e.l++,s&&s.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),c=e.read_shift(s&&s.biff==2?1:2);return[a,c]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,i,s){return e.l++,parse_ShortXLUnicodeString(e,i-1,s)}function parse_SerAr(e,i){var s=[e.read_shift(1)];if(i==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=parsebool(e,1)?"TRUE":"FALSE",i!=12&&(e.l+=7);break;case 37:case 16:s[1]=BErr[e[e.l]],e.l+=i==12?4:8;break;case 0:e.l+=8;break;case 1:s[1]=parse_Xnum(e);break;case 2:s[1]=parse_XLUnicodeString2(e,0,{biff:i>0&&i<8?2:i});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function parse_PtgExtraMem(e,i,s){for(var a=e.read_shift(s.biff==12?4:2),c=[],d=0;d!=a;++d)c.push((s.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return c}function parse_PtgExtraArray(e,i,s){var a=0,c=0;s.biff==12?(a=e.read_shift(4),c=e.read_shift(4)):(c=1+e.read_shift(1),a=1+e.read_shift(2)),s.biff>=2&&s.biff<8&&(--a,--c==0&&(c=256));for(var d=0,h=[];d!=a&&(h[d]=[]);++d)for(var g=0;g!=c;++g)h[d][g]=parse_SerAr(e,s.biff);return h}function parse_PtgName(e,i,s){var a=e.read_shift(1)>>>5&3,c=!s||s.biff>=8?4:2,d=e.read_shift(c);switch(s.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,d]}function parse_PtgNameX(e,i,s){if(s.biff==5)return parse_PtgNameX_BIFF5(e);var a=e.read_shift(1)>>>5&3,c=e.read_shift(2),d=e.read_shift(4);return[a,c,d]}function parse_PtgNameX_BIFF5(e){var i=e.read_shift(1)>>>5&3,s=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[i,s,a]}function parse_PtgMemArea(e,i,s){var a=e.read_shift(1)>>>5&3;e.l+=s&&s.biff==2?3:4;var c=e.read_shift(s&&s.biff==2?1:2);return[a,c]}function parse_PtgMemFunc(e,i,s){var a=e.read_shift(1)>>>5&3,c=e.read_shift(s&&s.biff==2?1:2);return[a,c]}function parse_PtgRefErr(e,i,s){var a=e.read_shift(1)>>>5&3;return e.l+=4,s.biff<8&&e.l--,s.biff==12&&(e.l+=2),[a]}function parse_PtgRefErr3d(e,i,s){var a=(e[e.l++]&96)>>5,c=e.read_shift(2),d=4;if(s)switch(s.biff){case 5:d=15;break;case 12:d=6;break}return e.l+=d,[a,c]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,i,s){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(4),c=e.read_shift(2),d=e.read_shift(2),h=PtgListRT[s>>2&31];return{ixti:i,coltype:s&3,rt:h,idx:a,c,C:d}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,i,s){return e.l+=5,e.l+=2,e.l+=s.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,i,s){return e.l+=s.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var i=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[i,s]}function parse_PtgMemNoMemN(e){var i=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[i,s]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,i,s,a){if(a.biff<8)return parsenoop(e,i);for(var c=e.l+i,d=[],h=0;h!==s.length;++h)switch(s[h][0]){case"PtgArray":s[h][1]=parse_PtgExtraArray(e,0,a),d.push(s[h][1]);break;case"PtgMemArea":s[h][2]=parse_PtgExtraMem(e,s[h][1],a),d.push(s[h][2]);break;case"PtgExp":a&&a.biff==12&&(s[h][1][1]=e.read_shift(4),d.push(s[h][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[h][0]}return i=c-e.l,i!==0&&d.push(parsenoop(e,i)),d}function parse_Rgce(e,i,s){for(var a=e.l+i,c,d,h=[];a!=e.l;)i=a-e.l,d=e[e.l],c=PtgTypes[d]||PtgTypes[PtgDupes[d]],(d===24||d===25)&&(c=(d===24?Ptg18:Ptg19)[e[e.l+1]]),!c||!c.f?parsenoop(e,i):h.push([c.n,c.f(e,i,s)]);return h}function stringify_array(e){for(var i=[],s=0;s<e.length;++s){for(var a=e[s],c=[],d=0;d<a.length;++d){var h=a[d];if(h)switch(h[0]){case 2:c.push('"'+h[1].replace(/"/g,'""')+'"');break;default:c.push(h[1])}else c.push("")}i.push(c.join(","))}return i.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,i){if(!e&&!(i&&i.biff<=5&&i.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,i,s){if(!e)return"SH33TJSERR0";if(s.biff>8&&(!e.XTI||!e.XTI[i]))return e.SheetNames[i];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[i];if(s.biff<8)return i>1e4&&(i-=65536),i<0&&(i=-i),i==0?"":e.XTI[i-1];if(!a)return"SH33TJSERR1";var c="";if(s.biff>8)switch(e[a[0]][0]){case 357:return c=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?c:c+":"+e.SheetNames[a[2]];case 358:return s.SID!=null?e.SheetNames[s.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return c=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?c:c+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(d){return d.Name}).join(";;");default:return e[a[0]][0][3]?(c=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?c:c+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function get_ixti(e,i,s){var a=get_ixti_raw(e,i,s);return a=="#REF"?a:formula_quote_sheet_name(a,s)}function stringify_formula(e,i,s,a,c){var d=c&&c.biff||8,h={s:{c:0,r:0},e:{c:0,r:0}},g=[],_,b,_e,nt=0,it=0,et,lt="";if(!e[0]||!e[0][0])return"";for(var rt=-1,at="",ot=0,st=e[0].length;ot<st;++ot){var ct=e[0][ot];switch(ct[0]){case"PtgUminus":g.push("-"+g.pop());break;case"PtgUplus":g.push("+"+g.pop());break;case"PtgPercent":g.push(g.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(_=g.pop(),b=g.pop(),rt>=0){switch(e[0][rt][1][0]){case 0:at=fill(" ",e[0][rt][1][1]);break;case 1:at=fill("\r",e[0][rt][1][1]);break;default:if(at="",c.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][rt][1][0])}b=b+at,rt=-1}g.push(b+PtgBinOp[ct[0]]+_);break;case"PtgIsect":_=g.pop(),b=g.pop(),g.push(b+" "+_);break;case"PtgUnion":_=g.pop(),b=g.pop(),g.push(b+","+_);break;case"PtgRange":_=g.pop(),b=g.pop(),g.push(b+":"+_);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":_e=shift_cell_xls(ct[1][1],h,c),g.push(encode_cell_xls(_e,d));break;case"PtgRefN":_e=s?shift_cell_xls(ct[1][1],s,c):ct[1][1],g.push(encode_cell_xls(_e,d));break;case"PtgRef3d":nt=ct[1][1],_e=shift_cell_xls(ct[1][2],h,c),lt=get_ixti(a,nt,c),g.push(lt+"!"+encode_cell_xls(_e,d));break;case"PtgFunc":case"PtgFuncVar":var mt=ct[1][0],pt=ct[1][1];mt||(mt=0),mt&=127;var Et=mt==0?[]:g.slice(-mt);g.length-=mt,pt==="User"&&(pt=Et.shift()),g.push(pt+"("+Et.join(",")+")");break;case"PtgBool":g.push(ct[1]?"TRUE":"FALSE");break;case"PtgInt":g.push(ct[1]);break;case"PtgNum":g.push(String(ct[1]));break;case"PtgStr":g.push('"'+ct[1].replace(/"/g,'""')+'"');break;case"PtgErr":g.push(ct[1]);break;case"PtgAreaN":et=shift_range_xls(ct[1][1],s?{s}:h,c),g.push(encode_range_xls(et,c));break;case"PtgArea":et=shift_range_xls(ct[1][1],h,c),g.push(encode_range_xls(et,c));break;case"PtgArea3d":nt=ct[1][1],et=ct[1][2],lt=get_ixti(a,nt,c),g.push(lt+"!"+encode_range_xls(et,c));break;case"PtgAttrSum":g.push("SUM("+g.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":it=ct[1][2];var ut=(a.names||[])[it-1]||(a[0]||[])[it],gt=ut?ut.Name:"SH33TJSNAME"+String(it);gt&&gt.slice(0,6)=="_xlfn."&&!c.xlfn&&(gt=gt.slice(6)),g.push(gt);break;case"PtgNameX":var xt=ct[1][1];it=ct[1][2];var Pt;if(c.biff<=5)xt<0&&(xt=-xt),a[xt]&&(Pt=a[xt][it]);else{var St="";if(((a[xt]||[])[0]||[])[0]==14849||(((a[xt]||[])[0]||[])[0]==1025?a[xt][it]&&a[xt][it].itab>0&&(St=a.SheetNames[a[xt][it].itab-1]+"!"):St=a.SheetNames[it-1]+"!"),a[xt]&&a[xt][it])St+=a[xt][it].Name;else if(a[0]&&a[0][it])St+=a[0][it].Name;else{var Ct=(get_ixti_raw(a,xt,c)||"").split(";;");Ct[it-1]?St=Ct[it-1]:St+="SH33TJSERRX"}g.push(St);break}Pt||(Pt={Name:"SH33TJSERRY"}),g.push(Pt.Name);break;case"PtgParen":var Lt="(",er=")";if(rt>=0){switch(at="",e[0][rt][1][0]){case 2:Lt=fill(" ",e[0][rt][1][1])+Lt;break;case 3:Lt=fill("\r",e[0][rt][1][1])+Lt;break;case 4:er=fill(" ",e[0][rt][1][1])+er;break;case 5:er=fill("\r",e[0][rt][1][1])+er;break;default:if(c.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][rt][1][0])}rt=-1}g.push(Lt+g.pop()+er);break;case"PtgRefErr":g.push("#REF!");break;case"PtgRefErr3d":g.push("#REF!");break;case"PtgExp":_e={c:ct[1][1],r:ct[1][0]};var Kt={c:s.c,r:s.r};if(a.sharedf[encode_cell(_e)]){var nr=a.sharedf[encode_cell(_e)];g.push(stringify_formula(nr,h,Kt,a,c))}else{var Jt=!1;for(_=0;_!=a.arrayf.length;++_)if(b=a.arrayf[_],!(_e.c<b[0].s.c||_e.c>b[0].e.c)&&!(_e.r<b[0].s.r||_e.r>b[0].e.r)){g.push(stringify_formula(b[1],h,Kt,a,c)),Jt=!0;break}Jt||g.push(ct[1])}break;case"PtgArray":g.push("{"+stringify_array(ct[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":rt=ot;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":g.push("");break;case"PtgAreaErr":g.push("#REF!");break;case"PtgAreaErr3d":g.push("#REF!");break;case"PtgList":g.push("Table"+ct[1].idx+"[#"+ct[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(ct));default:throw new Error("Unrecognized Formula Token: "+String(ct))}var qt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(c.biff!=3&&rt>=0&&qt.indexOf(e[0][ot][0])==-1){ct=e[0][rt];var kt=!0;switch(ct[1][0]){case 4:kt=!1;case 0:at=fill(" ",ct[1][1]);break;case 5:kt=!1;case 1:at=fill("\r",ct[1][1]);break;default:if(at="",c.WTF)throw new Error("Unexpected PtgAttrSpaceType "+ct[1][0])}g.push((kt?at:"")+g.pop()+(kt?"":at)),rt=-1}}if(g.length>1&&c.WTF)throw new Error("bad formula stack");return g[0]}function write_FormulaValue(e){if(e==null){var i=new_buf(8);return i.write_shift(1,3),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,65535),i}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function write_Formula(e,i,s,a,c){var d=write_XLSCell(i,s,c),h=write_FormulaValue(e.v),g=new_buf(6),_=33;g.write_shift(2,_),g.write_shift(4,0);for(var b=new_buf(e.bf.length),_e=0;_e<e.bf.length;++_e)b[_e]=e.bf[_e];var nt=bconcat([d,h,g,b]);return nt}function parse_XLSBParsedFormula(e,i,s){var a=e.read_shift(4),c=parse_Rgce(e,a,s),d=e.read_shift(4),h=d>0?parse_RgbExtra(e,d,c,s):null;return[c,h]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function csf_to_ods_formula(e){var i="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return i.replace(/;/g,"|").replace(/,/g,";")}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var browser_has_Map=typeof Map<"u";function get_sst_id(e,i,s){var a=0,c=e.length;if(s){if(browser_has_Map?s.has(i):Object.prototype.hasOwnProperty.call(s,i)){for(var d=browser_has_Map?s.get(i):s[i];a<d.length;++a)if(e[d[a]].t===i)return e.Count++,d[a]}}else for(;a<c;++a)if(e[a].t===i)return e.Count++,a;return e[c]={t:i},e.Count++,e.Unique++,s&&(browser_has_Map?(s.has(i)||s.set(i,[]),s.get(i).push(c)):(Object.prototype.hasOwnProperty.call(s,i)||(s[i]=[]),s[i].push(c))),c}function col_obj_w(e,i){var s={min:e+1,max:e+1},a=-1;return i.MDW&&(MDW=i.MDW),i.width!=null?s.customWidth=1:i.wpx!=null?a=px2char(i.wpx):i.wch!=null&&(a=i.wch),a>-1?(s.width=char2width(a),s.customWidth=1):i.width!=null&&(s.width=i.width),i.hidden&&(s.hidden=!0),i.level!=null&&(s.outlineLevel=s.level=i.level),s}function default_margins(e,i){if(e){var s=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=s[0]),e.right==null&&(e.right=s[1]),e.top==null&&(e.top=s[2]),e.bottom==null&&(e.bottom=s[3]),e.header==null&&(e.header=s[4]),e.footer==null&&(e.footer=s[5])}}function get_cell_style(e,i,s){var a=s.revssf[i.z!=null?i.z:"General"],c=60,d=e.length;if(a==null&&s.ssf){for(;c<392;++c)if(s.ssf[c]==null){SSF_load(i.z,c),s.ssf[c]=i.z,s.revssf[i.z]=a=c;break}}for(c=0;c!=d;++c)if(e[c].numFmtId===a)return c;return e[d]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},d}function check_ws(e,i,s){if(e&&e["!ref"]){var a=safe_decode_range(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+s+"): "+e["!ref"])}}function write_ws_xml_merges(e){if(e.length===0)return"";for(var i='<mergeCells count="'+e.length+'">',s=0;s!=e.length;++s)i+='<mergeCell ref="'+encode_range(e[s])+'"/>';return i+"</mergeCells>"}function write_ws_xml_sheetpr(e,i,s,a,c){var d=!1,h={},g=null;if(a.bookType!=="xlsx"&&i.vbaraw){var _=i.SheetNames[s];try{i.Workbook&&(_=i.Workbook.Sheets[s].CodeName||_)}catch{}d=!0,h.codeName=utf8write(escapexml(_))}if(e&&e["!outline"]){var b={summaryBelow:1,summaryRight:1};e["!outline"].above&&(b.summaryBelow=0),e["!outline"].left&&(b.summaryRight=0),g=(g||"")+writextag("outlinePr",null,b)}!d&&!g||(c[c.length]=writextag("sheetPr",g,h))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var i={sheet:1};return sheetprot_deffalse.forEach(function(s){e[s]!=null&&e[s]&&(i[s]="1")}),sheetprot_deftrue.forEach(function(s){e[s]!=null&&!e[s]&&(i[s]="0")}),e.password&&(i.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,i)}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function write_ws_xml_cols(e,i){for(var s=["<cols>"],a,c=0;c!=i.length;++c)(a=i[c])&&(s[s.length]=writextag("col",null,col_obj_w(c,a)));return s[s.length]="</cols>",s.join("")}function write_ws_xml_autofilter(e,i,s,a){var c=typeof e.ref=="string"?e.ref:encode_range(e.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var d=s.Workbook.Names,h=decode_range(c);h.s.r==h.e.r&&(h.e.r=decode_range(i["!ref"]).e.r,c=encode_range(h));for(var g=0;g<d.length;++g){var _=d[g];if(_.Name=="_xlnm._FilterDatabase"&&_.Sheet==a){_.Ref="'"+s.SheetNames[a]+"'!"+c;break}}return g==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+s.SheetNames[a]+"'!"+c}),writextag("autoFilter",null,{ref:c})}function write_ws_xml_sheetviews(e,i,s,a){var c={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(c.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,c),{})}function write_ws_xml_cell(e,i,s,a){if(e.c&&s["!comments"].push([i,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var c="",d=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":c=e.v?"1":"0";break;case"n":c=""+e.v;break;case"e":c=BErr[e.v];break;case"d":a&&a.cellDates?c=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",c=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:c=e.v;break}var g=writetag("v",escapexml(c)),_={r:i},b=get_cell_style(a.cellXfs,e,a);switch(b!==0&&(_.s=b),e.t){case"n":break;case"d":_.t="d";break;case"b":_.t="b";break;case"e":_.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){g=writetag("v",""+get_sst_id(a.Strings,e.v,a.revStrings)),_.t="s";break}_.t="str";break}if(e.t!=d&&(e.t=d,e.v=h),typeof e.f=="string"&&e.f){var _e=e.F&&e.F.slice(0,i.length)==i?{t:"array",ref:e.F}:null;g=writextag("f",escapexml(e.f),_e)+(e.v!=null?g:"")}return e.l&&s["!links"].push([i,e.l]),e.D&&(_.cm=1),writextag("c",g,_)}function write_ws_xml_data(e,i,s,a){var c=[],d=[],h=safe_decode_range(e["!ref"]),g="",_,b="",_e=[],nt=0,it=0,et=e["!rows"],lt=Array.isArray(e),rt={r:b},at,ot=-1;for(it=h.s.c;it<=h.e.c;++it)_e[it]=encode_col(it);for(nt=h.s.r;nt<=h.e.r;++nt){for(d=[],b=encode_row(nt),it=h.s.c;it<=h.e.c;++it){_=_e[it]+b;var st=lt?(e[nt]||[])[it]:e[_];st!==void 0&&(g=write_ws_xml_cell(st,_,e,i))!=null&&d.push(g)}(d.length>0||et&&et[nt])&&(rt={r:b},et&&et[nt]&&(at=et[nt],at.hidden&&(rt.hidden=1),ot=-1,at.hpx?ot=px2pt(at.hpx):at.hpt&&(ot=at.hpt),ot>-1&&(rt.ht=ot,rt.customHeight=1),at.level&&(rt.outlineLevel=at.level)),c[c.length]=writextag("row",d.join(""),rt))}if(et)for(;nt<et.length;++nt)et&&et[nt]&&(rt={r:nt+1},at=et[nt],at.hidden&&(rt.hidden=1),ot=-1,at.hpx?ot=px2pt(at.hpx):at.hpt&&(ot=at.hpt),ot>-1&&(rt.ht=ot,rt.customHeight=1),at.level&&(rt.outlineLevel=at.level),c[c.length]=writextag("row","",rt));return c.join("")}function write_ws_xml(e,i,s,a){var c=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],d=s.SheetNames[e],h=0,g="",_=s.Sheets[d];_==null&&(_={});var b=_["!ref"]||"A1",_e=safe_decode_range(b);if(_e.e.c>16383||_e.e.r>1048575){if(i.WTF)throw new Error("Range "+b+" exceeds format limit A1:XFD1048576");_e.e.c=Math.min(_e.e.c,16383),_e.e.r=Math.min(_e.e.c,1048575),b=encode_range(_e)}a||(a={}),_["!comments"]=[];var nt=[];write_ws_xml_sheetpr(_,s,e,i,c),c[c.length]=writextag("dimension",null,{ref:b}),c[c.length]=write_ws_xml_sheetviews(_,i,e,s),i.sheetFormat&&(c[c.length]=writextag("sheetFormatPr",null,{defaultRowHeight:i.sheetFormat.defaultRowHeight||"16",baseColWidth:i.sheetFormat.baseColWidth||"10",outlineLevelRow:i.sheetFormat.outlineLevelRow||"7"})),_["!cols"]!=null&&_["!cols"].length>0&&(c[c.length]=write_ws_xml_cols(_,_["!cols"])),c[h=c.length]="<sheetData/>",_["!links"]=[],_["!ref"]!=null&&(g=write_ws_xml_data(_,i),g.length>0&&(c[c.length]=g)),c.length>h+1&&(c[c.length]="</sheetData>",c[h]=c[h].replace("/>",">")),_["!protect"]&&(c[c.length]=write_ws_xml_protection(_["!protect"])),_["!autofilter"]!=null&&(c[c.length]=write_ws_xml_autofilter(_["!autofilter"],_,s,e)),_["!merges"]!=null&&_["!merges"].length>0&&(c[c.length]=write_ws_xml_merges(_["!merges"]));var it=-1,et,lt=-1;return _["!links"].length>0&&(c[c.length]="<hyperlinks>",_["!links"].forEach(function(rt){rt[1].Target&&(et={ref:rt[0]},rt[1].Target.charAt(0)!="#"&&(lt=add_rels(a,-1,escapexml(rt[1].Target).replace(/#.*$/,""),RELS.HLINK),et["r:id"]="rId"+lt),(it=rt[1].Target.indexOf("#"))>-1&&(et.location=escapexml(rt[1].Target.slice(it+1))),rt[1].Tooltip&&(et.tooltip=escapexml(rt[1].Tooltip)),c[c.length]=writextag("hyperlink",null,et))}),c[c.length]="</hyperlinks>"),delete _["!links"],_["!margins"]!=null&&(c[c.length]=write_ws_xml_margins(_["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&(c[c.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:b}))),nt.length>0&&(lt=add_rels(a,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),c[c.length]=writextag("drawing",null,{"r:id":"rId"+lt}),_["!drawing"]=nt),_["!comments"].length>0&&(lt=add_rels(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),c[c.length]=writextag("legacyDrawing",null,{"r:id":"rId"+lt}),_["!legacy"]=lt),c.length>1&&(c[c.length]="</worksheet>",c[1]=c[1].replace("/>",">")),c.join("")}function parse_BrtRowHdr(e,i){var s={},a=e.l+i;s.r=e.read_shift(4),e.l+=4;var c=e.read_shift(2);e.l+=1;var d=e.read_shift(1);return e.l=a,d&7&&(s.level=d&7),d&16&&(s.hidden=!0),d&32&&(s.hpt=c/20),s}function write_BrtRowHdr(e,i,s){var a=new_buf(145),c=(s["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var d=320;c.hpx?d=px2pt(c.hpx)*20:c.hpt&&(d=c.hpt*20),a.write_shift(2,d),a.write_shift(1,0);var h=0;c.level&&(h|=c.level),c.hidden&&(h|=16),(c.hpx||c.hpt)&&(h|=32),a.write_shift(1,h),a.write_shift(1,0);var g=0,_=a.l;a.l+=4;for(var b={r:e,c:0},_e=0;_e<16;++_e)if(!(i.s.c>_e+1<<10||i.e.c<_e<<10)){for(var nt=-1,it=-1,et=_e<<10;et<_e+1<<10;++et){b.c=et;var lt=Array.isArray(s)?(s[b.r]||[])[b.c]:s[encode_cell(b)];lt&&(nt<0&&(nt=et),it=et)}nt<0||(++g,a.write_shift(4,nt),a.write_shift(4,it))}var rt=a.l;return a.l=_,a.write_shift(4,g),a.l=rt,a.length>a.l?a.slice(0,a.l):a}function write_row_header(e,i,s,a){var c=write_BrtRowHdr(a,s,i);(c.length>17||(i["!rows"]||[])[a])&&write_record(e,0,c)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,i){var s={},a=e[e.l];return++e.l,s.above=!(a&64),s.left=!(a&128),e.l+=18,s.name=parse_XLSBCodeName(e),s}function write_BrtWsProp(e,i,s){s==null&&(s=new_buf(84+4*e.length));var a=192;i&&(i.above&&(a&=-65),i.left&&(a&=-129)),s.write_shift(1,a);for(var c=1;c<3;++c)s.write_shift(1,0);return write_BrtColor({auto:1},s),s.write_shift(-4,-1),s.write_shift(-4,-1),write_XLSBCodeName(e,s),s.slice(0,s.l)}function parse_BrtCellBlank(e){var i=parse_XLSBCell(e);return[i]}function write_BrtCellBlank(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBCell(i,s)}function parse_BrtShortBlank(e){var i=parse_XLSBShortCell(e);return[i]}function write_BrtShortBlank(e,i,s){return s==null&&(s=new_buf(4)),write_XLSBShortCell(i,s)}function parse_BrtCellBool(e){var i=parse_XLSBCell(e),s=e.read_shift(1);return[i,s,"b"]}function write_BrtCellBool(e,i,s){return s==null&&(s=new_buf(9)),write_XLSBCell(i,s),s.write_shift(1,e.v?1:0),s}function parse_BrtShortBool(e){var i=parse_XLSBShortCell(e),s=e.read_shift(1);return[i,s,"b"]}function write_BrtShortBool(e,i,s){return s==null&&(s=new_buf(5)),write_XLSBShortCell(i,s),s.write_shift(1,e.v?1:0),s}function parse_BrtCellError(e){var i=parse_XLSBCell(e),s=e.read_shift(1);return[i,s,"e"]}function write_BrtCellError(e,i,s){return s==null&&(s=new_buf(9)),write_XLSBCell(i,s),s.write_shift(1,e.v),s}function parse_BrtShortError(e){var i=parse_XLSBShortCell(e),s=e.read_shift(1);return[i,s,"e"]}function write_BrtShortError(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBShortCell(i,s),s.write_shift(1,e.v),s.write_shift(2,0),s.write_shift(1,0),s}function parse_BrtCellIsst(e){var i=parse_XLSBCell(e),s=e.read_shift(4);return[i,s,"s"]}function write_BrtCellIsst(e,i,s){return s==null&&(s=new_buf(12)),write_XLSBCell(i,s),s.write_shift(4,i.v),s}function parse_BrtShortIsst(e){var i=parse_XLSBShortCell(e),s=e.read_shift(4);return[i,s,"s"]}function write_BrtShortIsst(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBShortCell(i,s),s.write_shift(4,i.v),s}function parse_BrtCellReal(e){var i=parse_XLSBCell(e),s=parse_Xnum(e);return[i,s,"n"]}function write_BrtCellReal(e,i,s){return s==null&&(s=new_buf(16)),write_XLSBCell(i,s),write_Xnum(e.v,s),s}function parse_BrtShortReal(e){var i=parse_XLSBShortCell(e),s=parse_Xnum(e);return[i,s,"n"]}function write_BrtShortReal(e,i,s){return s==null&&(s=new_buf(12)),write_XLSBShortCell(i,s),write_Xnum(e.v,s),s}function parse_BrtCellRk(e){var i=parse_XLSBCell(e),s=parse_RkNumber(e);return[i,s,"n"]}function write_BrtCellRk(e,i,s){return s==null&&(s=new_buf(12)),write_XLSBCell(i,s),write_RkNumber(e.v,s),s}function parse_BrtShortRk(e){var i=parse_XLSBShortCell(e),s=parse_RkNumber(e);return[i,s,"n"]}function write_BrtShortRk(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBShortCell(i,s),write_RkNumber(e.v,s),s}function parse_BrtCellRString(e){var i=parse_XLSBCell(e),s=parse_RichStr(e);return[i,s,"is"]}function parse_BrtCellSt(e){var i=parse_XLSBCell(e),s=parse_XLWideString(e);return[i,s,"str"]}function write_BrtCellSt(e,i,s){return s==null&&(s=new_buf(12+4*e.v.length)),write_XLSBCell(i,s),write_XLWideString(e.v,s),s.length>s.l?s.slice(0,s.l):s}function parse_BrtShortSt(e){var i=parse_XLSBShortCell(e),s=parse_XLWideString(e);return[i,s,"str"]}function write_BrtShortSt(e,i,s){return s==null&&(s=new_buf(8+4*e.v.length)),write_XLSBShortCell(i,s),write_XLWideString(e.v,s),s.length>s.l?s.slice(0,s.l):s}function parse_BrtFmlaBool(e,i,s){var a=e.l+i,c=parse_XLSBCell(e);c.r=s["!row"];var d=e.read_shift(1),h=[c,d,"b"];if(s.cellFormula){e.l+=2;var g=parse_XLSBCellParsedFormula(e,a-e.l,s);h[3]=stringify_formula(g,null,c,s.supbooks,s)}else e.l=a;return h}function parse_BrtFmlaError(e,i,s){var a=e.l+i,c=parse_XLSBCell(e);c.r=s["!row"];var d=e.read_shift(1),h=[c,d,"e"];if(s.cellFormula){e.l+=2;var g=parse_XLSBCellParsedFormula(e,a-e.l,s);h[3]=stringify_formula(g,null,c,s.supbooks,s)}else e.l=a;return h}function parse_BrtFmlaNum(e,i,s){var a=e.l+i,c=parse_XLSBCell(e);c.r=s["!row"];var d=parse_Xnum(e),h=[c,d,"n"];if(s.cellFormula){e.l+=2;var g=parse_XLSBCellParsedFormula(e,a-e.l,s);h[3]=stringify_formula(g,null,c,s.supbooks,s)}else e.l=a;return h}function parse_BrtFmlaString(e,i,s){var a=e.l+i,c=parse_XLSBCell(e);c.r=s["!row"];var d=parse_XLWideString(e),h=[c,d,"str"];if(s.cellFormula){e.l+=2;var g=parse_XLSBCellParsedFormula(e,a-e.l,s);h[3]=stringify_formula(g,null,c,s.supbooks,s)}else e.l=a;return h}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,i){return i==null&&(i=new_buf(4)),i.write_shift(4,e),i}function parse_BrtHLink(e,i){var s=e.l+i,a=parse_UncheckedRfX(e),c=parse_XLNullableWideString(e),d=parse_XLWideString(e),h=parse_XLWideString(e),g=parse_XLWideString(e);e.l=s;var _={rfx:a,relId:c,loc:d,display:g};return h&&(_.Tooltip=h),_}function write_BrtHLink(e,i){var s=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},s),write_RelID("rId"+i,s);var a=e[1].Target.indexOf("#"),c=a==-1?"":e[1].Target.slice(a+1);return write_XLWideString(c||"",s),write_XLWideString(e[1].Tooltip||"",s),write_XLWideString("",s),s.slice(0,s.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,i,s){var a=e.l+i,c=parse_RfX(e),d=e.read_shift(1),h=[c];if(h[2]=d,s.cellFormula){var g=parse_XLSBArrayParsedFormula(e,a-e.l,s);h[1]=g}else e.l=a;return h}function parse_BrtShrFmla(e,i,s){var a=e.l+i,c=parse_UncheckedRfX(e),d=[c];if(s.cellFormula){var h=parse_XLSBSharedParsedFormula(e,a-e.l,s);d[1]=h,e.l=a}else e.l=a;return d}function write_BrtColInfo(e,i,s){s==null&&(s=new_buf(18));var a=col_obj_w(e,i);s.write_shift(-4,e),s.write_shift(-4,e),s.write_shift(4,(a.width||10)*256),s.write_shift(4,0);var c=0;return i.hidden&&(c|=1),typeof a.width=="number"&&(c|=2),i.level&&(c|=i.level<<8),s.write_shift(2,c),s}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var i={};return BrtMarginKeys.forEach(function(s){i[s]=parse_Xnum(e)}),i}function write_BrtMargins(e,i){return i==null&&(i=new_buf(6*8)),default_margins(e),BrtMarginKeys.forEach(function(s){write_Xnum(e[s],i)}),i}function parse_BrtBeginWsView(e){var i=e.read_shift(2);return e.l+=28,{RTL:i&32}}function write_BrtBeginWsView(e,i,s){s==null&&(s=new_buf(30));var a=924;return(((i||{}).Views||[])[0]||{}).RTL&&(a|=32),s.write_shift(2,a),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s}function write_BrtCellIgnoreEC(e){var i=new_buf(24);return i.write_shift(4,4),i.write_shift(4,1),write_UncheckedRfX(e,i),i}function write_BrtSheetProtection(e,i){return i==null&&(i=new_buf(16*4+2)),i.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),i.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(s){s[1]?i.write_shift(4,e[s[0]]!=null&&!e[s[0]]?1:0):i.write_shift(4,e[s[0]]!=null&&e[s[0]]?0:1)}),i}function parse_BrtDVal(){}function parse_BrtDVal14(){}function write_ws_bin_cell(e,i,s,a,c,d,h){if(i.v===void 0)return!1;var g="";switch(i.t){case"b":g=i.v?"1":"0";break;case"d":i=dup(i),i.z=i.z||table_fmt[14],i.v=datenum(parseDate(i.v)),i.t="n";break;case"n":case"e":g=""+i.v;break;default:g=i.v;break}var _={r:s,c:a};switch(_.s=get_cell_style(c.cellXfs,i,c),i.l&&d["!links"].push([encode_cell(_),i.l]),i.c&&d["!comments"].push([encode_cell(_),i.c]),i.t){case"s":case"str":return c.bookSST?(g=get_sst_id(c.Strings,i.v,c.revStrings),_.t="s",_.v=g,h?write_record(e,18,write_BrtShortIsst(i,_)):write_record(e,7,write_BrtCellIsst(i,_))):(_.t="str",h?write_record(e,17,write_BrtShortSt(i,_)):write_record(e,6,write_BrtCellSt(i,_))),!0;case"n":return i.v==(i.v|0)&&i.v>-1e3&&i.v<1e3?h?write_record(e,13,write_BrtShortRk(i,_)):write_record(e,2,write_BrtCellRk(i,_)):h?write_record(e,16,write_BrtShortReal(i,_)):write_record(e,5,write_BrtCellReal(i,_)),!0;case"b":return _.t="b",h?write_record(e,15,write_BrtShortBool(i,_)):write_record(e,4,write_BrtCellBool(i,_)),!0;case"e":return _.t="e",h?write_record(e,14,write_BrtShortError(i,_)):write_record(e,3,write_BrtCellError(i,_)),!0}return h?write_record(e,12,write_BrtShortBlank(i,_)):write_record(e,1,write_BrtCellBlank(i,_)),!0}function write_CELLTABLE(e,i,s,a){var c=safe_decode_range(i["!ref"]||"A1"),d,h="",g=[];write_record(e,145);var _=Array.isArray(i),b=c.e.r;i["!rows"]&&(b=Math.max(c.e.r,i["!rows"].length-1));for(var _e=c.s.r;_e<=b;++_e){h=encode_row(_e),write_row_header(e,i,c,_e);var nt=!1;if(_e<=c.e.r)for(var it=c.s.c;it<=c.e.c;++it){_e===c.s.r&&(g[it]=encode_col(it)),d=g[it]+h;var et=_?(i[_e]||[])[it]:i[d];if(!et){nt=!1;continue}nt=write_ws_bin_cell(e,et,_e,it,a,i,nt)}}write_record(e,146)}function write_MERGECELLS(e,i){!i||!i["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(i["!merges"].length)),i["!merges"].forEach(function(s){write_record(e,176,write_BrtMergeCell(s))}),write_record(e,178))}function write_COLINFOS(e,i){!i||!i["!cols"]||(write_record(e,390),i["!cols"].forEach(function(s,a){s&&write_record(e,60,write_BrtColInfo(a,s))}),write_record(e,391))}function write_IGNOREECS(e,i){!i||!i["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(i["!ref"]))),write_record(e,650))}function write_HLINKS(e,i,s){i["!links"].forEach(function(a){if(a[1].Target){var c=add_rels(s,-1,a[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(a,c))}}),delete i["!links"]}function write_LEGACYDRAWING(e,i,s,a){if(i["!comments"].length>0){var c=add_rels(a,-1,"../drawings/vmlDrawing"+(s+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+c)),i["!legacy"]=c}}function write_AUTOFILTER(e,i,s,a){if(i["!autofilter"]){var c=i["!autofilter"],d=typeof c.ref=="string"?c.ref:encode_range(c.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var h=s.Workbook.Names,g=decode_range(d);g.s.r==g.e.r&&(g.e.r=decode_range(i["!ref"]).e.r,d=encode_range(g));for(var _=0;_<h.length;++_){var b=h[_];if(b.Name=="_xlnm._FilterDatabase"&&b.Sheet==a){b.Ref="'"+s.SheetNames[a]+"'!"+d;break}}_==h.length&&h.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+s.SheetNames[a]+"'!"+d}),write_record(e,161,write_UncheckedRfX(safe_decode_range(d))),write_record(e,162)}}function write_WSVIEWS2(e,i,s){write_record(e,133),write_record(e,137,write_BrtBeginWsView(i,s)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,i){i["!protect"]&&write_record(e,535,write_BrtSheetProtection(i["!protect"]))}function write_ws_bin(e,i,s,a){var c=buf_array(),d=s.SheetNames[e],h=s.Sheets[d]||{},g=d;try{s&&s.Workbook&&(g=s.Workbook.Sheets[e].CodeName||g)}catch{}var _=safe_decode_range(h["!ref"]||"A1");if(_.e.c>16383||_.e.r>1048575){if(i.WTF)throw new Error("Range "+(h["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");_.e.c=Math.min(_.e.c,16383),_.e.r=Math.min(_.e.c,1048575)}return h["!links"]=[],h["!comments"]=[],write_record(c,129),(s.vbaraw||h["!outline"])&&write_record(c,147,write_BrtWsProp(g,h["!outline"])),write_record(c,148,write_BrtWsDim(_)),write_WSVIEWS2(c,h,s.Workbook),write_COLINFOS(c,h),write_CELLTABLE(c,h,e,i),write_SHEETPROTECT(c,h),write_AUTOFILTER(c,h,s,e),write_MERGECELLS(c,h),write_HLINKS(c,h,a),h["!margins"]&&write_record(c,476,write_BrtMargins(h["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&write_IGNOREECS(c,h),write_LEGACYDRAWING(c,h,e,a),write_record(c,130),c.end()}function parse_BrtCsProp(e,i){e.l+=10;var s=parse_XLWideString(e);return{name:s}}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,i){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var s=!0;return badchars.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),s}function check_wb_names(e,i,s){e.forEach(function(a,c){check_ws_name(a);for(var d=0;d<c;++d)if(a==e[d])throw new Error("Duplicate Sheet Name: "+a);if(s){var h=i&&i[c]&&i[c].CodeName||a;if(h.charCodeAt(0)==95&&h.length>22)throw new Error("Bad Code Name: Worksheet"+h)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var i=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,i,!!e.vbaraw);for(var s=0;s<e.SheetNames.length;++s)check_ws(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}function write_wb_xml(e){var i=[XML_HEADER];i[i.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var s=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(g){e.Workbook.WBProps[g[0]]!=null&&e.Workbook.WBProps[g[0]]!=g[1]&&(a[g[0]]=e.Workbook.WBProps[g[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),i[i.length]=writextag("workbookPr",null,a);var c=e.Workbook&&e.Workbook.Sheets||[],d=0;if(c&&c[0]&&c[0].Hidden){for(i[i.length]="<bookViews>",d=0;d!=e.SheetNames.length&&!(!c[d]||!c[d].Hidden);++d);d==e.SheetNames.length&&(d=0),i[i.length]='<workbookView firstSheet="'+d+'" activeTab="'+d+'"/>',i[i.length]="</bookViews>"}for(i[i.length]="<sheets>",d=0;d!=e.SheetNames.length;++d){var h={name:escapexml(e.SheetNames[d].slice(0,31))};if(h.sheetId=""+(d+1),h["r:id"]="rId"+(d+1),c[d])switch(c[d].Hidden){case 1:h.state="hidden";break;case 2:h.state="veryHidden";break}i[i.length]=writextag("sheet",null,h)}return i[i.length]="</sheets>",s&&(i[i.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(g){var _={name:g.Name};g.Comment&&(_.comment=g.Comment),g.Sheet!=null&&(_.localSheetId=""+g.Sheet),g.Hidden&&(_.hidden="1"),g.Ref&&(i[i.length]=writextag("definedName",escapexml(g.Ref),_))}),i[i.length]="</definedNames>"),i.length>2&&(i[i.length]="</workbook>",i[1]=i[1].replace("/>",">")),i.join("")}function parse_BrtBundleSh(e,i){var s={};return s.Hidden=e.read_shift(4),s.iTabID=e.read_shift(4),s.strRelID=parse_RelID(e),s.name=parse_XLWideString(e),s}function write_BrtBundleSh(e,i){return i||(i=new_buf(127)),i.write_shift(4,e.Hidden),i.write_shift(4,e.iTabID),write_RelID(e.strRelID,i),write_XLWideString(e.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i}function parse_BrtWbProp(e,i){var s={},a=e.read_shift(4);s.defaultThemeVersion=e.read_shift(4);var c=i>8?parse_XLWideString(e):"";return c.length>0&&(s.CodeName=c),s.autoCompressPictures=!!(a&65536),s.backupFile=!!(a&64),s.checkCompatibility=!!(a&4096),s.date1904=!!(a&1),s.filterPrivacy=!!(a&8),s.hidePivotFieldList=!!(a&1024),s.promptedSolutions=!!(a&16),s.publishItems=!!(a&2048),s.refreshAllConnections=!!(a&262144),s.saveExternalLinkValues=!!(a&128),s.showBorderUnselectedTables=!!(a&4),s.showInkAnnotation=!!(a&32),s.showObjects=["all","placeholders","none"][a>>13&3],s.showPivotChartFilter=!!(a&32768),s.updateLinks=["userSet","never","always"][a>>8&3],s}function write_BrtWbProp(e,i){i||(i=new_buf(72));var s=0;return e&&e.filterPrivacy&&(s|=8),i.write_shift(4,s),i.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",i),i.slice(0,i.l)}function parse_BrtName(e,i,s){var a=e.l+i;e.l+=4,e.l+=1;var c=e.read_shift(4),d=parse_XLNameWideString(e),h=parse_XLSBNameParsedFormula(e,0,s),g=parse_XLNullableWideString(e);e.l=a;var _={Name:d,Ptg:h};return c<268435455&&(_.Sheet=c),g&&(_.Comment=g),_}function write_BUNDLESHS(e,i){write_record(e,143);for(var s=0;s!=i.SheetNames.length;++s){var a=i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[s]&&i.Workbook.Sheets[s].Hidden||0,c={Hidden:a,iTabID:s+1,strRelID:"rId"+(s+1),name:i.SheetNames[s]};write_record(e,156,write_BrtBundleSh(c))}write_record(e,144)}function write_BrtFileVersion(e,i){i||(i=new_buf(127));for(var s=0;s!=4;++s)i.write_shift(4,0);return write_XLWideString("SheetJS",i),write_XLWideString(XLSX.version,i),write_XLWideString(XLSX.version,i),write_XLWideString("7262",i),i.length>i.l?i.slice(0,i.l):i}function write_BrtBookView(e,i){i||(i=new_buf(29)),i.write_shift(-4,0),i.write_shift(-4,460),i.write_shift(4,28800),i.write_shift(4,17600),i.write_shift(4,500),i.write_shift(4,e),i.write_shift(4,e);var s=120;return i.write_shift(1,s),i.length>i.l?i.slice(0,i.l):i}function write_BOOKVIEWS(e,i){if(!(!i.Workbook||!i.Workbook.Sheets)){for(var s=i.Workbook.Sheets,a=0,c=-1,d=-1;a<s.length;++a)!s[a]||!s[a].Hidden&&c==-1?c=a:s[a].Hidden==1&&d==-1&&(d=a);d>c||(write_record(e,135),write_record(e,158,write_BrtBookView(c)),write_record(e,136))}}function write_wb_bin(e,i){var s=buf_array();return write_record(s,131),write_record(s,128,write_BrtFileVersion()),write_record(s,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(s,e),write_BUNDLESHS(s,e),write_record(s,132),s.end()}function write_wb(e,i,s){return(i.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,i,s,a,c){return(i.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,s,a,c)}function write_sty(e,i,s){return(i.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,s)}function write_sst(e,i,s){return(i.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,s)}function write_cmnt(e,i,s){return(i.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}function write_props_xlml(e,i){var s=[];return e.Props&&s.push(xlml_write_docprops(e.Props,i)),e.Custprops&&s.push(xlml_write_custprops(e.Props,e.Custprops)),s.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,i){var s=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return i.cellXfs.forEach(function(a,c){var d=[];d.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[a.numFmtId])}));var h={"ss:ID":"s"+(21+c)};s.push(writextag("Style",d.join(""),h))}),writextag("Styles",s.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var i=e.Workbook.Names,s=[],a=0;a<i.length;++a){var c=i[a];c.Sheet==null&&(c.Name.match(/^_xlfn\./)||s.push(write_name_xlml(c)))}return writextag("Names",s.join(""))}function write_ws_xlml_names(e,i,s,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var c=a.Workbook.Names,d=[],h=0;h<c.length;++h){var g=c[h];g.Sheet==s&&(g.Name.match(/^_xlfn\./)||d.push(write_name_xlml(g)))}return d.join("")}function write_ws_xlml_wsopts(e,i,s,a){if(!e)return"";var c=[];if(e["!margins"]&&(c.push("<PageSetup>"),e["!margins"].header&&c.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&c.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),c.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),c.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[s])if(a.Workbook.Sheets[s].Hidden)c.push(writextag("Visible",a.Workbook.Sheets[s].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var d=0;d<s&&!(a.Workbook.Sheets[d]&&!a.Workbook.Sheets[d].Hidden);++d);d==s&&c.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&c.push("<DisplayRightToLeft/>"),e["!protect"]&&(c.push(writetag("ProtectContents","True")),e["!protect"].objects&&c.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&c.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?c.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&c.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(h){e["!protect"][h[0]]&&c.push("<"+h[1]+"/>")})),c.length==0?"":writextag("WorksheetOptions",c.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(i){var s=xlml_unfixstr(i.t||""),a=writextag("ss:Data",s,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",a,{"ss:Author":i.a})}).join("")}function write_ws_xlml_cell(e,i,s,a,c,d,h){if(!e||e.v==null&&e.f==null)return"";var g={};if(e.f&&(g["ss:Formula"]="="+escapexml(a1_to_rc(e.f,h))),e.F&&e.F.slice(0,i.length)==i){var _=decode_cell(e.F.slice(i.length+1));g["ss:ArrayRange"]="RC:R"+(_.r==h.r?"":"["+(_.r-h.r)+"]")+"C"+(_.c==h.c?"":"["+(_.c-h.c)+"]")}if(e.l&&e.l.Target&&(g["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(g["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),s["!merges"])for(var b=s["!merges"],_e=0;_e!=b.length;++_e)b[_e].s.c!=h.c||b[_e].s.r!=h.r||(b[_e].e.c>b[_e].s.c&&(g["ss:MergeAcross"]=b[_e].e.c-b[_e].s.c),b[_e].e.r>b[_e].s.r&&(g["ss:MergeDown"]=b[_e].e.r-b[_e].s.r));var nt="",it="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":nt="Number",it=String(e.v);break;case"b":nt="Boolean",it=e.v?"1":"0";break;case"e":nt="Error",it=BErr[e.v];break;case"d":nt="DateTime",it=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":nt="String",it=escapexlml(e.v||"");break}var et=get_cell_style(a.cellXfs,e,a);g["ss:StyleID"]="s"+(21+et),g["ss:Index"]=h.c+1;var lt=e.v!=null?it:"",rt=e.t=="z"?"":'<Data ss:Type="'+nt+'">'+lt+"</Data>";return(e.c||[]).length>0&&(rt+=write_ws_xlml_comment(e.c)),writextag("Cell",rt,g)}function write_ws_xlml_row(e,i){var s='<Row ss:Index="'+(e+1)+'"';return i&&(i.hpt&&!i.hpx&&(i.hpx=pt2px(i.hpt)),i.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+i.hpx+'"'),i.hidden&&(s+=' ss:Hidden="1"')),s+">"}function write_ws_xlml_table(e,i,s,a){if(!e["!ref"])return"";var c=safe_decode_range(e["!ref"]),d=e["!merges"]||[],h=0,g=[];e["!cols"]&&e["!cols"].forEach(function(at,ot){process_col(at);var st=!!at.width,ct=col_obj_w(ot,at),mt={"ss:Index":ot+1};st&&(mt["ss:Width"]=width2px(ct.width)),at.hidden&&(mt["ss:Hidden"]="1"),g.push(writextag("Column",null,mt))});for(var _=Array.isArray(e),b=c.s.r;b<=c.e.r;++b){for(var _e=[write_ws_xlml_row(b,(e["!rows"]||[])[b])],nt=c.s.c;nt<=c.e.c;++nt){var it=!1;for(h=0;h!=d.length;++h)if(!(d[h].s.c>nt)&&!(d[h].s.r>b)&&!(d[h].e.c<nt)&&!(d[h].e.r<b)){(d[h].s.c!=nt||d[h].s.r!=b)&&(it=!0);break}if(!it){var et={r:b,c:nt},lt=encode_cell(et),rt=_?(e[b]||[])[nt]:e[lt];_e.push(write_ws_xlml_cell(rt,lt,e,i,s,a,et))}}_e.push("</Row>"),_e.length>2&&g.push(_e.join(""))}return g.join("")}function write_ws_xlml(e,i,s){var a=[],c=s.SheetNames[e],d=s.Sheets[c],h=d?write_ws_xlml_names(d,i,e,s):"";return h.length>0&&a.push("<Names>"+h+"</Names>"),h=d?write_ws_xlml_table(d,i,e,s):"",h.length>0&&a.push("<Table>"+h+"</Table>"),a.push(write_ws_xlml_wsopts(d,i,e,s)),a.join("")}function write_xlml(e,i){i||(i={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF,i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}));var s=[];s.push(write_props_xlml(e,i)),s.push(write_wb_xlml()),s.push(""),s.push("");for(var a=0;a<e.SheetNames.length;++a)s.push(writextag("Worksheet",write_ws_xlml(a,i,e),{"ss:Name":escapexml(e.SheetNames[a])}));return s[2]=write_sty_xlml(e,i),s[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",s.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function write_xls_props(e,i){var s=[],a=[],c=[],d=0,h,g=evert_key(DocSummaryPIDDSI,"n"),_=evert_key(SummaryPIDSI,"n");if(e.Props)for(h=keys(e.Props),d=0;d<h.length;++d)(Object.prototype.hasOwnProperty.call(g,h[d])?s:Object.prototype.hasOwnProperty.call(_,h[d])?a:c).push([h[d],e.Props[h[d]]]);if(e.Custprops)for(h=keys(e.Custprops),d=0;d<h.length;++d)Object.prototype.hasOwnProperty.call(e.Props||{},h[d])||(Object.prototype.hasOwnProperty.call(g,h[d])?s:Object.prototype.hasOwnProperty.call(_,h[d])?a:c).push([h[d],e.Custprops[h[d]]]);var b=[];for(d=0;d<c.length;++d)XLSPSSkip.indexOf(c[d][0])>-1||PseudoPropsPairs.indexOf(c[d][0])>-1||c[d][1]!=null&&b.push(c[d]);a.length&&CFB.utils.cfb_add(i,"/SummaryInformation",write_PropertySetStream(a,PSCLSID.SI,_,SummaryPIDSI)),(s.length||b.length)&&CFB.utils.cfb_add(i,"/DocumentSummaryInformation",write_PropertySetStream(s,PSCLSID.DSI,g,DocSummaryPIDDSI,b.length?b:null,PSCLSID.UDI))}function write_xlscfb(e,i){var s=i||{},a=CFB.utils.cfb_new({root:"R"}),c="/Workbook";switch(s.bookType||"xls"){case"xls":s.bookType="biff8";case"xla":s.bookType||(s.bookType="xla");case"biff8":c="/Workbook",s.biff=8;break;case"biff5":c="/Book",s.biff=5;break;default:throw new Error("invalid type "+s.bookType+" for XLS CFB")}return CFB.utils.cfb_add(a,c,write_biff_buf(e,s)),s.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,a),s.biff==8&&e.vbaraw&&fill_vba_xls(a,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function write_biff_rec(e,i,s,a){var c=i;if(!isNaN(c)){var d=a||(s||[]).length||0,h=e.next(4);h.write_shift(2,c),h.write_shift(2,d),d>0&&is_buf(s)&&e.push(s)}}function write_biff_continue(e,i,s,a){var c=(s||[]).length||0;if(c<=8224)return write_biff_rec(e,i,s,c);var d=i;if(!isNaN(d)){for(var h=s.parts||[],g=0,_=0,b=0;b+(h[g]||8224)<=8224;)b+=h[g]||8224,g++;var _e=e.next(4);for(_e.write_shift(2,d),_e.write_shift(2,b),e.push(s.slice(_,_+b)),_+=b;_<c;){for(_e=e.next(4),_e.write_shift(2,60),b=0;b+(h[g]||8224)<=8224;)b+=h[g]||8224,g++;_e.write_shift(2,b),e.push(s.slice(_,_+b)),_+=b}}}function write_BIFF2Cell(e,i,s){return e||(e=new_buf(7)),e.write_shift(2,i),e.write_shift(2,s),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,i,s,a){var c=new_buf(9);return write_BIFF2Cell(c,e,i),write_Bes(s,a||"b",c),c}function write_BIFF2LABEL(e,i,s){var a=new_buf(8+2*s.length);return write_BIFF2Cell(a,e,i),a.write_shift(1,s.length),a.write_shift(s.length,s,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function write_ws_biff2_cell(e,i,s,a){if(i.v!=null)switch(i.t){case"d":case"n":var c=i.t=="d"?datenum(parseDate(i.v)):i.v;c==(c|0)&&c>=0&&c<65536?write_biff_rec(e,2,write_BIFF2INT(s,a,c)):write_biff_rec(e,3,write_BIFF2NUM(s,a,c));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(s,a,i.v,i.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(s,a,(i.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,s,a))}function write_ws_biff2(e,i,s,a){var c=Array.isArray(i),d=safe_decode_range(i["!ref"]||"A1"),h,g="",_=[];if(d.e.c>255||d.e.r>16383){if(a.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,16383),h=encode_range(d)}for(var b=d.s.r;b<=d.e.r;++b){g=encode_row(b);for(var _e=d.s.c;_e<=d.e.c;++_e){b===d.s.r&&(_[_e]=encode_col(_e)),h=_[_e]+g;var nt=c?(i[b]||[])[_e]:i[h];nt&&write_ws_biff2_cell(e,nt,b,_e)}}}function write_biff2_buf(e,i){for(var s=i||{},a=buf_array(),c=0,d=0;d<e.SheetNames.length;++d)e.SheetNames[d]==s.sheet&&(c=d);if(c==0&&s.sheet&&e.SheetNames[0]!=s.sheet)throw new Error("Sheet not found: "+s.sheet);return write_biff_rec(a,s.biff==4?1033:s.biff==3?521:9,write_BOF(e,16,s)),write_ws_biff2(a,e.Sheets[e.SheetNames[c]],c,s),write_biff_rec(a,10),a.end()}function write_FONTS_biff8(e,i,s){write_biff_rec(e,49,write_Font({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},s))}function write_FMTS_biff8(e,i,s){i&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var c=a[0];c<=a[1];++c)i[c]!=null&&write_biff_rec(e,1054,write_Format(c,i[c],s))})}function write_FEAT(e,i){var s=new_buf(19);s.write_shift(4,2151),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,1),s.write_shift(4,0),write_biff_rec(e,2151,s),s=new_buf(39),s.write_shift(4,2152),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(2,1),s.write_shift(4,4),s.write_shift(2,0),write_Ref8U(safe_decode_range(i["!ref"]||"A1"),s),s.write_shift(4,4),write_biff_rec(e,2152,s)}function write_CELLXFS_biff8(e,i){for(var s=0;s<16;++s)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,i));i.cellXfs.forEach(function(a){write_biff_rec(e,224,write_XF(a,0,i))})}function write_ws_biff8_hlinks(e,i){for(var s=0;s<i["!links"].length;++s){var a=i["!links"][s];write_biff_rec(e,440,write_HLink(a)),a[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(a))}delete i["!links"]}function write_ws_cols_biff8(e,i){if(i){var s=0;i.forEach(function(a,c){++s<=256&&a&&write_biff_rec(e,125,write_ColInfo(col_obj_w(c,a),c))})}}function write_ws_biff8_cell(e,i,s,a,c){var d=16+get_cell_style(c.cellXfs,i,c);if(i.v==null&&!i.bf){write_biff_rec(e,513,write_XLSCell(s,a,d));return}if(i.bf)write_biff_rec(e,6,write_Formula(i,s,a,c,d));else switch(i.t){case"d":case"n":var h=i.t=="d"?datenum(parseDate(i.v)):i.v;write_biff_rec(e,515,write_Number(s,a,h,d));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(s,a,i.v,d,c,i.t));break;case"s":case"str":if(c.bookSST){var g=get_sst_id(c.Strings,i.v,c.revStrings);write_biff_rec(e,253,write_LabelSst(s,a,g,d))}else write_biff_rec(e,516,write_Label(s,a,(i.v||"").slice(0,255),d,c));break;default:write_biff_rec(e,513,write_XLSCell(s,a,d))}}function write_ws_biff8(e,i,s){var a=buf_array(),c=s.SheetNames[e],d=s.Sheets[c]||{},h=(s||{}).Workbook||{},g=(h.Sheets||[])[e]||{},_=Array.isArray(d),b=i.biff==8,_e,nt="",it=[],et=safe_decode_range(d["!ref"]||"A1"),lt=b?65536:16384;if(et.e.c>255||et.e.r>=lt){if(i.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:IV16384");et.e.c=Math.min(et.e.c,255),et.e.r=Math.min(et.e.c,lt-1)}write_biff_rec(a,2057,write_BOF(s,16,i)),write_biff_rec(a,13,writeuint16(1)),write_biff_rec(a,12,writeuint16(100)),write_biff_rec(a,15,writebool(!0)),write_biff_rec(a,17,writebool(!1)),write_biff_rec(a,16,write_Xnum(.001)),write_biff_rec(a,95,writebool(!0)),write_biff_rec(a,42,writebool(!1)),write_biff_rec(a,43,writebool(!1)),write_biff_rec(a,130,writeuint16(1)),write_biff_rec(a,128,write_Guts()),write_biff_rec(a,131,writebool(!1)),write_biff_rec(a,132,writebool(!1)),b&&write_ws_cols_biff8(a,d["!cols"]),write_biff_rec(a,512,write_Dimensions(et,i)),b&&(d["!links"]=[]);for(var rt=et.s.r;rt<=et.e.r;++rt){nt=encode_row(rt);for(var at=et.s.c;at<=et.e.c;++at){rt===et.s.r&&(it[at]=encode_col(at)),_e=it[at]+nt;var ot=_?(d[rt]||[])[at]:d[_e];ot&&(write_ws_biff8_cell(a,ot,rt,at,i),b&&ot.l&&d["!links"].push([_e,ot.l]))}}var st=g.CodeName||g.name||c;return b&&write_biff_rec(a,574,write_Window2((h.Views||[])[0])),b&&(d["!merges"]||[]).length&&write_biff_rec(a,229,write_MergeCells(d["!merges"])),b&&write_ws_biff8_hlinks(a,d),write_biff_rec(a,442,write_XLUnicodeString(st)),b&&write_FEAT(a,d),write_biff_rec(a,10),a.end()}function write_biff8_global(e,i,s){var a=buf_array(),c=(e||{}).Workbook||{},d=c.Sheets||[],h=c.WBProps||{},g=s.biff==8,_=s.biff==5;if(write_biff_rec(a,2057,write_BOF(e,5,s)),s.bookType=="xla"&&write_biff_rec(a,135),write_biff_rec(a,225,g?writeuint16(1200):null),write_biff_rec(a,193,writezeroes(2)),_&&write_biff_rec(a,191),_&&write_biff_rec(a,192),write_biff_rec(a,226),write_biff_rec(a,92,write_WriteAccess("SheetJS",s)),write_biff_rec(a,66,writeuint16(g?1200:1252)),g&&write_biff_rec(a,353,writeuint16(0)),g&&write_biff_rec(a,448),write_biff_rec(a,317,write_RRTabId(e.SheetNames.length)),g&&e.vbaraw&&write_biff_rec(a,211),g&&e.vbaraw){var b=h.CodeName||"ThisWorkbook";write_biff_rec(a,442,write_XLUnicodeString(b))}write_biff_rec(a,156,writeuint16(17)),write_biff_rec(a,25,writebool(!1)),write_biff_rec(a,18,writebool(!1)),write_biff_rec(a,19,writeuint16(0)),g&&write_biff_rec(a,431,writebool(!1)),g&&write_biff_rec(a,444,writeuint16(0)),write_biff_rec(a,61,write_Window1()),write_biff_rec(a,64,writebool(!1)),write_biff_rec(a,141,writeuint16(0)),write_biff_rec(a,34,writebool(safe1904(e)=="true")),write_biff_rec(a,14,writebool(!0)),g&&write_biff_rec(a,439,writebool(!1)),write_biff_rec(a,218,writeuint16(0)),write_FONTS_biff8(a,e,s),write_FMTS_biff8(a,e.SSF,s),write_CELLXFS_biff8(a,s),g&&write_biff_rec(a,352,writebool(!1));var _e=a.end(),nt=buf_array();g&&write_biff_rec(nt,140,write_Country()),g&&s.Strings&&write_biff_continue(nt,252,write_SST(s.Strings)),write_biff_rec(nt,10);var it=nt.end(),et=buf_array(),lt=0,rt=0;for(rt=0;rt<e.SheetNames.length;++rt)lt+=(g?12:11)+(g?2:1)*e.SheetNames[rt].length;var at=_e.length+lt+it.length;for(rt=0;rt<e.SheetNames.length;++rt){var ot=d[rt]||{};write_biff_rec(et,133,write_BoundSheet8({pos:at,hs:ot.Hidden||0,dt:0,name:e.SheetNames[rt]},s)),at+=i[rt].length}var st=et.end();if(lt!=st.length)throw new Error("BS8 "+lt+" != "+st.length);var ct=[];return _e.length&&ct.push(_e),st.length&&ct.push(st),it.length&&ct.push(it),bconcat(ct)}function write_biff8_buf(e,i){var s=i||{},a=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),s.revssf=evert_num(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,fix_write_opts(s),s.cellXfs=[],get_cell_style(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var c=0;c<e.SheetNames.length;++c)a[a.length]=write_ws_biff8(c,s,e);return a.unshift(write_biff8_global(e,a,s)),bconcat(a)}function write_biff_buf(e,i){for(var s=0;s<=e.SheetNames.length;++s){var a=e.Sheets[e.SheetNames[s]];if(!(!a||!a["!ref"])){var c=decode_range(a["!ref"]);c.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[s]+"' extends beyond column IV (255).  Data may be lost.")}}var d=i||{};switch(d.biff||2){case 8:case 5:return write_biff8_buf(e,i);case 4:case 3:case 2:return write_biff2_buf(e,i)}throw new Error("invalid type "+d.bookType+" for BIFF")}function make_html_row(e,i,s,a){for(var c=e["!merges"]||[],d=[],h=i.s.c;h<=i.e.c;++h){for(var g=0,_=0,b=0;b<c.length;++b)if(!(c[b].s.r>s||c[b].s.c>h)&&!(c[b].e.r<s||c[b].e.c<h)){if(c[b].s.r<s||c[b].s.c<h){g=-1;break}g=c[b].e.r-c[b].s.r+1,_=c[b].e.c-c[b].s.c+1;break}if(!(g<0)){var _e=encode_cell({r:s,c:h}),nt=a.dense?(e[s]||[])[h]:e[_e],it=nt&&nt.v!=null&&(nt.h||escapehtml(nt.w||(format_cell(nt),nt.w)||""))||"",et={};g>1&&(et.rowspan=g),_>1&&(et.colspan=_),a.editable?it='<span contenteditable="true">'+it+"</span>":nt&&(et["data-t"]=nt&&nt.t||"z",nt.v!=null&&(et["data-v"]=nt.v),nt.z!=null&&(et["data-z"]=nt.z),nt.l&&(nt.l.Target||"#").charAt(0)!="#"&&(it='<a href="'+nt.l.Target+'">'+it+"</a>")),et.id=(a.id||"sjs")+"-"+_e,d.push(writextag("td",it,et))}}var lt="<tr>";return lt+d.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function make_html_preamble(e,i,s){var a=[];return a.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function sheet_to_html(e,i){var s=i||{},a=s.header!=null?s.header:HTML_BEGIN,c=s.footer!=null?s.footer:HTML_END,d=[a],h=decode_range(e["!ref"]);s.dense=Array.isArray(e),d.push(make_html_preamble(e,h,s));for(var g=h.s.r;g<=h.e.r;++g)d.push(make_html_row(e,h,g,s));return d.push("</table>"+c),d.join("")}function sheet_add_dom(e,i,s){var a=s||{},c=0,d=0;if(a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?decode_cell(a.origin):a.origin;c=h.r,d=h.c}var g=i.getElementsByTagName("tr"),_=Math.min(a.sheetRows||1e7,g.length),b={s:{r:0,c:0},e:{r:c,c:d}};if(e["!ref"]){var _e=decode_range(e["!ref"]);b.s.r=Math.min(b.s.r,_e.s.r),b.s.c=Math.min(b.s.c,_e.s.c),b.e.r=Math.max(b.e.r,_e.e.r),b.e.c=Math.max(b.e.c,_e.e.c),c==-1&&(b.e.r=c=_e.e.r+1)}var nt=[],it=0,et=e["!rows"]||(e["!rows"]=[]),lt=0,rt=0,at=0,ot=0,st=0,ct=0;for(e["!cols"]||(e["!cols"]=[]);lt<g.length&&rt<_;++lt){var mt=g[lt];if(is_dom_element_hidden(mt)){if(a.display)continue;et[rt]={hidden:!0}}var pt=mt.children;for(at=ot=0;at<pt.length;++at){var Et=pt[at];if(!(a.display&&is_dom_element_hidden(Et))){var ut=Et.hasAttribute("data-v")?Et.getAttribute("data-v"):Et.hasAttribute("v")?Et.getAttribute("v"):htmldecode(Et.innerHTML),gt=Et.getAttribute("data-z")||Et.getAttribute("z");for(it=0;it<nt.length;++it){var xt=nt[it];xt.s.c==ot+d&&xt.s.r<rt+c&&rt+c<=xt.e.r&&(ot=xt.e.c+1-d,it=-1)}ct=+Et.getAttribute("colspan")||1,((st=+Et.getAttribute("rowspan")||1)>1||ct>1)&&nt.push({s:{r:rt+c,c:ot+d},e:{r:rt+c+(st||1)-1,c:ot+d+(ct||1)-1}});var Pt={t:"s",v:ut},St=Et.getAttribute("data-t")||Et.getAttribute("t")||"";ut!=null&&(ut.length==0?Pt.t=St||"z":a.raw||ut.trim().length==0||St=="s"||(ut==="TRUE"?Pt={t:"b",v:!0}:ut==="FALSE"?Pt={t:"b",v:!1}:isNaN(fuzzynum(ut))?isNaN(fuzzydate(ut).getDate())||(Pt={t:"d",v:parseDate(ut)},a.cellDates||(Pt={t:"n",v:datenum(Pt.v)}),Pt.z=a.dateNF||table_fmt[14]):Pt={t:"n",v:fuzzynum(ut)})),Pt.z===void 0&&gt!=null&&(Pt.z=gt);var Ct="",Lt=Et.getElementsByTagName("A");if(Lt&&Lt.length)for(var er=0;er<Lt.length&&!(Lt[er].hasAttribute("href")&&(Ct=Lt[er].getAttribute("href"),Ct.charAt(0)!="#"));++er);Ct&&Ct.charAt(0)!="#"&&(Pt.l={Target:Ct}),a.dense?(e[rt+c]||(e[rt+c]=[]),e[rt+c][ot+d]=Pt):e[encode_cell({c:ot+d,r:rt+c})]=Pt,b.e.c<ot+d&&(b.e.c=ot+d),ot+=ct}}++rt}return nt.length&&(e["!merges"]=(e["!merges"]||[]).concat(nt)),b.e.r=Math.max(b.e.r,rt-1+c),e["!ref"]=encode_range(b),rt>=_&&(e["!fullref"]=encode_range((b.e.r=g.length-lt+rt-1+c,b))),e}function parse_dom_table(e,i){var s=i||{},a=s.dense?[]:{};return sheet_add_dom(a,e,i)}function table_to_book(e,i){return sheet_to_workbook(parse_dom_table(e,i),i)}function is_dom_element_hidden(e){var i="",s=get_get_computed_style_function(e);return s&&(i=s(e).getPropertyValue("display")),i||(i=e.style&&e.style.display),i==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),i="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+i}}(),write_content_ods=function(){var e=function(d){return escapexml(d).replace(/  +/g,function(h){return'<text:s text:c="'+h.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},i=`          <table:table-cell />
`,s=`          <table:covered-table-cell/>
`,a=function(d,h,g){var _=[];_.push('      <table:table table:name="'+escapexml(h.SheetNames[g])+`" table:style-name="ta1">
`);var b=0,_e=0,nt=decode_range(d["!ref"]||"A1"),it=d["!merges"]||[],et=0,lt=Array.isArray(d);if(d["!cols"])for(_e=0;_e<=nt.e.c;++_e)_.push("        <table:table-column"+(d["!cols"][_e]?' table:style-name="co'+d["!cols"][_e].ods+'"':"")+`></table:table-column>
`);var rt="",at=d["!rows"]||[];for(b=0;b<nt.s.r;++b)rt=at[b]?' table:style-name="ro'+at[b].ods+'"':"",_.push("        <table:table-row"+rt+`></table:table-row>
`);for(;b<=nt.e.r;++b){for(rt=at[b]?' table:style-name="ro'+at[b].ods+'"':"",_.push("        <table:table-row"+rt+`>
`),_e=0;_e<nt.s.c;++_e)_.push(i);for(;_e<=nt.e.c;++_e){var ot=!1,st={},ct="";for(et=0;et!=it.length;++et)if(!(it[et].s.c>_e)&&!(it[et].s.r>b)&&!(it[et].e.c<_e)&&!(it[et].e.r<b)){(it[et].s.c!=_e||it[et].s.r!=b)&&(ot=!0),st["table:number-columns-spanned"]=it[et].e.c-it[et].s.c+1,st["table:number-rows-spanned"]=it[et].e.r-it[et].s.r+1;break}if(ot){_.push(s);continue}var mt=encode_cell({r:b,c:_e}),pt=lt?(d[b]||[])[_e]:d[mt];if(pt&&pt.f&&(st["table:formula"]=escapexml(csf_to_ods_formula(pt.f)),pt.F&&pt.F.slice(0,mt.length)==mt)){var Et=decode_range(pt.F);st["table:number-matrix-columns-spanned"]=Et.e.c-Et.s.c+1,st["table:number-matrix-rows-spanned"]=Et.e.r-Et.s.r+1}if(!pt){_.push(i);continue}switch(pt.t){case"b":ct=pt.v?"TRUE":"FALSE",st["office:value-type"]="boolean",st["office:boolean-value"]=pt.v?"true":"false";break;case"n":ct=pt.w||String(pt.v||0),st["office:value-type"]="float",st["office:value"]=pt.v||0;break;case"s":case"str":ct=pt.v==null?"":pt.v,st["office:value-type"]="string";break;case"d":ct=pt.w||parseDate(pt.v).toISOString(),st["office:value-type"]="date",st["office:date-value"]=parseDate(pt.v).toISOString(),st["table:style-name"]="ce1";break;default:_.push(i);continue}var ut=e(ct);if(pt.l&&pt.l.Target){var gt=pt.l.Target;gt=gt.charAt(0)=="#"?"#"+csf_to_ods_3D(gt.slice(1)):gt,gt.charAt(0)!="#"&&!gt.match(/^\w+:/)&&(gt="../"+gt),ut=writextag("text:a",ut,{"xlink:href":gt.replace(/&/g,"&amp;")})}_.push("          "+writextag("table:table-cell",writextag("text:p",ut,{}),st)+`
`)}_.push(`        </table:table-row>
`)}return _.push(`      </table:table>
`),_.join("")},c=function(d,h){d.push(` <office:automatic-styles>
`),d.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),d.push(`   <number:month number:style="long"/>
`),d.push(`   <number:text>/</number:text>
`),d.push(`   <number:day number:style="long"/>
`),d.push(`   <number:text>/</number:text>
`),d.push(`   <number:year/>
`),d.push(`  </number:date-style>
`);var g=0;h.SheetNames.map(function(b){return h.Sheets[b]}).forEach(function(b){if(b&&b["!cols"]){for(var _e=0;_e<b["!cols"].length;++_e)if(b["!cols"][_e]){var nt=b["!cols"][_e];if(nt.width==null&&nt.wpx==null&&nt.wch==null)continue;process_col(nt),nt.ods=g;var it=b["!cols"][_e].wpx+"px";d.push('  <style:style style:name="co'+g+`" style:family="table-column">
`),d.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+it+`"/>
`),d.push(`  </style:style>
`),++g}}});var _=0;h.SheetNames.map(function(b){return h.Sheets[b]}).forEach(function(b){if(b&&b["!rows"]){for(var _e=0;_e<b["!rows"].length;++_e)if(b["!rows"][_e]){b["!rows"][_e].ods=_;var nt=b["!rows"][_e].hpx+"px";d.push('  <style:style style:name="ro'+_+`" style:family="table-row">
`),d.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+nt+`"/>
`),d.push(`  </style:style>
`),++_}}}),d.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),d.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),d.push(`  </style:style>
`),d.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),d.push(` </office:automatic-styles>
`)};return function(h,g){var _=[XML_HEADER],b=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),_e=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});g.bookType=="fods"?(_.push("<office:document"+b+_e+`>
`),_.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):_.push("<office:document-content"+b+`>
`),c(_,h),_.push(`  <office:body>
`),_.push(`    <office:spreadsheet>
`);for(var nt=0;nt!=h.SheetNames.length;++nt)_.push(a(h.Sheets[h.SheetNames[nt]],h,nt));return _.push(`    </office:spreadsheet>
`),_.push(`  </office:body>
`),g.bookType=="fods"?_.push("</office:document>"):_.push("</office:document-content>"),_.join("")}}();function write_ods(e,i){if(i.bookType=="fods")return write_content_ods(e,i);var s=zip_new(),a="",c=[],d=[];return a="mimetype",zip_add_file(s,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",zip_add_file(s,a,write_content_ods(e,i)),c.push([a,"text/xml"]),d.push([a,"ContentFile"]),a="styles.xml",zip_add_file(s,a,write_styles_ods(e,i)),c.push([a,"text/xml"]),d.push([a,"StylesFile"]),a="meta.xml",zip_add_file(s,a,XML_HEADER+write_meta_ods()),c.push([a,"text/xml"]),d.push([a,"MetadataFile"]),a="manifest.rdf",zip_add_file(s,a,write_rdf(d)),c.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",zip_add_file(s,a,write_manifest(c)),s}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,i){e:for(var s=0;s<=e.length-i.length;++s){for(var a=0;a<i.length;++a)if(e[s+a]!=i[a])continue e;return!0}return!1}function u8concat(e){var i=e.reduce(function(c,d){return c+d.length},0),s=new Uint8Array(i),a=0;return e.forEach(function(c){s.set(c,a),a+=c.length}),s}function writeDecimal128LE(e,i,s){var a=Math.floor(s==0?0:Math.LOG10E*Math.log(Math.abs(s)))+6176-20,c=s/Math.pow(10,a-6176);e[i+15]|=a>>7,e[i+14]|=(a&127)<<1;for(var d=0;c>=1;++d,c/=256)e[i+d]=c&255;e[i+15]|=s>=0?0:128}function parse_varint49(e,i){var s=i?i[0]:0,a=e[s]&127;e:if(e[s++]>=128&&(a|=(e[s]&127)<<7,e[s++]<128||(a|=(e[s]&127)<<14,e[s++]<128)||(a|=(e[s]&127)<<21,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,28),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,35),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,42),++s,e[s++]<128)))break e;return i&&(i[0]=s),a}function write_varint49(e){var i=new Uint8Array(7);i[0]=e&127;var s=1;e:if(e>127){if(i[s-1]|=128,i[s]=e>>7&127,++s,e<=16383||(i[s-1]|=128,i[s]=e>>14&127,++s,e<=2097151)||(i[s-1]|=128,i[s]=e>>21&127,++s,e<=268435455)||(i[s-1]|=128,i[s]=e/256>>>21&127,++s,e<=34359738367)||(i[s-1]|=128,i[s]=e/65536>>>21&127,++s,e<=4398046511103))break e;i[s-1]|=128,i[s]=e/16777216>>>21&127,++s}return i.slice(0,s)}function varint_to_i32(e){var i=0,s=e[i]&127;e:if(e[i++]>=128){if(s|=(e[i]&127)<<7,e[i++]<128||(s|=(e[i]&127)<<14,e[i++]<128)||(s|=(e[i]&127)<<21,e[i++]<128))break e;s|=(e[i]&127)<<28}return s}function parse_shallow(e){for(var i=[],s=[0];s[0]<e.length;){var a=s[0],c=parse_varint49(e,s),d=c&7;c=Math.floor(c/8);var h=0,g;if(c==0)break;switch(d){case 0:{for(var _=s[0];e[s[0]++]>=128;);g=e.slice(_,s[0])}break;case 5:h=4,g=e.slice(s[0],s[0]+h),s[0]+=h;break;case 1:h=8,g=e.slice(s[0],s[0]+h),s[0]+=h;break;case 2:h=parse_varint49(e,s),g=e.slice(s[0],s[0]+h),s[0]+=h;break;case 3:case 4:default:throw new Error("PB Type ".concat(d," for Field ").concat(c," at offset ").concat(a))}var b={data:g,type:d};i[c]==null?i[c]=[b]:i[c].push(b)}return i}function write_shallow(e){var i=[];return e.forEach(function(s,a){s.forEach(function(c){c.data&&(i.push(write_varint49(a*8+c.type)),c.type==2&&i.push(write_varint49(c.data.length)),i.push(c.data))})}),u8concat(i)}function parse_iwa_file(e){for(var i,s=[],a=[0];a[0]<e.length;){var c=parse_varint49(e,a),d=parse_shallow(e.slice(a[0],a[0]+c));a[0]+=c;var h={id:varint_to_i32(d[1][0].data),messages:[]};d[2].forEach(function(g){var _=parse_shallow(g.data),b=varint_to_i32(_[3][0].data);h.messages.push({meta:_,data:e.slice(a[0],a[0]+b)}),a[0]+=b}),(i=d[3])!=null&&i[0]&&(h.merge=varint_to_i32(d[3][0].data)>>>0>0),s.push(h)}return s}function write_iwa_file(e){var i=[];return e.forEach(function(s){var a=[];a[1]=[{data:write_varint49(s.id),type:0}],a[2]=[],s.merge!=null&&(a[3]=[{data:write_varint49(+!!s.merge),type:0}]);var c=[];s.messages.forEach(function(h){c.push(h.data),h.meta[3]=[{type:0,data:write_varint49(h.data.length)}],a[2].push({data:write_shallow(h.meta),type:2})});var d=write_shallow(a);i.push(write_varint49(d.length)),i.push(d),c.forEach(function(h){return i.push(h)})}),u8concat(i)}function parse_snappy_chunk(e,i){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var s=[0],a=parse_varint49(i,s),c=[];s[0]<i.length;){var d=i[s[0]]&3;if(d==0){var h=i[s[0]++]>>2;if(h<60)++h;else{var g=h-59;h=i[s[0]],g>1&&(h|=i[s[0]+1]<<8),g>2&&(h|=i[s[0]+2]<<16),g>3&&(h|=i[s[0]+3]<<24),h>>>=0,h++,s[0]+=g}c.push(i.slice(s[0],s[0]+h)),s[0]+=h;continue}else{var _=0,b=0;if(d==1?(b=(i[s[0]]>>2&7)+4,_=(i[s[0]++]&224)<<3,_|=i[s[0]++]):(b=(i[s[0]++]>>2)+1,d==2?(_=i[s[0]]|i[s[0]+1]<<8,s[0]+=2):(_=(i[s[0]]|i[s[0]+1]<<8|i[s[0]+2]<<16|i[s[0]+3]<<24)>>>0,s[0]+=4)),c=[u8concat(c)],_==0)throw new Error("Invalid offset 0");if(_>c[0].length)throw new Error("Invalid offset beyond length");if(b>=_)for(c.push(c[0].slice(-_)),b-=_;b>=c[c.length-1].length;)c.push(c[c.length-1]),b-=c[c.length-1].length;c.push(c[0].slice(-_,-_+b))}}var _e=u8concat(c);if(_e.length!=a)throw new Error("Unexpected length: ".concat(_e.length," != ").concat(a));return _e}function decompress_iwa_file(e){for(var i=[],s=0;s<e.length;){var a=e[s++],c=e[s]|e[s+1]<<8|e[s+2]<<16;s+=3,i.push(parse_snappy_chunk(a,e.slice(s,s+c))),s+=c}if(s!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(i)}function compress_iwa_file(e){for(var i=[],s=0;s<e.length;){var a=Math.min(e.length-s,268435455),c=new Uint8Array(4);i.push(c);var d=write_varint49(a),h=d.length;i.push(d),a<=60?(h++,i.push(new Uint8Array([a-1<<2]))):a<=256?(h+=2,i.push(new Uint8Array([240,a-1&255]))):a<=65536?(h+=3,i.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(h+=4,i.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(h+=5,i.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),i.push(e.slice(s,s+a)),h+=a,c[0]=0,c[1]=h&255,c[2]=h>>8&255,c[3]=h>>16&255,s+=a}return u8concat(i)}function write_new_storage(e,i){var s=new Uint8Array(32),a=u8_to_dataview(s),c=12,d=0;switch(s[0]=5,e.t){case"n":s[1]=2,writeDecimal128LE(s,c,e.v),d|=1,c+=16;break;case"b":s[1]=6,a.setFloat64(c,e.v?1:0,!0),d|=2,c+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));s[1]=3,a.setUint32(c,i.indexOf(e.v),!0),d|=8,c+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,d,!0),s.slice(0,c)}function write_old_storage(e,i){var s=new Uint8Array(32),a=u8_to_dataview(s),c=12,d=0;switch(s[0]=3,e.t){case"n":s[2]=2,a.setFloat64(c,e.v,!0),d|=32,c+=8;break;case"b":s[2]=6,a.setFloat64(c,e.v?1:0,!0),d|=32,c+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));s[2]=3,a.setUint32(c,i.indexOf(e.v),!0),d|=16,c+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,d,!0),s.slice(0,c)}function parse_TSP_Reference(e){var i=parse_shallow(e);return parse_varint49(i[1][0].data)}function write_tile_row(e,i,s){var a,c,d,h;if(!((a=e[6])!=null&&a[0])||!((c=e[7])!=null&&c[0]))throw"Mutation only works on post-BNC storages!";var g=((h=(d=e[8])==null?void 0:d[0])==null?void 0:h.data)&&varint_to_i32(e[8][0].data)>0||!1;if(g)throw"Math only works with normal offsets";for(var _=0,b=u8_to_dataview(e[7][0].data),_e=0,nt=[],it=u8_to_dataview(e[4][0].data),et=0,lt=[],rt=0;rt<i.length;++rt){if(i[rt]==null){b.setUint16(rt*2,65535,!0),it.setUint16(rt*2,65535);continue}b.setUint16(rt*2,_e,!0),it.setUint16(rt*2,et,!0);var at,ot;switch(typeof i[rt]){case"string":at=write_new_storage({t:"s",v:i[rt]},s),ot=write_old_storage({t:"s",v:i[rt]},s);break;case"number":at=write_new_storage({t:"n",v:i[rt]},s),ot=write_old_storage({t:"n",v:i[rt]},s);break;case"boolean":at=write_new_storage({t:"b",v:i[rt]},s),ot=write_old_storage({t:"b",v:i[rt]},s);break;default:throw new Error("Unsupported value "+i[rt])}nt.push(at),_e+=at.length,lt.push(ot),et+=ot.length,++_}for(e[2][0].data=write_varint49(_);rt<e[7][0].data.length/2;++rt)b.setUint16(rt*2,65535,!0),it.setUint16(rt*2,65535,!0);return e[6][0].data=u8concat(nt),e[3][0].data=u8concat(lt),_}function write_numbers_iwa(e,i){if(!i||!i.numbers)throw new Error("Must pass a `numbers` option -- check the README");var s=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=decode_range(s["!ref"]);a.s.r=a.s.c=0;var c=!1;a.e.c>9&&(c=!0,a.e.c=9),a.e.r>49&&(c=!0,a.e.r=49),c&&console.error("The Numbers writer is currently limited to ".concat(encode_range(a)));var d=sheet_to_json(s,{range:a,header:1}),h=["~Sh33tJ5~"];d.forEach(function(ht){return ht.forEach(function(dt){typeof dt=="string"&&h.push(dt)})});var g={},_=[],b=CFB.read(i.numbers,{type:"base64"});b.FileIndex.map(function(ht,dt){return[ht,b.FullPaths[dt]]}).forEach(function(ht){var dt=ht[0],Tt=ht[1];if(dt.type==2&&dt.name.match(/\.iwa/)){var Mt=dt.content,It=decompress_iwa_file(Mt),Ut=parse_iwa_file(It);Ut.forEach(function(Zt){_.push(Zt.id),g[Zt.id]={deps:[],location:Tt,type:varint_to_i32(Zt.messages[0].meta[1][0].data)}})}}),_.sort(function(ht,dt){return ht-dt});var _e=_.filter(function(ht){return ht>1}).map(function(ht){return[ht,write_varint49(ht)]});b.FileIndex.map(function(ht,dt){return[ht,b.FullPaths[dt]]}).forEach(function(ht){var dt=ht[0];if(ht[1],!!dt.name.match(/\.iwa/)){var Tt=parse_iwa_file(decompress_iwa_file(dt.content));Tt.forEach(function(Mt){Mt.messages.forEach(function(It){_e.forEach(function(Ut){Mt.messages.some(function(Zt){return varint_to_i32(Zt.meta[1][0].data)!=11006&&u8contains(Zt.data,Ut[1])})&&g[Ut[0]].deps.push(Mt.id)})})})}});for(var nt=CFB.find(b,g[1].location),it=parse_iwa_file(decompress_iwa_file(nt.content)),et,lt=0;lt<it.length;++lt){var rt=it[lt];rt.id==1&&(et=rt)}var at=parse_TSP_Reference(parse_shallow(et.messages[0].data)[1][0].data);for(nt=CFB.find(b,g[at].location),it=parse_iwa_file(decompress_iwa_file(nt.content)),lt=0;lt<it.length;++lt)rt=it[lt],rt.id==at&&(et=rt);for(at=parse_TSP_Reference(parse_shallow(et.messages[0].data)[2][0].data),nt=CFB.find(b,g[at].location),it=parse_iwa_file(decompress_iwa_file(nt.content)),lt=0;lt<it.length;++lt)rt=it[lt],rt.id==at&&(et=rt);for(at=parse_TSP_Reference(parse_shallow(et.messages[0].data)[2][0].data),nt=CFB.find(b,g[at].location),it=parse_iwa_file(decompress_iwa_file(nt.content)),lt=0;lt<it.length;++lt)rt=it[lt],rt.id==at&&(et=rt);var ot=parse_shallow(et.messages[0].data);{ot[6][0].data=write_varint49(a.e.r+1),ot[7][0].data=write_varint49(a.e.c+1);var st=parse_TSP_Reference(ot[46][0].data),ct=CFB.find(b,g[st].location),mt=parse_iwa_file(decompress_iwa_file(ct.content));{for(var pt=0;pt<mt.length&&mt[pt].id!=st;++pt);if(mt[pt].id!=st)throw"Bad ColumnRowUIDMapArchive";var Et=parse_shallow(mt[pt].messages[0].data);Et[1]=[],Et[2]=[],Et[3]=[];for(var ut=0;ut<=a.e.c;++ut){var gt=[];gt[1]=gt[2]=[{type:0,data:write_varint49(ut+420690)}],Et[1].push({type:2,data:write_shallow(gt)}),Et[2].push({type:0,data:write_varint49(ut)}),Et[3].push({type:0,data:write_varint49(ut)})}Et[4]=[],Et[5]=[],Et[6]=[];for(var xt=0;xt<=a.e.r;++xt)gt=[],gt[1]=gt[2]=[{type:0,data:write_varint49(xt+726270)}],Et[4].push({type:2,data:write_shallow(gt)}),Et[5].push({type:0,data:write_varint49(xt)}),Et[6].push({type:0,data:write_varint49(xt)});mt[pt].messages[0].data=write_shallow(Et)}ct.content=compress_iwa_file(write_iwa_file(mt)),ct.size=ct.content.length,delete ot[46];var Pt=parse_shallow(ot[4][0].data);{Pt[7][0].data=write_varint49(a.e.r+1);var St=parse_shallow(Pt[1][0].data),Ct=parse_TSP_Reference(St[2][0].data);ct=CFB.find(b,g[Ct].location),mt=parse_iwa_file(decompress_iwa_file(ct.content));{if(mt[0].id!=Ct)throw"Bad HeaderStorageBucket";var Lt=parse_shallow(mt[0].messages[0].data);for(xt=0;xt<d.length;++xt){var er=parse_shallow(Lt[2][0].data);er[1][0].data=write_varint49(xt),er[4][0].data=write_varint49(d[xt].length),Lt[2][xt]={type:Lt[2][0].type,data:write_shallow(er)}}mt[0].messages[0].data=write_shallow(Lt)}ct.content=compress_iwa_file(write_iwa_file(mt)),ct.size=ct.content.length;var Kt=parse_TSP_Reference(Pt[2][0].data);ct=CFB.find(b,g[Kt].location),mt=parse_iwa_file(decompress_iwa_file(ct.content));{if(mt[0].id!=Kt)throw"Bad HeaderStorageBucket";for(Lt=parse_shallow(mt[0].messages[0].data),ut=0;ut<=a.e.c;++ut)er=parse_shallow(Lt[2][0].data),er[1][0].data=write_varint49(ut),er[4][0].data=write_varint49(a.e.r+1),Lt[2][ut]={type:Lt[2][0].type,data:write_shallow(er)};mt[0].messages[0].data=write_shallow(Lt)}ct.content=compress_iwa_file(write_iwa_file(mt)),ct.size=ct.content.length;var nr=parse_TSP_Reference(Pt[4][0].data);(function(){for(var ht=CFB.find(b,g[nr].location),dt=parse_iwa_file(decompress_iwa_file(ht.content)),Tt,Mt=0;Mt<dt.length;++Mt){var It=dt[Mt];It.id==nr&&(Tt=It)}var Ut=parse_shallow(Tt.messages[0].data);{Ut[3]=[];var Zt=[];h.forEach(function(pr,Ar){Zt[1]=[{type:0,data:write_varint49(Ar)}],Zt[2]=[{type:0,data:write_varint49(1)}],Zt[3]=[{type:2,data:stru8(pr)}],Ut[3].push({type:2,data:write_shallow(Zt)})})}Tt.messages[0].data=write_shallow(Ut);var rr=write_iwa_file(dt),_r=compress_iwa_file(rr);ht.content=_r,ht.size=ht.content.length})();var Jt=parse_shallow(Pt[3][0].data);{var qt=Jt[1][0];delete Jt[2];var kt=parse_shallow(qt.data);{var Xt=parse_TSP_Reference(kt[2][0].data);(function(){for(var ht=CFB.find(b,g[Xt].location),dt=parse_iwa_file(decompress_iwa_file(ht.content)),Tt,Mt=0;Mt<dt.length;++Mt){var It=dt[Mt];It.id==Xt&&(Tt=It)}var Ut=parse_shallow(Tt.messages[0].data);{delete Ut[6],delete Jt[7];var Zt=new Uint8Array(Ut[5][0].data);Ut[5]=[];for(var rr=0,_r=0;_r<=a.e.r;++_r){var pr=parse_shallow(Zt);rr+=write_tile_row(pr,d[_r],h),pr[1][0].data=write_varint49(_r),Ut[5].push({data:write_shallow(pr),type:2})}Ut[1]=[{type:0,data:write_varint49(a.e.c+1)}],Ut[2]=[{type:0,data:write_varint49(a.e.r+1)}],Ut[3]=[{type:0,data:write_varint49(rr)}],Ut[4]=[{type:0,data:write_varint49(a.e.r+1)}]}Tt.messages[0].data=write_shallow(Ut);var Ar=write_iwa_file(dt),Sr=compress_iwa_file(Ar);ht.content=Sr,ht.size=ht.content.length})()}qt.data=write_shallow(kt)}Pt[3][0].data=write_shallow(Jt)}ot[4][0].data=write_shallow(Pt)}et.messages[0].data=write_shallow(ot);var sr=write_iwa_file(it),At=compress_iwa_file(sr);return nt.content=At,nt.size=nt.content.length,b}function fix_opts_func(e){return function(s){for(var a=0;a!=e.length;++a){var c=e[a];s[c[0]]===void 0&&(s[c[0]]=c[1]),c[2]==="n"&&(s[c[0]]=Number(s[c[0]]))}}}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function write_zip(e,i){return i.bookType=="ods"?write_ods(e,i):i.bookType=="numbers"?write_numbers_iwa(e,i):i.bookType=="xlsb"?write_zip_xlsxb(e,i):write_zip_xlsx(e,i)}function write_zip_xlsxb(e,i){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,browser_has_Map?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var s=i.bookType=="xlsb"?"bin":"xml",a=VBAFMTS.indexOf(i.bookType)>-1,c=new_ct();fix_write_opts(i=i||{});var d=zip_new(),h="",g=0;if(i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",zip_add_file(d,h,write_core_props(e.Props,i)),c.coreprops.push(h),add_rels(i.rels,2,h,RELS.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var _=[],b=0;b<e.SheetNames.length;++b)(e.Workbook.Sheets[b]||{}).Hidden!=2&&_.push(e.SheetNames[b]);e.Props.SheetNames=_}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(d,h,write_ext_props(e.Props)),c.extprops.push(h),add_rels(i.rels,3,h,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(h="docProps/custom.xml",zip_add_file(d,h,write_cust_props(e.Custprops)),c.custprops.push(h),add_rels(i.rels,4,h,RELS.CUST_PROPS)),g=1;g<=e.SheetNames.length;++g){var _e={"!id":{}},nt=e.Sheets[e.SheetNames[g-1]],it=(nt||{})["!type"]||"sheet";switch(it){case"chart":default:h="xl/worksheets/sheet"+g+"."+s,zip_add_file(d,h,write_ws(g-1,h,i,e,_e)),c.sheets.push(h),add_rels(i.wbrels,-1,"worksheets/sheet"+g+"."+s,RELS.WS[0])}if(nt){var et=nt["!comments"],lt=!1,rt="";et&&et.length>0&&(rt="xl/comments"+g+"."+s,zip_add_file(d,rt,write_cmnt(et,rt)),c.comments.push(rt),add_rels(_e,-1,"../comments"+g+"."+s,RELS.CMNT),lt=!0),nt["!legacy"]&&lt&&zip_add_file(d,"xl/drawings/vmlDrawing"+g+".vml",write_comments_vml(g,nt["!comments"])),delete nt["!comments"],delete nt["!legacy"]}_e["!id"].rId1&&zip_add_file(d,get_rels_path(h),write_rels(_e))}return i.Strings!=null&&i.Strings.length>0&&(h="xl/sharedStrings."+s,zip_add_file(d,h,write_sst(i.Strings,h,i)),c.strs.push(h),add_rels(i.wbrels,-1,"sharedStrings."+s,RELS.SST)),h="xl/workbook."+s,zip_add_file(d,h,write_wb(e,h)),c.workbooks.push(h),add_rels(i.rels,1,h,RELS.WB),h="xl/theme/theme1.xml",zip_add_file(d,h,write_theme(e.Themes,i)),c.themes.push(h),add_rels(i.wbrels,-1,"theme/theme1.xml",RELS.THEME),h="xl/styles."+s,zip_add_file(d,h,write_sty(e,h,i)),c.styles.push(h),add_rels(i.wbrels,-1,"styles."+s,RELS.STY),e.vbaraw&&a&&(h="xl/vbaProject.bin",zip_add_file(d,h,e.vbaraw),c.vba.push(h),add_rels(i.wbrels,-1,"vbaProject.bin",RELS.VBA)),h="xl/metadata."+s,zip_add_file(d,h,write_xlmeta(h)),c.metadata.push(h),add_rels(i.wbrels,-1,"metadata."+s,RELS.XLMETA),zip_add_file(d,"[Content_Types].xml",write_ct(c,i)),zip_add_file(d,"_rels/.rels",write_rels(i.rels)),zip_add_file(d,"xl/_rels/workbook."+s+".rels",write_rels(i.wbrels)),delete i.revssf,delete i.ssf,d}function write_zip_xlsx(e,i){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,browser_has_Map?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var s="xml",a=VBAFMTS.indexOf(i.bookType)>-1,c=new_ct();fix_write_opts(i=i||{});var d=zip_new(),h="",g=0;if(i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",zip_add_file(d,h,write_core_props(e.Props,i)),c.coreprops.push(h),add_rels(i.rels,2,h,RELS.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var _=[],b=0;b<e.SheetNames.length;++b)(e.Workbook.Sheets[b]||{}).Hidden!=2&&_.push(e.SheetNames[b]);e.Props.SheetNames=_}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(d,h,write_ext_props(e.Props)),c.extprops.push(h),add_rels(i.rels,3,h,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(h="docProps/custom.xml",zip_add_file(d,h,write_cust_props(e.Custprops)),c.custprops.push(h),add_rels(i.rels,4,h,RELS.CUST_PROPS));var _e=["SheetJ5"];for(i.tcid=0,g=1;g<=e.SheetNames.length;++g){var nt={"!id":{}},it=e.Sheets[e.SheetNames[g-1]],et=(it||{})["!type"]||"sheet";switch(et){case"chart":default:h="xl/worksheets/sheet"+g+"."+s,zip_add_file(d,h,write_ws_xml(g-1,i,e,nt)),c.sheets.push(h),add_rels(i.wbrels,-1,"worksheets/sheet"+g+"."+s,RELS.WS[0])}if(it){var lt=it["!comments"],rt=!1,at="";if(lt&&lt.length>0){var ot=!1;lt.forEach(function(st){st[1].forEach(function(ct){ct.T==!0&&(ot=!0)})}),ot&&(at="xl/threadedComments/threadedComment"+g+"."+s,zip_add_file(d,at,write_tcmnt_xml(lt,_e,i)),c.threadedcomments.push(at),add_rels(nt,-1,"../threadedComments/threadedComment"+g+"."+s,RELS.TCMNT)),at="xl/comments"+g+"."+s,zip_add_file(d,at,write_comments_xml(lt)),c.comments.push(at),add_rels(nt,-1,"../comments"+g+"."+s,RELS.CMNT),rt=!0}it["!legacy"]&&rt&&zip_add_file(d,"xl/drawings/vmlDrawing"+g+".vml",write_comments_vml(g,it["!comments"])),delete it["!comments"],delete it["!legacy"]}nt["!id"].rId1&&zip_add_file(d,get_rels_path(h),write_rels(nt))}return i.Strings!=null&&i.Strings.length>0&&(h="xl/sharedStrings."+s,zip_add_file(d,h,write_sst_xml(i.Strings,i)),c.strs.push(h),add_rels(i.wbrels,-1,"sharedStrings."+s,RELS.SST)),h="xl/workbook."+s,zip_add_file(d,h,write_wb_xml(e)),c.workbooks.push(h),add_rels(i.rels,1,h,RELS.WB),h="xl/theme/theme1.xml",zip_add_file(d,h,write_theme(e.Themes,i)),c.themes.push(h),add_rels(i.wbrels,-1,"theme/theme1.xml",RELS.THEME),h="xl/styles."+s,zip_add_file(d,h,write_sty_xml(e,i)),c.styles.push(h),add_rels(i.wbrels,-1,"styles."+s,RELS.STY),e.vbaraw&&a&&(h="xl/vbaProject.bin",zip_add_file(d,h,e.vbaraw),c.vba.push(h),add_rels(i.wbrels,-1,"vbaProject.bin",RELS.VBA)),h="xl/metadata."+s,zip_add_file(d,h,write_xlmeta_xml()),c.metadata.push(h),add_rels(i.wbrels,-1,"metadata."+s,RELS.XLMETA),_e.length>1&&(h="xl/persons/person.xml",zip_add_file(d,h,write_people_xml(_e)),c.people.push(h),add_rels(i.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(d,"[Content_Types].xml",write_ct(c,i)),zip_add_file(d,"_rels/.rels",write_rels(i.rels)),zip_add_file(d,"xl/_rels/workbook."+s+".rels",write_rels(i.wbrels)),delete i.revssf,delete i.ssf,d}function firstbyte(e,i){var s="";switch((i||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":s=Base64_decode(e.slice(0,12));break;case"binary":s=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(i&&i.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function write_cfb_ctr(e,i){switch(i.type){case"base64":case"binary":break;case"buffer":case"array":i.type="";break;case"file":return write_dl(i.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");default:throw new Error("Unrecognized type "+i.type)}return CFB.write(e,i)}function write_zip_type(e,i){var s=dup(i||{}),a=write_zip(e,s);return write_zip_denouement(a,s)}function write_zip_denouement(e,i){var s={},a=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(i.compression&&(s.compression="DEFLATE"),i.password)s.type=a;else switch(i.type){case"base64":s.type="base64";break;case"binary":s.type="string";break;case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");case"buffer":case"file":s.type=a;break;default:throw new Error("Unrecognized type "+i.type)}var c=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[s.type]||s.type,compression:!!i.compression}):e.generate(s);if(typeof Deno<"u"&&typeof c=="string"){if(i.type=="binary"||i.type=="base64")return c;c=new Uint8Array(s2ab(c))}return i.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(c,i.password),i):i.type==="file"?write_dl(i.file,c):i.type=="string"?utf8read(c):c}function write_cfb_type(e,i){var s=i||{},a=write_xlscfb(e,s);return write_cfb_ctr(a,s)}function write_string_type(e,i,s){s||(s="");var a=s+e;switch(i.type){case"base64":return Base64_encode(utf8write(a));case"binary":return utf8write(a);case"string":return e;case"file":return write_dl(i.file,a,"utf8");case"buffer":return has_buf?Buffer_from(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):write_string_type(a,{type:"binary"}).split("").map(function(c){return c.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function write_stxt_type(e,i){switch(i.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(i.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function write_binary_type(e,i){switch(i.type){case"string":case"base64":case"binary":for(var s="",a=0;a<e.length;++a)s+=String.fromCharCode(e[a]);return i.type=="base64"?Base64_encode(s):i.type=="string"?utf8read(s):s;case"file":return write_dl(i.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+i.type)}}function writeSync(e,i){reset_cp(),check_wb(e);var s=dup(i||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),s.type=="array"){s.type="binary";var a=writeSync(e,s);return s.type="array",s2ab(a)}var c=0;if(s.sheet&&(typeof s.sheet=="number"?c=s.sheet:c=e.SheetNames.indexOf(s.sheet),!e.SheetNames[c]))throw new Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,s),s);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[c]],s),s);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[c]],s),s);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[c]],s),s);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[c]],s),s,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[c]],s),s);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[c]],s),s);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[c]],s),s);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[c]],s),s);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[c]],s),s);case"fods":return write_string_type(write_ods(e,s),s);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[c]],s),s);case"wk3":return write_binary_type(WK_.book_to_wk3(e,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),write_binary_type(write_biff_buf(e,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),write_cfb_type(e,s);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,s);default:throw new Error("Unrecognized bookType |"+s.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var i={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},s=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();s.match(/^\.[a-z]+$/)&&(e.bookType=s.slice(1)),e.bookType=i[e.bookType]||e.bookType}}function writeFileSync(e,i,s){var a={};return a.type="file",a.file=i,resolve_book_type(a),writeSync(e,a)}function make_json_row(e,i,s,a,c,d,h,g){var _=encode_row(s),b=g.defval,_e=g.raw||!Object.prototype.hasOwnProperty.call(g,"raw"),nt=!0,it=c===1?[]:{};if(c!==1)if(Object.defineProperty)try{Object.defineProperty(it,"__rowNum__",{value:s,enumerable:!1})}catch{it.__rowNum__=s}else it.__rowNum__=s;if(!h||e[s])for(var et=i.s.c;et<=i.e.c;++et){var lt=h?e[s][et]:e[a[et]+_];if(lt===void 0||lt.t===void 0){if(b===void 0)continue;d[et]!=null&&(it[d[et]]=b);continue}var rt=lt.v;switch(lt.t){case"z":if(rt==null)break;continue;case"e":rt=rt==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+lt.t)}if(d[et]!=null){if(rt==null)if(lt.t=="e"&&rt===null)it[d[et]]=null;else if(b!==void 0)it[d[et]]=b;else if(_e&&rt===null)it[d[et]]=null;else continue;else it[d[et]]=_e&&(lt.t!=="n"||lt.t==="n"&&g.rawNumbers!==!1)?rt:format_cell(lt,rt,g);rt!=null&&(nt=!1)}}return{row:it,isempty:nt}}function sheet_to_json(e,i){if(e==null||e["!ref"]==null)return[];var s={t:"n",v:0},a=0,c=1,d=[],h=0,g="",_={s:{r:0,c:0},e:{r:0,c:0}},b=i||{},_e=b.range!=null?b.range:e["!ref"];switch(b.header===1?a=1:b.header==="A"?a=2:Array.isArray(b.header)?a=3:b.header==null&&(a=0),typeof _e){case"string":_=safe_decode_range(_e);break;case"number":_=safe_decode_range(e["!ref"]),_.s.r=_e;break;default:_=_e}a>0&&(c=0);var nt=encode_row(_.s.r),it=[],et=[],lt=0,rt=0,at=Array.isArray(e),ot=_.s.r,st=0,ct={};at&&!e[ot]&&(e[ot]=[]);var mt=b.skipHidden&&e["!cols"]||[],pt=b.skipHidden&&e["!rows"]||[];for(st=_.s.c;st<=_.e.c;++st)if(!(mt[st]||{}).hidden)switch(it[st]=encode_col(st),s=at?e[ot][st]:e[it[st]+nt],a){case 1:d[st]=st-_.s.c;break;case 2:d[st]=it[st];break;case 3:d[st]=b.header[st-_.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),g=h=format_cell(s,null,b),rt=ct[h]||0,!rt)ct[h]=1;else{do g=h+"_"+rt++;while(ct[g]);ct[h]=rt,ct[g]=1}d[st]=g}for(ot=_.s.r+c;ot<=_.e.r;++ot)if(!(pt[ot]||{}).hidden){var Et=make_json_row(e,_,ot,it,a,d,at,b);(Et.isempty===!1||(a===1?b.blankrows!==!1:b.blankrows))&&(et[lt++]=Et.row)}return et.length=lt,et}var qreg=/"/g;function make_csv_row(e,i,s,a,c,d,h,g){for(var _=!0,b=[],_e="",nt=encode_row(s),it=i.s.c;it<=i.e.c;++it)if(a[it]){var et=g.dense?(e[s]||[])[it]:e[a[it]+nt];if(et==null)_e="";else if(et.v!=null){_=!1,_e=""+(g.rawNumbers&&et.t=="n"?et.v:format_cell(et,null,g));for(var lt=0,rt=0;lt!==_e.length;++lt)if((rt=_e.charCodeAt(lt))===c||rt===d||rt===34||g.forceQuotes){_e='"'+_e.replace(qreg,'""')+'"';break}_e=="ID"&&(_e='"ID"')}else et.f!=null&&!et.F?(_=!1,_e="="+et.f,_e.indexOf(",")>=0&&(_e='"'+_e.replace(qreg,'""')+'"')):_e="";b.push(_e)}return g.blankrows===!1&&_?null:b.join(h)}function sheet_to_csv(e,i){var s=[],a=i??{};if(e==null||e["!ref"]==null)return"";var c=safe_decode_range(e["!ref"]),d=a.FS!==void 0?a.FS:",",h=d.charCodeAt(0),g=a.RS!==void 0?a.RS:`
`,_=g.charCodeAt(0),b=new RegExp((d=="|"?"\\|":d)+"+$"),_e="",nt=[];a.dense=Array.isArray(e);for(var it=a.skipHidden&&e["!cols"]||[],et=a.skipHidden&&e["!rows"]||[],lt=c.s.c;lt<=c.e.c;++lt)(it[lt]||{}).hidden||(nt[lt]=encode_col(lt));for(var rt=0,at=c.s.r;at<=c.e.r;++at)(et[at]||{}).hidden||(_e=make_csv_row(e,c,at,nt,h,_,d,a),_e!=null&&(a.strip&&(_e=_e.replace(b,"")),(_e||a.blankrows!==!1)&&s.push((rt++?g:"")+_e)));return delete a.dense,s.join("")}function sheet_to_txt(e,i){i||(i={}),i.FS="	",i.RS=`
`;var s=sheet_to_csv(e,i);return s}function sheet_to_formulae(e){var i="",s,a="";if(e==null||e["!ref"]==null)return[];var c=safe_decode_range(e["!ref"]),d="",h=[],g,_=[],b=Array.isArray(e);for(g=c.s.c;g<=c.e.c;++g)h[g]=encode_col(g);for(var _e=c.s.r;_e<=c.e.r;++_e)for(d=encode_row(_e),g=c.s.c;g<=c.e.c;++g)if(i=h[g]+d,s=b?(e[_e]||[])[g]:e[i],a="",s!==void 0){if(s.F!=null){if(i=s.F,!s.f)continue;a=s.f,i.indexOf(":")==-1&&(i=i+":"+i)}if(s.f!=null)a=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)a=""+s.v;else if(s.t=="b")a=s.v?"TRUE":"FALSE";else if(s.w!==void 0)a="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?a="'"+s.v:a=""+s.v}}_[_.length]=i+"="+a}return _}function sheet_add_json(e,i,s){var a=s||{},c=+!a.skipHeader,d=e||{},h=0,g=0;if(d&&a.origin!=null)if(typeof a.origin=="number")h=a.origin;else{var _=typeof a.origin=="string"?decode_cell(a.origin):a.origin;h=_.r,g=_.c}var b,_e={s:{c:0,r:0},e:{c:g,r:h+i.length-1+c}};if(d["!ref"]){var nt=safe_decode_range(d["!ref"]);_e.e.c=Math.max(_e.e.c,nt.e.c),_e.e.r=Math.max(_e.e.r,nt.e.r),h==-1&&(h=nt.e.r+1,_e.e.r=h+i.length-1+c)}else h==-1&&(h=0,_e.e.r=i.length-1+c);var it=a.header||[],et=0;i.forEach(function(rt,at){keys(rt).forEach(function(ot){(et=it.indexOf(ot))==-1&&(it[et=it.length]=ot);var st=rt[ot],ct="z",mt="",pt=encode_cell({c:g+et,r:h+at+c});b=ws_get_cell_stub(d,pt),st&&typeof st=="object"&&!(st instanceof Date)?d[pt]=st:(typeof st=="number"?ct="n":typeof st=="boolean"?ct="b":typeof st=="string"?ct="s":st instanceof Date?(ct="d",a.cellDates||(ct="n",st=datenum(st)),mt=a.dateNF||table_fmt[14]):st===null&&a.nullError&&(ct="e",st=0),b?(b.t=ct,b.v=st,delete b.w,delete b.R,mt&&(b.z=mt)):d[pt]=b={t:ct,v:st},mt&&(b.z=mt))})}),_e.e.c=Math.max(_e.e.c,g+it.length-1);var lt=encode_row(h);if(c)for(et=0;et<it.length;++et)d[encode_col(et+g)+lt]={t:"s",v:it[et]};return d["!ref"]=encode_range(_e),d}function json_to_sheet(e,i){return sheet_add_json(null,e,i)}function ws_get_cell_stub(e,i,s){if(typeof i=="string"){if(Array.isArray(e)){var a=decode_cell(i);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[i]||(e[i]={t:"z"})}return typeof i!="number"?ws_get_cell_stub(e,encode_cell(i)):ws_get_cell_stub(e,encode_cell({r:i,c:s||0}))}function wb_sheet_idx(e,i){if(typeof i=="number"){if(i>=0&&e.SheetNames.length>i)return i;throw new Error("Cannot find sheet # "+i)}else if(typeof i=="string"){var s=e.SheetNames.indexOf(i);if(s>-1)return s;throw new Error("Cannot find sheet name |"+i+"|")}else throw new Error("Cannot find sheet |"+i+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,i,s,a){var c=1;if(!s)for(;c<=65535&&e.SheetNames.indexOf(s="Sheet"+c)!=-1;++c,s=void 0);if(!s||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(s)>=0){var d=s.match(/(^.*?)(\d+)$/);c=d&&+d[2]||0;var h=d&&d[1]||s;for(++c;c<=65535&&e.SheetNames.indexOf(s=h+c)!=-1;++c);}if(check_ws_name(s),e.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return e.SheetNames.push(s),e.Sheets[s]=i,s}function book_set_sheet_visibility(e,i,s){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=wb_sheet_idx(e,i);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}e.Workbook.Sheets[a].Hidden=s}function cell_set_number_format(e,i){return e.z=i,e}function cell_set_hyperlink(e,i,s){return i?(e.l={Target:i},s&&(e.l.Tooltip=s)):delete e.l,e}function cell_set_internal_link(e,i,s){return cell_set_hyperlink(e,"#"+i,s)}function cell_add_comment(e,i,s){e.c||(e.c=[]),e.c.push({t:i,a:s||"SheetJS"})}function sheet_set_array_formula(e,i,s,a){for(var c=typeof i!="string"?i:safe_decode_range(i),d=typeof i=="string"?i:encode_range(i),h=c.s.r;h<=c.e.r;++h)for(var g=c.s.c;g<=c.e.c;++g){var _=ws_get_cell_stub(e,h,g);_.t="n",_.F=d,delete _.v,h==c.s.r&&g==c.s.c&&(_.f=s,a&&(_.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const cteToExcelRow=e=>({Data:e.dataEmissao,"N CT-e":e.numeroCTe,Srie:e.serie,Chave:e.chaveAcesso,Transportadora:e.transportadora,"CNPJ Transportadora":formatCNPJ(e.cnpjTransportadora),Remetente:e.remetente,"CNPJ Remetente":formatCNPJ(e.cnpjRemetente),Origem:e.cidadeOrigem&&e.ufOrigem?`${e.cidadeOrigem} - ${e.ufOrigem}`:e.cidadeOrigem||e.ufOrigem,Destinatrio:e.destinatario,"CNPJ Destinatrio":formatCNPJ(e.cnpjDestinatario),Destino:e.cidadeDestino&&e.ufDestino?`${e.cidadeDestino} - ${e.ufDestino}`:e.cidadeDestino||e.ufDestino,Produto:e.produto,"Peso KG":e.peso?parseFloat(e.peso):"",Volumes:e.quantidadeVolumes?parseInt(e.quantidadeVolumes):"","Valor Carga (R$)":e.valorTotalCarga?parseFloat(e.valorTotalCarga):"","Valor Frete (R$)":e.valorFrete?parseFloat(e.valorFrete):"","ICMS (R$)":e.valorICMS?parseFloat(e.valorICMS):"","NF-e":e.nfe,"Placa Veculo":""}),generateExcel=e=>{if(!e||e.length===0){console.error("Nenhum dado para gerar Excel");return}const i=e.map(cteToExcelRow),s=utils.json_to_sheet(i);s["!cols"]=[{wch:12},{wch:10},{wch:8},{wch:48},{wch:30},{wch:20},{wch:30},{wch:20},{wch:25},{wch:30},{wch:20},{wch:25},{wch:35},{wch:12},{wch:10},{wch:15},{wch:15},{wch:12},{wch:15},{wch:15}];const a=utils.book_new();utils.book_append_sheet(a,s,"CT-e");const c=e[0],d=getMonthYearFromDate(c.dataEmissao)||getCurrentMonthYear(),g=`CTe_${getMonthName(d.month)}_${d.year}.xlsx`;writeFileSync(a,g)},formatCNPJ=e=>!e||e.length!==14?e:e.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"),DB_NAME="CTeStorage",DB_VERSION=1,STORE_NAME="cteData",initDB=()=>new Promise((e,i)=>{const s=indexedDB.open(DB_NAME,DB_VERSION);s.onerror=()=>i(s.error),s.onsuccess=()=>e(s.result),s.onupgradeneeded=a=>{const c=a.target.result;c.objectStoreNames.contains(STORE_NAME)||c.createObjectStore(STORE_NAME,{keyPath:"monthYear"}).createIndex("monthYear","monthYear",{unique:!0})}}),getMonthKey=e=>{if(!e)return null;const i=e.split("/");if(i.length!==3)return null;const s=parseInt(i[0],10),a=parseInt(i[1],10),c=parseInt(i[2],10);return isNaN(s)||isNaN(a)||isNaN(c)?null:{year:c,month:a}},getCurrentMonthKey=()=>{const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1}},createMonthKeyString=e=>`${e.year}-${e.month.toString().padStart(2,"0")}`,addCTeToStorage=async e=>{const i=getMonthKey(e.dataEmissao)||getCurrentMonthKey(),s=createMonthKeyString(i);try{const d=(await initDB()).transaction([STORE_NAME],"readwrite").objectStore(STORE_NAME),g=d.index("monthYear").get(s);return new Promise((_,b)=>{g.onsuccess=()=>{const _e=g.result;let nt=[];_e&&_e.cteList&&(nt=_e.cteList),nt.push(e);const it=d.put({monthYear:s,cteList:nt});it.onsuccess=()=>_(),it.onerror=()=>b(it.error)},g.onerror=()=>b(g.error)})}catch(a){throw console.error("Erro ao adicionar CT-e ao armazenamento:",a),a}},getCTesFromCurrentMonth=async()=>{const e=getCurrentMonthKey(),i=createMonthKeyString(e);try{const h=(await initDB()).transaction([STORE_NAME],"readonly").objectStore(STORE_NAME).index("monthYear").get(i);return new Promise((g,_)=>{h.onsuccess=()=>{const b=h.result;g(b&&b.cteList?b.cteList:[])},h.onerror=()=>_(h.error)})}catch(s){return console.error("Erro ao recuperar CT-es do ms atual:",s),[]}},getCurrentMonthCount=async()=>(await getCTesFromCurrentMonth()).length,Card=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...i}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("flex flex-col space-y-1.5 p-6",e),...i}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("h3",{ref:s,className:cn("text-2xl font-semibold leading-none tracking-tight",e),...i}));CardTitle.displayName="CardTitle";const CardDescription=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("p",{ref:s,className:cn("text-sm text-muted-foreground",e),...i}));CardDescription.displayName="CardDescription";const CardContent=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("p-6 pt-0",e),...i}));CardContent.displayName="CardContent";const CardFooter=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("flex items-center p-6 pt-0",e),...i}));CardFooter.displayName="CardFooter";const badgeVariants=cva("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Badge({className:e,variant:i,...s}){return jsxRuntimeExports.jsx("div",{className:cn(badgeVariants({variant:i}),e),...s})}const Index=()=>{const[e,i]=reactExports.useState(null),[s,a]=reactExports.useState(null),[c,d]=reactExports.useState(!1),[h,g]=reactExports.useState(null),[_,b]=reactExports.useState(!1),[_e,nt]=reactExports.useState(0),[it,et]=reactExports.useState(null);reactExports.useEffect(()=>{_?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[_]),reactExports.useEffect(()=>{(async()=>{const st=await getCurrentMonthCount();nt(st)})()},[]);const lt=ot=>{if(ot&&ot.size>10*1024*1024){g("Arquivo muito grande. Mximo 10MB");return}i(ot),g(null),a(null)},rt=async()=>{if(!e){g("Selecione um arquivo primeiro");return}d(!0),g(null),et(null);try{const ot=await extractCTeData(e);await addCTeToStorage(ot);const st=await getCTesFromCurrentMonth();nt(st.length),generateExcel(st),a(ot),et(`CT-e adicionado ao Excel do ms! Total: ${st.length} CT-e(s) processado(s) este ms.`),setTimeout(()=>et(null),5e3)}catch(ot){console.error("Extraction error:",ot),g("Erro ao processar CT-e. Verifique se o arquivo  um PDF vlido.")}finally{d(!1)}},at=async()=>{try{const ot=await getCTesFromCurrentMonth();if(ot.length===0){g("Nenhum CT-e processado este ms ainda.");return}generateExcel(ot)}catch(ot){console.error("Download error:",ot),g("Erro ao gerar Excel. Tente novamente.")}};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex bg-background",children:[jsxRuntimeExports.jsx(Sidebar,{darkMode:_,onToggleDarkMode:()=>b(!_)}),jsxRuntimeExports.jsx("main",{className:"flex-1 p-8",children:jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold mb-2",children:" Extrair Dados do CT-e"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mb-8 font-mono text-sm",children:"Faa upload do PDF e gere sua planilha Excel automaticamente"}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{children:"Excel do Ms Atual"}),jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"text-sm",children:[getMonthName(getCurrentMonthYear().month)," ",getCurrentMonthYear().year]})]}),jsxRuntimeExports.jsx(CardDescription,{children:"Todos os CT-es processados este ms sero acumulados no mesmo arquivo Excel"})]}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold",children:_e}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"CT-e(s) processado(s) este ms"})]}),jsxRuntimeExports.jsxs(Button,{onClick:at,disabled:_e===0,variant:"outline",className:"gap-2",children:[jsxRuntimeExports.jsx(FileSpreadsheet,{className:"w-4 h-4"}),"Baixar Excel do Ms"]})]})})]}),it&&jsxRuntimeExports.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:jsxRuntimeExports.jsxs("p",{className:"text-green-800 dark:text-green-200 text-sm font-medium",children:[" ",it]})}),jsxRuntimeExports.jsx(UploadArea,{file:e,onFileSelect:lt,disabled:c}),jsxRuntimeExports.jsx(Button,{onClick:rt,disabled:!e||c,size:"lg",className:"w-full gap-2 font-bold text-base",children:c?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-5 h-5 animate-spin"}),"Extraindo dados..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Rocket,{className:"w-5 h-5"}),"Extrair Dados"]})}),h&&jsxRuntimeExports.jsx(ErrorMessage,{message:h}),s&&jsxRuntimeExports.jsx(ResultCard,{data:s,fieldsCount:countExtractedFields(s),missingFields:getMissingFields(s),onDownload:at})]})]})})]})},NotFound=()=>{const e=useLocation();return reactExports.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname),fetch("http://127.0.0.1:7242/ingest/730c0d06-4f93-497d-8fb0-19604a532633",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"NotFound.tsx:useEffect",message:"404 error triggered",data:{pathname:e.pathname,search:e.search,hash:e.hash,windowPathname:window.location.pathname,windowHref:window.location.href,viteBase:"/ct-e-to-excel/"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"D"})}).catch(()=>{})},[e.pathname]),jsxRuntimeExports.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),jsxRuntimeExports.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),jsxRuntimeExports.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},queryClient=new QueryClient,App=()=>jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsxs(TooltipProvider,{children:[jsxRuntimeExports.jsx(Toaster$1,{}),jsxRuntimeExports.jsx(Toaster,{}),jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Index,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})})]})})]})});createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
